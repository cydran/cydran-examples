{"version":3,"sources":["webpack://cydran/webpack/universalModuleDefinition","webpack://cydran/webpack/bootstrap","webpack://cydran/./src/Core.ts","webpack://cydran/./src/error/AbstractCydranError.ts","webpack://cydran/./src/logger/Level.ts","webpack://cydran/./src/logger/LoggerFactory.ts","webpack://cydran/./src/ObjectUtils.ts","webpack://cydran/./src/Config.ts","webpack://cydran/./src/logger/LoggerService.ts","webpack://cydran/./src/logger/LoggerImpl.ts","webpack://cydran/./src/messaging/PubSub.ts","webpack://cydran/(webpack)/buildin/global.js","webpack://cydran/./src/index.ts","webpack://cydran/./src/logger/ConsoleOutputStrategy.ts","webpack://cydran/./src/logger/LevelUtils.ts","webpack://cydran/./src/error/DigestLoopError.ts","webpack://cydran/./src/error/MalformedOnEventError.ts","webpack://cydran/./src/error/SelectorError.ts","webpack://cydran/./src/error/SetComponentError.ts","webpack://cydran/./src/error/TemplateError.ts","webpack://cydran/./src/error/UnknownRegionError.ts","webpack://cydran/./src/GuardGenerator.ts","webpack://cydran/./src/GuardImpl.ts","webpack://cydran/./src/messaging/ListenerImpl.ts","webpack://cydran/./src/ModelMediatorImpl.ts","webpack://cydran/(webpack)/buildin/module.js","webpack://cydran/./src/Properties.ts","webpack://cydran/./src/Registry.ts","webpack://cydran/./src/error/RegistrationError.ts","webpack://cydran/./src/ScopeImpl.ts","webpack://cydran/./src/error/ScopeError.ts","webpack://cydran/./src/SequenceGenerator.ts","webpack://cydran/./src/mediator/index.ts","webpack://cydran/./src/mediator/Checked.ts","webpack://cydran/./src/mediator/CSSClass.ts","webpack://cydran/./src/mediator/Content.ts","webpack://cydran/./src/mediator/Enabled.ts","webpack://cydran/./src/mediator/ReadOnly.ts","webpack://cydran/./src/mediator/Style.ts","webpack://cydran/./src/mediator/ForceFocus.ts","webpack://cydran/./src/mediator/MultiSelectValueModel.ts","webpack://cydran/./src/mediator/ValuedModel.ts","webpack://cydran/./src/mediator/InputValueModel.ts","webpack://cydran/./src/mediator/Visible.ts","webpack://cydran/./src/mediator/Repeat.ts","webpack://cydran/./src/Stage.ts","webpack://cydran/./src/DomUtils.ts"],"names":["root","factory","exports","module","define","amd","window","installedModules","__webpack_require__","moduleId","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","Properties","INTERNAL_DIRECT_CHANNEL_NAME","INTERNAL_CHANNEL_NAME","COMPONENT_INTERNALS_FIELD_NAME","MODULE_FIELD_NAME","Events","AFTER_CHILD_ADDED","AFTER_CHILD_CHANGED","AFTER_CHILD_REMOVED","AFTER_PARENT_ADDED","AFTER_PARENT_CHANGED","AFTER_PARENT_REMOVED","BEFORE_CHILD_ADDED","BEFORE_CHILD_CHANGED","BEFORE_CHILD_REMOVED","BEFORE_DISPOSE","BEFORE_PARENT_ADDED","BEFORE_PARENT_CHANGED","BEFORE_PARENT_REMOVED","this","logger","getLogger","listeners","broadcast","channelName","messageName","payload","trace","receive","addListener","listener","getChannelName","contains","push","removeListener","remove","length","dispose","array","instance","splice","ALIASES","scope","registry","RegistryImpl","broker","BrokerImpl","setParent","getName","associate","componentClasses","forEach","componentClass","disassociate","clear","message","id","result","Modules","getLocal","getScope","registerConstant","e","logError","registerPrototype","classInstance","registerSingleton","addStrategy","strategy","expose","error","ModuleImpl","DEFAULT_MODULE","getModule","getDefaultModule","fn","registerElementMediator","supportedTags","elementMediatorClass","Mvvm","register","DEFAULT","source","internals","component","componentName","template","attributePrefix","____internal$$cydran____","DeferredInternals","src","ComponentInternals","hasMetadata","getMetadata","hasRegion","setChild","setChildFromRegistry","defaultComponentName","getParent","getEl","getItem","getData","broadcastGlobally","$apply","args","watch","expression","target","withMetadata","on","forChannel","channel","invoke","Component","flags","repeatable","parent","prefix","toLocaleLowerCase","trim","INSTANCE","next","mvvm","regions","pubSub","render","init","el","getRegion","guard","generate","metadata","localGuard","down","seen","mark","hasComponent","childAdded","childRemoved","setComponent","propagateDigest","digest","setData","getId","getComponent","getPrefix","mediate","targetChannel","data","getGuard","Region","getTemplate","templateEl","getWindow","document","createElement","insertAdjacentHTML","count","childElementCount","parmObj","fatal","firstElementChild","setEl","parentAdded","parentRemoved","up","isPropagateUp","elements","querySelectorAll","eLength","errMsg","patSubObj","element","hasChildNodes","removeChild","firstChild","regionDiv","setAttribute","appendChild","selector","StageComponentInternals","StageComponent","dependencies","previous","params","domListeners","removeDomListeners","unwire","mediator","getExpression","wire","moduleInstance","setModule","listenTo","apply","listenToFramework","bridge","event","addEventListener","getModel","model","getModelMediator","notifyModelInteraction","removeEventListener","ElementMediator","defaultEl","setDefaultEl","newComponentEl","parentElement","replaceChild","oldComponentEl","onTargetChange","current","replacement","encodeHtml","innerHTML","handleEvent","eventKey","setEventKey","setAttributeName","attributeName","elementMediatorPrefix","eventElementMediatorPrefix","regionPrefix","componentPrefix","elementMediators","mediators","components","add","factories","supportedTag","regionLookupFn","populateElementMediators","localGuardUp","localGuardDown","remainingEvaluations","pending","changedMediators","evaluate","notifyWatcher","executeCallback","queue","processChild","pop","regex","elName","tagName","toLowerCase","getAttribute","moduleName","children","processTextChildren","childNodes","getAttributeNames","indexOf","eventName","substr","test","addEventElementMediator","removeAttribute","elementMediatorType","addElementMediator","trimmedExpression","substring","addAttributeElementMediator","regionName","discoveredNodes","child","nodeType","node","splitChild","newNode","parentNode","insertBefore","sections","textContent","split","inside","collected","section","span","addTextElementMediator","textNode","createTextNode","deps","elementMediator","TextElementMediator","EventElementMediator","AttributeElementMediator","tag","attributeValue","tags","msg","reps","CydranError","TypeError","doMsgFilling","replace","all","Error","NEWI","Level","LoggerFactory","CLONE_DEEP_FLAG","CLONE_FLAT_FLAG","CLONE_SYMBOLS_FLAG","COMPARE_PARTIAL_FLAG","COMPARE_UNORDERED_FLAG","MAX_SAFE_INTEGER","argsTag","arrayTag","asyncTag","boolTag","dateTag","errorTag","funcTag","genTag","mapTag","numberTag","nullTag","objectTag","proxyTag","regexpTag","setTag","stringTag","symbolTag","undefinedTag","weakMapTag","arrayBufferTag","dataViewTag","float32Tag","float64Tag","int8Tag","int16Tag","int32Tag","uint8Tag","uint8ClampedTag","uint16Tag","uint32Tag","reFlags","reIsHostCtor","reIsUint","typedArrayTags","cloneableTags","freeGlobal","global","freeSelf","self","Function","freeExports","freeModule","moduleExports","arrayPush","values","offset","index","mapToArray","map","Array","size","overArg","func","transform","arg","setToArray","set","uid","context","arrayProto","funcProto","objectProto","coreJsData","funcToString","toString","maskSrcKey","exec","keys","IE_PROTO","nativeObjectToString","reIsNative","RegExp","Buffer","undefined","Uint8Array","allocUnsafe","getPrototype","getPrototypeOf","objectCreate","propertyIsEnumerable","symToStringTag","nativeGetSymbols","getOwnPropertySymbols","nativeIsBuffer","isBuffer","nativeKeys","DataView","getNative","Map","Promise","Set","WeakMap","nativeCreate","dataViewCtorString","toSource","mapCtorString","promiseCtorString","setCtorString","weakMapCtorString","symbolProto","symbolValueOf","valueOf","baseCreate","proto","isObject","entries","entry","__DATA__","delete","has","assocIndexOf","hash","Hash","ListCache","string","getMapData","MapCache","pairs","LARGE_ARRAY_SIZE","arrayLikeKeys","inherited","isArr","isArray","isArg","isArguments","isBuff","isType","isTypedArray","skipIndexes","iteratee","baseTimes","String","isIndex","assignValue","objValue","eq","baseAssignValue","configurable","writable","baseClone","bitmask","customizer","stack","isDeep","isFlat","isFull","constructor","input","initCloneArray","copyArray","getTag","isFunc","buffer","slice","copy","cloneBuffer","isPrototype","initCloneObject","copyObject","getSymbolsIn","copySymbolsIn","keysIn","baseAssignIn","getSymbols","copySymbols","baseAssign","Ctor","cloneArrayBuffer","dataView","byteOffset","byteLength","cloneDataView","typedArray","cloneTypedArray","regexp","lastIndex","cloneRegExp","symbol","initCloneByTag","stacked","Stack","isSet","subValue","isMap","props","getAllKeysIn","getAllKeys","arrayEach","baseGetAllKeys","keysFunc","symbolsFunc","baseGetTag","isOwn","unmasked","getRawTag","objectToString","baseIsArguments","isObjectLike","baseIsEqual","other","equalFunc","objIsArr","othIsArr","objTag","othTag","objIsObj","othIsObj","isSameTag","equalArrays","convert","isPartial","equalByTag","objIsWrapped","othIsWrapped","objUnwrapped","othUnwrapped","objProps","objLength","othLength","skipCtor","othValue","compared","objCtor","othCtor","equalObjects","baseIsEqualDeep","baseIsNative","isFunction","baseKeysIn","nativeKeysIn","isProto","arrayBuffer","ctor","isNew","newValue","arrLength","SetCache","arrValue","predicate","arraySome","othIndex","type","getValue","resIndex","arrayFilter","stubArray","ArrayBuffer","resolve","ctorString","arguments","isArrayLike","isLength","baseKeys","encodeHtmlMap","lookupEncodeHtmlMap","clone","equals","first","second","Config","useTrace","setLevel","TRACE","useDebug","DEBUG","useInfo","INFO","useWarn","WARN","useError","ERROR","useFatal","FATAL","useDisable","DISABLE","level","outputStrategy","log","errorStack","stringValueOf","isTrace","isDebug","isInfo","isWarn","isError","isFatal","isDisable","LoggerService","LOGGER_NAME_LENGTH","loggerService","debug","info","warn","LoggerImpl","globalEnabled","listenersByChannel","enableGlobal","disableGlobal","mine","PubSub","g","Stage","CYDRAN_KEY","ORIGINAL_CYDRAN","noConflict","currentCydran","getNow","now","Date","getUTCFullYear","getUTCMonth","getUTCDate","getUTCHours","getUTCMinutes","getUTCSeconds","getUTCMilliseconds","preamble","ConsoleOutputStrategy","shortArgs","printFullStack","logMsg","secondPreamble","console","lvl","getKeys","k","rx","Number","parseInt","LevelUtils","DigestLoopError","MalformedOnEventError","SelectorError","SetComponentError","TemplateError","UnknownRegionError","major","minor","micro","GuardGenerator","MAX_VALUE","propagateUp","state","original","GuardImpl","isPropagateDown","mappings","ListenerImpl","DEFAULT_REDUCER","digested","digestCallbackContext","digestCallback","watchDispatchPending","reducerFn","code","getCode","getItems","logInvocationError","changed","valueFragment","previousFragment","swap","watchPrevious","watchCurrent","onDigest","setReducer","newPrevious","newPreviousFragment","ModelMediatorImpl","webpackPolyfill","deprecate","paths","setWindow","registerFactory","ConstantFactory","PrototypeFactory","SingletonFactory","defaultStrategy","DefaultRegistryStrategyImpl","strategies","RegistrationError","EXCLUSIONS","item","VALID_KEY_REGEX","restricted","localItems","items","addChild","refresh","checkName","refreshChildren","parentItems","refreshCode","statement","ScopeImpl","ScopeError","SequenceGenerator","KEY","checked","Checked","newClasses","className","join","CSSClass","Content","disabled","Enabled","readOnly","ReadOnly","style","Style","handleFocusout","shouldFocus","focus","ForceFocus","handleInput","multiple","selectedValues","selectedOptions","optValue","options","selected","includes","MultiSelectValueModel","ValuedModel","isRadio","handleRadioInput","onRadioTargetChange","InputValueModel","hidden","Visible","DOCUMENT","initialized","empty","ids","itemTemplate","last","nodeName","markup","idKey","itemComponentName","initAsRepeatable","newIds","newMap","fragment","createDocumentFragment","Repeat","rootSelector","started","initializers","withInitializer","callback","start","domReady","getConfig","ready","WIN","DOC","detach","completed","readyState","frameElement","documentElement","scrollCheck","setTimeout"],"mappings":"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","file":"cydran.min.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"cydran\"] = factory();\n\telse\n\t\troot[\"cydran\"] = factory();\n})(window, function() {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 10);\n","import { ForChannelContinuation, OnContinuation } from \"./Continuation\";\nimport Digestable from \"./Digestable\";\nimport Disposable from \"./Disposable\";\nimport DigestLoopError from \"./error/DigestLoopError\";\nimport MalformedOnEventError from \"./error/MalformedOnEventError\";\nimport RegistrationError from \"./error/RegistrationError\";\nimport SelectorError from \"./error/SelectorError\";\nimport SetComponentError from \"./error/SetComponentError\";\nimport TemplateError from \"./error/TemplateError\";\nimport UnknownRegionError from \"./error/UnknownRegionError\";\nimport Guard from \"./Guard\";\nimport GuardGenerator from \"./GuardGenerator\";\nimport GuardImpl from \"./GuardImpl\";\nimport Logger from \"./logger/Logger\";\nimport LoggerFactory from \"./logger/LoggerFactory\";\nimport Broker from \"./messaging/Broker\";\nimport Listener from \"./messaging/Listener\";\nimport PubSub from \"./messaging/PubSub\";\nimport ModelMediator from \"./ModelMediator\";\nimport ModelMediatorImpl from \"./ModelMediatorImpl\";\nimport Module from \"./Module\";\nimport ObjectUtils from \"./ObjectUtils\";\nimport Properties from \"./Properties\";\nimport Register from \"./Register\";\nimport { Registry, RegistryImpl } from \"./Registry\";\nimport RegistryStrategy from \"./RegistryStrategy\";\nimport Scope from \"./Scope\";\nimport ScopeImpl from \"./ScopeImpl\";\nimport SequenceGenerator from \"./SequenceGenerator\";\n\nconst MAX_EVALUATIONS: number = 10000;\nconst INTERNAL_DIRECT_CHANNEL_NAME: string = \"Cydran$$Direct$$Internal$$Channel\";\nconst INTERNAL_CHANNEL_NAME: string = \"Cydran$$Internal$$Channel\";\nconst TEXT_NODE_TYPE: number = 3;\nconst COMPONENT_INTERNALS_FIELD_NAME: string = \"____internal$$cydran____\";\nconst MODULE_FIELD_NAME: string = \"____internal$$cydran$$module____\";\n\nconst Events = {\n\tAFTER_CHILD_ADDED: \"AFTER_CHILD_ADDED\",\n\tAFTER_CHILD_CHANGED: \"AFTER_CHILD_CHANGED\",\n\tAFTER_CHILD_REMOVED: \"AFTER_CHILD_REMOVED\",\n\tAFTER_PARENT_ADDED: \"AFTER_PARENT_ADDED\",\n\tAFTER_PARENT_CHANGED: \"AFTER_PARENT_CHANGED\",\n\tAFTER_PARENT_REMOVED: \"AFTER_PARENT_REMOVED\",\n\tBEFORE_CHILD_ADDED: \"BEFORE_CHILD_ADDED\",\n\tBEFORE_CHILD_CHANGED: \"BEFORE_CHILD_CHANGED\",\n\tBEFORE_CHILD_REMOVED: \"BEFORE_CHILD_REMOVED\",\n\tBEFORE_DISPOSE: \"BEFORE_DISPOSE\",\n\tBEFORE_PARENT_ADDED: \"BEFORE_PARENT_ADDED\",\n\tBEFORE_PARENT_CHANGED: \"BEFORE_PARENT_CHANGED\",\n\tBEFORE_PARENT_REMOVED: \"BEFORE_PARENT_REMOVED\",\n};\n\nclass BrokerImpl implements Broker {\n\n\tpublic static INSTANCE: Broker;\n\n\tprivate logger: Logger;\n\n\tprivate listeners: {\n\t\t[channelName: string]: Listener[];\n\t};\n\n\tconstructor() {\n\t\tthis.logger = LoggerFactory.getLogger(\"Broker\");\n\t\tthis.listeners = {};\n\t}\n\n\tpublic broadcast(channelName: string, messageName: string, payload: any): void {\n\t\tthis.logger.trace({\n\t\t\tchannelName: channelName,\n\t\t\tmessageName: messageName,\n\t\t\tpayload: payload,\n\t\t});\n\n\t\tif (!this.listeners[channelName]) {\n\t\t\tthis.logger.trace(\"no listeners for channel, returning\");\n\t\t\treturn;\n\t\t}\n\n\t\tconst listeners = this.listeners[channelName];\n\n\t\tfor (const listener of listeners) {\n\t\t\tlistener.receive(messageName, payload);\n\t\t}\n\t}\n\n\tpublic addListener(listener: Listener): void {\n\t\tconst channelName: string = listener.getChannelName();\n\n\t\tif (!this.listeners[channelName]) {\n\t\t\tthis.listeners[channelName] = [];\n\t\t}\n\n\t\tconst listeners: Listener[] = this.listeners[channelName];\n\n\t\tif (!this.contains(listeners, listener)) {\n\t\t\tlisteners.push(listener);\n\t\t}\n\t}\n\n\tpublic removeListener(listener: Listener): void {\n\t\tconst channelName: string = listener.getChannelName();\n\n\t\tconst listeners: Listener[] = this.listeners[channelName];\n\n\t\tif (!listeners) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.remove(listeners, listener);\n\n\t\tif (0 === listeners.length) {\n\t\t\tdelete this.listeners[channelName];\n\t\t}\n\t}\n\n\tpublic dispose(): void {\n\t\tthis.listeners = {};\n\t}\n\n\tprivate contains(array: any[], instance: any): boolean {\n\t\tlet i = array.length;\n\n\t\twhile (i--) {\n\t\t\tif (array[i] === instance) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tprivate remove(array: any[], instance: any): void {\n\t\tlet i = array.length;\n\n\t\twhile (i--) {\n\t\t\tif (array[i] === instance) {\n\t\t\t\tarray.splice(i, 1);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\n}\n\nconst ALIASES: {\n\t[id: string]: string;\n} = {};\n\nclass ModuleImpl implements Module, Register {\n\n\tprivate name: string;\n\n\tprivate registry: Registry;\n\n\tprivate broker: Broker;\n\n\tprivate scope: ScopeImpl;\n\n\tconstructor(name: string, scope?: ScopeImpl) {\n\t\tthis.name = name;\n\t\tthis.registry = new RegistryImpl();\n\t\tthis.broker = new BrokerImpl();\n\t\tthis.scope = new ScopeImpl();\n\n\t\tif (scope) {\n\t\t\tthis.scope.setParent(scope);\n\t\t}\n\t}\n\n\tpublic getLogger(): Logger {\n\t\treturn LoggerFactory.getLogger(this.name);\n\t}\n\n\tpublic getName(): string {\n\t\treturn this.name;\n\t}\n\n\tpublic associate(...componentClasses: any[]): Module {\n\t\tcomponentClasses.forEach((componentClass) => {\n\t\t\tcomponentClass[\"prototype\"][MODULE_FIELD_NAME] = this;\n\t\t});\n\n\t\treturn this;\n\t}\n\n\tpublic disassociate(...componentClasses: any[]): Module {\n\t\tcomponentClasses.forEach((componentClass) => {\n\t\t\tcomponentClass[\"prototype\"][MODULE_FIELD_NAME] = this;\n\t\t});\n\n\t\treturn this;\n\t}\n\n\tpublic clear(): Module {\n\t\treturn this;\n\t}\n\n\tpublic broadcast(channelName: string, messageName: string, payload: any): void {\n\t\tthis.broker.broadcast(channelName, messageName, payload);\n\t}\n\n\tpublic message(channelName: string, messageName: string, payload: any): void {\n\t\tif (channelName === INTERNAL_DIRECT_CHANNEL_NAME) {\n\t\t\tif (messageName === \"addListener\") {\n\t\t\t\tthis.addListener(payload as Listener);\n\t\t\t} else if (messageName === \"removeListener\") {\n\t\t\t\tthis.removeListener(payload as Listener);\n\t\t\t}\n\t\t}\n\t}\n\n\tpublic get<T>(id: string): T {\n\t\tlet result: T = this.registry.get(id);\n\n\t\tif (!result) {\n\t\t\tresult = Modules.get(id);\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tpublic getLocal<T>(id: string): T {\n\t\treturn this.registry.get(id);\n\t}\n\n\tpublic getScope(): Scope {\n\t\treturn this.scope;\n\t}\n\n\tpublic registerConstant(id: string, instance: any): Module {\n\t\ttry {\n\t\t\tthis.registry.registerConstant(id, instance);\n\t\t} catch (e) {\n\t\t\tthis.logError(e);\n\t\t}\n\t\treturn this;\n\t}\n\n\tpublic registerPrototype(id: string, classInstance: any): Module {\n\t\ttry {\n\t\t\tthis.registry.registerPrototype(id, classInstance);\n\t\t} catch (e) {\n\t\t\tthis.logError(e);\n\t\t}\n\t\treturn this;\n\t}\n\n\tpublic registerSingleton(id: string, classInstance: any): Module {\n\t\ttry {\n\t\t\tthis.registry.registerSingleton(id, classInstance);\n\t\t} catch (e) {\n\t\t\tthis.logError(e);\n\t\t}\n\t\treturn this;\n\t}\n\n\tpublic addStrategy(strategy: RegistryStrategy): Module {\n\t\tthis.registry.addStrategy(strategy);\n\t\treturn this;\n\t}\n\n\tpublic expose(id: string): Module {\n\t\tALIASES[id] = this.name;\n\n\t\treturn this;\n\t}\n\n\tprivate addListener(listener: Listener): void {\n\t\tthis.broker.addListener(listener);\n\t}\n\n\tprivate removeListener(listener: Listener): void {\n\t\tthis.broker.removeListener(listener);\n\t}\n\n\tprivate logError(e: RegistrationError) {\n\t\tthis.getLogger().error(e);\n\t}\n\n}\n\nconst DEF_KEY: string = \"DEFAULT\";\nconst DEFAULT_MODULE: Module = new ModuleImpl(DEF_KEY);\n\nclass Modules {\n\n\tpublic static getModule(name: string): Module {\n\t\tif (!Modules.modules[name]) {\n\t\t\tModules.modules[name] = new ModuleImpl(name, DEFAULT_MODULE.getScope() as ScopeImpl);\n\t\t}\n\n\t\treturn Modules.modules[name];\n\t}\n\n\tpublic static getDefaultModule(): Module {\n\t\treturn this.getModule(DEF_KEY);\n\t}\n\n\tpublic static forEach(fn: (instace: Module) => void): void {\n\t\tfor (const name in Modules.modules) {\n\t\t\tif (!Modules.modules.hasOwnProperty(name)) {\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tconst current: Module = Modules.modules[name];\n\n\t\t\tfn(current);\n\t\t}\n\t}\n\n\tpublic static broadcast(channelName: string, messageName: string, payload: any): void {\n\t\tModules.forEach((instance) => instance.broadcast(channelName, messageName, payload));\n\t}\n\n\tpublic static registerConstant(id: string, instance: any): void {\n\t\tthis.getDefaultModule().registerConstant(id, instance);\n\t}\n\n\tpublic static registerPrototype(id: string, classInstance: any): void {\n\t\tthis.getDefaultModule().registerPrototype(id, classInstance);\n\t}\n\n\tpublic static registerSingleton(id: string, classInstance: any): void {\n\t\tthis.getDefaultModule().registerSingleton(id, classInstance);\n\t}\n\n\tpublic static registerElementMediator(name: string, supportedTags: string[], elementMediatorClass: any): void {\n\t\ttry {\n\t\t\tMvvm.register(name, supportedTags, elementMediatorClass);\n\t\t} catch (e) {\n\t\t\tthis.logger.error(e.message);\n\t\t}\n\t}\n\n\tpublic static getScope(): Scope {\n\t\treturn this.getDefaultModule().getScope();\n\t}\n\n\tpublic static get<T>(id: string): T {\n\t\tlet result: T = null;\n\n\t\tconst moduleId: string = ALIASES[id];\n\n\t\tif (moduleId) {\n\t\t\tresult = Modules.getModule(id).getLocal(id);\n\t\t}\n\n\t\tif (!result) {\n\t\t\tresult = DEFAULT_MODULE.getLocal(id);\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tprivate static logger: Logger = LoggerFactory.getLogger(\"Modules:static\");\n\n\tprivate static modules: {\n\t\t[id: string]: Module;\n\t} = {\n\t\t\tDEFAULT: DEFAULT_MODULE,\n\t\t};\n\n}\n\nclass Deferred<S, T> {\n\n\tprivate instance: T;\n\n\tprivate factory: (source: S) => T;\n\n\tconstructor(factory: (source: S) => T) {\n\t\tthis.factory = factory;\n\t}\n\n\tpublic get(source: S): T {\n\t\tif (!this.instance) {\n\t\t\tthis.instance = this.factory(source);\n\t\t}\n\n\t\treturn this.instance;\n\t}\n\n}\n\nclass DeferredInternals extends Deferred<Component, ComponentInternals> {\n\n\tconstructor(factory: (source: Component) => ComponentInternals) {\n\t\tsuper(factory);\n\t}\n\n}\n\nfunction internals(component: Component): ComponentInternals {\n\treturn (component[COMPONENT_INTERNALS_FIELD_NAME] as DeferredInternals).get(component);\n}\n\nclass Component {\n\n\t// tslint:disable-next-line\n\tprivate ____internal$$cydran____: any;\n\n\t// tslint:disable-next-line\n\tprivate ____internal$$cydran$$module____: any;\n\n\tconstructor(componentName: string, template: string, attributePrefix?: string) {\n\t\tthis.____internal$$cydran____ = new DeferredInternals((src) => new ComponentInternals(src, componentName, template, attributePrefix));\n\t}\n\n\t// TODO - Merge has and get metadata into a single metadata() call with get() and has() under it\n\n\tpublic hasMetadata(name: string): boolean {\n\t\treturn internals(this).hasMetadata(name);\n\t}\n\n\tpublic getMetadata(name: string): any {\n\t\treturn internals(this).getMetadata(name);\n\t}\n\n\tpublic hasRegion(name: string): boolean {\n\t\treturn internals(this).hasRegion(name);\n\t}\n\n\tpublic setChild(name: string, component: Component): void {\n\t\tinternals(this).setChild(name, component);\n\t}\n\n\tpublic setChildFromRegistry(name: string, componentName: string, defaultComponentName?: string): void {\n\t\tinternals(this).setChildFromRegistry(name, componentName, defaultComponentName);\n\t}\n\n\tpublic message(channelName: string, messageName: string, payload: any): void {\n\t\tinternals(this).message(channelName, messageName, payload);\n\t}\n\n\tpublic dispose(): void {\n\t\tinternals(this).dispose();\n\t}\n\n\tpublic getParent(): Component {\n\t\treturn internals(this).getParent();\n\t}\n\n\tpublic getEl(): HTMLElement {\n\t\treturn internals(this).getEl();\n\t}\n\n\tpublic get<T>(id: string): T {\n\t\treturn internals(this).get(id);\n\t}\n\n\tprotected getItem(): any {\n\t\treturn internals(this).getData();\n\t}\n\n\tprotected broadcast(channelName: string, messageName: string, payload: any): void {\n\t\tinternals(this).broadcast(channelName, messageName, payload);\n\t}\n\n\tprotected broadcastGlobally(channelName: string, messageName: string, payload: any): void {\n\t\tinternals(this).broadcastGlobally(channelName, messageName, payload);\n\t}\n\n\tprotected $apply(fn: Function, args: any[]): void {\n\t\tinternals(this).$apply(fn, args);\n\t}\n\n\tprotected scope(): Scope {\n\t\treturn internals(this).getScope();\n\t}\n\n\tprotected watch(expression: string, target: (previous: any, current: any) => void): void {\n\t\tinternals(this).watch(expression, target);\n\t}\n\n\tprotected withMetadata(name: string, value: any): void {\n\t\tinternals(this).withMetadata(name, value);\n\t}\n\n\tprotected on(messageName: string): OnContinuation {\n\t\treturn {\n\t\t\tforChannel: (channel: string) => {\n\t\t\t\treturn {\n\t\t\t\t\tinvoke: (target: (payload: any) => void) => {\n\t\t\t\t\t\tinternals(this).on(target, messageName, channel);\n\t\t\t\t\t},\n\t\t\t\t};\n\t\t\t},\n\t\t\tinvoke: (target: (payload: any) => void) => {\n\t\t\t\tinternals(this).on(target, messageName, INTERNAL_CHANNEL_NAME);\n\t\t\t},\n\t\t};\n\t}\n\n\tprotected getLogger(): Logger {\n\t\treturn internals(this).getLogger();\n\t}\n\n}\n\nComponent[\"prototype\"][MODULE_FIELD_NAME] = DEFAULT_MODULE;\n\ninterface ComponentFlags {\n\n\trepeatable: boolean;\n\n}\n\nclass ComponentInternals implements Digestable {\n\n\tprivate flags: ComponentFlags;\n\n\tprivate component: Component;\n\n\tprivate logger: Logger;\n\n\tprivate el: HTMLElement;\n\n\tprivate regions: { [id: string]: Region; };\n\n\tprivate parent: Component;\n\n\tprivate data: any;\n\n\tprivate componentName: string;\n\n\tprivate id: number;\n\n\tprivate template: string;\n\n\tprivate mvvm: Mvvm;\n\n\tprivate pubSub: PubSub;\n\n\tprivate scope: ScopeImpl;\n\n\tprivate metadata: {\n\t\t[id: string]: any;\n\t};\n\n\tprivate readonly prefix: string;\n\n\tprivate guard: string;\n\n\tconstructor(component: Component, componentName: string, template: string, attributePrefix?: string) {\n\t\tif (typeof template !== \"string\") {\n\t\t\tthrow new TemplateError(\"Template must be a non-null string\");\n\t\t}\n\n\t\tthis.flags = {\n\t\t\trepeatable: false,\n\t\t};\n\n\t\tthis.parent = null;\n\t\tthis.component = component;\n\t\tthis.prefix = (attributePrefix || \"c\").toLocaleLowerCase();\n\t\tthis.componentName = componentName;\n\t\tthis.template = template.trim();\n\t\tthis.id = SequenceGenerator.INSTANCE.next();\n\t\tthis.logger = LoggerFactory.getLogger(componentName + \" Component \" + this.id);\n\t\tthis.scope = new ScopeImpl();\n\n\t\tif (this.getModule()) {\n\t\t\tthis.scope.setParent(this.getModule().getScope() as ScopeImpl);\n\t\t}\n\n\t\tthis.mvvm = new Mvvm(this.component, this.getModule(), this.prefix, this.scope);\n\t\tthis.regions = {};\n\t\tthis.pubSub = new PubSub(this.component, this.getModule());\n\t\tthis.render();\n\t\tthis.mvvm.init(this.el, this, (name: string) => this.getRegion(name));\n\t\tthis.guard = GuardGenerator.INSTANCE.generate();\n\t}\n\n\tpublic hasMetadata(name: string): boolean {\n\t\treturn this.getMetadata(name) ? true : false;\n\t}\n\n\tpublic getMetadata(name: string): any {\n\t\treturn this.metadata[name];\n\t}\n\n\tpublic hasRegion(name: string): boolean {\n\t\treturn ((this.regions[name]) ? true : false);\n\t}\n\n\tpublic $apply(fn: Function, args: any[], guard?: Guard): void {\n\t\tconst localGuard: GuardImpl = GuardImpl.down(guard) as GuardImpl;\n\n\t\tif (localGuard.seen(this.guard)) {\n\t\t\tthis.getLogger().trace(\"Breaking digest loop\");\n\t\t\treturn;\n\t\t}\n\n\t\tlocalGuard.mark(this.guard);\n\n\t\tthis.mvvm.$apply(fn, args, localGuard);\n\t}\n\n\tpublic setChild(name: string, component: Component): void {\n\t\tif (!this.hasRegion(name)) {\n\t\t\tthrow new UnknownRegionError(\"Region \\'%rName%\\' is unkown and must be declared in component template.\", { \"%rName%\": name });\n\t\t}\n\n\t\tconst hasComponent: boolean = this.getRegion(name).hasComponent();\n\n\t\tconst childAdded: boolean = !!(component !== null && !hasComponent);\n\t\tconst childRemoved: boolean = !!(component === null && hasComponent);\n\n\t\tif (childAdded) {\n\t\t\tthis.message(INTERNAL_CHANNEL_NAME, Events.BEFORE_CHILD_ADDED, {\n\t\t\t\tname: name,\n\t\t\t});\n\t\t}\n\n\t\tif (childRemoved) {\n\t\t\tthis.message(INTERNAL_CHANNEL_NAME, Events.BEFORE_CHILD_REMOVED, {\n\t\t\t\tname: name,\n\t\t\t});\n\t\t}\n\n\t\tthis.message(INTERNAL_CHANNEL_NAME, Events.BEFORE_CHILD_CHANGED, {\n\t\t\tname: name,\n\t\t});\n\n\t\tthis.getRegion(name).setComponent(component);\n\n\t\tthis.message(INTERNAL_CHANNEL_NAME, Events.AFTER_CHILD_CHANGED, {\n\t\t\tname: name,\n\t\t});\n\n\t\tif (childAdded) {\n\t\t\tthis.message(INTERNAL_CHANNEL_NAME, Events.AFTER_CHILD_ADDED, {\n\t\t\t\tname: name,\n\t\t\t});\n\t\t}\n\n\t\tif (childRemoved) {\n\t\t\tthis.message(INTERNAL_CHANNEL_NAME, Events.AFTER_CHILD_REMOVED, {\n\t\t\t\tname: name,\n\t\t\t});\n\t\t}\n\t}\n\n\tpublic setChildFromRegistry(name: string, componentName: string, defaultComponentName?: string): void {\n\t\tlet component: Component = this.get(componentName);\n\n\t\tif (!component && defaultComponentName) {\n\t\t\tcomponent = this.get(defaultComponentName);\n\t\t}\n\n\t\tif (component) {\n\t\t\tthis.setChild(name, component);\n\t\t} else {\n\t\t\tconst error = new SetComponentError(\"Unable to set component %cName% on region %name%\", { \"%cName%\": componentName, \"%name%\": name });\n\t\t\tthis.getLogger().error(error);\n\t\t}\n\t}\n\n\tpublic message(channelName: string, messageName: string, payload: any): void {\n\t\tif (channelName === INTERNAL_DIRECT_CHANNEL_NAME) {\n\t\t\tif (messageName === \"propagateDigest\") {\n\t\t\t\tif (this.flags.repeatable) {\n\t\t\t\t\tthis.propagateDigest(payload);\n\t\t\t\t}\n\t\t\t} else if (messageName === \"setMode\") {\n\t\t\t\tswitch (payload) {\n\t\t\t\t\tcase \"repeatable\":\n\t\t\t\t\t\tthis.flags.repeatable = true;\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tthis.flags.repeatable = false;\n\t\t\t\t}\n\t\t\t} else if (messageName === \"digest\") {\n\t\t\t\tthis.digest(payload as Guard);\n\t\t\t} else if (messageName === \"setParent\") {\n\t\t\t\tthis.setParent(payload as Component);\n\t\t\t} else if (messageName === \"setData\") {\n\t\t\t\tthis.setData(payload);\n\t\t\t}\n\t\t} else {\n\t\t\tthis.pubSub.message(channelName, messageName, payload);\n\t\t}\n\t}\n\n\tpublic broadcast(channelName: string, messageName: string, payload: any): void {\n\t\tthis.getModule().broadcast(channelName, messageName, payload);\n\t}\n\n\tpublic broadcastGlobally(channelName: string, messageName: string, payload: any): void {\n\t\tModules.broadcast(channelName, messageName, payload);\n\t}\n\n\tpublic dispose(): void {\n\t\tthis.message(INTERNAL_CHANNEL_NAME, Events.BEFORE_DISPOSE, {});\n\t\tthis.pubSub.dispose();\n\t\tthis.parent = null;\n\t}\n\n\tpublic getId(): number {\n\t\treturn this.id;\n\t}\n\n\tpublic getEl(): HTMLElement {\n\t\treturn this.el;\n\t}\n\n\tpublic getComponent(): Component {\n\t\treturn this.component;\n\t}\n\n\tpublic get<T>(id: string): T {\n\t\treturn this.getModule().get(id);\n\t}\n\n\tpublic getPrefix(): string {\n\t\treturn this.prefix;\n\t}\n\n\tpublic getScope(): Scope {\n\t\treturn this.scope;\n\t}\n\n\tpublic watch(expression: string, target: (previous: any, current: any) => void): void {\n\t\tthis.mvvm.mediate(expression).watch(this, target);\n\t}\n\n\tpublic withMetadata(name: string, value: any): void {\n\t\tthis.metadata[name] = value;\n\t}\n\n\tpublic on(target: (payload: any) => void, messageName: string, channel?: string): void {\n\t\tconst targetChannel: string = channel || INTERNAL_CHANNEL_NAME;\n\n\t\tthis.pubSub.on(messageName).forChannel(targetChannel).invoke((payload: any) => {\n\t\t\tthis.$apply(target, [payload]);\n\t\t});\n\t}\n\n\tpublic getLogger(): Logger {\n\t\treturn this.logger;\n\t}\n\n\tpublic getModule(): Module {\n\t\treturn this.component[MODULE_FIELD_NAME] as Module;\n\t}\n\n\tpublic getParent(): Component {\n\t\treturn this.parent;\n\t}\n\n\tpublic setData(data: any): void {\n\t\tthis.data = data;\n\t}\n\n\tpublic getData(): any {\n\t\treturn this.data;\n\t}\n\n\tprotected getGuard(): string {\n\t\treturn this.guard;\n\t}\n\n\tprotected getRegion(name: string): Region {\n\t\tif (!this.regions[name]) {\n\t\t\tthis.getLogger().trace(\"Creating region \" + name);\n\t\t\tthis.regions[name] = new Region(name, this);\n\t\t}\n\n\t\treturn this.regions[name];\n\t}\n\n\tprotected getTemplate(): string {\n\t\treturn this.template;\n\t}\n\n\tprotected render(): void {\n\t\tthis.getLogger().trace(\"Rendering\");\n\t\tconst templateEl: HTMLTemplateElement = Properties.getWindow().document.createElement(\"template\");\n\t\ttemplateEl.insertAdjacentHTML(\"afterbegin\", this.template.trim());\n\t\tconst count: number = templateEl.childElementCount;\n\n\t\tif (count !== 1) {\n\t\t\tconst parmObj = { \"%count%\": \"\" + count, \"%template%\": this.template };\n\t\t\tconst errmsg = \"Component template must have a single top level element, but had %count% top level elements:\\n\\n%template%\\n\\n\";\n\t\t\tconst error = new TemplateError(errmsg, parmObj);\n\t\t\tthis.getLogger().fatal(error);\n\t\t\tthrow error;\n\t\t}\n\n\t\tthis.el = templateEl.firstElementChild as HTMLElement;\n\t}\n\n\tprotected setEl(el: HTMLElement): void {\n\t\tthis.el = el;\n\t}\n\n\tprivate setParent(parent: Component): void {\n\t\tif (parent === null) {\n\t\t\tthis.pubSub.message(INTERNAL_DIRECT_CHANNEL_NAME, \"disableGlobal\", {});\n\t\t\tthis.getLogger().trace(\"Clearing parent view\");\n\t\t} else {\n\t\t\tthis.pubSub.message(INTERNAL_DIRECT_CHANNEL_NAME, \"enableGlobal\", {});\n\t\t}\n\n\t\tconst parentAdded: boolean = !!(parent !== null && this.parent === null);\n\t\tconst parentRemoved: boolean = !!(parent === null && this.parent !== null);\n\n\t\tif (parentAdded) {\n\t\t\tthis.message(INTERNAL_CHANNEL_NAME, Events.BEFORE_PARENT_ADDED, {});\n\t\t}\n\n\t\tif (parentRemoved) {\n\t\t\tthis.message(INTERNAL_CHANNEL_NAME, Events.BEFORE_PARENT_REMOVED, {});\n\t\t}\n\n\t\tthis.message(INTERNAL_CHANNEL_NAME, Events.BEFORE_PARENT_CHANGED, {});\n\t\tthis.parent = parent;\n\t\tthis.digest();\n\t\tthis.message(INTERNAL_CHANNEL_NAME, Events.AFTER_PARENT_CHANGED, {});\n\n\t\tif (parentAdded) {\n\t\t\tthis.message(INTERNAL_CHANNEL_NAME, Events.AFTER_PARENT_ADDED, {});\n\t\t}\n\n\t\tif (parentRemoved) {\n\t\t\tthis.message(INTERNAL_CHANNEL_NAME, Events.AFTER_PARENT_REMOVED, {});\n\t\t}\n\t}\n\n\tprivate digest(guard?: Guard): void {\n\t\tthis.$apply(() => {\n\t\t\t// Intentionally do nothing\n\t\t}, [], guard);\n\t}\n\n\tprivate propagateDigest(guard: Guard): void {\n\t\tconst localGuard: GuardImpl = GuardImpl.up(guard) as GuardImpl;\n\n\t\tif (localGuard.seen(this.getGuard())) {\n\t\t\tthis.getLogger().trace(\"Breaking digest loop\");\n\t\t\treturn;\n\t\t}\n\n\t\tlocalGuard.mark(this.getGuard());\n\n\t\tif (this.getParent() && localGuard.isPropagateUp()) {\n\t\t\tthis.getParent().message(INTERNAL_DIRECT_CHANNEL_NAME, \"digest\", guard);\n\t\t} else {\n\t\t\tthis.getLogger().trace(\"Not propagating to parent\");\n\t\t}\n\t}\n\n}\n\nclass StageComponentInternals extends ComponentInternals {\n\n\tprotected render(): void {\n\t\tconst elements: NodeListOf<HTMLElement> = Properties.getWindow().document.querySelectorAll(this.getTemplate());\n\t\tconst eLength = ((elements) ? elements.length : 0);\n\t\tconst errMsg = (eLength !== 1) ? \"CSS selector MUST identify single HTMLElement: '%pattern%' - %qty% found\" : null;\n\n\t\tif (errMsg) {\n\t\t\tconst patSubObj = { \"%pattern%\": this.getTemplate(), \"%qty%\": eLength };\n\t\t\tconst error: SelectorError = new SelectorError(errMsg, patSubObj);\n\t\t\tthis.getLogger().fatal(error);\n\t\t\tthrow error;\n\t\t}\n\n\t\tconst element: HTMLElement = elements[0];\n\n\t\twhile (element.hasChildNodes()) {\n\t\t\telement.removeChild(element.firstChild);\n\t\t}\n\n\t\tconst regionDiv: HTMLElement = Properties.getWindow().document.createElement(\"c:region\");\n\t\tregionDiv.setAttribute(\"name\", \"body\");\n\t\telement.appendChild(regionDiv);\n\t\tthis.setEl(element);\n\t}\n\n}\n\nclass StageComponent extends Component {\n\n\tconstructor(selector: string) {\n\t\tsuper(\"stage\", \"<div></div>\");\n\t\tthis[COMPONENT_INTERNALS_FIELD_NAME] = new DeferredInternals((src) => new StageComponentInternals(src, \"stage\", selector));\n\t}\n\n\tpublic setComponent(component: Component): StageComponent {\n\t\tthis.setChild(\"body\", component);\n\n\t\treturn this;\n\t}\n\n}\n\nStageComponent[\"prototype\"][MODULE_FIELD_NAME] = DEFAULT_MODULE;\n\ninterface ElementMediatorDependencies {\n\n\tmvvm: Mvvm;\n\n\tparent: ComponentInternals;\n\n\tel: HTMLElement;\n\n\texpression: string;\n\n\tmodel: any;\n\n\tprefix: string;\n\n}\n\nabstract class ElementMediator<M, E extends HTMLElement> implements Disposable {\n\n\tprivate logger: Logger;\n\n\t// tslint:disable-next-line\n\tprivate ____internal$$cydran____: ElementMediatorDependencies;\n\n\tprivate previous: any;\n\n\tprivate value: any;\n\n\tprivate moduleInstance: Module;\n\n\tprivate mediator: ModelMediator<M>;\n\n\tprivate pubSub: PubSub;\n\n\tprivate params: {\n\t\t[name: string]: string;\n\t};\n\n\tprivate domListeners: {\n\t\t[name: string]: any;\n\t};\n\n\tconstructor(dependencies: any) {\n\t\tthis.logger = LoggerFactory.getLogger(\"ElementMediator: \" + dependencies.prefix);\n\t\tthis.____internal$$cydran____ = dependencies;\n\t\tthis.previous = null;\n\t\tthis.value = null;\n\t\tthis.params = {};\n\t\tthis.domListeners = {};\n\t\tthis.pubSub = new PubSub(this, this.getModule());\n\t}\n\n\t/**\n\t * Dispose of ElementMediator when released.\n\t * + All event listeners will be removed.\n\t * + This element mediator will be unwired from any other DOM entanglements\n\t * + The mediator reference to the model is released/nulled\n\t * + Any value representation of this element mediator is released/nulled\n\t * + The [[Mvvm|mvvm]] refernce is released/nulled\n\t * + The parental reference is released/nulled\n\t */\n\tpublic dispose(): void {\n\t\tthis.removeDomListeners();\n\t\tthis.unwire();\n\t\tthis.____internal$$cydran____ = null;\n\t\tthis.mediator = null;\n\t\tthis.value = null;\n\t}\n\n\t/**\n\t * Initialize this element mediator.\n\t */\n\tpublic init(): void {\n\t\tthis.mediator = this.mediate(this.getExpression());\n\t\tthis.wire();\n\t}\n\n\t/**\n\t * Get the active module instance reference by id\n\t * @return U\n\t */\n\tpublic get<U>(id: string): U {\n\t\treturn this.moduleInstance.get(id);\n\t}\n\n\t/**\n\t * Set the [[Module|module]] instance reference\n\t * @param {Module} moduleInstance\n\t */\n\tpublic setModule(moduleInstance: Module): void {\n\t\tthis.moduleInstance = moduleInstance;\n\t}\n\n\t/**\n\t * [message description]\n\t * @param {string} channelName [description]\n\t * @param {string} messageName [description]\n\t * @param {any}    payload     [description]\n\t */\n\tpublic message(channelName: string, messageName: string, payload: any): void {\n\t\tthis.pubSub.message(channelName, messageName, payload);\n\t}\n\n\t/**\n\t * Broadcast a message\n\t * @param {string} channelName [description]\n\t * @param {string} messageName [description]\n\t * @param {any}    payload     [description]\n\t */\n\tpublic broadcast(channelName: string, messageName: string, payload: any): void {\n\t\tthis.getModule().broadcast(channelName, messageName, payload);\n\t}\n\n\t/**\n\t * Broadcast a message in the Global context\n\t * @param {string} channelName [description]\n\t * @param {string} messageName [description]\n\t * @param {any}    payload     [description]\n\t */\n\tpublic broadcastGlobally(channelName: string, messageName: string, payload: any): void {\n\t\tModules.broadcast(channelName, messageName, payload);\n\t}\n\n\tprotected listenTo(channel: string, messageName: string, target: (payload: any) => void): void {\n\n\t\tthis.pubSub.on(messageName).forChannel(channel).invoke((payload: any) => {\n\t\t\ttarget.apply(this, [payload]);\n\t\t});\n\t}\n\n\tprotected listenToFramework(messageName: string, target: (payload: any) => void): void {\n\t\tthis.listenTo(INTERNAL_CHANNEL_NAME, messageName, target);\n\t}\n\n\tprotected bridge(name: string): void {\n\t\tconst listener = (event: Event) => {\n\t\t\tthis.message(\"dom\", name, event);\n\t\t};\n\n\t\tif (!this.domListeners[name]) {\n\t\t\tthis.domListeners[name] = listener;\n\t\t\tthis.getEl().addEventListener(name, listener, false);\n\t\t}\n\t}\n\n\t/**\n\t * Get the associated {HTMLElement html element} of this element mediator.\n\t * @return {HTMLElement} [description]\n\t */\n\tprotected getEl(): E {\n\t\treturn this.____internal$$cydran____.el as E;\n\t}\n\n\t/**\n\t * [getModule description]\n\t * @return {Module} [description]\n\t */\n\tprotected getModule(): Module {\n\t\treturn this[\"moduleInstance\"] as Module;\n\t}\n\n\t/**\n\t * [mediate description]\n\t * @param  {string}        expression [description]\n\t * @return {ModelMediator}            [description]\n\t */\n\tprotected mediate<T>(expression: string): ModelMediator<T> {\n\t\treturn this.____internal$$cydran____.mvvm.mediate(expression);\n\t}\n\n\t/**\n\t * [getModel description]\n\t * @return {any} [description]\n\t */\n\tprotected getModel(): any {\n\t\treturn this.____internal$$cydran____.model;\n\t}\n\n\t/**\n\t * [getParent description]\n\t * @return {Component} [description]\n\t */\n\tprotected getParent(): Component {\n\t\treturn this.____internal$$cydran____.parent.getComponent();\n\t}\n\n\t/**\n\t * [getMediator description]\n\t * @return {ModelMediator} [description]\n\t */\n\tprotected getModelMediator(): ModelMediator<M> {\n\t\treturn this.mediator;\n\t}\n\n\t/**\n\t * [notifyModelInteraction description]\n\t */\n\tprotected notifyModelInteraction(): void {\n\t\tif (this.____internal$$cydran____ && this.____internal$$cydran____.mvvm) {\n\t\t\tthis.____internal$$cydran____.mvvm.digest(null);\n\t\t}\n\t}\n\n\t/**\n\t * Get the expression specified\n\t * @return {string} [description]\n\t */\n\tprotected getExpression(): string {\n\t\treturn this.____internal$$cydran____.expression;\n\t}\n\n\t/**\n\t * Gets the logger.\n\t * @return {Logger} logger instance\n\t */\n\tprotected getLogger(): Logger {\n\t\treturn this.logger;\n\t}\n\n\t/**\n\t * Wire the element mediator\n\t */\n\tprotected abstract wire(): void;\n\n\t/**\n\t * Unwire the element mediator\n\t */\n\tprotected abstract unwire(): void;\n\n\tprivate removeDomListeners(): void {\n\t\tfor (const name in this.domListeners) {\n\t\t\tif (!this.domListeners.hasOwnProperty(name)) {\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tconst listener: any = this.domListeners[name];\n\n\t\t\tthis.getEl().removeEventListener(name, listener);\n\t\t}\n\n\t\tthis.domListeners = {};\n\t}\n\n}\n\nclass Region {\n\n\tprivate logger: Logger;\n\n\tprivate defaultEl: HTMLElement;\n\n\tprivate component: Component;\n\n\tprivate parent: ComponentInternals;\n\n\tprivate name: string;\n\n\tconstructor(name: string, parent: ComponentInternals) {\n\t\tthis.defaultEl = null;\n\t\tthis.component = null;\n\t\tthis.parent = parent;\n\t\tthis.name = name;\n\t\tthis.logger = LoggerFactory.getLogger(\"Region \" + this.name + \" for \" + parent.getId());\n\t}\n\n\tpublic setDefaultEl(defaultEl: HTMLElement): void {\n\t\tthis.defaultEl = defaultEl;\n\t}\n\n\tpublic setComponent(component: Component): void {\n\t\tthis.logger.trace(\"Setting component\");\n\n\t\tif (this.component === component) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (component !== null && this.component === null) {\n\t\t\tthis.component = component;\n\t\t\tconst newComponentEl: HTMLElement = component.getEl();\n\t\t\tconst parentElement: HTMLElement = this.defaultEl.parentElement;\n\t\t\tparentElement.replaceChild(newComponentEl, this.defaultEl);\n\t\t\tthis.component.message(INTERNAL_DIRECT_CHANNEL_NAME, \"setParent\", this.parent.getComponent());\n\t\t} else if (component === null && this.component !== null) {\n\t\t\tthis.component.message(INTERNAL_DIRECT_CHANNEL_NAME, \"setParent\", null);\n\t\t\tconst oldComponentEl: HTMLElement = this.component.getEl();\n\t\t\tthis.component = null;\n\t\t\tconst parentElement: HTMLElement = oldComponentEl.parentElement;\n\t\t\tparentElement.replaceChild(this.defaultEl, oldComponentEl);\n\t\t} else if (component !== null && this.component !== null) {\n\t\t\tthis.component.message(INTERNAL_DIRECT_CHANNEL_NAME, \"setParent\", null);\n\t\t\tconst newComponentEl: HTMLElement = component.getEl();\n\t\t\tconst oldComponentEl: HTMLElement = this.component.getEl();\n\t\t\tconst parentElement: HTMLElement = oldComponentEl.parentElement;\n\t\t\tparentElement.replaceChild(newComponentEl, oldComponentEl);\n\t\t\tthis.component = component;\n\t\t\tthis.component.message(INTERNAL_DIRECT_CHANNEL_NAME, \"setParent\", this.parent.getComponent());\n\t\t}\n\t}\n\n\tpublic hasComponent(): boolean {\n\t\treturn !!this.component;\n\t}\n\n\tpublic dispose() {\n\t\tif (this.component) {\n\t\t\tthis.component.dispose();\n\t\t}\n\n\t\tthis.setComponent(null);\n\t}\n\n}\n\nclass TextElementMediator extends ElementMediator<string, HTMLElement> {\n\n\tpublic wire(): void {\n\t\tthis.getModelMediator().watch(this, this.onTargetChange);\n\t}\n\n\tpublic unwire(): void {\n\t\t// Intentionally do nothing\n\t}\n\n\tprotected onTargetChange(previous: any, current: any): void {\n\t\tconst replacement: string = ObjectUtils.encodeHtml(current);\n\t\tthis.getEl().innerHTML = replacement;\n\t}\n\n}\n\nclass EventElementMediator extends ElementMediator<any, HTMLElement> {\n\n\tprivate eventKey: string;\n\n\tpublic unwire(): void {\n\t\t// Intentionally do nothing\n\t}\n\n\tpublic handleEvent(event: Event): void {\n\t\tthis.getModelMediator().invoke(event);\n\t\tthis.notifyModelInteraction();\n\t}\n\n\tpublic wire(): void {\n\t\tthis.bridge(this.eventKey);\n\t\tthis.listenTo(\"dom\", this.eventKey, this.handleEvent);\n\t}\n\n\tpublic setEventKey(eventKey: string): void {\n\t\tthis.eventKey = eventKey;\n\t}\n\n}\n\nclass AttributeElementMediator extends ElementMediator<string, HTMLElement> {\n\n\tprivate attributeName: string;\n\n\tpublic wire(): void {\n\t\tthis.getModelMediator().watch(this, this.onTargetChange);\n\t}\n\n\tpublic unwire(): void {\n\t\t// Intentionally do nothing\n\t}\n\n\tpublic setAttributeName(attributeName: string): void {\n\t\tthis.attributeName = attributeName;\n\t}\n\n\tprotected onTargetChange(previous: string, current: string): void {\n\t\tthis.getEl().setAttribute(this.attributeName, current + \"\");\n\t}\n\n}\n\nclass Mvvm {\n\n\tpublic static register(name: string, supportedTags: string[], elementMediatorClass: any): void {\n\t\tif (!Mvvm.factories[name]) {\n\t\t\tMvvm.factories[name] = {};\n\t\t}\n\n\t\tfor (const supportedTag of supportedTags) {\n\t\t\tMvvm.factories[name][supportedTag] = elementMediatorClass;\n\t\t}\n\t}\n\n\tprivate static factories: {\n\t\t[elementMediatorType: string]: {\n\t\t\t[tag: string]: new () => ElementMediator<any, HTMLElement>;\n\t\t},\n\t} = {};\n\n\tprivate logger: Logger;\n\n\tprivate el: HTMLElement;\n\n\tprivate elementMediators: Array<ElementMediator<any, HTMLElement>>;\n\n\tprivate mediators: Array<ModelMediatorImpl<any>>;\n\n\tprivate model: any;\n\n\tprivate parent: ComponentInternals;\n\n\tprivate moduleInstance: Module;\n\n\tprivate elementMediatorPrefix: string;\n\n\tprivate eventElementMediatorPrefix: string;\n\n\tprivate regionPrefix: string;\n\n\tprivate componentPrefix: string;\n\n\tprivate components: Component[];\n\n\tprivate scope: ScopeImpl;\n\n\tprivate regionLookupFn: (name: string) => Region;\n\n\tconstructor(model: any, moduleInstance: Module, prefix: string, scope: ScopeImpl) {\n\t\tthis.elementMediatorPrefix = prefix + \":\";\n\t\tthis.eventElementMediatorPrefix = prefix + \":on\";\n\t\tthis.regionPrefix = prefix + \":region\";\n\t\tthis.componentPrefix = prefix + \":component\";\n\t\tthis.logger = LoggerFactory.getLogger(\"Mvvm\");\n\t\tthis.scope = new ScopeImpl(false);\n\t\tthis.scope.setParent(scope);\n\t\tthis.elementMediators = [];\n\t\tthis.mediators = [];\n\t\tthis.model = model;\n\t\tthis.moduleInstance = moduleInstance;\n\t\tthis.components = [];\n\t\tthis.scope.add(\"m\", () => this.model);\n\t\tthis.scope.add(\"model\", () => this.model);\n\t\tthis.scope.add(\"i\", () => this.parent.getData());\n\t\tthis.scope.add(\"item\", () => this.parent.getData());\n\t\tthis.scope.add(\"p\", () => this.parent.getComponent().getParent());\n\t\tthis.scope.add(\"parent\", () => this.parent.getComponent().getParent());\n\t}\n\n\tpublic init(el: HTMLElement, parent: ComponentInternals, regionLookupFn: (name: string) => Region): void {\n\t\tthis.el = el;\n\t\tthis.parent = parent;\n\t\tthis.regionLookupFn = regionLookupFn;\n\t\tthis.populateElementMediators();\n\t}\n\n\tpublic dispose(): void {\n\t\tfor (const elementMediator of this.elementMediators) {\n\t\t\telementMediator.dispose();\n\t\t}\n\n\t\tthis.elementMediators = [];\n\t\tthis.components = [];\n\n\t\tfor (const component of this.components) {\n\t\t\tcomponent.dispose();\n\t\t}\n\n\t\tthis.parent = null;\n\t}\n\n\tpublic mediate<T>(expression: string): ModelMediator<T> {\n\t\tconst mediator: ModelMediator<T> = new ModelMediatorImpl<T>(this.model, expression, this.scope);\n\t\tthis.mediators.push(mediator as ModelMediatorImpl<any>);\n\n\t\treturn mediator;\n\t}\n\n\tpublic digest(guard: Guard): void {\n\t\tconst localGuardUp: GuardImpl = GuardImpl.up(guard) as GuardImpl;\n\t\tconst localGuardDown: GuardImpl = GuardImpl.down(guard) as GuardImpl;\n\n\t\tlet remainingEvaluations: number = MAX_EVALUATIONS;\n\t\tlet pending: boolean = true;\n\n\t\twhile (pending && remainingEvaluations > 0) {\n\t\t\tremainingEvaluations--;\n\n\t\t\tconst changedMediators: Array<ModelMediator<any>> = [];\n\n\t\t\tfor (const mediator of this.mediators) {\n\t\t\t\tconst changed: boolean = mediator.evaluate(localGuardDown);\n\n\t\t\t\tif (changed) {\n\t\t\t\t\tchangedMediators.push(mediator);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (changedMediators.length === 0) {\n\t\t\t\tpending = false;\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tfor (const changedMediator of changedMediators) {\n\t\t\t\tchangedMediator.notifyWatcher(localGuardDown);\n\t\t\t}\n\t\t}\n\n\t\tif (remainingEvaluations === 0) {\n\t\t\t// TODO - Make this error handling better\n\t\t\tthrow new DigestLoopError(\"Loop detected in digest cycle.\");\n\t\t}\n\n\t\tthis.parent.message(INTERNAL_DIRECT_CHANNEL_NAME, \"propagateDigest\", localGuardUp);\n\n\t\tfor (const mediator of this.mediators) {\n\t\t\tmediator.executeCallback(localGuardDown);\n\t\t}\n\t}\n\n\tpublic $apply(fn: Function, args: any[], guard?: Guard): any {\n\t\tconst result: any = fn.apply(this.model, args);\n\t\tthis.digest(guard);\n\t\treturn result;\n\t}\n\n\tprivate populateElementMediators(): void {\n\t\tconst queue: HTMLElement[] = [this.el];\n\n\t\twhile (queue.length > 0) {\n\t\t\tthis.processChild(queue);\n\t\t}\n\t}\n\n\tprivate processChild(queue: HTMLElement[]): void {\n\t\tconst el: HTMLElement = queue.pop();\n\t\tconst EVT_NAME_ERR = \"Event expressor \\'%eventName%\\' MUST correspond to a valid event in the target environment: \\'\";\n\t\tconst regex = /^[A-Za-z]+$/;\n\t\tconst elName: string = el.tagName.toLowerCase();\n\n\t\tif (elName === this.regionPrefix) {\n\t\t\tconst regionName: string = el.getAttribute(\"name\");\n\t\t\tconst region: Region = this.regionLookupFn(regionName);\n\t\t\tregion.setDefaultEl(el as HTMLElement);\n\t\t\treturn;\n\t\t} else if (elName === this.componentPrefix) {\n\t\t\tconst componentName: string = el.getAttribute(\"name\");\n\t\t\tconst moduleName: string = el.getAttribute(\"module\");\n\t\t\tconst moduleToUse: Module = moduleName ? Modules.getModule(moduleName) : this.moduleInstance;\n\t\t\tconst component: Component = (moduleToUse || this.moduleInstance).get(componentName);\n\t\t\tel.parentElement.replaceChild(component.getEl(), el);\n\t\t\tcomponent.message(INTERNAL_DIRECT_CHANNEL_NAME, \"setParent\", this.parent.getComponent());\n\t\t\tthis.components.push(component);\n\t\t\treturn;\n\t\t}\n\n\t\t// tslint:disable-next-line\n\t\tfor (let i = 0; i < el.children.length; i++) {\n\t\t\tqueue.push(el.children[i] as HTMLElement);\n\t\t}\n\n\t\tthis.processTextChildren(el.childNodes);\n\n\t\tfor (const name of el.getAttributeNames()) {\n\t\t\tconst expression: string = el.getAttribute(name);\n\t\t\tif (name.indexOf(this.eventElementMediatorPrefix) === 0) {\n\t\t\t\tconst eventName: string = name.substr(this.eventElementMediatorPrefix.length);\n\n\t\t\t\tif (!regex.test(eventName)) {\n\t\t\t\t\tthrow new MalformedOnEventError(EVT_NAME_ERR, { \"%eventName%\": eventName });\n\t\t\t\t}\n\n\t\t\t\tthis.addEventElementMediator(eventName.toLowerCase(), expression, el as HTMLElement);\n\t\t\t\tel.removeAttribute(name);\n\t\t\t} else if (name.indexOf(this.elementMediatorPrefix) === 0) {\n\t\t\t\tconst elementMediatorType: string = name.substr(this.elementMediatorPrefix.length);\n\t\t\t\tthis.addElementMediator(el.tagName.toLowerCase(), elementMediatorType, expression, el as HTMLElement);\n\t\t\t\tel.removeAttribute(name);\n\t\t\t} else if (expression.length > 4 && expression.indexOf(\"{{\") === 0 && expression.indexOf(\"}}\", expression.length - 2) !== -1) {\n\t\t\t\tconst trimmedExpression: string = expression.substring(2, expression.length - 2);\n\t\t\t\tthis.addAttributeElementMediator(name, trimmedExpression, el as HTMLElement);\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate processTextChildren(children: NodeListOf<ChildNode>): void {\n\t\tconst discoveredNodes: ChildNode[] = [];\n\n\t\t// tslint:disable-next-line\n\t\tfor (let i = 0; i < children.length; i++) {\n\t\t\tconst child: ChildNode = children[i];\n\n\t\t\tif (TEXT_NODE_TYPE === child.nodeType) {\n\t\t\t\tdiscoveredNodes.push(child);\n\t\t\t}\n\t\t}\n\n\t\tfor (const node of discoveredNodes) {\n\t\t\tconst result: Node[] = this.splitChild(node);\n\n\t\t\tif (result.length > 1) {\n\t\t\t\tfor (const newNode of result) {\n\t\t\t\t\tnode.parentNode.insertBefore(newNode, node);\n\t\t\t\t}\n\n\t\t\t\tnode.remove();\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate splitChild(node: Node): Node[] {\n\t\tconst source: string = node.textContent || \"\";\n\t\tconst sections: string[] = source.split(/(\\{\\{|\\}\\})/);\n\n\t\tif (sections.length < 2) {\n\t\t\treturn [node];\n\t\t}\n\n\t\tlet inside: boolean = false;\n\n\t\tconst collected: Node[] = [];\n\n\t\tfor (const section of sections) {\n\t\t\tswitch (section) {\n\t\t\t\tcase \"{{\":\n\t\t\t\t\tinside = true;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"}}\":\n\t\t\t\t\tinside = false;\n\t\t\t\t\tbreak;\n\n\t\t\t\tdefault:\n\t\t\t\t\tif (inside) {\n\t\t\t\t\t\tconst span: HTMLElement = Properties.getWindow().document.createElement(\"span\");\n\t\t\t\t\t\tspan.innerHTML = \"\";\n\t\t\t\t\t\tthis.addTextElementMediator(section, span);\n\t\t\t\t\t\tcollected.push(span);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tconst textNode: Text = Properties.getWindow().document.createTextNode(section);\n\t\t\t\t\t\tcollected.push(textNode);\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\treturn collected;\n\t}\n\n\tprivate addTextElementMediator(expression: string, el: HTMLElement): void {\n\t\tconst deps = { mvvm: this, parent: this.parent, el: el, expression: expression, model: this.model, prefix: \"Text\" };\n\t\tconst elementMediator: TextElementMediator = new TextElementMediator(deps);\n\t\telementMediator.setModule(this.moduleInstance);\n\t\telementMediator.init();\n\n\t\tthis.elementMediators.push(elementMediator);\n\t}\n\n\tprivate addEventElementMediator(eventName: string, expression: string, el: HTMLElement): void {\n\t\tconst deps = { mvvm: this, parent: this.parent, el: el, expression: expression, model: this.model, prefix: \"Event\" };\n\t\tconst elementMediator: EventElementMediator = new EventElementMediator(deps);\n\t\telementMediator.setModule(this.moduleInstance);\n\t\telementMediator.setEventKey(eventName);\n\t\telementMediator.init();\n\n\t\tthis.elementMediators.push(elementMediator);\n\t}\n\n\tprivate addAttributeElementMediator(attributeName: string, expression: string, el: HTMLElement): void {\n\t\tconst deps = { mvvm: this, parent: this.parent, el: el, expression: expression, model: this.model, prefix: \"Event\" };\n\t\tconst elementMediator: AttributeElementMediator = new AttributeElementMediator(deps);\n\t\telementMediator.setModule(this.moduleInstance);\n\t\telementMediator.setAttributeName(attributeName);\n\t\telementMediator.init();\n\n\t\tthis.elementMediators.push(elementMediator);\n\t}\n\n\tprivate addElementMediator(tag: string, elementMediatorType: string, attributeValue: string, el: HTMLElement): void {\n\t\tconst tags: { [tag: string]: new () => ElementMediator<any, HTMLElement>; } = Mvvm.factories[elementMediatorType];\n\t\tconst prefix: string = \"data-p-\" + elementMediatorType + \"-\";\n\n\t\tlet elementMediator: ElementMediator<any, HTMLElement> = null;\n\n\t\tif (!tags) {\n\t\t\tthis.logger.error(\"Unsupported elementMediator type: \" + elementMediatorType + \".\");\n\t\t\treturn;\n\t\t}\n\n\t\tlet elementMediatorClass: any = tags[tag];\n\n\t\tif (!elementMediatorClass) {\n\t\t\telementMediatorClass = tags[\"*\"];\n\t\t}\n\n\t\tif (!elementMediatorClass) {\n\t\t\tthis.logger.error(\"Unsupported tag: \" + tag + \" for elementMediator \" + elementMediatorType + \".\");\n\t\t\treturn;\n\t\t}\n\n\t\tconst deps = { mvvm: this, parent: this.parent, el: el, expression: attributeValue, model: this.model, prefix: prefix };\n\t\telementMediator = new elementMediatorClass(deps);\n\t\telementMediator.setModule(this.moduleInstance);\n\t\telementMediator.init();\n\n\t\tthis.elementMediators.push(elementMediator);\n\t}\n\n}\n\nexport {\n\tComponent,\n\tEvents,\n\tElementMediator,\n\tMvvm,\n\tStageComponent,\n\tModules,\n\tModuleImpl,\n\tElementMediatorDependencies,\n\tProperties,\n\tINTERNAL_CHANNEL_NAME,\n\tINTERNAL_DIRECT_CHANNEL_NAME,\n};\n","abstract class CydranError extends Error {\n\n\tprivate static doMsgFilling(msg: string, reps: any): string {\n\t\treturn msg.replace(/%\\w+%/g, (all: string) => (reps[all] + \"\") || all);\n\t}\n\n\tpublic readonly message: string;\n\n\t/**\n\t * Constructor\n\t *\n\t * @param msg string object specific to context\n\t * @param reps optional {key:value, <n^1>} object of named substitution values\n\t * @returns string filled in values in the mesage\n\t */\n\tconstructor(msg: string, reps?: any) {\n\t\tsuper();\n\n\t\tif (new.target === CydranError) {\n\t\t\tthrow TypeError(\"Direct instantiation of \" + new.target.name + \" is not allowed.\");\n\t\t}\n\n\t\tthis.message = (reps) ? CydranError.doMsgFilling(msg, reps) : msg;\n\t}\n\n}\n\nconst NEWI = \" needs to be instantiated with 'new'\";\n\nexport { CydranError, NEWI };\n","enum Level {\n\tTRACE,\n\tDEBUG,\n\tINFO,\n\tWARN,\n\tERROR,\n\tFATAL,\n\tDISABLE,\n}\n\nexport default Level;\n","import Logger from \"./Logger\";\nimport LoggerImpl from \"./LoggerImpl\";\nimport LoggerService from \"./LoggerService\";\n\nclass LoggerFactory {\n\n\tpublic static getLogger(name: string): Logger {\n\t\treturn new LoggerImpl(name, LoggerService.INSTANCE);\n\t}\n\n}\n\nexport default LoggerFactory;\n","/* tslint:disable */\n\nconst LARGE_ARRAY_SIZE = 200;\nconst FUNC_ERROR_TEXT = \"Expected a function\";\nconst HASH_UNDEFINED = \"__lodash_hash_undefined__\";\nconst CLONE_DEEP_FLAG = 1;\nconst CLONE_FLAT_FLAG = 2;\nconst CLONE_SYMBOLS_FLAG = 4;\nconst COMPARE_PARTIAL_FLAG = 1;\nconst COMPARE_UNORDERED_FLAG = 2;\nconst MAX_SAFE_INTEGER = 9007199254740991;\nconst argsTag = \"[object Arguments]\";\nconst arrayTag = \"[object Array]\";\nconst asyncTag = \"[object AsyncFunction]\";\nconst boolTag = \"[object Boolean]\";\nconst dateTag = \"[object Date]\";\nconst errorTag = \"[object Error]\";\nconst funcTag = \"[object Function]\";\nconst genTag = \"[object GeneratorFunction]\";\nconst mapTag = \"[object Map]\";\nconst numberTag = \"[object Number]\";\nconst nullTag = \"[object Null]\";\nconst objectTag = \"[object Object]\";\nconst promiseTag = \"[object Promise]\";\nconst proxyTag = \"[object Proxy]\";\nconst regexpTag = \"[object RegExp]\";\nconst setTag = \"[object Set]\";\nconst stringTag = \"[object String]\";\nconst symbolTag = \"[object Symbol]\";\nconst undefinedTag = \"[object Undefined]\";\nconst weakMapTag = \"[object WeakMap]\";\nconst arrayBufferTag = \"[object ArrayBuffer]\";\nconst dataViewTag = \"[object DataView]\";\nconst float32Tag = \"[object Float32Array]\";\nconst float64Tag = \"[object Float64Array]\";\nconst int8Tag = \"[object Int8Array]\";\nconst int16Tag = \"[object Int16Array]\";\nconst int32Tag = \"[object Int32Array]\";\nconst uint8Tag = \"[object Uint8Array]\";\nconst uint8ClampedTag = \"[object Uint8ClampedArray]\";\nconst uint16Tag = \"[object Uint16Array]\";\nconst uint32Tag = \"[object Uint32Array]\";\nconst reRegExpChar = /[\\\\^$.*+?()[\\]{}|]/g;\nconst reFlags = /\\w*$/;\nconst reIsHostCtor = /^\\[object .+?Constructor\\]$/;\nconst reIsUint = /^(?:0|[1-9]\\d*)$/;\nconst typedArrayTags = {};\ntypedArrayTags[float32Tag] = typedArrayTags[float64Tag] =\n\ttypedArrayTags[int8Tag] = typedArrayTags[int16Tag] =\n\ttypedArrayTags[int32Tag] = typedArrayTags[uint8Tag] =\n\ttypedArrayTags[uint8ClampedTag] = typedArrayTags[uint16Tag] =\n\ttypedArrayTags[uint32Tag] = true;\ntypedArrayTags[argsTag] = typedArrayTags[arrayTag] =\n\ttypedArrayTags[arrayBufferTag] = typedArrayTags[boolTag] =\n\ttypedArrayTags[dataViewTag] = typedArrayTags[dateTag] =\n\ttypedArrayTags[errorTag] = typedArrayTags[funcTag] =\n\ttypedArrayTags[mapTag] = typedArrayTags[numberTag] =\n\ttypedArrayTags[objectTag] = typedArrayTags[regexpTag] =\n\ttypedArrayTags[setTag] = typedArrayTags[stringTag] =\n\ttypedArrayTags[weakMapTag] = false;\nconst cloneableTags = {};\ncloneableTags[argsTag] = cloneableTags[arrayTag] =\n\tcloneableTags[arrayBufferTag] = cloneableTags[dataViewTag] =\n\tcloneableTags[boolTag] = cloneableTags[dateTag] =\n\tcloneableTags[float32Tag] = cloneableTags[float64Tag] =\n\tcloneableTags[int8Tag] = cloneableTags[int16Tag] =\n\tcloneableTags[int32Tag] = cloneableTags[mapTag] =\n\tcloneableTags[numberTag] = cloneableTags[objectTag] =\n\tcloneableTags[regexpTag] = cloneableTags[setTag] =\n\tcloneableTags[stringTag] = cloneableTags[symbolTag] =\n\tcloneableTags[uint8Tag] = cloneableTags[uint8ClampedTag] =\n\tcloneableTags[uint16Tag] = cloneableTags[uint32Tag] = true;\ncloneableTags[errorTag] = cloneableTags[funcTag] =\n\tcloneableTags[weakMapTag] = false;\nconst freeGlobal = typeof global === \"object\" && global && global.Object === Object && global;\nconst freeSelf = typeof self === \"object\" && self && self[\"Object\"] === Object && self;\nconst root = freeGlobal || freeSelf || Function(\"return this\")();\nconst freeExports = typeof exports === \"object\" && exports && !exports.nodeType && exports;\nconst freeModule = freeExports && typeof module === \"object\" && module && !module[\"nodeType\"] && module;\nconst moduleExports = freeModule && freeModule.exports === freeExports;\n\nfunction arrayEach(array: any[], iteratee: Function): any[] {\n\tconst length = array == null ? 0 : array.length;\n\n\tlet index = -1;\n\n\twhile (++index < length) {\n\t\tif (iteratee(array[index], index, array) === false) {\n\t\t\tbreak;\n\t\t}\n\t}\n\n\treturn array;\n}\n\nfunction arrayFilter(array: any[], predicate: Function): any[] {\n\tconst length = array == null ? 0 : array.length;\n\tconst result = [];\n\n\tlet index = -1;\n\tlet resIndex = 0;\n\n\twhile (++index < length) {\n\t\tconst value = array[index];\n\n\t\tif (predicate(value, index, array)) {\n\t\t\tresult[resIndex++] = value;\n\t\t}\n\t}\n\n\treturn result;\n}\n\nfunction arrayPush(array: any[], values: any[]): any[] {\n\tconst length = values.length;\n\tconst offset = array.length;\n\n\tlet index = -1;\n\n\twhile (++index < length) {\n\t\tarray[offset + index] = values[index];\n\t}\n\n\treturn array;\n}\n\nfunction arraySome(array: any[], predicate: Function): boolean {\n\tconst length = array == null ? 0 : array.length;\n\tlet index = -1;\n\n\twhile (++index < length) {\n\t\tif (predicate(array[index], index, array)) {\n\t\t\treturn true;\n\t\t}\n\t}\n\n\treturn false;\n}\n\nfunction baseTimes(n: number, iteratee: Function): any[] {\n\tconst result = Array(n);\n\tlet index = -1;\n\n\twhile (++index < n) {\n\t\tresult[index] = iteratee(index);\n\t}\n\n\treturn result;\n}\n\nfunction cacheHas(cache: any, key: string): boolean {\n\treturn cache.has(key);\n}\n\nfunction getValue(object: any, key: string): any {\n\treturn object == null ? undefined : object[key];\n}\n\nfunction mapToArray(map: any): any[] {\n\tconst result = Array(map.size);\n\n\tlet index = -1;\n\n\tmap.forEach(function(value: any, key: string) {\n\t\tresult[++index] = [key, value];\n\t});\n\n\treturn result;\n}\n\nfunction overArg(func: Function, transform: Function): Function {\n\treturn function(arg: any) {\n\t\treturn func(transform(arg));\n\t};\n}\n\nfunction setToArray(set: any): any[] {\n\tconst result = Array(set.size);\n\n\tlet index = -1;\n\n\tset.forEach(function(value: any) {\n\t\tresult[++index] = value;\n\t});\n\n\treturn result;\n}\n\ninterface ContextType {\n\t[x: string]: any;\n\tArray: any;\n\tDate: any;\n\tError: any;\n\tFunction: any;\n\tMath: any;\n\tObject: any;\n\tRegExp: any;\n\tString: any;\n\tTypeError: any;\n\tBuffer: any;\n\tSymbol: any;\n\tUint8Array: any;\n\tclearTimeout: any;\n\tsetTimeout: any;\n\tisFinite: any;\n\tparseInt: any;\n}\n\nconst context: ContextType = root;\n\nconst arrayProto = Array.prototype;\nconst funcProto = Function.prototype;\nconst objectProto = Object.prototype;\nconst coreJsData = context[\"__core-js_shared__\"];\nconst funcToString = funcProto.toString;\nconst hasOwnProperty = objectProto.hasOwnProperty;\nconst maskSrcKey = (function() {\n\tconst uid = /[^.]+$/.exec(coreJsData && coreJsData.keys && coreJsData.keys.IE_PROTO || \"\");\n\n\treturn uid ? (\"Symbol(src)_1.\" + uid) : \"\";\n}());\n\nconst nativeObjectToString = objectProto.toString;\nconst reIsNative = RegExp(\"^\" + funcToString.call(hasOwnProperty).replace(reRegExpChar, \"\\\\$&\").replace(/hasOwnProperty|(function).*?(?=\\\\\\()| for .+?(?=\\\\\\])/g, \"$1.*?\") + \"$\");\n\nconst Buffer = moduleExports ? context.Buffer : undefined;\nconst Symbol = context.Symbol;\nconst Uint8Array = context.Uint8Array;\nconst allocUnsafe = Buffer ? Buffer.allocUnsafe : undefined;\nconst getPrototype = overArg(Object.getPrototypeOf, Object);\nconst objectCreate = Object.create;\nconst propertyIsEnumerable = objectProto.propertyIsEnumerable;\nconst splice = arrayProto.splice;\nconst symToStringTag = Symbol ? Symbol.toStringTag : undefined;\nconst nativeGetSymbols = Object.getOwnPropertySymbols;\nconst nativeIsBuffer = Buffer ? Buffer.isBuffer : undefined;\nconst nativeKeys = overArg(Object.keys, Object);\nconst DataView = getNative(context, \"DataView\");\nconst Map = getNative(context, \"Map\");\nconst Promise = getNative(context, \"Promise\");\nconst Set = getNative(context, \"Set\");\nconst WeakMap = getNative(context, \"WeakMap\");\nconst nativeCreate = getNative(Object, \"create\");\nconst dataViewCtorString = toSource(DataView);\nconst mapCtorString = toSource(Map);\nconst promiseCtorString = toSource(Promise);\nconst setCtorString = toSource(Set);\nconst weakMapCtorString = toSource(WeakMap);\nconst symbolProto = Symbol ? Symbol.prototype : undefined;\nconst symbolValueOf = symbolProto ? symbolProto.valueOf : undefined;\n\nconst baseCreate = (function() {\n\tfunction object() {\n\t\t// Intentionally do nothing\n\t}\n\n\treturn function(proto: any) {\n\t\tif (!isObject(proto)) {\n\t\t\treturn {};\n\t\t}\n\t\tif (objectCreate) {\n\t\t\treturn objectCreate(proto);\n\t\t}\n\t\tobject.prototype = proto;\n\t\tconst result = new object();\n\t\tobject.prototype = undefined;\n\t\treturn result;\n\t};\n}());\n\nclass Hash {\n\n\tpublic size: number;\n\n\tpublic __DATA__: any;\n\n\tconstructor(entries?: any[]) {\n\t\tlet index = -1;\n\t\tconst length = entries == null ? 0 : entries.length;\n\n\t\tthis.clear();\n\t\twhile (++index < length) {\n\t\t\tconst entry = entries[index];\n\t\t\tthis.set(entry[0], entry[1]);\n\t\t}\n\t}\n\n\tpublic clear(): void {\n\t\tthis.__DATA__ = nativeCreate ? nativeCreate(null) : {};\n\t\tthis.size = 0;\n\t}\n\n\tpublic delete(key: string): boolean {\n\t\tconst result = this.has(key) && delete this.__DATA__[key];\n\t\tthis.size -= result ? 1 : 0;\n\t\treturn result;\n\t}\n\n\tpublic get(key: string): any {\n\t\tconst data = this.__DATA__;\n\t\tif (nativeCreate) {\n\t\t\tconst result = data[key];\n\t\t\treturn result === HASH_UNDEFINED ? undefined : result;\n\t\t}\n\t\treturn hasOwnProperty.call(data, key) ? data[key] : undefined;\n\t}\n\n\tpublic has(key: string): boolean {\n\t\tconst data = this.__DATA__;\n\t\treturn nativeCreate ? (data[key] !== undefined) : hasOwnProperty.call(data, key);\n\t}\n\n\tpublic set(key: string, value: any): any {\n\t\tconst data = this.__DATA__;\n\t\tthis.size += this.has(key) ? 0 : 1;\n\t\tdata[key] = (nativeCreate && value === undefined) ? HASH_UNDEFINED : value;\n\t\treturn this;\n\t}\n\n}\n\nclass ListCache {\n\n\tpublic size: number;\n\n\tpublic __DATA__: any;\n\n\tconstructor(entries?: any[]) {\n\t\tlet index = -1;\n\t\tconst length = entries == null ? 0 : entries.length;\n\n\t\tthis.clear();\n\n\t\twhile (++index < length) {\n\t\t\tconst entry = entries[index];\n\t\t\tthis.set(entry[0], entry[1]);\n\t\t}\n\t}\n\n\tpublic clear(): void {\n\t\tthis.__DATA__ = [];\n\t\tthis.size = 0;\n\t}\n\n\tpublic delete(key: string): boolean {\n\t\tconst data = this.__DATA__;\n\t\tconst index = assocIndexOf(data, key);\n\n\t\tif (index < 0) {\n\t\t\treturn false;\n\t\t}\n\t\tconst lastIndex = data.length - 1;\n\t\tif (index == lastIndex) {\n\t\t\tdata.pop();\n\t\t} else {\n\t\t\tsplice.call(data, index, 1);\n\t\t}\n\t\t--this.size;\n\t\treturn true;\n\t}\n\n\tpublic get(key: string): any {\n\t\tconst data = this.__DATA__;\n\t\tconst index = assocIndexOf(data, key);\n\n\t\treturn index < 0 ? undefined : data[index][1];\n\t}\n\n\tpublic has(key: string): boolean {\n\t\treturn assocIndexOf(this.__DATA__, key) > -1;\n\t}\n\n\tpublic set(key: string, value: any): any {\n\t\tconst data = this.__DATA__;\n\t\tconst index = assocIndexOf(data, key);\n\n\t\tif (index < 0) {\n\t\t\t++this.size;\n\t\t\tdata.push([key, value]);\n\t\t} else {\n\t\t\tdata[index][1] = value;\n\t\t}\n\t\treturn this;\n\t}\n\n}\n\nclass MapCache {\n\n\tpublic size: number;\n\n\tpublic __DATA__: any;\n\n\tconstructor(entries?: any[]) {\n\t\tlet index = -1;\n\t\tconst length = entries == null ? 0 : entries.length;\n\n\t\tthis.clear();\n\t\twhile (++index < length) {\n\t\t\tconst entry = entries[index];\n\t\t\tthis.set(entry[0], entry[1]);\n\t\t}\n\t}\n\n\tpublic clear(): void {\n\t\tthis.size = 0;\n\t\tthis.__DATA__ = {\n\t\t\thash: new Hash(),\n\t\t\tmap: new (Map || ListCache)(),\n\t\t\tstring: new Hash(),\n\t\t};\n\t}\n\n\tpublic delete(key: string): boolean {\n\t\tconst result = getMapData(this, key)[\"delete\"](key);\n\t\tthis.size -= result ? 1 : 0;\n\t\treturn result;\n\t}\n\n\tpublic get(key: string): any {\n\t\treturn getMapData(this, key).get(key);\n\t}\n\n\tpublic has(key: string): boolean {\n\t\treturn getMapData(this, key).has(key);\n\t}\n\n\tpublic set(key: string, value: any): any {\n\t\tconst data = getMapData(this, key);\n\t\tconst size = data.size;\n\n\t\tdata.set(key, value);\n\t\tthis.size += data.size == size ? 0 : 1;\n\t\treturn this;\n\t}\n\n}\n\nclass SetCache {\n\n\tpublic __DATA__: any;\n\n\tconstructor(values?: any[]) {\n\t\tlet index = -1;\n\t\tconst length = values == null ? 0 : values.length;\n\n\t\tthis.__DATA__ = new MapCache();\n\t\twhile (++index < length) {\n\t\t\tthis.add(values[index]);\n\t\t}\n\t}\n\n\tpublic push(value: any): any {\n\t\treturn this.add(value);\n\t}\n\n\tpublic add(value: any): any {\n\t\tthis.__DATA__.set(value, HASH_UNDEFINED);\n\t\treturn this;\n\t}\n\n\tpublic has(value: any): boolean {\n\t\treturn this.__DATA__.has(value);\n\t}\n\n}\n\nclass Stack {\n\n\tpublic __DATA__: any;\n\n\tpublic size: number;\n\n\tconstructor(entries?: any[]) {\n\t\tconst data = this.__DATA__ = new ListCache(entries);\n\t\tthis.size = data.size;\n\t}\n\n\tpublic clear(): void {\n\t\tthis.__DATA__ = new ListCache();\n\t\tthis.size = 0;\n\t}\n\n\tpublic delete(key: string): boolean {\n\t\tconst data = this.__DATA__;\n\t\tconst result = data[\"delete\"](key);\n\n\t\tthis.size = data.size;\n\t\treturn result;\n\t}\n\n\tpublic get(key: string): any {\n\t\treturn this.__DATA__.get(key);\n\t}\n\n\tpublic has(key: string): boolean {\n\t\treturn this.__DATA__.has(key);\n\t}\n\n\tpublic set(key: string, value: any): any {\n\t\tlet data = this.__DATA__;\n\t\tif (data instanceof ListCache) {\n\t\t\tconst pairs = data.__DATA__;\n\t\t\tif (!Map || (pairs.length < LARGE_ARRAY_SIZE - 1)) {\n\t\t\t\tpairs.push([key, value]);\n\t\t\t\tthis.size = ++data.size;\n\t\t\t\treturn this;\n\t\t\t}\n\t\t\tdata = this.__DATA__ = new MapCache(pairs);\n\t\t}\n\t\tdata.set(key, value);\n\t\tthis.size = data.size;\n\t\treturn this;\n\t}\n\n}\n\nfunction arrayLikeKeys(value: any, inherited?: boolean): string[] {\n\tconst isArr = isArray(value);\n\tconst isArg = !isArr && isArguments(value);\n\tconst isBuff = !isArr && !isArg && isBuffer(value);\n\tconst isType = !isArr && !isArg && !isBuff && isTypedArray(value);\n\tconst skipIndexes = isArr || isArg || isBuff || isType;\n\tconst result = skipIndexes ? baseTimes(value.length, String) : [];\n\tconst length = result.length;\n\n\tfor (const key in value) {\n\t\tif ((inherited || hasOwnProperty.call(value, key)) &&\n\t\t\t!(skipIndexes && (\n\t\t\t\t// Safari 9 has enumerable `arguments.length` in strict mode.\n\t\t\t\tkey == \"length\" ||\n\t\t\t\t// Node.js 0.10 has enumerable non-index properties on buffers.\n\t\t\t\t(isBuff && (key == \"offset\" || key == \"parent\")) ||\n\t\t\t\t// PhantomJS 2 has enumerable non-index properties on typed arrays.\n\t\t\t\t(isType && (key == \"buffer\" || key == \"byteLength\" || key == \"byteOffset\")) ||\n\t\t\t\t// Skip index properties.\n\t\t\t\tisIndex(key, length)\n\t\t\t))) {\n\t\t\tresult.push(key);\n\t\t}\n\t}\n\treturn result;\n}\n\nfunction assignValue(object: any, key: string, value: any): void {\n\tconst objValue = object[key];\n\tif (!(hasOwnProperty.call(object, key) && eq(objValue, value)) ||\n\t\t(value === undefined && !(key in object))) {\n\t\tbaseAssignValue(object, key, value);\n\t}\n}\n\nfunction assocIndexOf(array: any[], key: any): number {\n\tlet length = array.length;\n\twhile (length--) {\n\t\tif (eq(array[length][0], key)) {\n\t\t\treturn length;\n\t\t}\n\t}\n\treturn -1;\n}\n\nfunction baseAssign(object: any, source: any): any {\n\treturn object && copyObject(source, keys(source), object);\n}\n\nfunction baseAssignIn(object: any, source: any): any {\n\treturn object && copyObject(source, keysIn(source), object);\n}\n\nfunction baseAssignValue(object: any, key: string, value: any): void {\n\tif (key == \"__proto__\" && Object.defineProperty) {\n\t\tObject.defineProperty(object, key, {\n\t\t\tconfigurable: true,\n\t\t\tenumerable: true,\n\t\t\tvalue: value,\n\t\t\twritable: true,\n\t\t});\n\t} else {\n\t\tobject[key] = value;\n\t}\n}\n\nfunction baseClone(value: any, bitmask: number, customizer?: Function, key?: string, object?: any, stack?: any): any {\n\tlet result: any;\n\tconst isDeep = bitmask & CLONE_DEEP_FLAG;\n\tconst isFlat = bitmask & CLONE_FLAT_FLAG;\n\tconst isFull = bitmask & CLONE_SYMBOLS_FLAG;\n\n\tif (customizer) {\n\t\tresult = object ? customizer(value, key, object, stack) : customizer(value);\n\t}\n\tif (result !== undefined) {\n\t\treturn result;\n\t}\n\tif (!isObject(value)) {\n\t\treturn value;\n\t}\n\tconst isArr = isArray(value);\n\tif (isArr) {\n\t\tresult = initCloneArray(value);\n\t\tif (!isDeep) {\n\t\t\treturn copyArray(value, result);\n\t\t}\n\t} else {\n\t\tconst tag = getTag(value);\n\t\tconst isFunc = tag == funcTag || tag == genTag;\n\n\t\tif (isBuffer(value)) {\n\t\t\treturn cloneBuffer(value, !!isDeep);\n\t\t}\n\t\tif (tag == objectTag || tag == argsTag || (isFunc && !object)) {\n\t\t\tresult = (isFlat || isFunc) ? {} : initCloneObject(value);\n\t\t\tif (!isDeep) {\n\t\t\t\treturn isFlat\n\t\t\t\t\t? copySymbolsIn(value, baseAssignIn(result, value))\n\t\t\t\t\t: copySymbols(value, baseAssign(result, value));\n\t\t\t}\n\t\t} else {\n\t\t\tif (!cloneableTags[tag]) {\n\t\t\t\treturn object ? value : {};\n\t\t\t}\n\t\t\tresult = initCloneByTag(value, tag, !!isDeep);\n\t\t}\n\t}\n\t// Check for circular references and return its corresponding clone.\n\tstack = (!stack) ? new Stack() : stack;\n\tconst stacked = stack.get(value);\n\tif (stacked) {\n\t\treturn stacked;\n\t}\n\tstack.set(value, result);\n\n\tif (isSet(value)) {\n\t\tvalue.forEach(function(subValue: any) {\n\t\t\tresult.add(baseClone(subValue, bitmask, customizer, subValue, value, stack));\n\t\t});\n\t} else if (isMap(value)) {\n\t\tvalue.forEach(function(subValue: any, key: string) {\n\t\t\tresult.set(key, baseClone(subValue, bitmask, customizer, key, value, stack));\n\t\t});\n\t}\n\n\tconst keysFunc = isFull ? (isFlat ? getAllKeysIn : getAllKeys) : (isFlat ? keysIn : keys);\n\tconst props = isArr ? undefined : keysFunc(value);\n\tarrayEach(props || value, function(subValue: any, key: string) {\n\t\tif (props) {\n\t\t\tkey = subValue;\n\t\t\tsubValue = value[key];\n\t\t}\n\t\t// Recursively populate clone (susceptible to call stack limits).\n\t\tassignValue(result, key, baseClone(subValue, bitmask, customizer, key, value, stack));\n\t});\n\treturn result;\n}\n\nfunction baseGetAllKeys(object: any, keysFunc: Function, symbolsFunc: Function): any[] {\n\tconst result = keysFunc(object);\n\treturn isArray(object) ? result : arrayPush(result, symbolsFunc(object));\n}\n\nfunction baseGetTag(value: any): string {\n\tif (value == null) {\n\t\treturn value === undefined ? undefinedTag : nullTag;\n\t}\n\treturn (symToStringTag && symToStringTag in Object(value))\n\t\t? getRawTag(value)\n\t\t: objectToString(value);\n}\n\nfunction baseIsArguments(value: any): boolean {\n\treturn isObjectLike(value) && baseGetTag(value) == argsTag;\n}\n\nfunction baseIsEqual(value: any, other: any, bitmask?: number, customizer?: Function, stack?: any): boolean {\n\tif (value === other) {\n\t\treturn true;\n\t}\n\tif (value == null || other == null || (!isObjectLike(value) && !isObjectLike(other))) {\n\t\treturn value !== value && other !== other;\n\t}\n\treturn baseIsEqualDeep(value, other, bitmask, customizer, baseIsEqual, stack);\n}\n\nfunction baseIsEqualDeep(object: any, other: any, bitmask: number, customizer: Function, equalFunc: Function, stack: any): boolean {\n\tlet objIsArr = isArray(object);\n\tconst othIsArr = isArray(other);\n\tlet objTag = objIsArr ? arrayTag : getTag(object);\n\tlet othTag = othIsArr ? arrayTag : getTag(other);\n\n\tobjTag = objTag == argsTag ? objectTag : objTag;\n\tothTag = othTag == argsTag ? objectTag : othTag;\n\n\tlet objIsObj = objTag == objectTag;\n\tconst othIsObj = othTag == objectTag;\n\tconst isSameTag = objTag == othTag;\n\n\tif (isSameTag && isBuffer(object)) {\n\t\tif (!isBuffer(other)) {\n\t\t\treturn false;\n\t\t}\n\t\tobjIsArr = true;\n\t\tobjIsObj = false;\n\t}\n\tif (isSameTag && !objIsObj) {\n\t\tstack = (!stack) ? new Stack() : stack;\n\t\treturn (objIsArr || isTypedArray(object))\n\t\t\t? equalArrays(object, other, bitmask, customizer, equalFunc, stack)\n\t\t\t: equalByTag(object, other, objTag, bitmask, customizer, equalFunc, stack);\n\t}\n\tif (!(bitmask & COMPARE_PARTIAL_FLAG)) {\n\t\tconst objIsWrapped = objIsObj && hasOwnProperty.call(object, \"__wrapped__\");\n\t\tconst othIsWrapped = othIsObj && hasOwnProperty.call(other, \"__wrapped__\");\n\n\t\tif (objIsWrapped || othIsWrapped) {\n\t\t\tconst objUnwrapped = objIsWrapped ? object.value() : object;\n\t\t\tconst othUnwrapped = othIsWrapped ? other.value() : other;\n\n\t\t\tstack = (!stack) ? new Stack() : stack;\n\t\t\treturn equalFunc(objUnwrapped, othUnwrapped, bitmask, customizer, stack);\n\t\t}\n\t}\n\tif (!isSameTag) {\n\t\treturn false;\n\t}\n\tstack = (!stack) ? new Stack() : stack;\n\treturn equalObjects(object, other, bitmask, customizer, equalFunc, stack);\n}\n\nfunction baseIsMap(value: any): boolean {\n\treturn isObjectLike(value) && getTag(value) == mapTag;\n}\n\nfunction baseIsNative(value: any): boolean {\n\tif (!isObject(value) || isMasked(value)) {\n\t\treturn false;\n\t}\n\tconst pattern = isFunction(value) ? reIsNative : reIsHostCtor;\n\treturn pattern.test(toSource(value));\n}\n\nfunction baseIsSet(value: any): boolean {\n\treturn isObjectLike(value) && getTag(value) == setTag;\n}\n\nfunction baseIsTypedArray(value: any): boolean {\n\treturn isObjectLike(value) &&\n\t\tisLength(value.length) && !!typedArrayTags[baseGetTag(value)];\n}\n\nfunction baseKeys(object: any): string[] {\n\tif (!isPrototype(object)) {\n\t\treturn nativeKeys(object);\n\t}\n\tconst result = [];\n\tfor (const key in Object(object)) {\n\t\tif (hasOwnProperty.call(object, key) && key != \"constructor\") {\n\t\t\tresult.push(key);\n\t\t}\n\t}\n\treturn result;\n}\n\nfunction baseKeysIn(object: any): string[] {\n\tif (!isObject(object)) {\n\t\treturn nativeKeysIn(object);\n\t}\n\tconst isProto = isPrototype(object);\n\tconst result = [];\n\n\tfor (const key in object) {\n\t\tif (!(key == \"constructor\" && (isProto || !hasOwnProperty.call(object, key)))) {\n\t\t\tresult.push(key);\n\t\t}\n\t}\n\treturn result;\n}\n\nfunction cloneBuffer(buffer: Buffer, isDeep: boolean): Buffer {\n\tif (isDeep) {\n\t\treturn buffer.slice();\n\t}\n\tconst length = buffer.length;\n\tconst result = allocUnsafe ? allocUnsafe(length) : new buffer.constructor(length);\n\n\tbuffer.copy(result);\n\treturn result;\n}\n\nfunction cloneArrayBuffer(arrayBuffer: ArrayBuffer): ArrayBuffer {\n\tconst ctor: any = arrayBuffer[\"constructor\"];\n\tconst result = new ctor(arrayBuffer.byteLength);\n\tnew Uint8Array(result).set(new Uint8Array(arrayBuffer));\n\treturn result;\n}\n\nfunction cloneDataView(dataView: any, isDeep: boolean): any {\n\tconst buffer = isDeep ? cloneArrayBuffer(dataView.buffer) : dataView.buffer;\n\treturn new dataView.constructor(buffer, dataView.byteOffset, dataView.byteLength);\n}\n\nfunction cloneRegExp(regexp: any): any {\n\tconst result = new regexp.constructor(regexp.source, reFlags.exec(regexp));\n\tresult.lastIndex = regexp.lastIndex;\n\treturn result;\n}\n\nfunction cloneSymbol(symbol: any): any {\n\treturn symbolValueOf ? Object(symbolValueOf.call(symbol)) : {};\n}\n\nfunction cloneTypedArray(typedArray: any, isDeep: boolean): any {\n\tconst buffer = isDeep ? cloneArrayBuffer(typedArray.buffer) : typedArray.buffer;\n\treturn new typedArray.constructor(buffer, typedArray.byteOffset, typedArray.length);\n}\n\nfunction copyArray(source: any[], array?: any[]): any[] {\n\tlet index = -1;\n\tconst length = source.length;\n\n\tarray = (!array) ? Array(length) : array;\n\twhile (++index < length) {\n\t\tarray[index] = source[index];\n\t}\n\treturn array;\n}\n\nfunction copyObject(source: any, props: string[], object?: any, customizer?: Function): any {\n\tconst isNew = !object;\n\tobject = (isNew) ? {} : object;\n\n\tlet index = -1;\n\tconst length = props.length;\n\n\twhile (++index < length) {\n\t\tconst key = props[index];\n\n\t\tlet newValue = customizer\n\t\t\t? customizer(object[key], source[key], key, object, source)\n\t\t\t: undefined;\n\n\t\tif (newValue === undefined) {\n\t\t\tnewValue = source[key];\n\t\t}\n\t\tif (isNew) {\n\t\t\tbaseAssignValue(object, key, newValue);\n\t\t} else {\n\t\t\tassignValue(object, key, newValue);\n\t\t}\n\t}\n\treturn object;\n}\n\nfunction copySymbols(source: any, object: any): any {\n\treturn copyObject(source, getSymbols(source), object);\n}\n\nfunction copySymbolsIn(source: any, object: any): any {\n\treturn copyObject(source, getSymbolsIn(source), object);\n}\n\nfunction equalArrays(array: any[], other: any[], bitmask: number, customizer: Function, equalFunc: Function, stack: any): boolean {\n\tconst isPartial = bitmask & COMPARE_PARTIAL_FLAG;\n\tconst arrLength = array.length;\n\tconst othLength = other.length;\n\n\tif (arrLength != othLength && !(isPartial && othLength > arrLength)) {\n\t\treturn false;\n\t}\n\t// Assume cyclic values are equal.\n\tconst stacked = stack.get(array);\n\tif (stacked && stack.get(other)) {\n\t\treturn stacked == other;\n\t}\n\tlet index = -1;\n\tlet result = true;\n\tconst seen = (bitmask & COMPARE_UNORDERED_FLAG) ? new SetCache() : undefined;\n\n\tstack.set(array, other);\n\tstack.set(other, array);\n\n\t// Ignore non-index properties.\n\twhile (++index < arrLength) {\n\t\tconst arrValue = array[index];\n\t\tconst othValue = other[index];\n\n\t\tlet compared;\n\t\tif (customizer) {\n\t\t\tcompared = isPartial\n\t\t\t\t? customizer(othValue, arrValue, index, other, array, stack)\n\t\t\t\t: customizer(arrValue, othValue, index, array, other, stack);\n\t\t}\n\t\tif (compared !== undefined) {\n\t\t\tif (compared) {\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tresult = false;\n\t\t\tbreak;\n\t\t}\n\t\t// Recursively compare arrays (susceptible to call stack limits).\n\t\tif (seen) {\n\t\t\tif (!arraySome(other, function(othValue: any, othIndex: any) {\n\t\t\t\tif (!cacheHas(seen, othIndex) &&\n\t\t\t\t\t(arrValue === othValue || equalFunc(arrValue, othValue, bitmask, customizer, stack))) {\n\t\t\t\t\treturn seen.push(othIndex);\n\t\t\t\t}\n\t\t\t})) {\n\t\t\t\tresult = false;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t} else if (!(\n\t\t\tarrValue === othValue ||\n\t\t\tequalFunc(arrValue, othValue, bitmask, customizer, stack)\n\t\t)) {\n\t\t\tresult = false;\n\t\t\tbreak;\n\t\t}\n\t}\n\tstack[\"delete\"](array);\n\tstack[\"delete\"](other);\n\treturn result;\n}\n\nfunction equalByTag(object: any, other: any, tag: string, bitmask: number, customizer: Function, equalFunc: Function, stack: any): boolean {\n\tswitch (tag) {\n\t\tcase dataViewTag:\n\t\t\tif ((object.byteLength != other.byteLength) ||\n\t\t\t\t(object.byteOffset != other.byteOffset)) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tobject = object.buffer;\n\t\t\tother = other.buffer;\n\n\t\tcase arrayBufferTag:\n\t\t\tif ((object.byteLength != other.byteLength) ||\n\t\t\t\t!equalFunc(new Uint8Array(object), new Uint8Array(other))) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\treturn true;\n\n\t\tcase boolTag:\n\t\tcase dateTag:\n\t\tcase numberTag:\n\t\t\t// Coerce booleans to `1` or `0` and dates to milliseconds.\n\t\t\t// Invalid dates are coerced to `NaN`.\n\t\t\treturn eq(+object, +other);\n\n\t\tcase errorTag:\n\t\t\treturn object.name == other.name && object.message == other.message;\n\n\t\tcase regexpTag:\n\t\tcase stringTag:\n\t\t\t// Coerce regexes to strings and treat strings, primitives and objects,\n\t\t\t// as equal. See http://www.ecma-international.org/ecma-262/7.0/#sec-regexp.prototype.tostring\n\t\t\t// for more details.\n\t\t\treturn object == (other + \"\");\n\n\t\tcase mapTag:\n\t\t\tlet convert = mapToArray;\n\n\t\tcase setTag:\n\t\t\tconst isPartial = bitmask & COMPARE_PARTIAL_FLAG;\n\t\t\tconvert = (!convert) ? setToArray : convert;\n\n\t\t\tif (object.size != other.size && !isPartial) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\t// Assume cyclic values are equal.\n\t\t\tconst stacked = stack.get(object);\n\t\t\tif (stacked) {\n\t\t\t\treturn stacked == other;\n\t\t\t}\n\t\t\tbitmask |= COMPARE_UNORDERED_FLAG;\n\n\t\t\t// Recursively compare objects (susceptible to call stack limits).\n\t\t\tstack.set(object, other);\n\t\t\tconst result = equalArrays(convert(object), convert(other), bitmask, customizer, equalFunc, stack);\n\t\t\tstack[\"delete\"](object);\n\t\t\treturn result;\n\n\t\tcase symbolTag:\n\t\t\tif (symbolValueOf) {\n\t\t\t\treturn symbolValueOf.call(object) == symbolValueOf.call(other);\n\t\t\t}\n\t}\n\treturn false;\n}\n\nfunction equalObjects(object: any, other: any, bitmask: number, customizer: Function, equalFunc: Function, stack: any): boolean {\n\tconst isPartial = bitmask & COMPARE_PARTIAL_FLAG;\n\tconst objProps = getAllKeys(object);\n\tconst objLength = objProps.length;\n\tconst othProps = getAllKeys(other);\n\tconst othLength = othProps.length;\n\n\tif (objLength != othLength && !isPartial) {\n\t\treturn false;\n\t}\n\tlet index = objLength;\n\twhile (index--) {\n\t\tconst key = objProps[index];\n\t\tif (!(isPartial ? key in other : hasOwnProperty.call(other, key))) {\n\t\t\treturn false;\n\t\t}\n\t}\n\t// Assume cyclic values are equal.\n\tconst stacked = stack.get(object);\n\tif (stacked && stack.get(other)) {\n\t\treturn stacked == other;\n\t}\n\tlet result = true;\n\tstack.set(object, other);\n\tstack.set(other, object);\n\n\tlet skipCtor: boolean = !!isPartial;\n\twhile (++index < objLength) {\n\t\tconst key = objProps[index];\n\t\tconst objValue = object[key];\n\t\tconst othValue = other[key];\n\n\t\tlet compared;\n\t\tif (customizer) {\n\t\t\tcompared = isPartial\n\t\t\t\t? customizer(othValue, objValue, key, other, object, stack)\n\t\t\t\t: customizer(objValue, othValue, key, object, other, stack);\n\t\t}\n\t\t// Recursively compare objects (susceptible to call stack limits).\n\t\tif (!(compared === undefined\n\t\t\t? (objValue === othValue || equalFunc(objValue, othValue, bitmask, customizer, stack))\n\t\t\t: compared\n\t\t)) {\n\t\t\tresult = false;\n\t\t\tbreak;\n\t\t}\n\t\tskipCtor = (!skipCtor) ? key == \"constructor\" : skipCtor;\n\t}\n\tif (result && !skipCtor) {\n\t\tconst objCtor = object.constructor;\n\t\tconst othCtor = other.constructor;\n\n\t\t// Non `Object` object instances with different constructors are not equal.\n\t\tif (objCtor != othCtor &&\n\t\t\t(\"constructor\" in object && \"constructor\" in other) &&\n\t\t\t!(typeof objCtor == \"function\" && objCtor instanceof objCtor &&\n\t\t\t\ttypeof othCtor == \"function\" && othCtor instanceof othCtor)) {\n\t\t\tresult = false;\n\t\t}\n\t}\n\tstack[\"delete\"](object);\n\tstack[\"delete\"](other);\n\treturn result;\n}\n\nfunction getAllKeys(object: any): string[] {\n\treturn baseGetAllKeys(object, keys, getSymbols);\n}\n\nfunction getAllKeysIn(object: any): string[] {\n\treturn baseGetAllKeys(object, keysIn, getSymbolsIn);\n}\n\nfunction getMapData(map: any, key: string): any {\n\tconst data = map.__DATA__;\n\n\treturn isKeyable(key) ? data[typeof key === \"string\" ? \"string\" : \"hash\"]\n\t\t: data.map;\n}\n\nfunction getNative(object: any, key: string): any {\n\tconst value = getValue(object, key);\n\treturn baseIsNative(value) ? value : undefined;\n}\n\nfunction getRawTag(value: any): string {\n\tconst isOwn = hasOwnProperty.call(value, symToStringTag);\n\tconst tag = value[symToStringTag];\n\n\tlet unmasked = false;\n\n\ttry {\n\t\tvalue[symToStringTag] = undefined;\n\t\tunmasked = true;\n\t} catch (e) {\n\t\t// Intentionally do nothing\n\t}\n\n\tconst result = nativeObjectToString.call(value);\n\n\tif (unmasked) {\n\t\tif (isOwn) {\n\t\t\tvalue[symToStringTag] = tag;\n\t\t} else {\n\t\t\tdelete value[symToStringTag];\n\t\t}\n\t}\n\n\treturn result;\n}\n\nconst getSymbols: (source: any) => string[] = !nativeGetSymbols ? stubArray : function(object) {\n\tif (object == null) {\n\t\treturn [];\n\t}\n\tobject = Object(object);\n\treturn arrayFilter(nativeGetSymbols(object), function(symbol: any) {\n\t\treturn propertyIsEnumerable.call(object, symbol);\n\t});\n};\n\nconst getSymbolsIn: (source: any) => string[] = !nativeGetSymbols ? stubArray : function(object) {\n\tconst result = [];\n\n\twhile (object) {\n\t\tarrayPush(result, getSymbols(object));\n\t\tobject = getPrototype(object);\n\t}\n\n\treturn result;\n};\n\nlet getTag: (source: any) => string = baseGetTag;\n\n// Fallback for data views, maps, sets, and weak maps in IE 11 and promises in Node.js < 6.\nif ((DataView && getTag(new DataView(new ArrayBuffer(1))) !== dataViewTag) ||\n\t(Map && getTag(new Map()) !== mapTag) ||\n\t(Promise && getTag(Promise.resolve()) !== promiseTag) ||\n\t(Set && getTag(new Set()) !== setTag) ||\n\t(WeakMap && getTag(new WeakMap()) !== weakMapTag)) {\n\tgetTag = function(value) {\n\t\tconst result = baseGetTag(value);\n\t\tconst Ctor = result === objectTag ? value.constructor : undefined;\n\t\tconst ctorString = Ctor ? toSource(Ctor) : \"\";\n\n\t\tif (ctorString) {\n\t\t\tswitch (ctorString) {\n\t\t\t\tcase dataViewCtorString: return dataViewTag;\n\t\t\t\tcase mapCtorString: return mapTag;\n\t\t\t\tcase promiseCtorString: return promiseTag;\n\t\t\t\tcase setCtorString: return setTag;\n\t\t\t\tcase weakMapCtorString: return weakMapTag;\n\t\t\t}\n\t\t}\n\t\treturn result;\n\t};\n}\n\nfunction initCloneArray(array: any): any[] {\n\tconst length = array.length;\n\tconst result = new array.constructor(length);\n\n\t// Add properties assigned by `RegExp#exec`.\n\tif (length && typeof array[0] === \"string\" && hasOwnProperty.call(array, \"index\")) {\n\t\tresult.index = array.index;\n\t\tresult.input = array.input;\n\t}\n\treturn result;\n}\n\nfunction initCloneObject(object: any): any {\n\treturn (typeof object.constructor === \"function\" && !isPrototype(object))\n\t\t? baseCreate(getPrototype(object))\n\t\t: {};\n}\n\nfunction initCloneByTag(object: any, tag: string, isDeep: boolean): any {\n\tconst Ctor = object.constructor;\n\n\tswitch (tag) {\n\t\tcase arrayBufferTag:\n\t\t\treturn cloneArrayBuffer(object);\n\n\t\tcase boolTag:\n\t\tcase dateTag:\n\t\t\treturn new Ctor(+object);\n\n\t\tcase dataViewTag:\n\t\t\treturn cloneDataView(object, isDeep);\n\n\t\tcase float32Tag: case float64Tag:\n\t\tcase int8Tag: case int16Tag: case int32Tag:\n\t\tcase uint8Tag: case uint8ClampedTag: case uint16Tag: case uint32Tag:\n\t\t\treturn cloneTypedArray(object, isDeep);\n\n\t\tcase mapTag:\n\t\t\treturn new Ctor();\n\n\t\tcase numberTag:\n\t\tcase stringTag:\n\t\t\treturn new Ctor(object);\n\n\t\tcase regexpTag:\n\t\t\treturn cloneRegExp(object);\n\n\t\tcase setTag:\n\t\t\treturn new Ctor();\n\n\t\tcase symbolTag:\n\t\t\treturn cloneSymbol(object);\n\t}\n}\n\nfunction isIndex(value: any, length?: number): boolean {\n\tconst type = typeof value;\n\tlength = length == null ? MAX_SAFE_INTEGER : length;\n\n\treturn !!length &&\n\t\t(type === \"number\" ||\n\t\t\t(type !== \"symbol\" && reIsUint.test(value))) &&\n\t\t(value > -1 && value % 1 === 0 && value < length);\n}\n\nfunction isKeyable(value: any): boolean {\n\tconst type = typeof value;\n\n\treturn (type === \"string\" || type === \"number\" || type === \"symbol\" || type === \"boolean\")\n\t\t? (value !== \"__proto__\")\n\t\t: (value === null);\n}\n\nfunction isMasked(func: Function): boolean {\n\treturn !!maskSrcKey && (maskSrcKey in func);\n}\n\nfunction isPrototype(value: any): boolean {\n\tconst Ctor = value && value.constructor;\n\tconst proto = (typeof Ctor === \"function\" && Ctor.prototype) || objectProto;\n\n\treturn value === proto;\n}\n\nfunction nativeKeysIn(object: any): any[] {\n\tconst result = [];\n\n\tif (object != null) {\n\t\t/* tslint:disable-next-line */\n\t\tfor (const key in Object(object)) {\n\t\t\tresult.push(key);\n\t\t}\n\t}\n\n\treturn result;\n}\n\nfunction objectToString(value: any): string {\n\treturn nativeObjectToString.call(value);\n}\n\nfunction toSource(func: Function): string {\n\tif (func != null) {\n\t\ttry {\n\t\t\treturn funcToString.call(func);\n\t\t} catch (e) {\n\t\t\t// Intentionally do nothing\n\t\t}\n\t\ttry {\n\t\t\treturn (func + \"\");\n\t\t} catch (e) {\n\t\t\t// Intentionally do nothing\n\t\t}\n\t}\n\treturn \"\";\n}\n\nfunction memoize(func: Function, resolver: Function): Function {\n\tif (typeof func !== \"function\" || (resolver != null && typeof resolver !== \"function\")) {\n\t\tthrow new TypeError(FUNC_ERROR_TEXT);\n\t}\n\n\tconst memoized = function() {\n\t\tconst args = arguments;\n\t\tconst key = resolver ? resolver.apply(this, args) : args[0];\n\t\tconst cache = memoized[\"cache\"];\n\n\t\tif (cache.has(key)) {\n\t\t\treturn cache.get(key);\n\t\t}\n\n\t\tconst result = func.apply(this, args);\n\t\tmemoized[\"cache\"] = cache.set(key, result) || cache;\n\n\t\treturn result;\n\t};\n\n\tmemoized[\"cache\"] = new (memoize.Cache || MapCache)();\n\n\treturn memoized;\n}\n\n// Expose `MapCache`.\nmemoize.Cache = MapCache;\n\nfunction cloneDeep(value: any): any {\n\treturn baseClone(value, CLONE_DEEP_FLAG | CLONE_SYMBOLS_FLAG);\n}\n\nfunction eq(value: any, other: any): boolean {\n\treturn value === other || (value !== value && other !== other);\n}\n\nconst isArguments: (value: any) => boolean = baseIsArguments(function() { return arguments; }()) ? baseIsArguments : function(value) {\n\treturn isObjectLike(value) && hasOwnProperty.call(value, \"callee\") && !propertyIsEnumerable.call(value, \"callee\");\n};\n\nconst isArray: (value: any) => boolean = Array.isArray;\n\nfunction isArrayLike(value: any): boolean {\n\treturn value != null && isLength(value.length) && !isFunction(value);\n}\n\nconst isBuffer: (value: any) => boolean = nativeIsBuffer || stubFalse;\n\nfunction isEqual(value: any, other: any): boolean {\n\treturn baseIsEqual(value, other);\n}\n\nfunction isFunction(value: any): boolean {\n\tif (!isObject(value)) {\n\t\treturn false;\n\t}\n\n\tconst tag = baseGetTag(value);\n\n\treturn tag === funcTag || tag === genTag || tag === asyncTag || tag === proxyTag;\n}\n\nfunction isLength(value: any): boolean {\n\treturn typeof value === \"number\" && value > -1 && value % 1 === 0 && value <= MAX_SAFE_INTEGER;\n}\n\nfunction isObject(value: any): boolean {\n\tconst type = typeof value;\n\treturn value != null && (type === \"object\" || type === \"function\");\n}\n\nfunction isObjectLike(value: any): boolean {\n\treturn value != null && typeof value === \"object\";\n}\n\nconst isMap: (value: any) => boolean = baseIsMap;\n\nconst isSet: (value: any) => boolean = baseIsSet;\n\nconst isTypedArray: (value: any) => boolean = baseIsTypedArray;\n\nfunction keys(object: any): string[] {\n\treturn isArrayLike(object) ? arrayLikeKeys(object) : baseKeys(object);\n}\n\nfunction keysIn(object: any): string[] {\n\treturn isArrayLike(object) ? arrayLikeKeys(object, true) : baseKeysIn(object);\n}\n\nfunction stubArray(): any[] {\n\treturn [];\n}\n\nfunction stubFalse(): boolean {\n\treturn false;\n}\n\nconst encodeHtmlMap: any = {\n\t'\"': \"&quot;\",\n\t\"&\": \"&amp;\",\n\t\"'\": \"&#39;\",\n\t\"<\": \"&lt;\",\n\t\">\": \"&gt;\",\n};\n\nfunction lookupEncodeHtmlMap(key: string): string {\n\treturn encodeHtmlMap[key];\n}\n\nfunction encodeHtml(source: string): string {\n\treturn (source === null) ? null : (source + \"\").replace(/[&\"'<>]/g, lookupEncodeHtmlMap);\n}\n\nexport default {\n\tclone: function(source: any) {\n\t\treturn cloneDeep(source);\n\t},\n\tequals: function(first: any, second: any): boolean {\n\t\treturn isEqual(first, second);\n\t},\n\tencodeHtml: encodeHtml\n};\n","import Level from \"./logger/Level\";\nimport LoggerService from \"./logger/LoggerService\";\n\nclass Config {\n\n\tconstructor() {\n\t\tif (!(this instanceof Config)) {\n\t\t\tthrow TypeError(new.target.name + \" should be an instance of Config\");\n\t\t}\n\t}\n\n\tpublic useTrace(): void {\n\t\tLoggerService.INSTANCE.setLevel(Level.TRACE);\n\t}\n\n\tpublic useDebug(): void {\n\t\tLoggerService.INSTANCE.setLevel(Level.DEBUG);\n\t}\n\n\tpublic useInfo(): void {\n\t\tLoggerService.INSTANCE.setLevel(Level.INFO);\n\t}\n\n\tpublic useWarn(): void {\n\t\tLoggerService.INSTANCE.setLevel(Level.WARN);\n\t}\n\n\tpublic useError(): void {\n\t\tLoggerService.INSTANCE.setLevel(Level.ERROR);\n\t}\n\n\tpublic useFatal(): void {\n\t\tLoggerService.INSTANCE.setLevel(Level.FATAL);\n\t}\n\n\tpublic useDisable(): void {\n\t\tLoggerService.INSTANCE.setLevel(Level.DISABLE);\n\t}\n}\n\nexport default Config;\n","import ConsoleOutputStrategy from \"./ConsoleOutputStrategy\";\nimport Level from \"./Level\";\nimport LevelUtils from \"./LevelUtils\";\nimport Logger from \"./Logger\";\nimport LoggerImpl from \"./LoggerImpl\";\nimport OutputStrategy from \"./OutputStrategy\";\n\nclass LoggerService {\n\n\tpublic static INSTANCE: LoggerService = new LoggerService();\n\n\tprivate level: Level;\n\n\tprivate outputStrategy: OutputStrategy;\n\n\tprivate logger: LoggerImpl;\n\n\tconstructor() {\n\t\tthis.level = Level.INFO;\n\t\tthis.outputStrategy = new ConsoleOutputStrategy();\n\t\tthis.logger = new LoggerImpl(\"LoggerService\", this);\n\t}\n\n\tpublic log(logger: Logger, level: Level, payload: any, errorStack?: Error | boolean): void {\n\t\tif (level >= this.level && level !== Level.DISABLE) {\n\t\t\tthis.outputStrategy.log(logger, level, payload, errorStack);\n\t\t}\n\t}\n\n\tpublic setLevel(level: Level): void {\n\t\tthis.level = level;\n\t\tthis.log(this.logger, Level.DEBUG, \"Logging level: \" + LevelUtils.stringValueOf(level));\n\t}\n\n\tpublic isTrace(): boolean {\n\t\treturn (Level.TRACE >= this.level);\n\t}\n\n\tpublic isDebug(): boolean {\n\t\treturn (Level.DEBUG >= this.level);\n\t}\n\n\tpublic isInfo(): boolean {\n\t\treturn (Level.INFO >= this.level);\n\t}\n\n\tpublic isWarn(): boolean {\n\t\treturn (Level.WARN >= this.level);\n\t}\n\n\tpublic isError(): boolean {\n\t\treturn (Level.ERROR >= this.level);\n\t}\n\n\tpublic isFatal(): boolean {\n\t\treturn (Level.FATAL >= this.level);\n\t}\n\n\tpublic isDisable(): boolean {\n\t\treturn (Level.DISABLE >= this.level);\n\t}\n\n}\n\nexport default LoggerService;\n","import Level from \"./Level\";\nimport Logger from \"./Logger\";\nimport LoggerService from \"./LoggerService\";\n\nconst LOGGER_NAME_LENGTH = 20;\n\nclass LoggerImpl implements Logger {\n\n\tprivate name: string;\n\n\tprivate loggerService: LoggerService;\n\n\tconstructor(name: string, loggerService: LoggerService) {\n\t\tif (name.length < LOGGER_NAME_LENGTH) {\n\t\t\tlet count: number = LOGGER_NAME_LENGTH - name.length;\n\n\t\t\twhile (count > 0) {\n\t\t\t\tname = name + \" \";\n\t\t\t\t--count;\n\t\t\t}\n\t\t}\n\n\t\tthis.name = name;\n\t\tthis.loggerService = loggerService;\n\t}\n\n\tpublic trace(payload: any, error?: Error): void {\n\t\tthis.loggerService.log(this, Level.TRACE, payload, error);\n\t}\n\n\tpublic debug(payload: any, error?: Error): void {\n\t\tthis.loggerService.log(this, Level.DEBUG, payload, error);\n\t}\n\n\tpublic info(payload: any, error?: Error): void {\n\t\tthis.loggerService.log(this, Level.INFO, payload, error);\n\t}\n\n\tpublic warn(payload: any, error?: Error): void {\n\t\tthis.loggerService.log(this, Level.WARN, payload, error);\n\t}\n\n\tpublic error(payload: any, error?: Error): void {\n\t\tthis.loggerService.log(this, Level.ERROR, payload, error);\n\t}\n\n\tpublic fatal(payload: any, error?: Error): void {\n\t\tthis.loggerService.log(this, Level.FATAL, payload, error);\n\t}\n\n\tpublic isTrace(): boolean {\n\t\treturn this.loggerService.isTrace();\n\t}\n\n\tpublic isDebug(): boolean {\n\t\treturn this.loggerService.isDebug();\n\t}\n\n\tpublic isInfo(): boolean {\n\t\treturn this.loggerService.isInfo();\n\t}\n\n\tpublic isWarn(): boolean {\n\t\treturn this.loggerService.isWarn();\n\t}\n\n\tpublic isError(): boolean {\n\t\treturn this.loggerService.isError();\n\t}\n\n\tpublic isFatal(): boolean {\n\t\treturn this.loggerService.isFatal();\n\t}\n\n\tpublic isDisable(): boolean {\n\t\treturn this.loggerService.isDisable();\n\t}\n\n\tpublic getName(): string {\n\t\treturn this.name;\n\t}\n\n}\n\nexport default LoggerImpl;\n","import { ForChannelContinuation, OnContinuation } from \"../Continuation\";\nimport { INTERNAL_CHANNEL_NAME, Modules } from \"../Core\";\nimport Disposable from \"../Disposable\";\nimport Module from \"../Module\";\nimport Listener from \"./Listener\";\nimport ListenerImpl from \"./ListenerImpl\";\n\n// TODO - Refactor into common constants\nconst INTERNAL_DIRECT_CHANNEL_NAME: string = \"Cydran$$Direct$$Internal$$Channel\";\n\nclass PubSub implements Disposable {\n\n\tprivate listeners: Listener[];\n\n\tprivate listenersByChannel: {};\n\n\tprivate moduleInstance: Module;\n\n\tprivate context: any;\n\n\tprivate globalEnabled: boolean;\n\n\tconstructor(context: any, moduleInstance?: Module) {\n\t\tthis.globalEnabled = false;\n\t\tthis.listeners = [];\n\t\tthis.listenersByChannel = {};\n\t\tthis.context = context;\n\t\tthis.moduleInstance = (moduleInstance) ? moduleInstance : Modules.getModule(\"DEFAULT\");\n\t}\n\n\tpublic message(channelName: string, messageName: string, payload: any): void {\n\t\tif (INTERNAL_DIRECT_CHANNEL_NAME === channelName) {\n\t\t\tif (messageName === \"enableGlobal\") {\n\t\t\t\tthis.enableGlobal();\n\t\t\t} else if (messageName === \"disableGlobal\") {\n\t\t\t\tthis.disableGlobal();\n\t\t\t}\n\t\t} else {\n\t\t\tthis.listeners.forEach((listener) => {\n\t\t\t\tif (channelName === listener.getChannelName()) {\n\t\t\t\t\tlistener.receive(messageName, payload);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n\n\tpublic broadcast(channelName: string, messageName: string, payload: any): void {\n\t\tthis.moduleInstance.broadcast(channelName, messageName, payload);\n\t}\n\n\tpublic broadcastGlobally(channelName: string, messageName: string, payload: any): void {\n\t\tModules.broadcast(channelName, messageName, payload);\n\t}\n\n\tpublic dispose(): void {\n\t\tthis.disableGlobal();\n\t\tthis.listeners = [];\n\t\tthis.listenersByChannel = {};\n\t}\n\n\tpublic on(messageName: string): OnContinuation {\n\t\tconst mine: PubSub = this;\n\t\treturn {\n\t\t\tforChannel: (channel: string) => {\n\t\t\t\treturn {\n\t\t\t\t\tinvoke: (target: (payload: any) => void) => {\n\t\t\t\t\t\tmine.listenTo(channel, messageName, target);\n\t\t\t\t\t},\n\t\t\t\t};\n\t\t\t},\n\t\t\tinvoke: (target: (payload: any) => void) => {\n\t\t\t\tmine.listenTo(INTERNAL_CHANNEL_NAME, messageName, target);\n\t\t\t},\n\t\t};\n\t}\n\n\tprivate listenTo(channel: string, messageName: string, target: (payload: any) => void): void {\n\t\tlet listener: Listener = this.listenersByChannel[channel];\n\n\t\tif (!listener) {\n\t\t\tlistener = new ListenerImpl(channel, this.context);\n\n\t\t\tif (this.globalEnabled) {\n\t\t\t\tthis.moduleInstance.message(INTERNAL_DIRECT_CHANNEL_NAME, \"addListener\", listener);\n\t\t\t}\n\n\t\t\tthis.listeners.push(listener);\n\t\t}\n\t\tlistener.register(messageName, target);\n\t}\n\n\tprivate enableGlobal(): void {\n\t\tif (this.globalEnabled) {\n\t\t\treturn;\n\t\t}\n\n\t\tfor (const listener of this.listeners) {\n\t\t\tthis.moduleInstance.message(INTERNAL_DIRECT_CHANNEL_NAME, \"addListener\", listener);\n\t\t}\n\n\t\tthis.globalEnabled = true;\n\t}\n\n\tprivate disableGlobal(): void {\n\t\tif (!this.globalEnabled) {\n\t\t\treturn;\n\t\t}\n\n\t\tfor (const listener of this.listeners) {\n\t\t\tthis.moduleInstance.message(INTERNAL_DIRECT_CHANNEL_NAME, \"removeListener\", listener);\n\t\t}\n\n\t\tthis.globalEnabled = false;\n\t}\n}\n\nexport default PubSub;\n","var g;\n\n// This works in non-strict mode\ng = (function() {\n\treturn this;\n})();\n\ntry {\n\t// This works if eval is allowed (see CSP)\n\tg = g || new Function(\"return this\")();\n} catch (e) {\n\t// This works if the window reference is available\n\tif (typeof window === \"object\") g = window;\n}\n\n// g can still be undefined, but nothing to do about it...\n// We return undefined, instead of nothing here, so it's\n// easier to handle this case. if(!global) { ...}\n\nmodule.exports = g;\n","import * as Config from \"./Config\";\nimport { Component, ElementMediator, Events, Modules } from \"./Core\";\nimport Logger from \"./logger/Logger\";\nimport LoggerFactory from \"./logger/LoggerFactory\";\nimport \"./mediator/\";\nimport \"./messaging/\";\nimport PubSub from \"./messaging/PubSub\";\nimport RegistryStrategy from \"./RegistryStrategy\";\nimport Stage from \"./Stage\";\n\nconst CYDRAN_KEY: string = \"cydran\";\nconst ORIGINAL_CYDRAN: any = window[CYDRAN_KEY];\n\nfunction noConflict() {\n\tconst currentCydran: any = window[CYDRAN_KEY];\n\twindow[CYDRAN_KEY] = ORIGINAL_CYDRAN;\n\n\treturn currentCydran;\n}\n\nexport {\n\tComponent,\n\tEvents,\n\tStage,\n\tElementMediator,\n\tLogger,\n\tLoggerFactory,\n\tConfig,\n\tPubSub,\n\tRegistryStrategy,\n\tModules,\n\tnoConflict,\n};\n","import Level from \"./Level\";\nimport Logger from \"./Logger\";\nimport OutputStrategy from \"./OutputStrategy\";\n\nclass ConsoleOutputStrategy implements OutputStrategy {\n\n\tprivate static getNow(): string {\n\t\tconst now = new Date();\n\n\t\treturn now.getUTCFullYear()\n\t\t\t+ \"-\"\n\t\t\t+ now.getUTCMonth()\n\t\t\t+ \":\"\n\t\t\t+ now.getUTCDate()\n\t\t\t+ \":\"\n\t\t\t+ now.getUTCHours()\n\t\t\t+ \":\"\n\t\t\t+ now.getUTCMinutes()\n\t\t\t+ \":\"\n\t\t\t+ now.getUTCSeconds()\n\t\t\t+ \":\"\n\t\t\t+ now.getUTCMilliseconds();\n\t}\n\n\tpublic log(logger: Logger, level: Level, payload: any, stacked?: Error | boolean): void {\n\n\t\tif (level !== Level.DISABLE) {\n\t\t\tconst wkTStamp = ConsoleOutputStrategy.getNow();\n\t\t\tconst preamble: string = wkTStamp + \" \" + level + \" [\" + logger.getName() + \"]\";\n\n\t\t\tconst shortArgs: boolean = payload instanceof Error;\n\t\t\tconst printFullStack: boolean = !(stacked instanceof Error) ? (null !== stacked ? stacked : false) : false;\n\n\t\t\tif (level >= Level.WARN) {\n\t\t\t\tconst logMsg: string = (shortArgs ? payload.stack : payload);\n\t\t\t\tlet errMsg: string;\n\t\t\t\tif (stacked instanceof Error) {\n\t\t\t\t\terrMsg = stacked.stack;\n\t\t\t\t} else {\n\t\t\t\t\terrMsg = !shortArgs ? \"- FYI ONLY: \" : \"\";\n\t\t\t\t}\n\n\t\t\t\tconst secondPreamble = (shortArgs ? \"\" : ((stacked) ? \" - %s\" : \"\"));\n\n\t\t\t\tswitch (level) {\n\t\t\t\t\tcase Level.WARN:\n\t\t\t\t\t\t// tslint:disable-next-line\n\t\t\t\t\t\tconsole.warn(\"%c\" + preamble + secondPreamble, \"color:#ff9400;\", logMsg, errMsg);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase Level.ERROR:\n\t\t\t\t\tcase Level.FATAL:\n\t\t\t\t\tdefault:\n\t\t\t\t\t\t// tslint:disable-next-line\n\t\t\t\t\t\tconsole.error(preamble + secondPreamble, logMsg, errMsg);\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tswitch (level) {\n\t\t\t\t\tcase Level.TRACE:\n\t\t\t\t\t\tif (printFullStack) {\n\t\t\t\t\t\t\t// tslint:disable-next-line\n\t\t\t\t\t\t\tconsole.trace(\"%c\" + preamble, \"color:#00752d;\", payload);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t// tslint:disable-next-line\n\t\t\t\t\t\t\tconsole.info(\"%c\" + preamble, \"color:#ff9400;\", payload);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase Level.DEBUG:\n\t\t\t\t\t\t// tslint:disable-next-line\n\t\t\t\t\t\tconsole.debug(\"%c\" + preamble, \"color:#00752d;\", payload);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase Level.INFO:\n\t\t\t\t\t\t// tslint:disable-next-line\n\t\t\t\t\t\tconsole.info(\"%c\" + preamble, \"color:#2d57ca;\", payload);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tdefault:\n\t\t\t\t\t\t// tslint:disable-next-line\n\t\t\t\t\t\tconsole.log(preamble, payload);\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n}\n\nexport default ConsoleOutputStrategy;\n","import Level from \"./Level\";\n\nclass LevelUtils {\n\n\tpublic static valueOf(lvl: string): Level {\n\t\treturn Level[lvl];\n\t}\n\n\tpublic static stringValueOf(lvl: Level): string {\n\t\treturn Level[lvl];\n\t}\n\n\tpublic static getKeys(): String[] {\n\t\tconst keys: String[] = [];\n\t\tfor (const k of Object.keys(Level)) {\n\t\t\tif (this.rx.test(k)) {\n\t\t\t\tkeys[k] = this.stringValueOf(Number.parseInt(k, 10));\n\t\t\t}\n\t\t}\n\t\treturn keys;\n\t}\n\n\tpublic static values(): Level[] {\n\t\treturn this.getKeys().map((key: string) => {\n\t\t\treturn Level[key];\n\t\t});\n\t}\n\n\tpublic static size(): number {\n\t\treturn this.getKeys().length;\n\t}\n\n\tprivate static readonly rx = /\\d+/;\n}\n\nexport default LevelUtils;\n","import { CydranError, NEWI } from \"./AbstractCydranError\";\n\nclass DigestLoopError extends CydranError {\n\n\tconstructor(msg: string, reps?: any) {\n\t\tif (!new.target) { throw (new.target + NEWI); }\n\t\tsuper(msg, reps);\n\t}\n\n}\n\nexport default DigestLoopError;\n","import { CydranError, NEWI } from \"./AbstractCydranError\";\n\nclass MalformedOnEventError extends CydranError {\n\n\tconstructor(msg: string, reps?: any) {\n\t\tif (!new.target) { throw (new.target + NEWI); }\n\t\tsuper(msg, reps);\n\t}\n\n}\n\nexport default MalformedOnEventError;\n","import { CydranError, NEWI } from \"./AbstractCydranError\";\n\nclass SelectorError extends CydranError {\n\n\tconstructor(msg: string, reps?: any) {\n\t\tif (!new.target) { throw (new.target + NEWI); }\n\t\tsuper(msg, reps);\n\t}\n\n}\n\nexport default SelectorError;\n","import { CydranError, NEWI } from \"./AbstractCydranError\";\n\nclass SetComponentError extends CydranError {\n\n\tconstructor(msg: string, reps?: any) {\n\t\tif (!new.target) { throw (new.target + NEWI); }\n\t\tsuper(msg, reps);\n\t}\n\n}\n\nexport default SetComponentError;\n","import { CydranError, NEWI } from \"./AbstractCydranError\";\n\nclass TemplateError extends CydranError {\n\n\tconstructor(msg: string, reps?: any) {\n\t\tif (!new.target) { throw (new.target + NEWI); }\n\t\tsuper(msg, reps);\n\t}\n\n}\n\nexport default TemplateError;\n","import { CydranError, NEWI } from \"./AbstractCydranError\";\n\nclass UnknownRegionError extends CydranError {\n\n\tconstructor(msg: string, reps?: any) {\n\t\tif (!new.target) { throw (new.target + NEWI); }\n\t\tsuper(msg, reps);\n\t}\n\n}\n\nexport default UnknownRegionError;\n","\nclass GuardGenerator {\n\n\tpublic static readonly INSTANCE: GuardGenerator = new GuardGenerator();\n\n\tprivate static readonly MAX_VALUE: number = 9007199254740989;\n\n\tprivate major: number;\n\n\tprivate minor: number;\n\n\tprivate micro: number;\n\n\tconstructor() {\n\t\tthis.major = 0;\n\t\tthis.minor = 0;\n\t\tthis.micro = 0;\n\t}\n\n\tpublic generate(): string {\n\t\tconst result: string = this.major + \"-\" + this.minor + \"-\" + this.micro;\n\n\t\tthis.micro++;\n\n\t\tif (this.micro > GuardGenerator.MAX_VALUE) {\n\t\t\tthis.micro = 0;\n\t\t\tthis.minor++;\n\t\t}\n\n\t\tif (this.minor > GuardGenerator.MAX_VALUE) {\n\t\t\tthis.minor = 0;\n\t\t\tthis.major++;\n\t\t}\n\n\t\treturn result;\n\t}\n\n}\n\nexport default GuardGenerator;\n","import Guard from \"./Guard\";\n\ninterface ValueMap {\n\n\t[key: string]: string;\n\n}\n\nclass GuardImpl implements Guard {\n\n\tpublic static up(original: Guard): Guard {\n\t\treturn original || new GuardImpl(true);\n\t}\n\n\tpublic static down(original: Guard): Guard {\n\t\treturn original || new GuardImpl(false);\n\t}\n\n\tprivate propagateUp: boolean;\n\n\tprivate state: ValueMap;\n\n\tconstructor(propagateUp: boolean) {\n\t\tthis.state = {};\n\t\tthis.propagateUp = !!propagateUp;\n\t}\n\n\tpublic mark(value: string): void {\n\t\tif (value) {\n\t\t\tthis.state[value] = value;\n\t\t}\n\t}\n\n\tpublic seen(value: string): boolean {\n\t\treturn (value && this.state[value]) ? true : false;\n\t}\n\n\tpublic isPropagateUp(): boolean {\n\t\treturn this.propagateUp;\n\t}\n\n\tpublic isPropagateDown(): boolean {\n\t\treturn !this.propagateUp;\n\t}\n\n}\n\nexport default GuardImpl;\n","import Listener from \"./Listener\";\n\nclass ListenerImpl implements Listener {\n\n\tprivate context: any;\n\n\tprivate channelName;\n\n\tprivate mappings: {\n\t\t[messageName: string]: Array<(payload: any) => void>;\n\t};\n\n\tconstructor(channelName: string, context: any) {\n\t\tthis.mappings = {};\n\t\tthis.channelName = channelName;\n\t\tthis.context = context;\n\t}\n\n\tpublic receive(messageName: string, payload: any): void {\n\t\tconst mappings: Array<(payload: any) => void> = this.mappings[messageName];\n\n\t\tif (!mappings) {\n\t\t\treturn;\n\t\t}\n\n\t\tfor (const mapping of mappings) {\n\t\t\tmapping.call(this.context, payload);\n\t\t}\n\t}\n\n\tpublic register(messageName: string, fn: (payload: any) => void): void {\n\t\tif (!this.mappings[messageName]) {\n\t\t\tthis.mappings[messageName] = [];\n\t\t}\n\n\t\tthis.mappings[messageName].push(fn);\n\t}\n\n\tpublic getChannelName(): string {\n\t\treturn this.channelName;\n\t}\n\n\tpublic dispose(): void {\n\t\tthis.mappings = {};\n\t\tthis.context = null;\n\t}\n\n}\n\nexport default ListenerImpl;\n","import Guard from \"./Guard\";\nimport Logger from \"./logger/Logger\";\nimport LoggerFactory from \"./logger/LoggerFactory\";\nimport ModelMediator from \"./ModelMediator\";\nimport ObjectUtils from \"./ObjectUtils\";\nimport ScopeImpl from \"./ScopeImpl\";\n\nconst DEFAULT_REDUCER: (input: any) => any = (input) => input;\n\nclass ModelMediatorImpl<T> implements ModelMediator<T> {\n\n\tprivate logger: Logger;\n\n\tprivate model: any;\n\n\tprivate expression: string;\n\n\tprivate previous: T;\n\n\tprivate previousFragment: any;\n\n\tprivate watchPrevious: T;\n\n\tprivate watchCurrent: T;\n\n\tprivate watchDispatchPending: boolean;\n\n\tprivate scope: ScopeImpl;\n\n\tprivate context: any;\n\n\tprivate digested: boolean = false;\n\n\tprivate target: (previous: T, current: T, guard: Guard) => void;\n\n\tprivate digestCallback: (guard: Guard) => void;\n\n\tprivate digestCallbackContext: any;\n\n\tprivate reducerFn: (input: T) => any;\n\n\tconstructor(model: any, expression: string, scope: ScopeImpl) {\n\t\tthis.logger = LoggerFactory.getLogger(\"ModelMediator: \" + expression);\n\t\tthis.model = model;\n\t\tthis.expression = expression;\n\t\tthis.scope = scope;\n\t\tthis.previous = null;\n\t\tthis.context = {};\n\t\tthis.digestCallbackContext = {};\n\t\tthis.target = null;\n\t\tthis.digestCallback = null;\n\t\tthis.watchDispatchPending = false;\n\t\tthis.reducerFn = DEFAULT_REDUCER;\n\t}\n\n\tpublic invoke(...args: any[]): void {\n\t\tconst code: string = '\"use strict\"; ' + this.scope.getCode() + \" var args = arguments[1]; (\" + this.expression + \");\";\n\n\t\ttry {\n\t\t\tFunction(code).apply({}, [this.scope.getItems(), args]);\n\t\t} catch (e) {\n\t\t\tthis.logInvocationError(code, e);\n\t\t}\n\t}\n\n\tpublic get(): T {\n\t\tconst code: string = '\"use strict\"; ' + this.scope.getCode() + \" return (\" + this.expression + \");\";\n\n\t\tlet value: any = null;\n\n\t\ttry {\n\t\t\tvalue = Function(code).apply({}, [this.scope.getItems()]);\n\t\t} catch (e) {\n\t\t\tthis.logInvocationError(code, e);\n\t\t}\n\n\t\treturn value;\n\t}\n\n\tpublic set(value: T): void {\n\t\tconst code: string = '\"use strict\"; ' + this.scope.getCode() + \" \" + this.expression + \" = arguments[1];\";\n\n\t\ttry {\n\t\t\tFunction(code).apply({}, [this.scope.getItems(), value]);\n\t\t} catch (e) {\n\t\t\tthis.logInvocationError(code, e);\n\t\t}\n\t}\n\n\tpublic evaluate(guard: Guard): boolean {\n\t\tif (!this.target) {\n\t\t\treturn false;\n\t\t}\n\n\t\t// Check for opts out of digestion\n\t\tlet changed: boolean = false;\n\t\tconst value: T = this.get();\n\t\tconst valueFragment: any = this.reducerFn(value);\n\n\t\tif (this.digested) {\n\t\t\tif (ObjectUtils.equals(this.previousFragment, valueFragment)) {\n\t\t\t\tthis.logger.trace(\"Not different.\");\n\t\t\t} else {\n\t\t\t\tif (this.logger.isTrace()) {\n\t\t\t\t\tthis.logger.trace({ current: value, previous: this.previous });\n\t\t\t\t}\n\n\t\t\t\tthis.logger.trace(\"Invoking listener\");\n\t\t\t\tthis.swap(value, valueFragment);\n\t\t\t\tchanged = true;\n\t\t\t}\n\t\t} else {\n\t\t\tthis.swap(value, valueFragment);\n\t\t\tchanged = true;\n\t\t\tthis.digested = true;\n\t\t}\n\n\t\treturn changed;\n\t}\n\n\n\n\tpublic notifyWatcher(guard: Guard): void {\n\t\tif (this.watchDispatchPending) {\n\t\t\tthis.target.apply(this.context, [this.watchPrevious, this.watchCurrent, guard]);\n\t\t\tthis.watchDispatchPending = false;\n\n\t}\n\t}\n\n\tpublic watch(context: any, target: (previous: T, current: T, guard: Guard) => void): void {\n\t\tthis.context = context;\n\t\tthis.target = target;\n\t}\n\n\tpublic onDigest(context: any, digestCallback: (guard: Guard) => void): void {\n\t\tthis.digestCallbackContext = context;\n\t\tthis.digestCallback = digestCallback;\n\t}\n\n\tpublic dispose(): void {\n\t\tthis.model = null;\n\t\tthis.previous = null;\n\t\tthis.context = null;\n\t\tthis.target = null;\n\t\tthis.digestCallbackContext = null;\n\t\tthis.digestCallback = null;\n\t\tthis.watchPrevious = null;\n\t\tthis.watchCurrent = null;\n\t\tthis.watchDispatchPending = false;\n\t}\n\n\n\tpublic executeCallback(guard: Guard): void {\n\t\tif (this.digestCallback !== null) {\n\t\t\tthis.digestCallback.call(this.digestCallbackContext, guard);\n\t\t}\n\t}\n\tpublic setReducer(reducerFn: (input: T) => any): void {\n\t\tthis.reducerFn = (reducerFn === null) ? DEFAULT_REDUCER : reducerFn;\n\t}\n\n\tprotected getExpression(): string {\n\t\treturn this.expression;\n\t}\n\n\tprivate swap(value: T, valueFragment: any): void {\n\t\tconst newPrevious: T = ObjectUtils.clone(value);\n\t\tconst newPreviousFragment: any = ObjectUtils.clone(valueFragment);\n\t\tthis.watchPrevious = this.previous;\n\t\tthis.watchCurrent = value;\n\t\tthis.watchDispatchPending = true;\n\t\tthis.previous = newPrevious;\n\t\tthis.previousFragment = newPreviousFragment;\n\t}\n\n\tprivate logInvocationError(code: string, e: Error) {\n\t\tthis.logger.error(\"\\nAn exception (\" + e.name + \") was thrown invoking the element mediator expression: \" + this.expression\n\t\t\t + \"\\n\\nIn context:\\n\" + code + \"\\n\\nException message: \" + e.message + \"\\n\\n\", e);\n\t}\n\n}\n\nexport default ModelMediatorImpl;\n","module.exports = function(module) {\n\tif (!module.webpackPolyfill) {\n\t\tmodule.deprecate = function() {};\n\t\tmodule.paths = [];\n\t\t// module.parent = undefined by default\n\t\tif (!module.children) module.children = [];\n\t\tObject.defineProperty(module, \"loaded\", {\n\t\t\tenumerable: true,\n\t\t\tget: function() {\n\t\t\t\treturn module.l;\n\t\t\t}\n\t\t});\n\t\tObject.defineProperty(module, \"id\", {\n\t\t\tenumerable: true,\n\t\t\tget: function() {\n\t\t\t\treturn module.i;\n\t\t\t}\n\t\t});\n\t\tmodule.webpackPolyfill = 1;\n\t}\n\treturn module;\n};\n","class Properties {\n\n\tpublic static setWindow(window: Window): void {\n\t\tProperties.window = window;\n\t}\n\n\tpublic static getWindow(): Window {\n\t\treturn Properties.window;\n\t}\n\n\tprivate static window: Window;\n\n}\n\nProperties.setWindow(global[\"window\"]);\n\nexport default Properties;\n","import RegistrationError from \"./error/RegistrationError\";\nimport Register from \"./Register\";\nimport RegistryStrategy from \"./RegistryStrategy\";\n\ninterface Factories {\n\n\t[id: string]: Factory<any>;\n\n}\n\ninterface Factory<T> {\n\n\tget(): T;\n\n}\n\nclass DefaultRegistryStrategyImpl implements RegistryStrategy, Register {\n\n\tprivate factories: Factories;\n\n\tconstructor() {\n\t\tthis.factories = {};\n\t}\n\n\tpublic get<T>(id: string): T {\n\t\tlet instance: T = null;\n\n\t\tif (this.factories[id]) {\n\t\t\tinstance = this.factories[id].get();\n\t\t}\n\n\t\treturn instance;\n\t}\n\n\tpublic registerConstant(id: string, instance: any): void {\n\t\tthis.registerFactory(id, new ConstantFactory(instance));\n\t}\n\n\tpublic registerPrototype(id: string, classInstance: any): void {\n\t\tthis.registerFactory(id, new PrototypeFactory(classInstance));\n\t}\n\n\tpublic registerSingleton(id: string, classInstance: any): void {\n\t\tthis.registerFactory(id, new SingletonFactory(classInstance));\n\t}\n\n\tprivate registerFactory(id: string, factory: Factory<any>): void {\n\t\tif (id && factory) {\n\t\t\tif (this.factories[id]) {\n\t\t\t\tthrow new RegistrationError(\"'%id%' key is considered unique and already exists\", {\"%id%\": id});\n\t\t\t}\n\t\t\tthis.factories[id] = factory;\n\t\t}\n\t}\n}\n\nexport interface Registry extends Register {\n\n\tget<T>(id: string): T;\n\n\taddStrategy(strategy: RegistryStrategy): void;\n\n}\n\nexport class RegistryImpl implements Registry {\n\n\tpublic static INSTANCE: RegistryImpl = new RegistryImpl();\n\n\tprivate strategies: RegistryStrategy[];\n\n\tprivate defaultStrategy: DefaultRegistryStrategyImpl;\n\n\tconstructor() {\n\t\tthis.defaultStrategy = new DefaultRegistryStrategyImpl();\n\t\tthis.strategies = [this.defaultStrategy];\n\t}\n\n\tpublic get<T>(id: string): T {\n\t\tlet i: number = 0;\n\n\t\tlet instance: T = null;\n\n\t\twhile (!instance && i < this.strategies.length) {\n\t\t\tinstance = this.strategies[i].get(id);\n\t\t\ti++;\n\t\t}\n\n\t\treturn instance;\n\t}\n\n\tpublic registerConstant(id: string, instance: any): Registry {\n\t\tthis.defaultStrategy.registerConstant(id, instance);\n\t\treturn this;\n\t}\n\n\tpublic registerPrototype(id: string, classInstance: any): Registry {\n\t\tthis.defaultStrategy.registerPrototype(id, classInstance);\n\t\treturn this;\n\t}\n\n\tpublic registerSingleton(id: string, classInstance: any): Registry {\n\t\tthis.defaultStrategy.registerSingleton(id, classInstance);\n\t\treturn this;\n\t}\n\n\tpublic addStrategy(strategy: RegistryStrategy): void {\n\t\tif (strategy) {\n\t\t\tthis.strategies.push(strategy);\n\t\t}\n\t}\n\n}\n\nclass ConstantFactory<T> implements Factory<T> {\n\n\tprivate instance: T;\n\n\tconstructor(instance: T) {\n\t\tthis.instance = instance;\n\t}\n\n\tpublic get(): T {\n\t\treturn this.instance;\n\t}\n\n}\n\nclass PrototypeFactory<T> implements Factory<T> {\n\n\tprivate classInstance: any;\n\n\tconstructor(classInstance: any) {\n\t\tthis.classInstance = classInstance;\n\t}\n\n\tpublic get(): T {\n\t\treturn new this.classInstance();\n\t}\n\n}\n\nclass SingletonFactory<T> implements Factory<T> {\n\n\tprivate classInstance: any;\n\n\tprivate instance: T;\n\n\tconstructor(classInstance: any) {\n\t\tthis.classInstance = classInstance;\n\t}\n\n\tpublic get(): T {\n\t\tif (!this.instance) {\n\t\t\tthis.instance = new this.classInstance();\n\t\t}\n\n\t\treturn this.instance;\n\t}\n\n}\n","import { CydranError, NEWI } from \"./AbstractCydranError\";\n\nclass RegistrationError extends CydranError {\n\n\tconstructor(msg: string, reps?: any) {\n\t\tif (!new.target) { throw (new.target + NEWI); }\n\t\tsuper(msg, reps);\n\t}\n\n}\n\nexport default RegistrationError;\n","import ScopeError from \"./error/ScopeError\";\nimport Scope from \"./Scope\";\n\ninterface ScopeMap {\n\n\t[name: string]: any;\n\n}\n\ninterface ScopeSet {\n\n\t[name: string]: string;\n\n}\n\nconst EXCLUSIONS: ScopeSet = {\n\ti: \"i\",\n\titem: \"item\",\n\tm: \"m\",\n\tmodel: \"model\",\n\tp: \"p\",\n\tparent: \"parent\",\n};\n\nconst VALID_KEY_REGEX: RegExp = new RegExp(/^[a-zA-Z\\$\\_][a-zA-Z0-9\\$\\_]*$/);\n\nclass ScopeImpl implements Scope {\n\n\tprivate code: string;\n\n\tprivate children: ScopeImpl[];\n\n\tprivate localItems: ScopeMap;\n\n\tprivate items: ScopeMap;\n\n\tprivate parent: ScopeImpl;\n\n\tprivate restricted: boolean;\n\n\tconstructor(restricted?: boolean) {\n\t\tthis.children = [];\n\t\tthis.localItems = {};\n\t\tthis.items = {};\n\t\tthis.code = \"\";\n\t\tthis.parent = null;\n\t\tthis.restricted = (restricted === null || restricted === undefined) ? true : restricted;\n\t}\n\n\tpublic setParent(parent: ScopeImpl): void {\n\t\tif (!parent) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.parent) {\n\t\t\tthis.parent.removeChild(this);\n\t\t}\n\n\t\tthis.parent = parent;\n\t\tthis.parent.addChild(this);\n\t\tthis.refresh();\n\t}\n\n\tpublic addChild(child: ScopeImpl): void {\n\t\tif (child) {\n\t\t\tthis.children.push(child);\n\t\t}\n\t}\n\n\tpublic removeChild(child: ScopeImpl): void {\n\t\tconst index: number = this.children.indexOf(child);\n\n\t\tif (index >= 0) {\n\t\t\tthis.children.splice(index, 1);\n\t\t}\n\t}\n\n\tpublic getItems(): ScopeMap {\n\t\treturn this.items;\n\t}\n\n\tpublic getCode(): string {\n\t\treturn this.code;\n\t}\n\n\tpublic add(name: string, item: any): void {\n\t\tthis.checkName(name);\n\t\tthis.localItems[name] = item;\n\t\tthis.refresh();\n\t\tthis.refreshChildren();\n\t}\n\n\tpublic remove(name: string): void {\n\t\tthis.checkName(name);\n\t\tdelete this.localItems[name];\n\t\tthis.refresh();\n\t\tthis.refreshChildren();\n\t}\n\n\tprivate checkName(name: string): void {\n\t\tif (!VALID_KEY_REGEX.test(name)) {\n\t\t\tthrow new ScopeError(\"Only objects with names containing letters and numbers and starting with a letter are allowed.\");\n\t\t}\n\n\t\tif (this.restricted && EXCLUSIONS[name]) {\n\t\t\tthrow new ScopeError(name + \" is a reserved name in the scope.\");\n\t\t}\n\t}\n\n\tprivate refresh(): void {\n\t\tthis.items = {};\n\n\t\tif (this.parent) {\n\t\t\tconst parentItems: ScopeMap = this.parent.getItems();\n\n\t\t\tfor (const key in parentItems) {\n\t\t\t\tif (parentItems.hasOwnProperty(key)) {\n\t\t\t\t\tthis.items[key] = parentItems[key];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tfor (const key in this.localItems) {\n\t\t\tif (this.localItems.hasOwnProperty(key)) {\n\t\t\t\tthis.items[key] = this.localItems[key];\n\t\t\t}\n\t\t}\n\n\t\tthis.refreshCode();\n\t}\n\n\tprivate refreshCode(): void {\n\t\tthis.code = \"\";\n\n\t\tfor (const key in this.items) {\n\t\t\tif (this.items.hasOwnProperty(key)) {\n\t\t\t\tconst statement: string = \"var \" + key + \" = arguments[0]['\" + key + \"'];\\n\";\n\t\t\t\tthis.code += statement;\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate refreshChildren(): void {\n\t\tfor (const child of this.children) {\n\t\t\tchild.refresh();\n\t\t}\n\t}\n\n}\n\nexport default ScopeImpl;\n","import { CydranError, NEWI } from \"./AbstractCydranError\";\n\nclass ScopeError extends CydranError {\n\n\tconstructor(msg: string, reps?: any) {\n\t\tif (!new.target) {\n\t\t\tthrow (new.target + NEWI);\n\t\t}\n\n\t\tsuper(msg, reps);\n\t}\n\n}\n\nexport default ScopeError;\n","const MAX_SAFE_INTEGER: number = 9007199254740989;\n\nclass SequenceGenerator {\n\n\tpublic static INSTANCE: SequenceGenerator = new SequenceGenerator();\n\n\tprivate value: number;\n\n\tconstructor() {\n\t\tthis.value = 0;\n\t}\n\n\tpublic next(): number {\n\t\tif (this.value >= MAX_SAFE_INTEGER) {\n\t\t\tthis.value = -1;\n\t\t}\n\n\t\tthis.value++;\n\n\t\treturn this.value;\n\t}\n\n}\n\nexport default SequenceGenerator;\n","import { Mvvm } from \"../Core\";\n\nimport Checked from \"./Checked\";\nMvvm.register(Checked.KEY, [\"input\"], Checked);\n\nimport CSSClass from \"./CSSClass\";\nMvvm.register(CSSClass.KEY, [\"*\"], CSSClass);\n\nimport Content from \"./Content\";\nMvvm.register(Content.KEY, [\"*\"], Content);\n\nimport Enabled from \"./Enabled\";\nMvvm.register(Enabled.KEY, [\"*\"], Enabled);\n\nimport ReadOnly from \"./ReadOnly\";\nMvvm.register(ReadOnly.KEY, [\"*\"], ReadOnly);\n\nimport Style from \"./Style\";\nMvvm.register(Style.KEY, [\"*\"], Style);\n\nimport ForceFocus from \"./ForceFocus\";\nMvvm.register(ForceFocus.KEY, [\"*\"], ForceFocus);\n\nimport MultiSelectValueModel from \"./MultiSelectValueModel\";\nMvvm.register(MultiSelectValueModel.KEY, [\"select\"], MultiSelectValueModel);\n\nimport ValuedModel from \"./ValuedModel\";\nMvvm.register(ValuedModel.KEY, [\"textarea\"], ValuedModel);\n\nimport InputValueModel from \"./InputValueModel\";\nMvvm.register(InputValueModel.KEY, [\"input\"], InputValueModel);\n\nimport Visible from \"./Visible\";\nMvvm.register(Visible.KEY, [\"*\"], Visible);\n\nimport Repeat from \"./Repeat\";\nMvvm.register(\"repeat\", [\"*\"], Repeat);\n\nexport { };\n","import { ElementMediator } from \"../Core\";\n\n/**\n *\n */\nclass Checked extends ElementMediator<boolean, HTMLInputElement> {\n\n\tpublic static readonly KEY: string = \"checked\";\n\n\tpublic wire(): void {\n\t\tthis.getModelMediator().watch(this, this.onTargetChange);\n\t}\n\n\tpublic unwire(): void {\n\t\t// Intentionally do nothing\n\t}\n\n\tprotected onTargetChange(previous: boolean, current: boolean): void {\n\t\tthis.getEl().checked = !current;\n\t}\n}\n\nexport default Checked;\n","import { ElementMediator } from \"../Core\";\n\nclass CSSClass extends ElementMediator<any, HTMLElement> {\n\n\tpublic static readonly KEY: string = \"class\";\n\n\tpublic wire(): void {\n\t\tthis.getModelMediator().watch(this, this.onTargetChange);\n\t}\n\n\tpublic unwire(): void {\n\t\t// Intentionally do nothing\n\t}\n\n\tprivate onTargetChange(previous: any, current: any): void {\n\t\tconst oldClasses: string[] = (this.getEl().className || \"\").trim().split(\" \");\n\t\tconst newClasses: string[] = [];\n\t\tconst map: any = current || {};\n\n\t\tfor (const value of oldClasses) {\n\t\t\tif (!map.hasOwnProperty(value)) {\n\t\t\t\tnewClasses.push(value);\n\t\t\t}\n\t\t}\n\n\t\tfor (const key in map) {\n\t\t\tif (map.hasOwnProperty(key) && !!map[key]) {\n\t\t\t\tnewClasses.push(key);\n\t\t\t}\n\t\t}\n\n\t\tthis.getEl().className = newClasses.join(\" \");\n\t}\n\n}\n\nexport default CSSClass;\n","import { ElementMediator } from \"../Core\";\nimport ObjectUtils from \"../ObjectUtils\";\n\nclass Content extends ElementMediator<string, HTMLElement> {\n\n\tpublic static readonly KEY: string = \"content\";\n\n\tpublic wire(): void {\n\t\tthis.getModelMediator().watch(this, this.onTargetChange);\n\t}\n\n\tpublic unwire(): void {\n\t\t// Intentionally do nothing\n\t}\n\n\tprotected onTargetChange(previous: string, current: string): void {\n\t\tthis.getEl().innerHTML = ObjectUtils.encodeHtml(current);\n\t}\n\n}\n\nexport default Content;\n","import { ElementMediator } from \"../Core\";\n\nclass Enabled extends ElementMediator<boolean, HTMLInputElement> {\n\n\tpublic static readonly KEY: string = \"enabled\";\n\n\tpublic wire(): void {\n\t\tthis.getModelMediator().watch(this, this.onTargetChange);\n\t}\n\n\tpublic unwire(): void {\n\t\t// Intentionally do nothing\n\t}\n\n\tprotected onTargetChange(previous: boolean, current: boolean): void {\n\t\tthis.getEl().disabled = !current;\n\t}\n\n}\n\nexport default Enabled;\n","import { ElementMediator } from \"../Core\";\n\nclass ReadOnly extends ElementMediator<boolean, HTMLInputElement> {\n\n\tpublic static readonly KEY: string = \"readonly\";\n\n\tpublic wire(): void {\n\t\tthis.getModelMediator().watch(this, this.onTargetChange);\n\t}\n\n\tpublic unwire(): void {\n\t\t// Intentionally do nothing\n\t}\n\n\tprotected onTargetChange(previous: boolean, current: boolean): void {\n\t\tthis.getEl().readOnly = current;\n\t}\n\n}\n\nexport default ReadOnly;\n","import { ElementMediator } from \"../Core\";\n\nclass Style extends ElementMediator<any, HTMLElement> {\n\n\tpublic static readonly KEY: string = \"style\";\n\n\tpublic wire(): void {\n\t\tthis.getModelMediator().watch(this, this.onTargetChange);\n\t}\n\n\tpublic unwire(): void {\n\t\t// Intentionally do nothing\n\t}\n\n\tprotected onTargetChange(previous: any, current: any): void {\n\t\tif (current === null) {\n\t\t\treturn;\n\t\t}\n\n\t\tfor (const key in current) {\n\t\t\tif (!current.hasOwnProperty(key)) {\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tthis.getEl().style[key] = current[key];\n\t\t}\n\t}\n\n}\n\nexport default Style;\n","import { ElementMediator } from \"../Core\";\n\n\nclass ForceFocus extends ElementMediator<boolean, HTMLElement> {\n\n\tpublic static readonly KEY: string = \"force-focus\";\n\n\tprivate shouldFocus: boolean;\n\n\tpublic wire(): void {\n\t\tthis.bridge(\"focusout\");\n\t\tthis.listenTo(\"dom\", \"focusout\", this.handleFocusout);\n\t\tthis.shouldFocus = false;\n\t\tthis.getModelMediator().watch(this, this.onTargetChange);\n\t}\n\n\tpublic unwire(): void {\n\t\t// Intentionally do nothing\n\t}\n\n\tpublic handleFocusout(event: Event): void {\n\t\tif (this.shouldFocus) {\n\t\t\tthis.getEl().focus();\n\t\t}\n\t}\n\n\tprotected onTargetChange(previous: boolean, current: boolean): void {\n\t\tthis.shouldFocus = current;\n\t}\n\n}\n\nexport default ForceFocus;\n","import { ElementMediator } from \"../Core\";\n\n/**\n *\n */\nclass MultiSelectValueModel extends ElementMediator<string | string[], HTMLSelectElement> {\n\n\tpublic static readonly KEY: string = \"model\";\n\n\tpublic wire(): void {\n\t\tthis.bridge(\"input\");\n\t\tthis.listenTo(\"dom\", \"input\", this.handleInput);\n\t\tthis.getModelMediator().watch(this, this.onTargetChange);\n\t}\n\n\tpublic unwire(): void {\n\t\t// Intentionally do nothing\n\t}\n\n\tpublic handleInput(event: Event): void {\n\t\tif (this.getEl().multiple) {\n\t\t\tconst selectedValues: Array<string|number> = [];\n\n\t\t\tfor (let i = 0; i < this.getEl().selectedOptions.length; i++) {\n\t\t\t\tconst optValue: string = this.getEl().selectedOptions.item(i).getAttribute(\"value\");\n\t\t\t\tselectedValues.push(optValue);\n\t\t\t}\n\n\t\t\tthis.getModelMediator().set(selectedValues);\n\t\t} else {\n\t\t\tthis.getModelMediator().set(this.getEl()[\"value\"]);\n\t\t}\n\n\t\tthis.notifyModelInteraction();\n\t}\n\n\tprotected onTargetChange(previous: string | string[], current: string | string[]): void {\n\t\tif (this.getEl().multiple) {\n\t\t\tcurrent = (current === null) ? [] : current;\n\n\t\t\tfor (let i = 0; i < this.getEl().options.length; i++) {\n\t\t\t\tconst element: HTMLOptionElement = this.getEl().options.item(i);\n\t\t\t\telement.selected = current.includes(element.value);\n\t\t\t}\n\t\t} else {\n\t\t\tthis.getEl().value = current as string;\n\t\t}\n\t}\n\n}\n\nexport default MultiSelectValueModel;\n","import { ElementMediator } from \"../Core\";\n\n/**\n *\n */\nclass ValuedModel extends ElementMediator<string, HTMLInputElement> {\n\n\tpublic static readonly KEY: string = \"model\";\n\n\tpublic wire(): void {\n\t\tthis.bridge(\"input\");\n\t\tthis.listenTo(\"dom\", \"input\", this.handleInput);\n\t\tthis.getModelMediator().watch(this, this.onTargetChange);\n\t}\n\n\tpublic unwire(): void {\n\t\t// Intentionally do nothing\n\t}\n\n\tpublic handleInput(event: Event): void {\n\t\tthis.getModelMediator().set(this.getEl().value);\n\t\tthis.notifyModelInteraction();\n\t}\n\n\tprotected onTargetChange(previous: string, current: string): void {\n\t\tthis.getEl().value = current;\n\t}\n\n}\n\nexport default ValuedModel;\n","import { ElementMediator } from \"../Core\";\n\n/**\n *\n */\nclass InputValueModel extends ElementMediator<string, HTMLInputElement> {\n\n\tpublic static readonly KEY: string = \"model\";\n\n\tpublic wire(): void {\n\t\tthis.bridge(\"input\");\n\t\tconst isRadio: boolean = this.getEl().type.toLowerCase() === \"radio\";\n\t\tthis.listenTo(\"dom\", \"input\", (isRadio ? this.handleRadioInput : this.handleInput));\n\t\tthis.getModelMediator().watch(this, (isRadio ? this.onRadioTargetChange : this.onTargetChange));\n\t}\n\n\tpublic unwire(): void {\n\t\t// Intentionally do nothing\n\t}\n\n\tpublic handleInput(event: Event): void {\n\t\tthis.getModelMediator().set(this.getEl().value);\n\t\tthis.notifyModelInteraction();\n\t}\n\n\tpublic handleRadioInput(event: Event): void {\n\t\tif (this.getEl().checked) {\n\t\t\tthis.getModelMediator().set(this.getEl().value);\n\t\t\tthis.notifyModelInteraction();\n\t\t}\n\t}\n\n\tprotected onTargetChange(previous: string, current: string): void {\n\t\tthis.getEl().value = current;\n\t}\n\n\tprotected onRadioTargetChange(previous: string, current: string): void {\n\t\tif (this.getEl().value === current) {\n\t\t\tthis.getEl().checked = true;\n\t\t}\n\t}\n\n}\n\nexport default InputValueModel;\n","import { ElementMediator } from \"../Core\";\n\n/**\n *\n */\nclass Visible extends ElementMediator<boolean, HTMLElement> {\n\n\tpublic static readonly KEY: string = \"visible\";\n\n\tpublic wire(): void {\n\t\tthis.getModelMediator().watch(this, this.onTargetChange);\n\t}\n\n\tpublic unwire(): void {\n\t\t// Intentionally do nothing\n\t}\n\n\tprotected onTargetChange(previous: boolean, current: boolean): void {\n\t\tthis.getEl().hidden = !current;\n\t}\n\n}\n\nexport default Visible;\n","import { Component, ElementMediator, INTERNAL_DIRECT_CHANNEL_NAME, Properties } from \"../Core\";\nimport Guard from \"../Guard\";\nimport LoggerFactory from \"../logger/LoggerFactory\";\nimport ObjectUtils from \"../ObjectUtils\";\n\nconst LOGGER = LoggerFactory.getLogger(\"RepeatElementMediator\");\nconst DEFAULT_ID_KEY: string = \"id\";\nconst DOCUMENT: Document = Properties.getWindow().document;\n\ninterface ElementMediatorValues {\n\n\tidKey: string;\n\n\titem: string;\n\n\tempty: string;\n\n\tfirst: string;\n\n\tlast: string;\n\n\titems: any[];\n\n}\n\ninterface ComponentMap {\n\n\t[id: string]: Component;\n\n}\n\n/**\n *\n */\nclass Repeat extends ElementMediator<ElementMediatorValues, HTMLElement> {\n\n\tprivate idKey: string;\n\n\tprivate itemComponentName: string;\n\n\tprivate map: ComponentMap;\n\n\tprivate empty: Component;\n\n\tprivate first: Component;\n\n\tprivate last: Component;\n\n\tprivate ids: string[];\n\n\tprivate itemTemplate: string;\n\n\tprivate initialized: boolean = false;\n\n\tpublic wire(): void {\n\t\tthis.map = {};\n\t\tthis.empty = null;\n\t\tthis.ids = [];\n\t\tthis.itemTemplate = null;\n\t\tthis.getModelMediator().setReducer((input) => input.items);\n\t\tthis.getModelMediator().watch(this, this.onTargetChange);\n\t\tthis.getModelMediator().onDigest(this, this.onDigest);\n\t}\n\n\tpublic unwire(): void {\n\t\tif (this.empty) {\n\t\t\tthis.empty.dispose();\n\t\t}\n\n\t\tif (this.first) {\n\t\t\tthis.first.dispose();\n\t\t}\n\n\t\tif (this.last) {\n\t\t\tthis.last.dispose();\n\t\t}\n\n\t\tfor (const key in this.map) {\n\t\t\tif (this.map.hasOwnProperty(key)) {\n\t\t\t\tconst component: Component = this.map[key];\n\t\t\t\tcomponent.dispose();\n\t\t\t}\n\t\t}\n\n\t\tthis.empty = null;\n\t\tthis.map = {};\n\t}\n\n\tprotected onDigest(guard: Guard): void {\n\t\tif (guard.isPropagateDown()) {\n\t\t\tfor (const id of this.ids) {\n\t\t\t\tthis.map[id].message(INTERNAL_DIRECT_CHANNEL_NAME, \"digest\", guard);\n\t\t\t}\n\t\t} else {\n\t\t\tthis.getLogger().debug(\"Not propagating to children\");\n\t\t}\n\t}\n\n\tprotected onTargetChange(previous: ElementMediatorValues, current: ElementMediatorValues, guard: Guard): void {\n\t\tif (!this.initialized) {\n\t\t\tconst children: HTMLCollection = this.getEl().children;\n\n\t\t\t// tslint:disable-next-line\n\t\t\tfor (let i = 0; i < children.length; i++) {\n\t\t\t\tconst child: ChildNode = children[i];\n\n\t\t\t\tif (\"template\" === child.nodeName.toLowerCase()) {\n\t\t\t\t\tconst template: HTMLElement = child as HTMLElement;\n\n\t\t\t\t\tif (template.innerHTML) {\n\t\t\t\t\t\tconst markup: string = template.innerHTML.trim();\n\t\t\t\t\t\tconst type: string = template.getAttribute(\"type\");\n\n\t\t\t\t\t\tif (\"empty\" === type) {\n\t\t\t\t\t\t\tthis.empty = new Component(\"repeatEmpty\", markup);\n\t\t\t\t\t\t\tthis.empty.message(INTERNAL_DIRECT_CHANNEL_NAME, \"setParent\", this.getParent());\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (\"first\" === type) {\n\t\t\t\t\t\t\tthis.first = new Component(\"repeatFirst\", markup);\n\t\t\t\t\t\t\tthis.first.message(INTERNAL_DIRECT_CHANNEL_NAME, \"setParent\", this.getParent());\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (\"after\" === type) {\n\t\t\t\t\t\t\tthis.last = new Component(\"repeatLast\", markup);\n\t\t\t\t\t\t\tthis.last.message(INTERNAL_DIRECT_CHANNEL_NAME, \"setParent\", this.getParent());\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (\"item\" === type) {\n\t\t\t\t\t\t\tthis.itemTemplate = markup;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.idKey = current.idKey || DEFAULT_ID_KEY;\n\t\t\tthis.itemComponentName = current.item;\n\n\t\t\tif (current.empty && !this.empty) {\n\t\t\t\tthis.empty = this.getComponent(current.empty);\n\t\t\t\tthis.empty.message(INTERNAL_DIRECT_CHANNEL_NAME, \"setParent\", this.getParent());\n\t\t\t}\n\n\t\t\tif (current.first && !this.first) {\n\t\t\t\tthis.first = this.getComponent(current.first);\n\t\t\t\tthis.first.message(INTERNAL_DIRECT_CHANNEL_NAME, \"setParent\", this.getParent());\n\t\t\t}\n\n\t\t\tif (current.last && !this.last) {\n\t\t\t\tthis.last = this.getComponent(current.last);\n\t\t\t\tthis.last.message(INTERNAL_DIRECT_CHANNEL_NAME, \"setParent\", this.getParent());\n\t\t\t}\n\n\t\t\tif (this.empty) {\n\t\t\t\tthis.initAsRepeatable(this.empty);\n\t\t\t}\n\n\t\t\tif (this.first) {\n\t\t\t\tthis.initAsRepeatable(this.first);\n\t\t\t}\n\n\t\t\tif (this.last) {\n\t\t\t\tthis.initAsRepeatable(this.last);\n\t\t\t}\n\n\t\t\tthis.initialized = true;\n\t\t}\n\n\t\tconst newIds: string[] = [];\n\n\t\tfor (const item of current.items) {\n\t\t\tconst id: string = item[this.idKey] + \"\";\n\t\t\tnewIds.push(id);\n\t\t}\n\n\t\tif (!ObjectUtils.equals(this.ids, newIds)) {\n\t\t\tconst newMap: ComponentMap = {};\n\t\t\tconst components: Component[] = [];\n\n\t\t\tfor (const item of current.items) {\n\t\t\t\tconst id: string = item[this.idKey] + \"\";\n\t\t\t\tconst component: Component = this.map[id] ? this.map[id] : this.create(item);\n\t\t\t\tnewMap[id] = component;\n\t\t\t\tcomponents.push(component);\n\t\t\t\tdelete this.map[id];\n\t\t\t}\n\n\t\t\tfor (const key in this.map) {\n\t\t\t\tif (this.map.hasOwnProperty(key)) {\n\t\t\t\t\tconst component: Component = this.map[key];\n\t\t\t\t\tcomponent.dispose();\n\t\t\t\t\tdelete this.map[key];\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.map = newMap;\n\t\t\tconst el: HTMLElement = this.getEl();\n\n\t\t\twhile (el.firstChild) {\n\t\t\t\tel.removeChild(el.firstChild);\n\t\t\t}\n\n\t\t\tif (components.length === 0) {\n\t\t\t\tif (this.empty) {\n\t\t\t\t\tel.appendChild(this.empty.getEl());\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tconst fragment: DocumentFragment = DOCUMENT.createDocumentFragment();\n\n\t\t\t\tif (this.first) {\n\t\t\t\t\tfragment.appendChild(this.first.getEl());\n\t\t\t\t}\n\n\t\t\t\tfor (const component of components) {\n\t\t\t\t\tfragment.appendChild(component.getEl());\n\t\t\t\t}\n\n\t\t\t\tif (this.last) {\n\t\t\t\t\tfragment.appendChild(this.last.getEl());\n\t\t\t\t}\n\n\t\t\t\tel.appendChild(fragment);\n\t\t\t}\n\t\t}\n\n\t\tfor (const id of newIds) {\n\t\t\tthis.map[id].message(INTERNAL_DIRECT_CHANNEL_NAME, \"digest\", guard);\n\t\t}\n\n\t\tthis.ids = newIds;\n\t}\n\n\tprivate getComponent(name: string): Component {\n\t\treturn this.getParent().get(name);\n\t}\n\n\tprivate create(data: any): Component {\n\t\tconst component: Component = (this.itemTemplate === null)\n\t\t\t? this.getComponent(this.itemComponentName)\n\t\t\t: new Component(\"repeatItem\", this.itemTemplate);\n\n\t\tthis.initAsRepeatable(component);\n\t\tcomponent.message(INTERNAL_DIRECT_CHANNEL_NAME, \"setData\", data);\n\t\tcomponent.message(INTERNAL_DIRECT_CHANNEL_NAME, \"setParent\", this.getParent());\n\n\t\treturn component;\n\t}\n\n\tprivate initAsRepeatable(component: Component): void {\n\t\tcomponent.message(INTERNAL_DIRECT_CHANNEL_NAME, \"setMode\", \"repeatable\");\n\t}\n\n}\n\nexport default Repeat;\n","import Config from \"./Config\";\nimport { Component, INTERNAL_DIRECT_CHANNEL_NAME, StageComponent } from \"./Core\";\nimport DomUtils from \"./DomUtils\";\nimport Logger from \"./logger/Logger\";\nimport LoggerFactory from \"./logger/LoggerFactory\";\n\nclass Stage {\n\n\tprivate started: boolean;\n\n\tprivate rootSelector: string;\n\n\tprivate logger: Logger;\n\n\tprivate initializers: Array<(() => void)>;\n\n\tprivate root: StageComponent;\n\n\tconstructor(rootSelector: string) {\n\t\tthis.logger = LoggerFactory.getLogger(\"Stage\");\n\t\tthis.started = false;\n\t\tthis.rootSelector = rootSelector;\n\t\tthis.initializers = [];\n\t\tthis.root = null;\n\t}\n\n\tpublic withInitializer(callback: () => void): Stage {\n\t\tthis.initializers.push(callback);\n\n\t\treturn this;\n\t}\n\n\tpublic start(): void {\n\t\tthis.logger.debug(\"Start Requested\");\n\n\t\tif (this.started) {\n\t\t\tthis.logger.debug(\"Aleady Started\");\n\t\t\treturn;\n\t\t}\n\n\t\tthis.logger.debug(\"Cydran Starting\");\n\n\t\tDomUtils.domReady(() => this.domReady());\n\t}\n\n\tpublic setComponent(component: Component): Stage {\n\t\tthis.root.setChild(\"body\", component);\n\n\t\treturn this;\n\t}\n\n\tpublic get<T>(id: string): T {\n\t\treturn this.root.get(id);\n\t}\n\n\tpublic getConfig(): Config {\n\t\treturn new Config();\n\t}\n\n\tprivate domReady(): void {\n\t\tthis.logger.debug(\"DOM Ready\");\n\t\tthis.root = new StageComponent(this.rootSelector);\n\t\tthis.root.message(INTERNAL_DIRECT_CHANNEL_NAME, \"setParent\", null);\n\t\tthis.started = true;\n\t\tthis.logger.debug(\"Running initializers\");\n\n\t\tfor (const initializer of this.initializers) {\n\t\t\tinitializer.apply(this);\n\t\t}\n\n\t\tthis.logger.debug(\"Startup Complete\");\n\t}\n\n}\n\nexport default Stage;\n","import { Properties } from \"./Core\";\n// TODO - Refactor this\n\nconst domReady = function(callback) {\n\tlet ready = false;\n\tconst WIN = Properties.getWindow();\n\tconst DOC = WIN.document;\n\n\tconst detach = function() {\n\t\tif (DOC.addEventListener) {\n\t\t\tDOC.removeEventListener(\"DOMContentLoaded\", completed);\n\t\t\tWIN.removeEventListener(\"load\", completed);\n\t\t} else {\n\t\t\tWIN[\"detachEvent\"](\"onreadystatechange\", completed);\n\t\t\tWIN[\"detachEvent\"](\"onload\", completed);\n\t\t}\n\t};\n\n\tconst completed = function() {\n\t\tif (!ready && (DOC.addEventListener || event.type === \"load\" || DOC.readyState === \"complete\")) {\n\t\t\tready = true;\n\t\t\tdetach();\n\t\t\tcallback();\n\t\t}\n\t};\n\n\tif (DOC.readyState === \"complete\") {\n\t\tcallback();\n\t} else if (DOC.addEventListener) {\n\t\tDOC.addEventListener(\"DOMContentLoaded\", completed);\n\t\tWIN.addEventListener(\"load\", completed);\n\t} else {\n\t\tDOC[\"attachEvent\"](\"onreadystatechange\", completed);\n\t\tWIN[\"attachEvent\"](\"onload\", completed);\n\n\t\tlet top = false;\n\n\t\ttry {\n\t\t\ttop = (WIN.frameElement == null && DOC.documentElement) ? true : false;\n\t\t} catch (e) {\n\t\t\t// Intentionally do nothing\n\t\t}\n\n\t\tif (top && top[\"doScroll\"]) {\n\t\t\t(function scrollCheck() {\n\t\t\t\tif (ready) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\ttry {\n\t\t\t\t\ttop[\"doScroll\"](\"left\");\n\t\t\t\t} catch (e) {\n\t\t\t\t\treturn setTimeout(scrollCheck, 50);\n\t\t\t\t}\n\n\t\t\t\tready = true;\n\t\t\t\tdetach();\n\t\t\t\tcallback();\n\t\t\t})();\n\t\t}\n\t}\n};\n\nconst result = {\n\tdomReady: domReady,\n};\n\nexport default result;\n"],"sourceRoot":""}