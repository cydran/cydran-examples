{"version":3,"sources":["webpack://cydran/webpack/universalModuleDefinition","webpack://cydran/webpack/bootstrap","webpack://cydran/./src/util/ObjectUtils.ts","webpack://cydran/./src/element/ElementMediator.ts","webpack://cydran/./src/logger/LoggerFactory.ts","webpack://cydran/./src/constant/Constants.ts","webpack://cydran/./src/mvvm/Factories.ts","webpack://cydran/./src/error/AbstractCydranError.ts","webpack://cydran/./src/model/Reducers.ts","webpack://cydran/./src/constant/ValidationRegExp.ts","webpack://cydran/./src/config/Properties.ts","webpack://cydran/./src/component/ComponentConfig.ts","webpack://cydran/./src/component/Component.ts","webpack://cydran/./src/logger/Level.ts","webpack://cydran/./src/message/PubSubImpl.ts","webpack://cydran/./src/model/ScopeImpl.ts","webpack://cydran/./src/constant/Events.ts","webpack://cydran/./src/component/ComponentInternalsImpl.ts","webpack://cydran/./src/model/Getter.ts","webpack://cydran/(webpack)/buildin/global.js","webpack://cydran/./src/error/NullValueError.ts","webpack://cydran/./src/logger/LoggerServiceImpl.ts","webpack://cydran/./src/pattern/IdGenerator.ts","webpack://cydran/./src/error/TemplateError.ts","webpack://cydran/./src/model/Setter.ts","webpack://cydran/./src/constant/DirectEvents.ts","webpack://cydran/./src/module/ModulesContextImpl.ts","webpack://cydran/./src/config/CydranConfig.ts","webpack://cydran/./src/index.ts","webpack://cydran/./src/element/index.ts","webpack://cydran/./src/element/Checked.ts","webpack://cydran/(webpack)/buildin/module.js","webpack://cydran/./src/error/ValidationError.ts","webpack://cydran/./src/logger/LoggerImpl.ts","webpack://cydran/./src/logger/ConsoleOutputStrategy.ts","webpack://cydran/./src/util/ParamUtils.ts","webpack://cydran/./src/message/ListenerImpl.ts","webpack://cydran/./src/element/CSSClass.ts","webpack://cydran/./src/element/Enabled.ts","webpack://cydran/./src/element/ReadOnly.ts","webpack://cydran/./src/element/Style.ts","webpack://cydran/./src/element/ForceFocus.ts","webpack://cydran/./src/element/MultiSelectValueModel.ts","webpack://cydran/./src/element/ValuedModel.ts","webpack://cydran/./src/element/InputValueModel.ts","webpack://cydran/./src/element/Visible.ts","webpack://cydran/./src/element/If.ts","webpack://cydran/./src/element/repeat/Repeat.ts","webpack://cydran/./src/model/Evaluator.ts","webpack://cydran/./src/error/ScopeError.ts","webpack://cydran/./src/element/repeat/GeneratedIdStrategyImpl.ts","webpack://cydran/./src/util/UuidUtils.ts","webpack://cydran/./src/element/repeat/NoneIdStrategyImpl.ts","webpack://cydran/./src/element/repeat/UtilityComponentFactoryImpl.ts","webpack://cydran/./src/element/repeat/UtilityComponent.ts","webpack://cydran/./src/component/Region.ts","webpack://cydran/./src/error/UnknownRegionError.ts","webpack://cydran/./src/error/SetComponentError.ts","webpack://cydran/./src/model/ExternalMediator.ts","webpack://cydran/./src/mvvm/MvvmImpl.ts","webpack://cydran/./src/model/ModelMediatorImpl.ts","webpack://cydran/./src/model/Invoker.ts","webpack://cydran/./src/mvvm/DigestionContextImpl.ts","webpack://cydran/./src/error/MalformedOnEventError.ts","webpack://cydran/./src/element/TextElementMediator.ts","webpack://cydran/./src/element/EventElementMediator.ts","webpack://cydran/./src/element/AttributeElementMediator.ts","webpack://cydran/./src/error/DigestLoopError.ts","webpack://cydran/./src/component/NamedElementOperationsImpl.ts","webpack://cydran/./src/error/UnknownElementError.ts","webpack://cydran/./src/error/ModuleAffinityError.ts","webpack://cydran/./src/module/ModuleImpl.ts","webpack://cydran/./src/registry/Registry.ts","webpack://cydran/./src/error/RegistrationError.ts","webpack://cydran/./src/registry/Instantiator.ts","webpack://cydran/./src/message/BrokerImpl.ts","webpack://cydran/./src/element/repeat/ItemComponentFactoryImpl.ts","webpack://cydran/./src/element/repeat/ItemComponent.ts","webpack://cydran/./src/element/repeat/EmbeddedComponentFactoryImpl.ts","webpack://cydran/./src/element/repeat/InvalidIdStrategyImpl.ts","webpack://cydran/./src/element/repeat/ExpressionIdStrategyImpl.ts","webpack://cydran/./src/stage/Stage.ts","webpack://cydran/./src/util/DomUtils.ts","webpack://cydran/./src/stage/StageComponent.ts","webpack://cydran/./src/stage/StageComponentInternals.ts","webpack://cydran/./src/error/SelectorError.ts","webpack://cydran/./src/component/AnonymousComponent.ts"],"names":["root","factory","exports","module","define","amd","window","installedModules","__webpack_require__","moduleId","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","argsTag","arrayTag","boolTag","dateTag","funcTag","genTag","mapTag","numberTag","objectTag","regexpTag","setTag","stringTag","weakMapTag","dataViewTag","float32Tag","float64Tag","int8Tag","int16Tag","int32Tag","uint8Tag","uint16Tag","uint32Tag","reFlags","reIsHostCtor","reIsUint","typedArrayTags","cloneableTags","freeGlobal","global","freeSelf","self","Function","freeExports","nodeType","freeModule","moduleExports","arrayPush","array","values","length","offset","index","mapToArray","map","result","Array","size","forEach","overArg","func","transform","arg","setToArray","set","uid","context","arrayProto","funcProto","objectProto","coreJsData","funcToString","toString","maskSrcKey","exec","keys","IE_PROTO","nativeObjectToString","reIsNative","RegExp","replace","Buffer","undefined","Uint8Array","allocUnsafe","getPrototype","getPrototypeOf","objectCreate","propertyIsEnumerable","splice","symToStringTag","nativeGetSymbols","getOwnPropertySymbols","nativeIsBuffer","isBuffer","nativeKeys","DataView","getNative","Map","Promise","Set","WeakMap","nativeCreate","dataViewCtorString","toSource","mapCtorString","promiseCtorString","setCtorString","weakMapCtorString","symbolProto","symbolValueOf","valueOf","baseCreate","proto","isObject","entries","this","clear","entry","__DATA__","delete","has","data","assocIndexOf","pop","push","hash","Hash","ListCache","string","getMapData","MapCache","add","pairs","LARGE_ARRAY_SIZE","arrayLikeKeys","inherited","isArr","isArray","isArg","isArguments","isBuff","isType","isTypedArray","skipIndexes","iteratee","baseTimes","String","isIndex","assignValue","objValue","eq","baseAssignValue","configurable","writable","baseClone","bitmask","customizer","stack","isDeep","isFlat","isFull","constructor","input","initCloneArray","source","copyArray","tag","getTag","isFunc","buffer","slice","ctor","copy","cloneBuffer","isPrototype","initCloneObject","copyObject","getSymbolsIn","copySymbolsIn","keysIn","baseAssignIn","getSymbols","copySymbols","baseAssign","Ctor","cloneArrayBuffer","dataView","byteOffset","byteLength","cloneDataView","typedArray","cloneTypedArray","regexp","lastIndex","cloneRegExp","symbol","initCloneByTag","stacked","Stack","isSet","subValue","isMap","props","getAllKeysIn","getAllKeys","arrayEach","baseGetAllKeys","keysFunc","symbolsFunc","baseGetTag","isOwn","unmasked","e","getRawTag","objectToString","baseIsArguments","isObjectLike","baseIsEqual","other","equalFunc","objIsArr","othIsArr","objTag","othTag","objIsObj","othIsObj","isSameTag","equalArrays","message","convert","isPartial","equalByTag","objIsWrapped","othIsWrapped","objUnwrapped","othUnwrapped","objProps","objLength","othLength","skipCtor","othValue","compared","objCtor","othCtor","equalObjects","baseIsEqualDeep","baseIsNative","isFunction","test","baseKeysIn","nativeKeysIn","isProto","arrayBuffer","isNew","newValue","arrLength","seen","SetCache","arrValue","predicate","arraySome","othIndex","type","getValue","resIndex","arrayFilter","stubArray","ArrayBuffer","resolve","ctorString","arguments","isArrayLike","isLength","baseKeys","encodeHtmlMap","lookupEncodeHtmlMap","clone","CLONE_DEEP_FLAG","equals","first","second","requireNotNull","requireValid","regex","isDefined","encodeHtml","dependencies","propagation","reducerFn","____internal$$cydran____","logger","getLogger","prefix","domListeners","pubSub","getModule","params","id","INSTANCE","generate","dispose","removeDomListeners","unwire","mediator","init","mediate","getExpression","wire","VALID_ID","channelName","messageName","payload","actualPayload","broadcast","broadcastGlobally","on","forChannel","invoke","target","apply","INTERNAL_CHANNEL_NAME","requestMediatorSources","sources","getParentId","mvvm","getId","requestMediators","consumer","hasPropagation","getParams","extractAttributes","getPrefix","getEl","getModelFn","getExternalFn","bridge","listener","event","addEventListener","el","expression","getModel","model","getParent","parent","getComponent","getModelMediator","$apply","fn","args","removeEventListener","ElementMediator","LoggerFactory","INTERNAL_DIRECT_CHANNEL_NAME","TEXT_NODE_TYPE","MODULE_FIELD_NAME","COMPONENT_INTERNALS_FIELD_NAME","DEFAULT_MODULE_KEY","NO_OP_FN","EMPTY_OBJECT_FN","register","supportedTags","elementMediatorClass","Factories","factories","supportedTag","msg","reps","CydranError","doMsgFilling","all","Error","asIdentity","asBoolean","Boolean","asString","asNumber","Number","VALID_KEY","setWindow","instance","Properties","getWindow","metadata","attributes","topComponentIds","bottomComponentIds","parentModelFn","getMetadata","getAttributes","withMetadata","withAttribute","withPrefix","setTopComponentIds","setBottomComponentIds","getTopComponentIds","getBottomComponentIds","setModule","setParentModelFn","getParentModelFn","ComponentConfigImpl","build","ComponentConfigBuilder","template","config","____internal$$cydran$$init____","internal","hasMetadata","hasRegion","getChild","setChild","component","setChildFromRegistry","componentName","defaultComponentName","scope","getScope","isConnected","forElement","getItem","getData","getExternals","getExternalCache","watch","Component","Level","globalEnabled","listeners","listenersByChannel","setContext","getChannelName","receive","disableGlobal","mine","listenTo","enableGlobal","trace","channel","isGlobalEnabled","PubSubImpl","EXCLUSIONS","external","item","v","restricted","children","localItems","items","code","setParent","removeChild","addChild","refresh","child","indexOf","getItems","getCode","checkName","refreshChildren","remove","parentItems","refreshCode","statement","ScopeImpl","AFTER_CHILD_ADDED","AFTER_CHILD_CHANGED","AFTER_CHILD_REMOVED","AFTER_PARENT_ADDED","AFTER_PARENT_CHANGED","AFTER_PARENT_REMOVED","BEFORE_CHILD_ADDED","BEFORE_CHILD_CHANGED","BEFORE_CHILD_REMOVED","BEFORE_DISPOSE","BEFORE_PARENT_ADDED","BEFORE_PARENT_CHANGED","BEFORE_PARENT_REMOVED","COMPONENT_NESTING_CHANGED","DEFAULT_COMPONENT_CONFIG","parentSeen","hasExternals","itemFn","toLowerCase","trim","externalMediators","externalCache","externalFields","effectiveExternalAttributes","validateModulePresent","attribute","externalize","flags","repeatable","regions","regionsAsArray","render","getRegion","actualFn","actualArgs","evaluate","hasComponent","childAdded","childRemoved","messageInternalIf","setComponent","componentId","error","region","hasExpression","NESTING_CHANGED","nestingChanged","digest","skipId","setParentScope","setItemFn","addExternalAttribute","parentScope","element","getNamedElement","importExternals","exportExternals","hasExternalMediators","getFlags","getConfig","created","getTemplate","templateEl","document","createElement","insertAdjacentHTML","count","childElementCount","parmObj","firstElementChild","setEl","moduleInstance","getInstances","getDefaultModule","condition","messageChildren","detail","fieldName","attributeName","changed","bothPresentButDifferent","exactlyOneDefined","parentAdded","parentRemoved","ComponentInternalsImpl","logInvocationError","ifWarn","Getter","g","NullValueError","level","INFO","outputStrategy","log","errorStack","DISABLED","getName","setLevel","isTrace","TRACE","isDebug","DEBUG","isInfo","isWarn","WARN","isError","ERROR","isFatal","FATAL","isDisabled","LoggerServiceImpl","major","minor","micro","IdGenerator","MAX_VALUE","TemplateError","Setter","defaultModule","DEFAULT","ModulesContextImpl","INSTANCES","resetInstances","registerConstant","registerPrototype","classInstance","registerPrototypeWithFactory","factoryFn","registerSingleton","registerSingletonWithFactory","registerElementMediator","ALIASES","getLocal","useTrace","useDebug","useInfo","useWarn","useError","useFatal","useDisabled","CydranConfig","Events","builder","ORIGINAL_CYDRAN","noConflict","currentCydran","deps","onTargetChange","previous","current","checked","Checked","webpackPolyfill","deprecate","paths","ValidationError","loggerService","ifTrace","payloadFn","debug","ifDebug","info","ifInfo","warn","ifError","fatal","ifFatal","LoggerImpl","getNow","now","Date","getUTCFullYear","getUTCMonth","getUTCDate","getUTCHours","getUTCMinutes","getUTCSeconds","getUTCMilliseconds","logName","preamble","ConsoleOutputStrategy","shortArgs","printFullStack","logMsg","errMsg","secondPreamble","console","extractParams","tagName","paramName","getAttribute","paramValue","lowerCasePrefix","mappings","ListenerImpl","newClasses","className","split","join","CSSClass","disabled","Enabled","readOnly","ReadOnly","style","Style","handleFocus","shouldFocus","focus","ForceFocus","handleInput","multiple","selectedOptions","optValue","options","selected","includes","MultiSelectValueModel","ValuedModel","isRadio","handleRadioInput","onRadioTargetChange","InputValueModel","hidden","Visible","initialized","comment","createComment","activeEl","parentElement","replaceChild","If","idStrategy","elIsSelect","empty","ids","itemFactory","alternatives","localScope","modelFn","scopeItem","idKey","idkey","idExpression","nodeName","innerHTML","markup","createFactory","last","firstChild","appendChild","newIds","check","enrich","extract","newMap","components","lastChild","workingEl","createDocumentFragment","alternative","expectedTag","Repeat","Evaluator","ScopeError","uuidV4","GeneratedIdStrategyImpl","CHARS","chars","uuid","rnd","Math","random","NoneIdStrategyImpl","parentId","UtilityComponentFactoryImpl","UtilityComponent","defaultEl","setDefaultEl","setExpression","syncComponentMode","newComponentEl","oldComponentEl","Region","UnknownRegionError","SetComponentError","setter","ExternalMediator","requireNonNull","elementMediatorPrefix","eventElementMediatorPrefix","externalAttributePrefix","regionPrefix","namePrefix","componentPrefix","propagatingElementMediators","elementMediators","namedElements","mediators","skipableIds","externalFn","regionLookupFn","validateEl","populateElementMediators","start","remainingEvaluations","pending","skipableId","changedMediators","notify","getItemFn","queue","processChild","elName","regionName","valueExpression","moduleName","attributeValue","substr","processTextChildren","childNodes","names","eventName","addEventElementMediator","trimExpression","removeAttribute","namedElementName","elementMediatorType","addElementMediator","addAttributeElementMediator","discoveredNodes","node","splitChild","newNode","parentNode","insertBefore","substring","sections","textContent","inside","collected","section","beginComment","textNode","createTextNode","addTextElementMediator","endComment","elementMediator","setEventKey","setAttributeName","tags","MvvmImpl","digested","watchDispatchPending","invoker","swap","watchPrevious","watchCurrent","newPrevious","ModelMediatorImpl","aggregateScope","scopeItems","aggregateScopeCode","Invoker","digestSegment","DigestionContextImpl","MalformedOnEventError","TextElementMediator","handleEvent","eventKey","EventElementMediator","setAttribute","AttributeElementMediator","DigestLoopError","setTimeout","blur","NamedElementOperationsImpl","UnknownElementError","ModuleAffinityError","registry","RegistryImpl","broker","associate","componentClasses","componentClass","disassociate","addListener","removeListener","addStrategy","strategy","expose","ModuleImpl","createPubSubFor","logError","gettable","registerFactory","ConstantFactory","PrototypeFactory","SingletonFactory","defaultStrategy","DefaultRegistryStrategyImpl","strategies","pubSubs","param","AbstractFunctionalFactory","RegistrationError","argumentsCode","Instantiator","contains","BrokerImpl","ItemComponentFactoryImpl","ItemComponent","EmbeddedComponentFactoryImpl","InvalidIdStrategyImpl","ExpressionIdStrategyImpl","rootSelector","StageImpl","withComponentBefore","withComponentAfter","withComponent","withInitializer","callback","withTraceLogging","withDebugLogging","withInfoLogging","withWarnLogging","withErrorLogging","withFatalLogging","withLoggingDisabled","getModules","withElementMediator","withConstant","withPrototype","withPrototypeFromFactory","withSingleton","withSingletonFromFactory","withImplicit","withCapability","capability","withScopeItem","started","initializers","domReady","setComponentFromRegistry","StageBuilderImpl","WIN","DOC","readyList","readyFired","readyEventHandlersInstalled","ready","ctx","readyStateChange","readyState","TypeError","selector","StageComponent","elements","querySelectorAll","eLength","patSubObj","topIds","bottomIds","hasChildNodes","pair","componentDiv","regionDiv","StageComponentInternals","SelectorError","configInstance","AnonymousComponent"],"mappings":"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","file":"cydran.min.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"cydran\"] = factory();\n\telse\n\t\troot[\"cydran\"] = factory();\n})(window, function() {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 26);\n","import NullValueError from \"@/error/NullValueError\";\nimport ValidationError from \"@/error/ValidationError\";\n\n/* tslint:disable */\n\nconst LARGE_ARRAY_SIZE = 200;\nconst FUNC_ERROR_TEXT = \"Expected a function\";\nconst HASH_UNDEFINED = \"__lodash_hash_undefined__\";\nconst CLONE_DEEP_FLAG = 1;\nconst CLONE_FLAT_FLAG = 2;\nconst CLONE_SYMBOLS_FLAG = 4;\nconst COMPARE_PARTIAL_FLAG = 1;\nconst COMPARE_UNORDERED_FLAG = 2;\nconst MAX_SAFE_INTEGER = 9007199254740991;\nconst argsTag = \"[object Arguments]\";\nconst arrayTag = \"[object Array]\";\nconst asyncTag = \"[object AsyncFunction]\";\nconst boolTag = \"[object Boolean]\";\nconst dateTag = \"[object Date]\";\nconst errorTag = \"[object Error]\";\nconst funcTag = \"[object Function]\";\nconst genTag = \"[object GeneratorFunction]\";\nconst mapTag = \"[object Map]\";\nconst numberTag = \"[object Number]\";\nconst nullTag = \"[object Null]\";\nconst objectTag = \"[object Object]\";\nconst promiseTag = \"[object Promise]\";\nconst proxyTag = \"[object Proxy]\";\nconst regexpTag = \"[object RegExp]\";\nconst setTag = \"[object Set]\";\nconst stringTag = \"[object String]\";\nconst symbolTag = \"[object Symbol]\";\nconst undefinedTag = \"[object Undefined]\";\nconst weakMapTag = \"[object WeakMap]\";\nconst arrayBufferTag = \"[object ArrayBuffer]\";\nconst dataViewTag = \"[object DataView]\";\nconst float32Tag = \"[object Float32Array]\";\nconst float64Tag = \"[object Float64Array]\";\nconst int8Tag = \"[object Int8Array]\";\nconst int16Tag = \"[object Int16Array]\";\nconst int32Tag = \"[object Int32Array]\";\nconst uint8Tag = \"[object Uint8Array]\";\nconst uint8ClampedTag = \"[object Uint8ClampedArray]\";\nconst uint16Tag = \"[object Uint16Array]\";\nconst uint32Tag = \"[object Uint32Array]\";\nconst reRegExpChar = /[\\\\^$.*+?()[\\]{}|]/g;\nconst reFlags = /\\w*$/;\nconst reIsHostCtor = /^\\[object .+?Constructor\\]$/;\nconst reIsUint = /^(?:0|[1-9]\\d*)$/;\nconst typedArrayTags = {};\ntypedArrayTags[float32Tag] = typedArrayTags[float64Tag] =\n\ttypedArrayTags[int8Tag] = typedArrayTags[int16Tag] =\n\ttypedArrayTags[int32Tag] = typedArrayTags[uint8Tag] =\n\ttypedArrayTags[uint8ClampedTag] = typedArrayTags[uint16Tag] =\n\ttypedArrayTags[uint32Tag] = true;\ntypedArrayTags[argsTag] = typedArrayTags[arrayTag] =\n\ttypedArrayTags[arrayBufferTag] = typedArrayTags[boolTag] =\n\ttypedArrayTags[dataViewTag] = typedArrayTags[dateTag] =\n\ttypedArrayTags[errorTag] = typedArrayTags[funcTag] =\n\ttypedArrayTags[mapTag] = typedArrayTags[numberTag] =\n\ttypedArrayTags[objectTag] = typedArrayTags[regexpTag] =\n\ttypedArrayTags[setTag] = typedArrayTags[stringTag] =\n\ttypedArrayTags[weakMapTag] = false;\nconst cloneableTags = {};\ncloneableTags[argsTag] = cloneableTags[arrayTag] =\n\tcloneableTags[arrayBufferTag] = cloneableTags[dataViewTag] =\n\tcloneableTags[boolTag] = cloneableTags[dateTag] =\n\tcloneableTags[float32Tag] = cloneableTags[float64Tag] =\n\tcloneableTags[int8Tag] = cloneableTags[int16Tag] =\n\tcloneableTags[int32Tag] = cloneableTags[mapTag] =\n\tcloneableTags[numberTag] = cloneableTags[objectTag] =\n\tcloneableTags[regexpTag] = cloneableTags[setTag] =\n\tcloneableTags[stringTag] = cloneableTags[symbolTag] =\n\tcloneableTags[uint8Tag] = cloneableTags[uint8ClampedTag] =\n\tcloneableTags[uint16Tag] = cloneableTags[uint32Tag] = true;\ncloneableTags[errorTag] = cloneableTags[funcTag] =\n\tcloneableTags[weakMapTag] = false;\nconst freeGlobal = typeof global === \"object\" && global && global.Object === Object && global;\nconst freeSelf = typeof self === \"object\" && self && self[\"Object\"] === Object && self;\nconst root = freeGlobal || freeSelf || Function(\"return this\")();\nconst freeExports = typeof exports === \"object\" && exports && !exports.nodeType && exports;\nconst freeModule = freeExports && typeof module === \"object\" && module && !module[\"nodeType\"] && module;\nconst moduleExports = freeModule && freeModule.exports === freeExports;\n\nfunction arrayEach(array: any[], iteratee: Function): any[] {\n\tconst length = array == null ? 0 : array.length;\n\n\tlet index = -1;\n\n\twhile (++index < length) {\n\t\tif (iteratee(array[index], index, array) === false) {\n\t\t\tbreak;\n\t\t}\n\t}\n\n\treturn array;\n}\n\nfunction arrayFilter(array: any[], predicate: Function): any[] {\n\tconst length = array == null ? 0 : array.length;\n\tconst result = [];\n\n\tlet index = -1;\n\tlet resIndex = 0;\n\n\twhile (++index < length) {\n\t\tconst value = array[index];\n\n\t\tif (predicate(value, index, array)) {\n\t\t\tresult[resIndex++] = value;\n\t\t}\n\t}\n\n\treturn result;\n}\n\nfunction arrayPush(array: any[], values: any[]): any[] {\n\tconst length = values.length;\n\tconst offset = array.length;\n\n\tlet index = -1;\n\n\twhile (++index < length) {\n\t\tarray[offset + index] = values[index];\n\t}\n\n\treturn array;\n}\n\nfunction arraySome(array: any[], predicate: Function): boolean {\n\tconst length = array == null ? 0 : array.length;\n\tlet index = -1;\n\n\twhile (++index < length) {\n\t\tif (predicate(array[index], index, array)) {\n\t\t\treturn true;\n\t\t}\n\t}\n\n\treturn false;\n}\n\nfunction baseTimes(n: number, iteratee: Function): any[] {\n\tconst result = Array(n);\n\tlet index = -1;\n\n\twhile (++index < n) {\n\t\tresult[index] = iteratee(index);\n\t}\n\n\treturn result;\n}\n\nfunction cacheHas(cache: any, key: string): boolean {\n\treturn cache.has(key);\n}\n\nfunction getValue(object: any, key: string): any {\n\treturn object == null ? undefined : object[key];\n}\n\nfunction mapToArray(map: any): any[] {\n\tconst result = Array(map.size);\n\n\tlet index = -1;\n\n\tmap.forEach(function(value: any, key: string) {\n\t\tresult[++index] = [key, value];\n\t});\n\n\treturn result;\n}\n\nfunction overArg(func: Function, transform: Function): Function {\n\treturn function(arg: any) {\n\t\treturn func(transform(arg));\n\t};\n}\n\nfunction setToArray(set: any): any[] {\n\tconst result = Array(set.size);\n\n\tlet index = -1;\n\n\tset.forEach(function(value: any) {\n\t\tresult[++index] = value;\n\t});\n\n\treturn result;\n}\n\ninterface ContextType {\n\t[x: string]: any;\n\tArray: any;\n\tDate: any;\n\tError: any;\n\tFunction: any;\n\tMath: any;\n\tObject: any;\n\tRegExp: any;\n\tString: any;\n\tTypeError: any;\n\tBuffer: any;\n\tSymbol: any;\n\tUint8Array: any;\n\tclearTimeout: any;\n\tsetTimeout: any;\n\tisFinite: any;\n\tparseInt: any;\n}\n\nconst context: ContextType = root;\n\nconst arrayProto = Array.prototype;\nconst funcProto = Function.prototype;\nconst objectProto = Object.prototype;\nconst coreJsData = context[\"__core-js_shared__\"];\nconst funcToString = funcProto.toString;\nconst hasOwnProperty = objectProto.hasOwnProperty;\nconst maskSrcKey = (function() {\n\tconst uid = /[^.]+$/.exec(coreJsData && coreJsData.keys && coreJsData.keys.IE_PROTO || \"\");\n\n\treturn uid ? (\"Symbol(src)_1.\" + uid) : \"\";\n}());\n\nconst nativeObjectToString = objectProto.toString;\nconst reIsNative = RegExp(\"^\" + funcToString.call(hasOwnProperty).replace(reRegExpChar, \"\\\\$&\").replace(/hasOwnProperty|(function).*?(?=\\\\\\()| for .+?(?=\\\\\\])/g, \"$1.*?\") + \"$\");\n\nconst Buffer = moduleExports ? context.Buffer : undefined;\nconst Symbol = context.Symbol;\nconst Uint8Array = context.Uint8Array;\nconst allocUnsafe = Buffer ? Buffer.allocUnsafe : undefined;\nconst getPrototype = overArg(Object.getPrototypeOf, Object);\nconst objectCreate = Object.create;\nconst propertyIsEnumerable = objectProto.propertyIsEnumerable;\nconst splice = arrayProto.splice;\nconst symToStringTag = Symbol ? Symbol.toStringTag : undefined;\nconst nativeGetSymbols = Object.getOwnPropertySymbols;\nconst nativeIsBuffer = Buffer ? Buffer.isBuffer : undefined;\nconst nativeKeys = overArg(Object.keys, Object);\nconst DataView = getNative(context, \"DataView\");\nconst Map = getNative(context, \"Map\");\nconst Promise = getNative(context, \"Promise\");\nconst Set = getNative(context, \"Set\");\nconst WeakMap = getNative(context, \"WeakMap\");\nconst nativeCreate = getNative(Object, \"create\");\nconst dataViewCtorString = toSource(DataView);\nconst mapCtorString = toSource(Map);\nconst promiseCtorString = toSource(Promise);\nconst setCtorString = toSource(Set);\nconst weakMapCtorString = toSource(WeakMap);\nconst symbolProto = Symbol ? Symbol.prototype : undefined;\nconst symbolValueOf = symbolProto ? symbolProto.valueOf : undefined;\n\nconst baseCreate = (function() {\n\tfunction object() {\n\t\t// Intentionally do nothing\n\t}\n\n\treturn function(proto: any) {\n\t\tif (!isObject(proto)) {\n\t\t\treturn {};\n\t\t}\n\t\tif (objectCreate) {\n\t\t\treturn objectCreate(proto);\n\t\t}\n\t\tobject.prototype = proto;\n\t\tconst result = new object();\n\t\tobject.prototype = undefined;\n\t\treturn result;\n\t};\n}());\n\nclass Hash {\n\n\tpublic size: number;\n\n\tpublic __DATA__: any;\n\n\tconstructor(entries?: any[]) {\n\t\tlet index = -1;\n\t\tconst length = entries == null ? 0 : entries.length;\n\n\t\tthis.clear();\n\t\twhile (++index < length) {\n\t\t\tconst entry = entries[index];\n\t\t\tthis.set(entry[0], entry[1]);\n\t\t}\n\t}\n\n\tpublic clear(): void {\n\t\tthis.__DATA__ = nativeCreate ? nativeCreate(null) : {};\n\t\tthis.size = 0;\n\t}\n\n\tpublic delete(key: string): boolean {\n\t\tconst result = this.has(key) && delete this.__DATA__[key];\n\t\tthis.size -= result ? 1 : 0;\n\t\treturn result;\n\t}\n\n\tpublic get(key: string): any {\n\t\tconst data = this.__DATA__;\n\t\tif (nativeCreate) {\n\t\t\tconst result = data[key];\n\t\t\treturn result === HASH_UNDEFINED ? undefined : result;\n\t\t}\n\t\treturn hasOwnProperty.call(data, key) ? data[key] : undefined;\n\t}\n\n\tpublic has(key: string): boolean {\n\t\tconst data = this.__DATA__;\n\t\treturn nativeCreate ? (data[key] !== undefined) : hasOwnProperty.call(data, key);\n\t}\n\n\tpublic set(key: string, value: any): any {\n\t\tconst data = this.__DATA__;\n\t\tthis.size += this.has(key) ? 0 : 1;\n\t\tdata[key] = (nativeCreate && value === undefined) ? HASH_UNDEFINED : value;\n\t\treturn this;\n\t}\n\n}\n\nclass ListCache {\n\n\tpublic size: number;\n\n\tpublic __DATA__: any;\n\n\tconstructor(entries?: any[]) {\n\t\tlet index = -1;\n\t\tconst length = entries == null ? 0 : entries.length;\n\n\t\tthis.clear();\n\n\t\twhile (++index < length) {\n\t\t\tconst entry = entries[index];\n\t\t\tthis.set(entry[0], entry[1]);\n\t\t}\n\t}\n\n\tpublic clear(): void {\n\t\tthis.__DATA__ = [];\n\t\tthis.size = 0;\n\t}\n\n\tpublic delete(key: string): boolean {\n\t\tconst data = this.__DATA__;\n\t\tconst index = assocIndexOf(data, key);\n\n\t\tif (index < 0) {\n\t\t\treturn false;\n\t\t}\n\t\tconst lastIndex = data.length - 1;\n\t\tif (index == lastIndex) {\n\t\t\tdata.pop();\n\t\t} else {\n\t\t\tsplice.call(data, index, 1);\n\t\t}\n\t\t--this.size;\n\t\treturn true;\n\t}\n\n\tpublic get(key: string): any {\n\t\tconst data = this.__DATA__;\n\t\tconst index = assocIndexOf(data, key);\n\n\t\treturn index < 0 ? undefined : data[index][1];\n\t}\n\n\tpublic has(key: string): boolean {\n\t\treturn assocIndexOf(this.__DATA__, key) > -1;\n\t}\n\n\tpublic set(key: string, value: any): any {\n\t\tconst data = this.__DATA__;\n\t\tconst index = assocIndexOf(data, key);\n\n\t\tif (index < 0) {\n\t\t\t++this.size;\n\t\t\tdata.push([key, value]);\n\t\t} else {\n\t\t\tdata[index][1] = value;\n\t\t}\n\t\treturn this;\n\t}\n\n}\n\nclass MapCache {\n\n\tpublic size: number;\n\n\tpublic __DATA__: any;\n\n\tconstructor(entries?: any[]) {\n\t\tlet index = -1;\n\t\tconst length = entries == null ? 0 : entries.length;\n\n\t\tthis.clear();\n\t\twhile (++index < length) {\n\t\t\tconst entry = entries[index];\n\t\t\tthis.set(entry[0], entry[1]);\n\t\t}\n\t}\n\n\tpublic clear(): void {\n\t\tthis.size = 0;\n\t\tthis.__DATA__ = {\n\t\t\thash: new Hash(),\n\t\t\tmap: new (Map || ListCache)(),\n\t\t\tstring: new Hash(),\n\t\t};\n\t}\n\n\tpublic delete(key: string): boolean {\n\t\tconst result = getMapData(this, key)[\"delete\"](key);\n\t\tthis.size -= result ? 1 : 0;\n\t\treturn result;\n\t}\n\n\tpublic get(key: string): any {\n\t\treturn getMapData(this, key).get(key);\n\t}\n\n\tpublic has(key: string): boolean {\n\t\treturn getMapData(this, key).has(key);\n\t}\n\n\tpublic set(key: string, value: any): any {\n\t\tconst data = getMapData(this, key);\n\t\tconst size = data.size;\n\n\t\tdata.set(key, value);\n\t\tthis.size += data.size == size ? 0 : 1;\n\t\treturn this;\n\t}\n\n}\n\nclass SetCache {\n\n\tpublic __DATA__: any;\n\n\tconstructor(values?: any[]) {\n\t\tlet index = -1;\n\t\tconst length = values == null ? 0 : values.length;\n\n\t\tthis.__DATA__ = new MapCache();\n\t\twhile (++index < length) {\n\t\t\tthis.add(values[index]);\n\t\t}\n\t}\n\n\tpublic push(value: any): any {\n\t\treturn this.add(value);\n\t}\n\n\tpublic add(value: any): any {\n\t\tthis.__DATA__.set(value, HASH_UNDEFINED);\n\t\treturn this;\n\t}\n\n\tpublic has(value: any): boolean {\n\t\treturn this.__DATA__.has(value);\n\t}\n\n}\n\nclass Stack {\n\n\tpublic __DATA__: any;\n\n\tpublic size: number;\n\n\tconstructor(entries?: any[]) {\n\t\tconst data = this.__DATA__ = new ListCache(entries);\n\t\tthis.size = data.size;\n\t}\n\n\tpublic clear(): void {\n\t\tthis.__DATA__ = new ListCache();\n\t\tthis.size = 0;\n\t}\n\n\tpublic delete(key: string): boolean {\n\t\tconst data = this.__DATA__;\n\t\tconst result = data[\"delete\"](key);\n\n\t\tthis.size = data.size;\n\t\treturn result;\n\t}\n\n\tpublic get(key: string): any {\n\t\treturn this.__DATA__.get(key);\n\t}\n\n\tpublic has(key: string): boolean {\n\t\treturn this.__DATA__.has(key);\n\t}\n\n\tpublic set(key: string, value: any): any {\n\t\tlet data = this.__DATA__;\n\t\tif (data instanceof ListCache) {\n\t\t\tconst pairs = data.__DATA__;\n\t\t\tif (!Map || (pairs.length < LARGE_ARRAY_SIZE - 1)) {\n\t\t\t\tpairs.push([key, value]);\n\t\t\t\tthis.size = ++data.size;\n\t\t\t\treturn this;\n\t\t\t}\n\t\t\tdata = this.__DATA__ = new MapCache(pairs);\n\t\t}\n\t\tdata.set(key, value);\n\t\tthis.size = data.size;\n\t\treturn this;\n\t}\n\n}\n\nfunction arrayLikeKeys(value: any, inherited?: boolean): string[] {\n\tconst isArr = isArray(value);\n\tconst isArg = !isArr && isArguments(value);\n\tconst isBuff = !isArr && !isArg && isBuffer(value);\n\tconst isType = !isArr && !isArg && !isBuff && isTypedArray(value);\n\tconst skipIndexes = isArr || isArg || isBuff || isType;\n\tconst result = skipIndexes ? baseTimes(value.length, String) : [];\n\tconst length = result.length;\n\n\tfor (const key in value) {\n\t\tif ((inherited || hasOwnProperty.call(value, key)) &&\n\t\t\t!(skipIndexes && (\n\t\t\t\t// Safari 9 has enumerable `arguments.length` in strict mode.\n\t\t\t\tkey == \"length\" ||\n\t\t\t\t// Node.js 0.10 has enumerable non-index properties on buffers.\n\t\t\t\t(isBuff && (key == \"offset\" || key == \"parent\")) ||\n\t\t\t\t// PhantomJS 2 has enumerable non-index properties on typed arrays.\n\t\t\t\t(isType && (key == \"buffer\" || key == \"byteLength\" || key == \"byteOffset\")) ||\n\t\t\t\t// Skip index properties.\n\t\t\t\tisIndex(key, length)\n\t\t\t))) {\n\t\t\tresult.push(key);\n\t\t}\n\t}\n\treturn result;\n}\n\nfunction assignValue(object: any, key: string, value: any): void {\n\tconst objValue = object[key];\n\tif (!(hasOwnProperty.call(object, key) && eq(objValue, value)) ||\n\t\t(value === undefined && !(key in object))) {\n\t\tbaseAssignValue(object, key, value);\n\t}\n}\n\nfunction assocIndexOf(array: any[], key: any): number {\n\tlet length = array.length;\n\twhile (length--) {\n\t\tif (eq(array[length][0], key)) {\n\t\t\treturn length;\n\t\t}\n\t}\n\treturn -1;\n}\n\nfunction baseAssign(object: any, source: any): any {\n\treturn object && copyObject(source, keys(source), object);\n}\n\nfunction baseAssignIn(object: any, source: any): any {\n\treturn object && copyObject(source, keysIn(source), object);\n}\n\nfunction baseAssignValue(object: any, key: string, value: any): void {\n\tif (key == \"__proto__\" && Object.defineProperty) {\n\t\tObject.defineProperty(object, key, {\n\t\t\tconfigurable: true,\n\t\t\tenumerable: true,\n\t\t\tvalue: value,\n\t\t\twritable: true,\n\t\t});\n\t} else {\n\t\tobject[key] = value;\n\t}\n}\n\nfunction baseClone(value: any, bitmask: number, customizer?: Function, key?: string, object?: any, stack?: any): any {\n\tlet result: any;\n\tconst isDeep = bitmask & CLONE_DEEP_FLAG;\n\tconst isFlat = bitmask & CLONE_FLAT_FLAG;\n\tconst isFull = bitmask & CLONE_SYMBOLS_FLAG;\n\n\tif (customizer) {\n\t\tresult = object ? customizer(value, key, object, stack) : customizer(value);\n\t}\n\tif (result !== undefined) {\n\t\treturn result;\n\t}\n\tif (!isObject(value)) {\n\t\treturn value;\n\t}\n\tconst isArr = isArray(value);\n\tif (isArr) {\n\t\tresult = initCloneArray(value);\n\t\tif (!isDeep) {\n\t\t\treturn copyArray(value, result);\n\t\t}\n\t} else {\n\t\tconst tag = getTag(value);\n\t\tconst isFunc = tag == funcTag || tag == genTag;\n\n\t\tif (isBuffer(value)) {\n\t\t\treturn cloneBuffer(value, !!isDeep);\n\t\t}\n\t\tif (tag == objectTag || tag == argsTag || (isFunc && !object)) {\n\t\t\tresult = (isFlat || isFunc) ? {} : initCloneObject(value);\n\t\t\tif (!isDeep) {\n\t\t\t\treturn isFlat\n\t\t\t\t\t? copySymbolsIn(value, baseAssignIn(result, value))\n\t\t\t\t\t: copySymbols(value, baseAssign(result, value));\n\t\t\t}\n\t\t} else {\n\t\t\tif (!cloneableTags[tag]) {\n\t\t\t\treturn object ? value : {};\n\t\t\t}\n\t\t\tresult = initCloneByTag(value, tag, !!isDeep);\n\t\t}\n\t}\n\t// Check for circular references and return its corresponding clone.\n\tstack = (!stack) ? new Stack() : stack;\n\tconst stacked = stack.get(value);\n\tif (stacked) {\n\t\treturn stacked;\n\t}\n\tstack.set(value, result);\n\n\tif (isSet(value)) {\n\t\tvalue.forEach(function(subValue: any) {\n\t\t\tresult.add(baseClone(subValue, bitmask, customizer, subValue, value, stack));\n\t\t});\n\t} else if (isMap(value)) {\n\t\tvalue.forEach(function(subValue: any, key: string) {\n\t\t\tresult.set(key, baseClone(subValue, bitmask, customizer, key, value, stack));\n\t\t});\n\t}\n\n\tconst keysFunc = isFull ? (isFlat ? getAllKeysIn : getAllKeys) : (isFlat ? keysIn : keys);\n\tconst props = isArr ? undefined : keysFunc(value);\n\tarrayEach(props || value, function(subValue: any, key: string) {\n\t\tif (props) {\n\t\t\tkey = subValue;\n\t\t\tsubValue = value[key];\n\t\t}\n\t\t// Recursively populate clone (susceptible to call stack limits).\n\t\tassignValue(result, key, baseClone(subValue, bitmask, customizer, key, value, stack));\n\t});\n\treturn result;\n}\n\nfunction baseGetAllKeys(object: any, keysFunc: Function, symbolsFunc: Function): any[] {\n\tconst result = keysFunc(object);\n\treturn isArray(object) ? result : arrayPush(result, symbolsFunc(object));\n}\n\nfunction baseGetTag(value: any): string {\n\tif (value == null) {\n\t\treturn value === undefined ? undefinedTag : nullTag;\n\t}\n\treturn (symToStringTag && symToStringTag in Object(value))\n\t\t? getRawTag(value)\n\t\t: objectToString(value);\n}\n\nfunction baseIsArguments(value: any): boolean {\n\treturn isObjectLike(value) && baseGetTag(value) == argsTag;\n}\n\nfunction baseIsEqual(value: any, other: any, bitmask?: number, customizer?: Function, stack?: any): boolean {\n\tif (value === other) {\n\t\treturn true;\n\t}\n\tif (value == null || other == null || (!isObjectLike(value) && !isObjectLike(other))) {\n\t\treturn value !== value && other !== other;\n\t}\n\treturn baseIsEqualDeep(value, other, bitmask, customizer, baseIsEqual, stack);\n}\n\nfunction baseIsEqualDeep(object: any, other: any, bitmask: number, customizer: Function, equalFunc: Function, stack: any): boolean {\n\tlet objIsArr = isArray(object);\n\tconst othIsArr = isArray(other);\n\tlet objTag = objIsArr ? arrayTag : getTag(object);\n\tlet othTag = othIsArr ? arrayTag : getTag(other);\n\n\tobjTag = objTag == argsTag ? objectTag : objTag;\n\tothTag = othTag == argsTag ? objectTag : othTag;\n\n\tlet objIsObj = objTag == objectTag;\n\tconst othIsObj = othTag == objectTag;\n\tconst isSameTag = objTag == othTag;\n\n\tif (isSameTag && isBuffer(object)) {\n\t\tif (!isBuffer(other)) {\n\t\t\treturn false;\n\t\t}\n\t\tobjIsArr = true;\n\t\tobjIsObj = false;\n\t}\n\tif (isSameTag && !objIsObj) {\n\t\tstack = (!stack) ? new Stack() : stack;\n\t\treturn (objIsArr || isTypedArray(object))\n\t\t\t? equalArrays(object, other, bitmask, customizer, equalFunc, stack)\n\t\t\t: equalByTag(object, other, objTag, bitmask, customizer, equalFunc, stack);\n\t}\n\tif (!(bitmask & COMPARE_PARTIAL_FLAG)) {\n\t\tconst objIsWrapped = objIsObj && hasOwnProperty.call(object, \"__wrapped__\");\n\t\tconst othIsWrapped = othIsObj && hasOwnProperty.call(other, \"__wrapped__\");\n\n\t\tif (objIsWrapped || othIsWrapped) {\n\t\t\tconst objUnwrapped = objIsWrapped ? object.value() : object;\n\t\t\tconst othUnwrapped = othIsWrapped ? other.value() : other;\n\n\t\t\tstack = (!stack) ? new Stack() : stack;\n\t\t\treturn equalFunc(objUnwrapped, othUnwrapped, bitmask, customizer, stack);\n\t\t}\n\t}\n\tif (!isSameTag) {\n\t\treturn false;\n\t}\n\tstack = (!stack) ? new Stack() : stack;\n\treturn equalObjects(object, other, bitmask, customizer, equalFunc, stack);\n}\n\nfunction baseIsMap(value: any): boolean {\n\treturn isObjectLike(value) && getTag(value) == mapTag;\n}\n\nfunction baseIsNative(value: any): boolean {\n\tif (!isObject(value) || isMasked(value)) {\n\t\treturn false;\n\t}\n\tconst pattern = isFunction(value) ? reIsNative : reIsHostCtor;\n\treturn pattern.test(toSource(value));\n}\n\nfunction baseIsSet(value: any): boolean {\n\treturn isObjectLike(value) && getTag(value) == setTag;\n}\n\nfunction baseIsTypedArray(value: any): boolean {\n\treturn isObjectLike(value) &&\n\t\tisLength(value.length) && !!typedArrayTags[baseGetTag(value)];\n}\n\nfunction baseKeys(object: any): string[] {\n\tif (!isPrototype(object)) {\n\t\treturn nativeKeys(object);\n\t}\n\tconst result = [];\n\tfor (const key in Object(object)) {\n\t\tif (hasOwnProperty.call(object, key) && key != \"constructor\") {\n\t\t\tresult.push(key);\n\t\t}\n\t}\n\treturn result;\n}\n\nfunction baseKeysIn(object: any): string[] {\n\tif (!isObject(object)) {\n\t\treturn nativeKeysIn(object);\n\t}\n\tconst isProto = isPrototype(object);\n\tconst result = [];\n\n\tfor (const key in object) {\n\t\tif (!(key == \"constructor\" && (isProto || !hasOwnProperty.call(object, key)))) {\n\t\t\tresult.push(key);\n\t\t}\n\t}\n\treturn result;\n}\n\nfunction cloneBuffer(buffer: Buffer, isDeep: boolean): Buffer {\n\tif (isDeep) {\n\t\treturn buffer.slice();\n\t}\n\tconst length = buffer.length;\n\tconst ctor: any = buffer.constructor;\n\tconst result = allocUnsafe ? allocUnsafe(length) : new ctor(length);\n\n\tbuffer.copy(result);\n\treturn result;\n}\n\nfunction cloneArrayBuffer(arrayBuffer: ArrayBuffer): ArrayBuffer {\n\tconst ctor: any = arrayBuffer[\"constructor\"];\n\tconst result = new ctor(arrayBuffer.byteLength);\n\tnew Uint8Array(result).set(new Uint8Array(arrayBuffer));\n\treturn result;\n}\n\nfunction cloneDataView(dataView: any, isDeep: boolean): any {\n\tconst buffer = isDeep ? cloneArrayBuffer(dataView.buffer) : dataView.buffer;\n\treturn new dataView.constructor(buffer, dataView.byteOffset, dataView.byteLength);\n}\n\nfunction cloneRegExp(regexp: any): any {\n\tconst result = new regexp.constructor(regexp.source, reFlags.exec(regexp));\n\tresult.lastIndex = regexp.lastIndex;\n\treturn result;\n}\n\nfunction cloneSymbol(symbol: any): any {\n\treturn symbolValueOf ? Object(symbolValueOf.call(symbol)) : {};\n}\n\nfunction cloneTypedArray(typedArray: any, isDeep: boolean): any {\n\tconst buffer = isDeep ? cloneArrayBuffer(typedArray.buffer) : typedArray.buffer;\n\treturn new typedArray.constructor(buffer, typedArray.byteOffset, typedArray.length);\n}\n\nfunction copyArray(source: any[], array?: any[]): any[] {\n\tlet index = -1;\n\tconst length = source.length;\n\n\tarray = (!array) ? Array(length) : array;\n\twhile (++index < length) {\n\t\tarray[index] = source[index];\n\t}\n\treturn array;\n}\n\nfunction copyObject(source: any, props: string[], object?: any, customizer?: Function): any {\n\tconst isNew = !object;\n\tobject = (isNew) ? {} : object;\n\n\tlet index = -1;\n\tconst length = props.length;\n\n\twhile (++index < length) {\n\t\tconst key = props[index];\n\n\t\tlet newValue = customizer\n\t\t\t? customizer(object[key], source[key], key, object, source)\n\t\t\t: undefined;\n\n\t\tif (newValue === undefined) {\n\t\t\tnewValue = source[key];\n\t\t}\n\t\tif (isNew) {\n\t\t\tbaseAssignValue(object, key, newValue);\n\t\t} else {\n\t\t\tassignValue(object, key, newValue);\n\t\t}\n\t}\n\treturn object;\n}\n\nfunction copySymbols(source: any, object: any): any {\n\treturn copyObject(source, getSymbols(source), object);\n}\n\nfunction copySymbolsIn(source: any, object: any): any {\n\treturn copyObject(source, getSymbolsIn(source), object);\n}\n\nfunction equalArrays(array: any[], other: any[], bitmask: number, customizer: Function, equalFunc: Function, stack: any): boolean {\n\tconst isPartial = bitmask & COMPARE_PARTIAL_FLAG;\n\tconst arrLength = array.length;\n\tconst othLength = other.length;\n\n\tif (arrLength != othLength && !(isPartial && othLength > arrLength)) {\n\t\treturn false;\n\t}\n\t// Assume cyclic values are equal.\n\tconst stacked = stack.get(array);\n\tif (stacked && stack.get(other)) {\n\t\treturn stacked == other;\n\t}\n\tlet index = -1;\n\tlet result = true;\n\tconst seen = (bitmask & COMPARE_UNORDERED_FLAG) ? new SetCache() : undefined;\n\n\tstack.set(array, other);\n\tstack.set(other, array);\n\n\t// Ignore non-index properties.\n\twhile (++index < arrLength) {\n\t\tconst arrValue = array[index];\n\t\tconst othValue = other[index];\n\n\t\tlet compared;\n\t\tif (customizer) {\n\t\t\tcompared = isPartial\n\t\t\t\t? customizer(othValue, arrValue, index, other, array, stack)\n\t\t\t\t: customizer(arrValue, othValue, index, array, other, stack);\n\t\t}\n\t\tif (compared !== undefined) {\n\t\t\tif (compared) {\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tresult = false;\n\t\t\tbreak;\n\t\t}\n\t\t// Recursively compare arrays (susceptible to call stack limits).\n\t\tif (seen) {\n\t\t\tif (!arraySome(other, function(othValue: any, othIndex: any) {\n\t\t\t\tif (!cacheHas(seen, othIndex) &&\n\t\t\t\t\t(arrValue === othValue || equalFunc(arrValue, othValue, bitmask, customizer, stack))) {\n\t\t\t\t\treturn seen.push(othIndex);\n\t\t\t\t}\n\t\t\t})) {\n\t\t\t\tresult = false;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t} else if (!(\n\t\t\tarrValue === othValue ||\n\t\t\tequalFunc(arrValue, othValue, bitmask, customizer, stack)\n\t\t)) {\n\t\t\tresult = false;\n\t\t\tbreak;\n\t\t}\n\t}\n\tstack[\"delete\"](array);\n\tstack[\"delete\"](other);\n\treturn result;\n}\n\nfunction equalByTag(object: any, other: any, tag: string, bitmask: number, customizer: Function, equalFunc: Function, stack: any): boolean {\n\tswitch (tag) {\n\t\tcase dataViewTag:\n\t\t\tif ((object.byteLength != other.byteLength) ||\n\t\t\t\t(object.byteOffset != other.byteOffset)) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tobject = object.buffer;\n\t\t\tother = other.buffer;\n\n\t\tcase arrayBufferTag:\n\t\t\tif ((object.byteLength != other.byteLength) ||\n\t\t\t\t!equalFunc(new Uint8Array(object), new Uint8Array(other))) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\treturn true;\n\n\t\tcase boolTag:\n\t\tcase dateTag:\n\t\tcase numberTag:\n\t\t\t// Coerce booleans to `1` or `0` and dates to milliseconds.\n\t\t\t// Invalid dates are coerced to `NaN`.\n\t\t\treturn eq(+object, +other);\n\n\t\tcase errorTag:\n\t\t\treturn object.name == other.name && object.message == other.message;\n\n\t\tcase regexpTag:\n\t\tcase stringTag:\n\t\t\t// Coerce regexes to strings and treat strings, primitives and objects,\n\t\t\t// as equal. See http://www.ecma-international.org/ecma-262/7.0/#sec-regexp.prototype.tostring\n\t\t\t// for more details.\n\t\t\treturn object == (other + \"\");\n\n\t\tcase mapTag:\n\t\t\tlet convert = mapToArray;\n\n\t\tcase setTag:\n\t\t\tconst isPartial = bitmask & COMPARE_PARTIAL_FLAG;\n\t\t\tconvert = (!convert) ? setToArray : convert;\n\n\t\t\tif (object.size != other.size && !isPartial) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\t// Assume cyclic values are equal.\n\t\t\tconst stacked = stack.get(object);\n\t\t\tif (stacked) {\n\t\t\t\treturn stacked == other;\n\t\t\t}\n\t\t\tbitmask |= COMPARE_UNORDERED_FLAG;\n\n\t\t\t// Recursively compare objects (susceptible to call stack limits).\n\t\t\tstack.set(object, other);\n\t\t\tconst result = equalArrays(convert(object), convert(other), bitmask, customizer, equalFunc, stack);\n\t\t\tstack[\"delete\"](object);\n\t\t\treturn result;\n\n\t\tcase symbolTag:\n\t\t\tif (symbolValueOf) {\n\t\t\t\treturn symbolValueOf.call(object) == symbolValueOf.call(other);\n\t\t\t}\n\t}\n\treturn false;\n}\n\nfunction equalObjects(object: any, other: any, bitmask: number, customizer: Function, equalFunc: Function, stack: any): boolean {\n\tconst isPartial = bitmask & COMPARE_PARTIAL_FLAG;\n\tconst objProps = getAllKeys(object);\n\tconst objLength = objProps.length;\n\tconst othProps = getAllKeys(other);\n\tconst othLength = othProps.length;\n\n\tif (objLength != othLength && !isPartial) {\n\t\treturn false;\n\t}\n\tlet index = objLength;\n\twhile (index--) {\n\t\tconst key = objProps[index];\n\t\tif (!(isPartial ? key in other : hasOwnProperty.call(other, key))) {\n\t\t\treturn false;\n\t\t}\n\t}\n\t// Assume cyclic values are equal.\n\tconst stacked = stack.get(object);\n\tif (stacked && stack.get(other)) {\n\t\treturn stacked == other;\n\t}\n\tlet result = true;\n\tstack.set(object, other);\n\tstack.set(other, object);\n\n\tlet skipCtor: boolean = !!isPartial;\n\twhile (++index < objLength) {\n\t\tconst key = objProps[index];\n\t\tconst objValue = object[key];\n\t\tconst othValue = other[key];\n\n\t\tlet compared;\n\t\tif (customizer) {\n\t\t\tcompared = isPartial\n\t\t\t\t? customizer(othValue, objValue, key, other, object, stack)\n\t\t\t\t: customizer(objValue, othValue, key, object, other, stack);\n\t\t}\n\t\t// Recursively compare objects (susceptible to call stack limits).\n\t\tif (!(compared === undefined\n\t\t\t? (objValue === othValue || equalFunc(objValue, othValue, bitmask, customizer, stack))\n\t\t\t: compared\n\t\t)) {\n\t\t\tresult = false;\n\t\t\tbreak;\n\t\t}\n\t\tskipCtor = (!skipCtor) ? key == \"constructor\" : skipCtor;\n\t}\n\tif (result && !skipCtor) {\n\t\tconst objCtor = object.constructor;\n\t\tconst othCtor = other.constructor;\n\n\t\t// Non `Object` object instances with different constructors are not equal.\n\t\tif (objCtor != othCtor &&\n\t\t\t(\"constructor\" in object && \"constructor\" in other) &&\n\t\t\t!(typeof objCtor == \"function\" && objCtor instanceof objCtor &&\n\t\t\t\ttypeof othCtor == \"function\" && othCtor instanceof othCtor)) {\n\t\t\tresult = false;\n\t\t}\n\t}\n\tstack[\"delete\"](object);\n\tstack[\"delete\"](other);\n\treturn result;\n}\n\nfunction getAllKeys(object: any): string[] {\n\treturn baseGetAllKeys(object, keys, getSymbols);\n}\n\nfunction getAllKeysIn(object: any): string[] {\n\treturn baseGetAllKeys(object, keysIn, getSymbolsIn);\n}\n\nfunction getMapData(map: any, key: string): any {\n\tconst data = map.__DATA__;\n\n\treturn isKeyable(key) ? data[typeof key === \"string\" ? \"string\" : \"hash\"]\n\t\t: data.map;\n}\n\nfunction getNative(object: any, key: string): any {\n\tconst value = getValue(object, key);\n\treturn baseIsNative(value) ? value : undefined;\n}\n\nfunction getRawTag(value: any): string {\n\tconst isOwn = hasOwnProperty.call(value, symToStringTag);\n\tconst tag = value[symToStringTag];\n\n\tlet unmasked = false;\n\n\ttry {\n\t\tvalue[symToStringTag] = undefined;\n\t\tunmasked = true;\n\t} catch (e) {\n\t\t// Intentionally do nothing\n\t}\n\n\tconst result = nativeObjectToString.call(value);\n\n\tif (unmasked) {\n\t\tif (isOwn) {\n\t\t\tvalue[symToStringTag] = tag;\n\t\t} else {\n\t\t\tdelete value[symToStringTag];\n\t\t}\n\t}\n\n\treturn result;\n}\n\nconst getSymbols: (source: any) => string[] = !nativeGetSymbols ? stubArray : function(object) {\n\tif (object == null) {\n\t\treturn [];\n\t}\n\tobject = Object(object);\n\treturn arrayFilter(nativeGetSymbols(object), function(symbol: any) {\n\t\treturn propertyIsEnumerable.call(object, symbol);\n\t});\n};\n\nconst getSymbolsIn: (source: any) => string[] = !nativeGetSymbols ? stubArray : function(object) {\n\tconst result = [];\n\n\twhile (object) {\n\t\tarrayPush(result, getSymbols(object));\n\t\tobject = getPrototype(object);\n\t}\n\n\treturn result;\n};\n\nlet getTag: (source: any) => string = baseGetTag;\n\n// Fallback for data views, maps, sets, and weak maps in IE 11 and promises in Node.js < 6.\nif ((DataView && getTag(new DataView(new ArrayBuffer(1))) !== dataViewTag) ||\n\t(Map && getTag(new Map()) !== mapTag) ||\n\t(Promise && getTag(Promise.resolve()) !== promiseTag) ||\n\t(Set && getTag(new Set()) !== setTag) ||\n\t(WeakMap && getTag(new WeakMap()) !== weakMapTag)) {\n\tgetTag = function(value) {\n\t\tconst result = baseGetTag(value);\n\t\tconst Ctor = result === objectTag ? value.constructor : undefined;\n\t\tconst ctorString = Ctor ? toSource(Ctor) : \"\";\n\n\t\tif (ctorString) {\n\t\t\tswitch (ctorString) {\n\t\t\t\tcase dataViewCtorString: return dataViewTag;\n\t\t\t\tcase mapCtorString: return mapTag;\n\t\t\t\tcase promiseCtorString: return promiseTag;\n\t\t\t\tcase setCtorString: return setTag;\n\t\t\t\tcase weakMapCtorString: return weakMapTag;\n\t\t\t}\n\t\t}\n\t\treturn result;\n\t};\n}\n\nfunction initCloneArray(array: any): any[] {\n\tconst length = array.length;\n\tconst result = new array.constructor(length);\n\n\t// Add properties assigned by `RegExp#exec`.\n\tif (length && typeof array[0] === \"string\" && hasOwnProperty.call(array, \"index\")) {\n\t\tresult.index = array.index;\n\t\tresult.input = array.input;\n\t}\n\treturn result;\n}\n\nfunction initCloneObject(object: any): any {\n\treturn (typeof object.constructor === \"function\" && !isPrototype(object))\n\t\t? baseCreate(getPrototype(object))\n\t\t: {};\n}\n\nfunction initCloneByTag(object: any, tag: string, isDeep: boolean): any {\n\tconst Ctor = object.constructor;\n\n\tswitch (tag) {\n\t\tcase arrayBufferTag:\n\t\t\treturn cloneArrayBuffer(object);\n\n\t\tcase boolTag:\n\t\tcase dateTag:\n\t\t\treturn new Ctor(+object);\n\n\t\tcase dataViewTag:\n\t\t\treturn cloneDataView(object, isDeep);\n\n\t\tcase float32Tag: case float64Tag:\n\t\tcase int8Tag: case int16Tag: case int32Tag:\n\t\tcase uint8Tag: case uint8ClampedTag: case uint16Tag: case uint32Tag:\n\t\t\treturn cloneTypedArray(object, isDeep);\n\n\t\tcase mapTag:\n\t\t\treturn new Ctor();\n\n\t\tcase numberTag:\n\t\tcase stringTag:\n\t\t\treturn new Ctor(object);\n\n\t\tcase regexpTag:\n\t\t\treturn cloneRegExp(object);\n\n\t\tcase setTag:\n\t\t\treturn new Ctor();\n\n\t\tcase symbolTag:\n\t\t\treturn cloneSymbol(object);\n\t}\n}\n\nfunction isIndex(value: any, length?: number): boolean {\n\tconst type = typeof value;\n\tlength = length == null ? MAX_SAFE_INTEGER : length;\n\n\treturn !!length &&\n\t\t(type === \"number\" ||\n\t\t\t(type !== \"symbol\" && reIsUint.test(value))) &&\n\t\t(value > -1 && value % 1 === 0 && value < length);\n}\n\nfunction isKeyable(value: any): boolean {\n\tconst type = typeof value;\n\n\treturn (type === \"string\" || type === \"number\" || type === \"symbol\" || type === \"boolean\")\n\t\t? (value !== \"__proto__\")\n\t\t: (value === null);\n}\n\nfunction isMasked(func: Function): boolean {\n\treturn !!maskSrcKey && (maskSrcKey in func);\n}\n\nfunction isPrototype(value: any): boolean {\n\tconst Ctor = value && value.constructor;\n\tconst proto = (typeof Ctor === \"function\" && Ctor.prototype) || objectProto;\n\n\treturn value === proto;\n}\n\nfunction nativeKeysIn(object: any): any[] {\n\tconst result = [];\n\n\tif (object != null) {\n\t\t/* tslint:disable-next-line */\n\t\tfor (const key in Object(object)) {\n\t\t\tresult.push(key);\n\t\t}\n\t}\n\n\treturn result;\n}\n\nfunction objectToString(value: any): string {\n\treturn nativeObjectToString.call(value);\n}\n\nfunction toSource(func: Function): string {\n\tif (func != null) {\n\t\ttry {\n\t\t\treturn funcToString.call(func);\n\t\t} catch (e) {\n\t\t\t// Intentionally do nothing\n\t\t}\n\t\ttry {\n\t\t\treturn (func + \"\");\n\t\t} catch (e) {\n\t\t\t// Intentionally do nothing\n\t\t}\n\t}\n\treturn \"\";\n}\n\nfunction memoize(func: Function, resolver: Function): Function {\n\tif (typeof func !== \"function\" || (resolver != null && typeof resolver !== \"function\")) {\n\t\tthrow new TypeError(FUNC_ERROR_TEXT);\n\t}\n\n\tconst memoized = function() {\n\t\tconst args = arguments;\n\t\tconst key = resolver ? resolver.apply(this, args) : args[0];\n\t\tconst cache = memoized[\"cache\"];\n\n\t\tif (cache.has(key)) {\n\t\t\treturn cache.get(key);\n\t\t}\n\n\t\tconst result = func.apply(this, args);\n\t\tmemoized[\"cache\"] = cache.set(key, result) || cache;\n\n\t\treturn result;\n\t};\n\n\tmemoized[\"cache\"] = new (memoize.Cache || MapCache)();\n\n\treturn memoized;\n}\n\n// Expose `MapCache`.\nmemoize.Cache = MapCache;\n\nfunction cloneDeep(value: any): any {\n\treturn baseClone(value, CLONE_DEEP_FLAG | CLONE_SYMBOLS_FLAG);\n}\n\nfunction eq(value: any, other: any): boolean {\n\treturn value === other || (value !== value && other !== other);\n}\n\nconst isArguments: (value: any) => boolean = baseIsArguments(function() { return arguments; }()) ? baseIsArguments : function(value) {\n\treturn isObjectLike(value) && hasOwnProperty.call(value, \"callee\") && !propertyIsEnumerable.call(value, \"callee\");\n};\n\nconst isArray: (value: any) => boolean = Array.isArray;\n\nfunction isArrayLike(value: any): boolean {\n\treturn value != null && isLength(value.length) && !isFunction(value);\n}\n\nconst isBuffer: (value: any) => boolean = nativeIsBuffer || stubFalse;\n\nfunction isEqual(value: any, other: any): boolean {\n\treturn baseIsEqual(value, other);\n}\n\nfunction isFunction(value: any): boolean {\n\tif (!isObject(value)) {\n\t\treturn false;\n\t}\n\n\tconst tag = baseGetTag(value);\n\n\treturn tag === funcTag || tag === genTag || tag === asyncTag || tag === proxyTag;\n}\n\nfunction isLength(value: any): boolean {\n\treturn typeof value === \"number\" && value > -1 && value % 1 === 0 && value <= MAX_SAFE_INTEGER;\n}\n\nfunction isObject(value: any): boolean {\n\tconst type = typeof value;\n\treturn value != null && (type === \"object\" || type === \"function\");\n}\n\nfunction isObjectLike(value: any): boolean {\n\treturn value != null && typeof value === \"object\";\n}\n\nconst isMap: (value: any) => boolean = baseIsMap;\n\nconst isSet: (value: any) => boolean = baseIsSet;\n\nconst isTypedArray: (value: any) => boolean = baseIsTypedArray;\n\nfunction keys(object: any): string[] {\n\treturn isArrayLike(object) ? arrayLikeKeys(object) : baseKeys(object);\n}\n\nfunction keysIn(object: any): string[] {\n\treturn isArrayLike(object) ? arrayLikeKeys(object, true) : baseKeysIn(object);\n}\n\nfunction stubArray(): any[] {\n\treturn [];\n}\n\nfunction stubFalse(): boolean {\n\treturn false;\n}\n\nconst encodeHtmlMap: any = {\n\t'\"': \"&quot;\",\n\t\"&\": \"&amp;\",\n\t\"'\": \"&#39;\",\n\t\"<\": \"&lt;\",\n\t\">\": \"&gt;\",\n};\n\nfunction lookupEncodeHtmlMap(key: string): string {\n\treturn encodeHtmlMap[key];\n}\n\nfunction encodeHtml(source: string): string {\n\treturn (source === null) ? null : (source + \"\").replace(/[&\"'<>]/g, lookupEncodeHtmlMap);\n}\n\nexport default {\n\tclone: function(source: any) {\n\t\treturn cloneDeep(source);\n\t},\n\tequals: function(first: any, second: any): boolean {\n\t\treturn isEqual(first, second);\n\t},\n\trequireNotNull: function<T>(value: T, name: string): T {\n\t\tif (value === null || value === undefined) {\n\t\t\tthrow new NullValueError(name + \" shall not be null\");\n\t\t}\n\n\t\treturn value;\n\t},\n\trequireValid: function(value: string, name: string, regex: RegExp): string {\n\t\tif (value === null || value === undefined) {\n\t\t\tthrow new NullValueError(name + \" shall not be null\");\n\t\t}\n\n\t\tif (!regex.test(value)) {\n\t\t\tthrow new ValidationError(name + \" must be valid\");\n\t\t}\n\n\t\treturn value;\n\t},\n\tisDefined(value: any): boolean {\n\t\treturn value !== null && value !== undefined;\n\t},\n\tencodeHtml: encodeHtml\n};\n","import Logger from \"@/logger/Logger\";\nimport ModelMediator from \"@/model/ModelMediator\";\nimport ObjectUtils from \"@/util/ObjectUtils\";\nimport PubSub from \"@/message/PubSub\";\nimport LoggerFactory from \"@/logger/LoggerFactory\";\nimport Module from \"@/module/Module\";\nimport { VALID_ID } from \"@/constant/ValidationRegExp\";\nimport Disposable from \"@/pattern/Disposable\";\nimport DigestionCandidateConsumer from \"@/mvvm/DigestionCandidateConsumer\";\nimport { OnContinuation } from \"@/message/Continuation\";\nimport { extractAttributes } from \"@/util/ParamUtils\";\nimport ElementMediatorDependencies from \"@/element/ElementMediatorDependencies\";\nimport { INTERNAL_CHANNEL_NAME } from \"@/constant/Constants\";\nimport Nestable from \"@/component/Nestable\";\nimport MediatorSource from \"@/mvvm/MediatorSource\";\nimport IdGenerator from \"@/pattern/IdGenerator\";\nimport PubSubImpl from \"@/message/PubSubImpl\";\n\nconst requireNotNull = ObjectUtils.requireNotNull;\nconst requireValid = ObjectUtils.requireValid;\n\n/**\n * The piece of code between the HTMLElement and the Mvvm\n * @type M {@link ModelMediator}\n * @type E extends HTMLElement\n * @implements {@link Disposable}\n */\nabstract class ElementMediator<M, E extends HTMLElement | Text, P> implements Disposable, MediatorSource {\n\n\tprivate logger: Logger;\n\n\t// tslint:disable-next-line\n\tprivate ____internal$$cydran____: ElementMediatorDependencies;\n\n\tprivate mediator: ModelMediator<M>;\n\n\tprivate pubSub: PubSub;\n\n\tprivate propagation: boolean;\n\n\tprivate domListeners: {\n\t\t[name: string]: any;\n\t};\n\n\tprivate id: string;\n\n\tprivate params: P;\n\n\tprivate reducerFn?: (input: any) => M;\n\n\tconstructor(dependencies: any, propagation: boolean, reducerFn: (input: any) => M) {\n\t\tthis.____internal$$cydran____ = requireNotNull(dependencies, \"dependencies\");\n\t\tthis.logger = LoggerFactory.getLogger(\"ElementMediator: \" + dependencies.prefix);\n\t\tthis.domListeners = {};\n\t\tthis.pubSub = new PubSubImpl(this, this.getModule());\n\t\tthis.params = null;\n\t\tthis.propagation = propagation;\n\t\tthis.id = IdGenerator.INSTANCE.generate();\n\t\tthis.reducerFn = reducerFn;\n\t}\n\n\t/**\n\t * Dispose of ElementMediator when released.\n\t * + All event listeners will be removed.\n\t * + This element mediator will be unwired from any other DOM entanglements\n\t * + The mediator reference to the model is released/nulled\n\t * + Any value representation of this element mediator is released/nulled\n\t * + The [[Mvvm|mvvm]] refernce is released/nulled\n\t * + The parental reference is released/nulled\n\t */\n\tpublic dispose(): void {\n\t\tthis.removeDomListeners();\n\t\tthis.unwire();\n\t\tthis.____internal$$cydran____ = null;\n\t\tthis.mediator = null;\n\t}\n\n\t/**\n\t * Initialize this element mediator.\n\t */\n\tpublic init(): void {\n\t\tthis.mediator = this.mediate(this.getExpression(), this.reducerFn);\n\t\tthis.wire();\n\t}\n\n\t/**\n\t * Get the active module instance reference by id\n\t * @return U\n\t */\n\tpublic get<U>(id: string): U {\n\t\trequireValid(id, \"id\", VALID_ID);\n\t\treturn this.____internal$$cydran____.module.get(id);\n\t}\n\n\t// /**\n\t//  * Set the [[Module|module]] instance reference\n\t//  * @param {Module} moduleInstance\n\t//  */\n\t// public setModule(moduleInstance: Module): void {\n\t// \tthis.moduleInstance = requireNotNull(moduleInstance, \"moduleInstance\");\n\t// }\n\n\t/**\n\t * [message description]\n\t * @param {string} channelName [description]\n\t * @param {string} messageName [description]\n\t * @param {any}    payload     [description]\n\t */\n\tpublic message(channelName: string, messageName: string, payload?: any): void {\n\t\trequireNotNull(channelName, \"channelName\");\n\t\trequireNotNull(messageName, \"messageName\");\n\t\tconst actualPayload: any = (payload === null || payload === undefined) ? {} : payload;\n\t\tthis.pubSub.message(channelName, messageName, actualPayload);\n\t}\n\n\t/**\n\t * Broadcast a message\n\t * @param {string} channelName [description]\n\t * @param {string} messageName [description]\n\t * @param {any}    payload     [description]\n\t */\n\tpublic broadcast(channelName: string, messageName: string, payload?: any): void {\n\t\trequireNotNull(channelName, \"channelName\");\n\t\trequireNotNull(messageName, \"messageName\");\n\t\tconst actualPayload: any = (payload === null || payload === undefined) ? {} : payload;\n\t\tthis.getModule().broadcast(channelName, messageName, actualPayload);\n\t}\n\n\t/**\n\t * Broadcast a message in the Global context\n\t * @param {string} channelName [description]\n\t * @param {string} messageName [description]\n\t * @param {any}    payload     [description]\n\t */\n\tpublic broadcastGlobally(channelName: string, messageName: string, payload?: any): void {\n\t\trequireNotNull(channelName, \"channelName\");\n\t\trequireNotNull(messageName, \"messageName\");\n\t\tconst actualPayload: any = (payload === null || payload === undefined) ? {} : payload;\n\t\tthis.____internal$$cydran____.module.broadcastGlobally(channelName, messageName, actualPayload);\n\t}\n\n\tpublic on(messageName: string): OnContinuation {\n\t\trequireNotNull(messageName, \"messageName\");\n\n\t\treturn {\n\t\t\tforChannel: (channelName: string) => {\n\t\t\t\trequireNotNull(channelName, \"channelName\");\n\n\t\t\t\treturn {\n\t\t\t\t\tinvoke: (target: (payload: any) => void) => {\n\t\t\t\t\t\trequireNotNull(target, \"target\");\n\t\t\t\t\t\tthis.pubSub.on(messageName).forChannel(channelName).invoke((payload: any) => {\n\t\t\t\t\t\t\ttarget.apply(this, [payload]);\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t},\n\t\t\tinvoke: (target: (payload: any) => void) => {\n\t\t\t\trequireNotNull(target, \"target\");\n\t\t\t\tthis.pubSub.on(messageName).forChannel(INTERNAL_CHANNEL_NAME).invoke((payload: any) => {\n\t\t\t\t\ttarget.apply(this, [payload]);\n\t\t\t\t});\n\t\t\t}\n\t\t};\n\t}\n\n\tpublic requestMediatorSources(sources: MediatorSource[]): void {\n\t\t// Intentionally do nothing by default\n\t}\n\n\tpublic getParentId(): string {\n\t\treturn this.____internal$$cydran____.mvvm.getId();\n\t}\n\n\tpublic getId(): string {\n\t\treturn this.id;\n\t}\n\n\tpublic requestMediators(consumer: DigestionCandidateConsumer): void {\n\t\t// Intentionally do nothing by default\n\t}\n\n\tpublic hasPropagation(): boolean {\n\t\treturn this.propagation;\n\t}\n\n\tprotected getParams(): P {\n\t\tif (this.params === null) {\n\t\t\tthis.params = extractAttributes<P>(this.getPrefix(), this.getEl() as HTMLElement);\n\t\t}\n\n\t\treturn this.params;\n\t}\n\n\tprotected getModelFn(): () => any {\n\t\treturn this.____internal$$cydran____.mvvm.getModelFn();\n\t}\n\n\tprotected getExternalFn(): () => any {\n\t\treturn this.____internal$$cydran____.mvvm.getExternalFn();\n\t}\n\n\tprotected bridge(name: string): void {\n\t\trequireNotNull(name, \"name\");\n\n\t\tconst listener = (event: Event) => {\n\t\t\tthis.message(\"dom\", name, event);\n\t\t};\n\n\t\tif (!this.domListeners[name]) {\n\t\t\tthis.domListeners[name] = listener;\n\t\t\tthis.getEl().addEventListener(name, listener, false);\n\t\t}\n\t}\n\n\t/**\n\t * Get the associated {HTMLElement html element} of this element mediator.\n\t * @return {HTMLElement} [description]\n\t */\n\tprotected getEl(): E {\n\t\treturn this.____internal$$cydran____.el as E;\n\t}\n\n\t/**\n\t * [getModule description]\n\t * @return {Module} [description]\n\t */\n\tprotected getModule(): Module {\n\t\treturn this.____internal$$cydran____.module;\n\t}\n\n\t/**\n\t * Gets the prefix.\n\t * @return the prefix\n\t */\n\tprotected getPrefix(): string {\n\t\treturn this.____internal$$cydran____.prefix;\n\t}\n\n\t/**\n\t * [mediate description]\n\t * @param  {string}        expression [description]\n\t * @return {ModelMediator}            [description]\n\t */\n\tprotected mediate<T>(expression: string, reducerFn?: (input: any) => T): ModelMediator<T> {\n\t\trequireNotNull(expression, \"expression\");\n\t\treturn this.____internal$$cydran____.mvvm.mediate(expression, reducerFn);\n\t}\n\n\t/**\n\t * [getModel description]\n\t * @return {any} [description]\n\t */\n\tprotected getModel(): any {\n\t\treturn this.____internal$$cydran____.model;\n\t}\n\n\t/**\n\t * [getParent description]\n\t * @return {Component} [description]\n\t */\n\tprotected getParent(): Nestable {\n\t\treturn this.____internal$$cydran____.parent.getComponent();\n\t}\n\n\t/**\n\t * [getMediator description]\n\t * @return {ModelMediator} [description]\n\t */\n\tprotected getModelMediator(): ModelMediator<M> {\n\t\treturn this.mediator;\n\t}\n\n\tprotected $apply(fn: Function, args: any[]): any {\n\t\trequireNotNull(fn, \"fn\");\n\t\trequireNotNull(args, \"args\");\n\n\t\tif (this.____internal$$cydran____ && this.____internal$$cydran____.mvvm) {\n\t\t\tthis.____internal$$cydran____.mvvm.$apply(fn, args);\n\t\t}\n\t}\n\n\t/**\n\t * Get the expression specified\n\t * @return {string} [description]\n\t */\n\tprotected getExpression(): string {\n\t\treturn this.____internal$$cydran____.expression;\n\t}\n\n\t/**\n\t * Gets the logger.\n\t * @return {Logger} logger instance\n\t */\n\tprotected getLogger(): Logger {\n\t\treturn this.logger;\n\t}\n\n\t/**\n\t * Wire the element mediator\n\t */\n\tprotected abstract wire(): void;\n\n\t/**\n\t * Unwire the element mediator\n\t */\n\tprotected abstract unwire(): void;\n\n\tprivate removeDomListeners(): void {\n\t\tfor (const name in this.domListeners) {\n\t\t\tif (!this.domListeners.hasOwnProperty(name)) {\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tthis.getEl().removeEventListener(name, this.domListeners[name]);\n\t\t}\n\n\t\tthis.domListeners = {};\n\t}\n\n}\n\nexport default ElementMediator;\n","import Logger from \"@/logger/Logger\";\nimport LoggerImpl from \"@/logger/LoggerImpl\";\nimport LoggerServiceImpl from \"@/logger/LoggerServiceImpl\";\n\nclass LoggerFactory {\n\n\t/**\n\t * Get the named logger\n\t * @param name of the associated logger\n\t */\n\tpublic static getLogger(name: string): Logger {\n\t\treturn new LoggerImpl(name, LoggerServiceImpl.INSTANCE);\n\t}\n\n}\n\nexport default LoggerFactory;\n","const INTERNAL_DIRECT_CHANNEL_NAME: string = \"Cydran$$Direct$$Internal$$Channel\";\nconst TEXT_NODE_TYPE: number = 3;\nconst MODULE_FIELD_NAME: string = \"____internal$$cydran$$module____\";\nconst INTERNAL_CHANNEL_NAME: string = \"Cydran$$Internal$$Channel\";\nconst COMPONENT_INTERNALS_FIELD_NAME: string = \"____internal$$cydran____\";\nconst DEFAULT_MODULE_KEY: string = \"DEFAULT\";\n\nfunction NO_OP_FN() {\n\t// Intentionally do nothing\n}\n\nfunction EMPTY_OBJECT_FN() {\n\treturn {};\n}\n\nexport {\n\tCOMPONENT_INTERNALS_FIELD_NAME,\n\tDEFAULT_MODULE_KEY,\n\tINTERNAL_DIRECT_CHANNEL_NAME,\n\tINTERNAL_CHANNEL_NAME,\n\tMODULE_FIELD_NAME,\n\tTEXT_NODE_TYPE,\n\tNO_OP_FN,\n\tEMPTY_OBJECT_FN\n};\n","import ObjectUtils from \"@/util/ObjectUtils\";\nimport SimpleMap from \"@/pattern/SimpleMap\";\nimport Type from \"@/type/Type\";\nimport ElementMediator from \"@/element/ElementMediator\";\n\nconst requireNotNull = ObjectUtils.requireNotNull;\n\nclass Factories {\n\n\tpublic static register(name: string, supportedTags: string[], elementMediatorClass: Type<ElementMediator<any, HTMLElement | Text, any>>): void {\n\t\trequireNotNull(name, \"name\");\n\t\trequireNotNull(supportedTags, \"supportedTags\");\n\t\trequireNotNull(elementMediatorClass, \"elementMediatorClass\");\n\n\t\tif (!Factories.factories[name]) {\n\t\t\tFactories.factories[name] = {};\n\t\t}\n\n\t\tfor (const supportedTag of supportedTags) {\n\t\t\tFactories.factories[name][supportedTag] = elementMediatorClass;\n\t\t}\n\t}\n\n\tpublic static get<T>(type: string): T {\n\t\treturn (Factories.factories[type] as any) as T;\n\t}\n\n\tprivate static factories: SimpleMap<SimpleMap<new () => any>> = {};\n\n}\n\nexport default Factories;\n","abstract class CydranError extends Error {\n\n\tprivate static doMsgFilling(msg: string, reps: any): string {\n\t\treturn msg.replace(/%\\w+%/g, (all: string) => (reps[all] + \"\") || all);\n\t}\n\n\tpublic readonly message: string;\n\n\t/**\n\t * Constructor\n\t *\n\t * @param msg string object specific to context\n\t * @param reps optional {key:value, <n^1>} object of named substitution values\n\t * @returns string filled in values in the mesage\n\t */\n\tconstructor(msg: string, reps?: any) {\n\t\tsuper();\n\n\t\tthis.name = new.target.name;\n\t\tthis.message = (reps) ? CydranError.doMsgFilling(msg, reps) : msg;\n\t}\n\n}\n\nexport { CydranError };\n","import ObjectUtils from \"@/util/ObjectUtils\";\n\nconst isDefined = ObjectUtils.isDefined;\n\nfunction asIdentity(input: any): any {\n\treturn input;\n}\n\nfunction asBoolean(input: any): boolean {\n\treturn Boolean(input);\n}\n\nfunction asString(input: any): string {\n\treturn isDefined(input) ? ('' + input) : null;\n}\n\nfunction asNumber(input: any): number {\n\treturn isDefined(input) ? Number(input) : null;\n}\n\nexport { asIdentity, asBoolean, asString, asNumber };\n","const VALID_ID: RegExp = /^[a-zA-Z][a-zA-Z0-9\\$\\@\\-\\_\\.\\:\\\\\\/]*$/m;\nconst VALID_KEY: RegExp = new RegExp(/^[a-zA-Z\\$\\_][a-zA-Z0-9\\$\\_]*$/);\n\nexport { VALID_ID, VALID_KEY };\n","class Properties {\n\n\tpublic static setWindow(instance: Window): void {\n\t\tProperties.window = instance;\n\t}\n\n\tpublic static getWindow(): Window {\n\t\treturn Properties.window || global[\"window\"];\n\t}\n\n\tprivate static window: Window;\n\n}\n\nexport default Properties;\n","import ObjectUtils from \"@/util/ObjectUtils\";\nimport Module from \"@/module/Module\";\n\nconst requireNotNull = ObjectUtils.requireNotNull;\n\ninterface ComponentIdPair {\n\n\tcomponentId: string;\n\n\tmoduleId: string;\n\n}\n\ninterface ComponentConfig {\n\n\tgetMetadata(key: string): any;\n\n\tgetPrefix(): string;\n\n\tgetAttributes(): string[];\n\n}\n\nclass ComponentConfigImpl implements ComponentConfig {\n\n\tprivate metadata: any;\n\n\tprivate attributes: string[];\n\n\tprivate prefix: string;\n\n\tprivate topComponentIds: ComponentIdPair[];\n\n\tprivate bottomComponentIds: ComponentIdPair[];\n\n\tprivate parentModelFn: () => any;\n\n\tprivate module: Module;\n\n\tconstructor() {\n\t\tthis.metadata = {};\n\t\tthis.attributes = [];\n\t\tthis.prefix = \"c\";\n\t\tthis.topComponentIds = [];\n\t\tthis.bottomComponentIds = [];\n\t\tthis.parentModelFn = null;\n\t}\n\n\tpublic getMetadata(key: string): any {\n\t\treturn this.metadata[key] ? this.metadata[key] : null;\n\t}\n\n\tpublic getPrefix(): string {\n\t\treturn this.prefix;\n\t}\n\n\tpublic getAttributes(): string[] {\n\t\treturn this.attributes.slice();\n\t}\n\n\tpublic withMetadata(name: string, value: any): void {\n\t\tthis.metadata[name] = value;\n\t}\n\n\tpublic withAttribute(name: string): void {\n\t\tthis.attributes.push(name);\n\t}\n\n\tpublic withPrefix(prefix: string): void {\n\t\tthis.prefix = prefix;\n\t}\n\n\tpublic setTopComponentIds(topComponentIds: ComponentIdPair[]): void {\n\t\tthis.topComponentIds = topComponentIds;\n\t}\n\n\tpublic setBottomComponentIds(bottomComponentIds: ComponentIdPair[]): void {\n\t\tthis.bottomComponentIds = bottomComponentIds;\n\t}\n\n\tpublic getTopComponentIds(): ComponentIdPair[] {\n\t\treturn this.topComponentIds;\n\t}\n\n\tpublic getBottomComponentIds(): ComponentIdPair[] {\n\t\treturn this.bottomComponentIds;\n\t}\n\n\tpublic setModule(module: Module): void {\n\t\tthis.module = module;\n\t}\n\n\tpublic getModule(): Module {\n\t\treturn this.module;\n\t}\n\n\tpublic setParentModelFn(parentModelFn: () => any): void {\n\t\tthis.parentModelFn = parentModelFn;\n\t}\n\n\tpublic getParentModelFn(): () => any {\n\t\treturn this.parentModelFn;\n\t}\n\n}\n\nclass ComponentConfigBuilder {\n\n\tprivate instance: ComponentConfigImpl;\n\n\tconstructor() {\n\t\tthis.instance = new ComponentConfigImpl();\n\t}\n\n\tpublic withMetadata(name: string, value: any): ComponentConfigBuilder {\n\t\trequireNotNull(name, \"name\");\n\t\trequireNotNull(value, \"value\");\n\t\tthis.instance.withMetadata(name, value);\n\n\t\treturn this;\n\t}\n\n\tpublic withAttribute(name: string): ComponentConfigBuilder {\n\t\trequireNotNull(name, \"name\");\n\t\tthis.instance.withAttribute(name);\n\n\t\treturn this;\n\t}\n\n\tpublic withPrefix(prefix: string): ComponentConfigBuilder {\n\t\trequireNotNull(prefix, \"prefix\");\n\t\tthis.instance.withPrefix(prefix);\n\n\t\treturn this;\n\t}\n\n\tpublic build(): ComponentConfig {\n\t\treturn this.instance;\n\t}\n\n}\n\nexport { ComponentConfig, ComponentConfigImpl, ComponentConfigBuilder, ComponentIdPair };\n","import ObjectUtils from \"@/util/ObjectUtils\";\nimport ComponentInternals from \"@/component/ComponentInternals\";\nimport { ComponentConfig } from \"@/component/ComponentConfig\";\nimport MetadataContinuation from \"@/component/MetadataContinuation\";\nimport Scope from \"@/model/Scope\";\nimport { OnContinuation } from \"@/message/Continuation\";\nimport { INTERNAL_CHANNEL_NAME, MODULE_FIELD_NAME } from \"@/constant/Constants\";\nimport Logger from \"@/logger/Logger\";\nimport Nestable from \"@/component/Nestable\";\nimport ComponentInternalsImpl from \"@/component/ComponentInternalsImpl\";\nimport NamedElementOperations from \"@/component/NamedElementOperations\";\n\nconst requireNotNull = ObjectUtils.requireNotNull;\n\n/**\n * Core class for Cydran\n */\nclass Component implements Nestable {\n\n\t// tslint:disable-next-line\n\tprivate ____internal$$cydran____: ComponentInternals;\n\n\t// tslint:disable-next-line\n\tprivate ____internal$$cydran$$module____: any;\n\n\t/**\n\t * Constructor\n\t * @param template - string value representation of a template\n\t * @param config - optional {@link ComponentConfig} argument\n\t */\n\tconstructor(template: string, config?: ComponentConfig) {\n\t\tthis.____internal$$cydran$$init____(template, config);\n\t}\n\n\t/**\n\t * Get the {@link MetadataContinuation} of the {@link Component}\n\t */\n\tpublic metadata(): MetadataContinuation {\n\t\tconst internal: ComponentInternals = this.____internal$$cydran____;\n\n\t\treturn {\n\t\t\tget: (name: string) => internal.getMetadata(name),\n\t\t\thas: (name: string) => internal.hasMetadata(name)\n\t\t};\n\t}\n\n\t/**\n\t * Component has a {@link Region}\n\t * @returns boolean - true | false\n\t */\n\tpublic hasRegion(name: string): boolean {\n\t\treturn this.____internal$$cydran____.hasRegion(name);\n\t}\n\n\t/**\n\t * Get a child component from a region.\n\t * @param name - string name value of the child {@link Component}\n\t * @returns Component instance, or null\n\t */\n\tpublic getChild<N extends Nestable>(name: string): N {\n\t\treturn this.____internal$$cydran____.getChild(name);\n\t}\n\n\t/**\n\t * Set a child component into a region.\n\t * @param name - string name value of the child {@link Component}\n\t * @param component - the {@link Component} reference\n\t */\n\tpublic setChild(name: string, component: Nestable): void {\n\t\tthis.____internal$$cydran____.setChild(name, component);\n\t}\n\n\tpublic setChildFromRegistry(name: string, componentName: string, defaultComponentName?: string): void {\n\t\tthis.____internal$$cydran____.setChildFromRegistry(name, componentName, defaultComponentName);\n\t}\n\n\tpublic message(channelName: string, messageName: string, payload?: any): void {\n\t\tthis.____internal$$cydran____.message(channelName, messageName, payload);\n\t}\n\n\tpublic dispose(): void {\n\t\tthis.____internal$$cydran____.dispose();\n\t}\n\n\tpublic getParent(): Nestable {\n\t\treturn this.____internal$$cydran____.getParent();\n\t}\n\n\tpublic getEl(): HTMLElement {\n\t\treturn this.____internal$$cydran____.getEl();\n\t}\n\n\tpublic get<T>(id: string): T {\n\t\treturn this.____internal$$cydran____.get(id);\n\t}\n\n\tpublic scope(): Scope {\n\t\treturn this.____internal$$cydran____.getScope();\n\t}\n\n\tpublic getPrefix(): string {\n\t\treturn this.____internal$$cydran____.getPrefix();\n\t}\n\n\tpublic isConnected(): boolean {\n\t\treturn this.____internal$$cydran____.isConnected();\n\t}\n\n\tpublic getId(): string {\n\t\treturn this.____internal$$cydran____.getId();\n\t}\n\n\tpublic forElement<E extends HTMLElement>(name: string): NamedElementOperations<E> {\n\t\treturn this.____internal$$cydran____.forElement(name);\n\t}\n\n\t/**\n\t * @deprecated\n\t */\n\tprotected getItem<T>(): T {\n\t\treturn this.____internal$$cydran____.getData() as T;\n\t}\n\n\tprotected getValue<T>(): T {\n\t\treturn this.____internal$$cydran____.getData() as T;\n\t}\n\n\tprotected getExternals<T>(): T {\n\t\treturn this.____internal$$cydran____.getExternalCache() as T;\n\t}\n\n\tprotected broadcast(channelName: string, messageName: string, payload?: any): void {\n\t\tthis.____internal$$cydran____.broadcast(channelName, messageName, payload);\n\t}\n\n\tprotected broadcastGlobally(channelName: string, messageName: string, payload?: any): void {\n\t\tthis.____internal$$cydran____.broadcastGlobally(channelName, messageName, payload);\n\t}\n\n\tprotected $apply(fn?: Function, args?: any[]): void {\n\t\tthis.____internal$$cydran____.$apply(fn, args);\n\t}\n\n\tprotected watch<T>(expression: string, target: (previous: T, current: T) => void, reducerFn?: (input: any) => T): void {\n\t\tthis.____internal$$cydran____.watch(expression, target, reducerFn);\n\t}\n\n\tprotected on(messageName: string): OnContinuation {\n\t\trequireNotNull(messageName, \"messageName\");\n\n\t\treturn {\n\t\t\tforChannel: (channelName: string) => {\n\t\t\t\trequireNotNull(channelName, \"channelName\");\n\n\t\t\t\treturn {\n\t\t\t\t\tinvoke: (target: (payload: any) => void) => {\n\t\t\t\t\t\trequireNotNull(target, \"target\");\n\t\t\t\t\t\tthis.____internal$$cydran____.on(target, messageName, channelName);\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t},\n\t\t\tinvoke: (target: (payload: any) => void) => {\n\t\t\t\trequireNotNull(target, \"target\");\n\t\t\t\tthis.____internal$$cydran____.on(target, messageName, INTERNAL_CHANNEL_NAME);\n\t\t\t}\n\t\t};\n\t}\n\n\tprotected getLogger(): Logger {\n\t\treturn this.____internal$$cydran____.getLogger();\n\t}\n\n\tprotected ____internal$$cydran$$init____(template: string, config: ComponentConfig): void {\n\t\tthis.____internal$$cydran____ = new ComponentInternalsImpl(this, template, config);\n\t\tthis.____internal$$cydran____.init();\n\t}\n\n}\n\nexport default Component;\n","enum Level {\n\tTRACE,\n\tDEBUG,\n\tINFO,\n\tWARN,\n\tERROR,\n\tFATAL,\n\tDISABLED\n}\n\nexport default Level;\n","import { OnContinuation } from \"@/message/Continuation\";\nimport Listener from \"@/message/Listener\";\nimport ListenerImpl from \"@/message/ListenerImpl\";\nimport Module from \"@/module/Module\";\nimport ObjectUtils from \"@/util/ObjectUtils\";\nimport { INTERNAL_CHANNEL_NAME, INTERNAL_DIRECT_CHANNEL_NAME } from \"@/constant/Constants\";\nimport Logger from \"@/logger/Logger\";\nimport LoggerFactory from \"@/logger/LoggerFactory\";\nimport PubSub from \"@/message/PubSub\";\n\nconst requireNotNull = ObjectUtils.requireNotNull;\n\nclass PubSubImpl implements PubSub {\n\n\tprivate logger: Logger;\n\n\tprivate listeners: Listener[];\n\n\tprivate listenersByChannel: {};\n\n\tprivate module: Module;\n\n\tprivate context: any;\n\n\tprivate globalEnabled: boolean;\n\n\tconstructor(context: any, module: Module) {\n\t\tthis.context = context;\n\t\tthis.module = module;\n\t\tthis.logger = LoggerFactory.getLogger(\"PubSub\");\n\t\tthis.globalEnabled = false;\n\t\tthis.listeners = [];\n\t\tthis.listenersByChannel = {};\n\t}\n\n\tpublic setContext(context: any): void {\n\t\tthis.context = context;\n\t}\n\n\tpublic setModule(module: Module): void {\n\t\tthis.module = module;\n\t}\n\n\tpublic message(channelName: string, messageName: string, payload?: any): void {\n\t\trequireNotNull(channelName, \"channelName\");\n\t\trequireNotNull(messageName, \"messageName\");\n\n\t\tconst actualPayload: any = (payload === null || payload === undefined) ? {} : payload;\n\n\t\tthis.listeners.forEach((listener) => {\n\t\t\tif (channelName === listener.getChannelName()) {\n\t\t\t\tlistener.receive(messageName, actualPayload);\n\t\t\t}\n\t\t});\n\t}\n\n\tpublic broadcast(channelName: string, messageName: string, payload?: any): void {\n\t\trequireNotNull(channelName, \"channelName\");\n\t\trequireNotNull(messageName, \"messageName\");\n\n\t\tconst actualPayload: any = (payload === null || payload === undefined) ? {} : payload;\n\t\tthis.module.broadcast(channelName, messageName, actualPayload);\n\t}\n\n\tpublic broadcastGlobally(channelName: string, messageName: string, payload?: any): void {\n\t\tthis.module.broadcastGlobally(channelName, messageName, payload);\n\t}\n\n\tpublic dispose(): void {\n\t\tthis.disableGlobal();\n\t\tthis.listeners = [];\n\t\tthis.listenersByChannel = {};\n\t}\n\n\tpublic on(messageName: string): OnContinuation {\n\t\trequireNotNull(messageName, \"messageName\");\n\n\t\tconst mine: PubSubImpl = this;\n\n\t\treturn {\n\t\t\tforChannel: (channelName: string) => {\n\t\t\t\trequireNotNull(channelName, \"channelName\");\n\n\t\t\t\treturn {\n\t\t\t\t\tinvoke: (target: (payload: any) => void) => {\n\t\t\t\t\t\trequireNotNull(target, \"target\");\n\t\t\t\t\t\tmine.listenTo(channelName, messageName, target);\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t},\n\t\t\tinvoke: (target: (payload: any) => void) => {\n\t\t\t\trequireNotNull(target, \"target\");\n\t\t\t\tmine.listenTo(INTERNAL_CHANNEL_NAME, messageName, target);\n\t\t\t}\n\t\t};\n\t}\n\n\tpublic enableGlobal(): void {\n\t\tif (this.globalEnabled) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.logger.trace(\"Enabling global\");\n\n\t\tfor (const listener of this.listeners) {\n\t\t\tthis.module.message(INTERNAL_DIRECT_CHANNEL_NAME, \"addListener\", listener);\n\t\t}\n\n\t\tthis.globalEnabled = true;\n\t}\n\n\tpublic disableGlobal(): void {\n\t\tif (!this.globalEnabled) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.logger.trace(\"Disabling global\");\n\n\t\tfor (const listener of this.listeners) {\n\t\t\tthis.module.message(INTERNAL_DIRECT_CHANNEL_NAME, \"removeListener\", listener);\n\t\t}\n\n\t\tthis.globalEnabled = false;\n\t}\n\n\tpublic listenTo(channel: string, messageName: string, target: (payload: any) => void): void {\n\t\tlet listener: Listener = this.listenersByChannel[channel];\n\n\t\tif (!listener) {\n\t\t\tlistener = new ListenerImpl(channel, this.context);\n\n\t\t\tif (this.globalEnabled) {\n\t\t\t\tthis.module.message(INTERNAL_DIRECT_CHANNEL_NAME, \"addListener\", listener);\n\t\t\t}\n\n\t\t\tthis.listeners.push(listener);\n\t\t}\n\n\t\tlistener.register(messageName, target);\n\t}\n\n\tpublic isGlobalEnabled(): boolean {\n\t\treturn this.globalEnabled;\n\t}\n\n}\n\nexport default PubSubImpl;\n","import NullValueError from \"@/error/NullValueError\";\nimport ScopeError from \"@/error/ScopeError\";\nimport Scope from \"@/model/Scope\";\nimport SimpleMap from \"@/pattern/SimpleMap\";\nimport { VALID_KEY } from \"@/constant/ValidationRegExp\";\n\nconst EXCLUSIONS: SimpleMap<string> = {\n\te: \"e\",\n\texternal: \"external\",\n\ti: \"i\",\n\titem: \"item\",\n\tv: \"v\",\n\tvalue: \"value\",\n\tm: \"m\",\n\tmodel: \"model\",\n\tp: \"p\",\n\tparent: \"parent\"\n};\n\nclass ScopeImpl implements Scope {\n\n\tprivate code: string;\n\n\tprivate children: ScopeImpl[];\n\n\tprivate localItems: SimpleMap<any>;\n\n\tprivate items: SimpleMap<any>;\n\n\tprivate parent: ScopeImpl;\n\n\tprivate restricted: boolean;\n\n\tconstructor(restricted?: boolean) {\n\t\tthis.children = [];\n\t\tthis.localItems = {};\n\t\tthis.items = {};\n\t\tthis.code = \"\";\n\t\tthis.parent = null;\n\t\tthis.restricted = (restricted === null || restricted === undefined) || restricted;\n\t}\n\n\tpublic setParent(parent: ScopeImpl): void {\n\t\tif (!parent) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.parent) {\n\t\t\tthis.parent.removeChild(this);\n\t\t}\n\n\t\tthis.parent = parent;\n\t\tthis.parent.addChild(this);\n\t\tthis.refresh();\n\t}\n\n\tpublic addChild(child: ScopeImpl): void {\n\t\tif (child) {\n\t\t\tthis.children.push(child);\n\t\t}\n\t}\n\n\tpublic removeChild(child: ScopeImpl): void {\n\t\tconst index: number = this.children.indexOf(child);\n\n\t\tif (index >= 0) {\n\t\t\tthis.children.splice(index, 1);\n\t\t}\n\t}\n\n\tpublic getItems(): SimpleMap<any> {\n\t\treturn this.items;\n\t}\n\n\tpublic getCode(): string {\n\t\treturn this.code;\n\t}\n\n\tpublic add(name: string, item: any): void {\n\t\tthis.checkName(name);\n\t\tthis.localItems[name] = item;\n\t\tthis.refresh();\n\t\tthis.refreshChildren();\n\t}\n\n\tpublic remove(name: string): void {\n\t\tthis.checkName(name);\n\t\tdelete this.localItems[name];\n\t\tthis.refresh();\n\t\tthis.refreshChildren();\n\t}\n\n\tprivate checkName(name: string): void {\n\t\tif (name === null || name === undefined) {\n\t\t\tthrow new NullValueError(\"name must not be null or undefined.\");\n\t\t}\n\n\t\tif (!VALID_KEY.test(name)) {\n\t\t\tthrow new ScopeError(\"Only objects with names containing letters and numbers and starting with a letter are allowed.\");\n\t\t}\n\n\t\tif (this.restricted && EXCLUSIONS[name]) {\n\t\t\tthrow new ScopeError(name + \" is a reserved name in the scope.\");\n\t\t}\n\t}\n\n\tprivate refresh(): void {\n\t\tthis.items = {};\n\n\t\tif (this.parent) {\n\t\t\tconst parentItems: SimpleMap<any> = this.parent.getItems();\n\n\t\t\tfor (const key in parentItems) {\n\t\t\t\tif (!parentItems.hasOwnProperty(key)) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tthis.items[key] = parentItems[key];\n\t\t\t}\n\t\t}\n\n\t\tfor (const key in this.localItems) {\n\t\t\tif (!this.localItems.hasOwnProperty(key)) {\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tthis.items[key] = this.localItems[key];\n\t\t}\n\n\t\tthis.refreshCode();\n\t}\n\n\tprivate refreshCode(): void {\n\t\tthis.code = \"\";\n\n\t\tfor (const key in this.items) {\n\t\t\tif (!this.items.hasOwnProperty(key)) {\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tconst statement: string = \"var \" + key + \" = arguments[0]['\" + key + \"'];\\n\";\n\t\t\tthis.code += statement;\n\t\t}\n\t}\n\n\tprivate refreshChildren(): void {\n\t\tfor (const child of this.children) {\n\t\t\tchild.refresh();\n\t\t}\n\t}\n\n}\n\nexport default ScopeImpl;\n","const Events: any = {\n\tAFTER_CHILD_ADDED: \"AFTER_CHILD_ADDED\",\n\tAFTER_CHILD_CHANGED: \"AFTER_CHILD_CHANGED\",\n\tAFTER_CHILD_REMOVED: \"AFTER_CHILD_REMOVED\",\n\tAFTER_PARENT_ADDED: \"AFTER_PARENT_ADDED\",\n\tAFTER_PARENT_CHANGED: \"AFTER_PARENT_CHANGED\",\n\tAFTER_PARENT_REMOVED: \"AFTER_PARENT_REMOVED\",\n\tBEFORE_CHILD_ADDED: \"BEFORE_CHILD_ADDED\",\n\tBEFORE_CHILD_CHANGED: \"BEFORE_CHILD_CHANGED\",\n\tBEFORE_CHILD_REMOVED: \"BEFORE_CHILD_REMOVED\",\n\tBEFORE_DISPOSE: \"BEFORE_DISPOSE\",\n\tBEFORE_PARENT_ADDED: \"BEFORE_PARENT_ADDED\",\n\tBEFORE_PARENT_CHANGED: \"BEFORE_PARENT_CHANGED\",\n\tBEFORE_PARENT_REMOVED: \"BEFORE_PARENT_REMOVED\",\n\tCOMPONENT_NESTING_CHANGED: \"COMPONENT_NESTING_CHANGED\"\n};\n\nexport default Events;\n","import TemplateError from \"@/error/TemplateError\";\nimport Properties from \"@/config/Properties\";\nimport Region from \"@/component/Region\";\nimport Logger from \"@/logger/Logger\";\nimport Scope from \"@/model/Scope\";\nimport UnknownRegionError from \"@/error/UnknownRegionError\";\nimport { VALID_ID } from \"@/constant/ValidationRegExp\";\nimport ObjectUtils from \"@/util/ObjectUtils\";\nimport SimpleMap from \"@/pattern/SimpleMap\";\nimport ScopeImpl from \"@/model/ScopeImpl\";\nimport PubSub from \"@/message/PubSub\";\nimport LoggerFactory from \"@/logger/LoggerFactory\";\nimport SetComponentError from \"@/error/SetComponentError\";\nimport { INTERNAL_DIRECT_CHANNEL_NAME, INTERNAL_CHANNEL_NAME, MODULE_FIELD_NAME, NO_OP_FN, EMPTY_OBJECT_FN } from \"@/constant/Constants\";\nimport { ComponentConfigBuilder, ComponentConfig, ComponentConfigImpl } from \"@/component/ComponentConfig\";\nimport Events from \"@/constant/Events\";\nimport ComponentFlags from \"@/component/ComponentFlags\";\nimport Mvvm from \"@/mvvm/Mvvm\";\nimport ExternalMediator from \"@/model/ExternalMediator\";\nimport MvvmImpl from \"@/mvvm/MvvmImpl\";\nimport ExternalAttributeDetail from \"@/model/ExternalAttributeDetail\";\nimport Module from \"@/module/Module\";\nimport Nestable from \"@/component/Nestable\";\nimport MediatorSource from \"@/mvvm/MediatorSource\";\nimport ComponentInternals from \"@/component/ComponentInternals\";\nimport DirectEvents from \"@/constant/DirectEvents\";\nimport IdGenerator from \"@/pattern/IdGenerator\";\nimport NamedElementOperationsImpl from \"@/component/NamedElementOperationsImpl\";\nimport NamedElementOperations from \"@/component/NamedElementOperations\";\nimport UnknownElementError from \"@/error/UnknownElementError\";\nimport Getter from \"@/model/Getter\";\nimport ModuleAffinityError from \"@/error/ModuleAffinityError\";\nimport PubSubImpl from \"@/message/PubSubImpl\";\nimport ModulesContextImpl from \"@/module/ModulesContextImpl\";\n\nconst requireNotNull = ObjectUtils.requireNotNull;\nconst requireValid = ObjectUtils.requireValid;\nconst isDefined = ObjectUtils.isDefined;\nconst DEFAULT_COMPONENT_CONFIG: ComponentConfig = new ComponentConfigBuilder().build();\n\nclass ComponentInternalsImpl implements ComponentInternals {\n\n\tprivate id: string;\n\n\tprivate flags: ComponentFlags;\n\n\tprivate component: Nestable;\n\n\tprivate logger: Logger;\n\n\tprivate el: HTMLElement;\n\n\tprivate regions: { [id: string]: Region; };\n\n\tprivate regionsAsArray: Region[];\n\n\tprivate parent: Nestable;\n\n\tprivate itemFn: () => any;\n\n\tprivate template: string;\n\n\tprivate mvvm: Mvvm;\n\n\tprivate pubSub: PubSub;\n\n\tprivate scope: ScopeImpl;\n\n\tprivate parentScope: ScopeImpl;\n\n\tprivate externalCache: any;\n\n\tprivate externalMediators: SimpleMap<ExternalMediator<any>>;\n\n\tprivate externalFields: SimpleMap<string>;\n\n\tprivate readonly prefix: string;\n\n\tprivate hasExternals: boolean;\n\n\tprivate config: ComponentConfigImpl;\n\n\tprivate parentModelFn: () => any;\n\n\tprivate parentSeen: boolean;\n\n\tconstructor(component: Nestable, template: string, config: ComponentConfig) {\n\t\trequireNotNull(template, \"template\");\n\n\t\tif (typeof template !== \"string\") {\n\t\t\tthrow new TemplateError(\"Template must be a string\");\n\t\t}\n\n\t\tthis.parentSeen = false;\n\t\tthis.id = IdGenerator.INSTANCE.generate();\n\t\tthis.config = (config || DEFAULT_COMPONENT_CONFIG) as ComponentConfigImpl;\n\t\tthis.hasExternals = false;\n\t\tthis.parentModelFn = this.config.getParentModelFn();\n\t\tthis.itemFn = EMPTY_OBJECT_FN;\n\t\tthis.parent = null;\n\t\tthis.component = component;\n\t\tthis.prefix = this.config.getPrefix().toLowerCase();\n\t\tthis.template = template.trim();\n\t\tthis.scope = new ScopeImpl();\n\t\tthis.externalMediators = {};\n\t\tthis.externalCache = {};\n\t\tthis.externalFields = {};\n\t\tconst effectiveExternalAttributes: string[] = this.config.getAttributes();\n\n\t\tif (isDefined(this.config.getModule())) {\n\t\t\tthis.component[MODULE_FIELD_NAME] = this.config.getModule();\n\t\t}\n\n\t\tthis.validateModulePresent();\n\n\t\tfor (const attribute of effectiveExternalAttributes) {\n\t\t\tthis.externalize(attribute);\n\t\t}\n\n\t\tthis.flags = {\n\t\t\trepeatable: false\n\t\t};\n\n\t\tif (this.getModule()) {\n\t\t\tthis.scope.setParent(this.getModule().getScope() as ScopeImpl);\n\t\t}\n\n\t\tthis.regions = {};\n\t\tthis.regionsAsArray = [];\n\t\tthis.pubSub = new PubSubImpl(this.component, this.getModule());\n\t}\n\n\tpublic init(): void {\n\t\tthis.mvvm = new MvvmImpl(this.id, this.component, this.getModule(), this.prefix, this.scope, this.parentModelFn);\n\t\tthis.render();\n\t\tthis.mvvm.init(this.el, this, (name: string) => this.getRegion(name));\n\t\tthis.logger = LoggerFactory.getLogger(this.component.constructor.name + \" Component \" + this.mvvm.getId());\n\t}\n\n\tpublic hasMetadata(name: string): boolean {\n\t\treturn this.getMetadata(name) ? true : false;\n\t}\n\n\tpublic getMetadata(name: string): any {\n\t\trequireNotNull(name, \"name\");\n\t\treturn this.config.getMetadata(name);\n\t}\n\n\tpublic hasRegion(name: string): boolean {\n\t\trequireNotNull(name, \"name\");\n\t\treturn ((this.regions[name]) ? true : false);\n\t}\n\n\tpublic $apply(fn: Function, args: any[]): void {\n\t\tconst actualFn: Function = fn || NO_OP_FN;\n\t\tconst actualArgs = args || [];\n\n\t\tif (this.parentSeen) {\n\t\t\tthis.mvvm.$apply(actualFn, actualArgs);\n\t\t} else {\n\t\t\tactualFn.apply(this.component, actualArgs);\n\t\t}\n\t}\n\n\tpublic evaluate<T>(expression: string): T {\n\t\treturn new Getter<T>(expression).get(this.mvvm.getScope()) as T;\n\t}\n\n\tpublic getChild<N extends Nestable>(name: string): N {\n\t\trequireNotNull(name, \"name\");\n\n\t\treturn this.hasRegion(name) ? this.getRegion(name).getComponent() : null;\n\t}\n\n\tpublic setChild(name: string, component: Nestable): void {\n\t\trequireNotNull(name, \"name\");\n\n\t\tif (!this.hasRegion(name)) {\n\t\t\tthrow new UnknownRegionError(\"Region \\'%rName%\\' is unknown and must be declared in component template.\",\n\t\t\t\t{ \"%rName%\": name });\n\t\t}\n\n\t\tconst hasComponent: boolean = this.getRegion(name).hasComponent();\n\t\tconst childAdded: boolean = !!(component !== null && !hasComponent);\n\t\tconst childRemoved: boolean = !!(component === null && hasComponent);\n\t\tthis.messageInternalIf(childAdded, Events.BEFORE_CHILD_ADDED, { name: name });\n\t\tthis.messageInternalIf(childRemoved, Events.BEFORE_CHILD_REMOVED, { name: name });\n\t\tthis.message(INTERNAL_CHANNEL_NAME, Events.BEFORE_CHILD_CHANGED, { name: name });\n\t\tthis.getRegion(name).setComponent(component);\n\t\tthis.message(INTERNAL_CHANNEL_NAME, Events.AFTER_CHILD_CHANGED, { name: name });\n\t\tthis.messageInternalIf(childAdded, Events.AFTER_CHILD_ADDED, { name: name });\n\t\tthis.messageInternalIf(childRemoved, Events.AFTER_CHILD_REMOVED, { name: name });\n\t\tthis.broadcastGlobally(INTERNAL_CHANNEL_NAME, Events.COMPONENT_NESTING_CHANGED);\n\t}\n\n\tpublic setChildFromRegistry(name: string, componentId: string, defaultComponentName?: string): void {\n\t\trequireNotNull(name, \"name\");\n\t\trequireValid(componentId, \"componentId\", VALID_ID);\n\n\t\tif (!this.hasRegion(name)) {\n\t\t\tthrow new UnknownRegionError(\"Region \\'%rName%\\' is unknown and must be declared in component template.\", { \"%rName%\": name });\n\t\t}\n\n\t\tlet component: Nestable = this.get(componentId);\n\n\t\tif (!component && defaultComponentName) {\n\t\t\tcomponent = this.get(defaultComponentName);\n\t\t}\n\n\t\tif (component) {\n\t\t\tthis.setChild(name, component);\n\t\t} else {\n\t\t\tconst error = new SetComponentError(\"Unable to set component %cName% on region %name%\",\n\t\t\t\t{ \"%cName%\": componentId, \"%name%\": name });\n\t\t\tthis.getLogger().error(error);\n\t\t}\n\t}\n\n\tpublic message(channelName: string, messageName: string, payload: any): void {\n\t\tif (channelName !== INTERNAL_DIRECT_CHANNEL_NAME) {\n\t\t\tthis.pubSub.message(channelName, messageName, payload);\n\n\t\t\treturn;\n\t\t}\n\n\t\tswitch (messageName) {\n\t\t\tcase \"setMode\":\n\t\t\t\tswitch (payload) {\n\t\t\t\t\tcase \"repeatable\":\n\t\t\t\t\t\tthis.flags.repeatable = true;\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tthis.flags.repeatable = false;\n\t\t\t\t}\n\t\t\t\tbreak;\n\n\t\t\tcase \"consumeRegionDigestionCandidates\":\n\t\t\t\tfor (const region of this.regionsAsArray) {\n\t\t\t\t\tif (region.hasExpression() && region.hasComponent()) {\n\t\t\t\t\t\tregion.getComponent().message(INTERNAL_DIRECT_CHANNEL_NAME, \"consumeDigestionCandidates\", payload);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tbreak;\n\n\t\t\tcase \"consumeDigestionCandidates\":\n\t\t\t\t(payload as MediatorSource[]).push(this.mvvm);\n\t\t\t\tbreak;\n\n\t\t\tcase DirectEvents.NESTING_CHANGED:\n\t\t\t\tthis.nestingChanged();\n\t\t\t\tbreak;\n\n\t\t\tcase \"digest\":\n\t\t\t\tthis.digest();\n\t\t\t\tbreak;\n\n\t\t\tcase \"setParent\":\n\t\t\t\tthis.setParent(payload as Nestable);\n\t\t\t\tbreak;\n\n\t\t\tcase \"skipId\":\n\t\t\t\tthis.mvvm.skipId(payload as string);\n\t\t\t\tbreak;\n\n\t\t\tcase \"setParentScope\":\n\t\t\t\tthis.setParentScope(payload as ScopeImpl);\n\t\t\t\tbreak;\n\n\t\t\tcase \"setItemFn\":\n\t\t\t\tthis.setItemFn(payload);\n\t\t\t\tbreak;\n\n\t\t\tcase \"addExternalAttribute\":\n\t\t\t\tthis.addExternalAttribute(payload as ExternalAttributeDetail);\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\t\t\t\t// Intentionally do nothing\n\t\t}\n\t}\n\n\tpublic broadcast(channelName: string, messageName: string, payload?: any): void {\n\t\tthis.getModule().broadcast(channelName, messageName, payload);\n\t}\n\n\tpublic broadcastGlobally(channelName: string, messageName: string, payload?: any): void {\n\t\tthis.getModule().broadcastGlobally(channelName, messageName, payload);\n\t}\n\n\tpublic dispose(): void {\n\t\tthis.message(INTERNAL_CHANNEL_NAME, Events.BEFORE_DISPOSE, {});\n\t\tthis.pubSub.dispose();\n\t\tthis.parent = null;\n\t\tthis.parentScope = null;\n\t\tthis.scope = null;\n\t\tthis.regions = null;\n\t\tthis.regionsAsArray = [];\n\t}\n\n\tpublic getEl(): HTMLElement {\n\t\treturn this.el;\n\t}\n\n\tpublic getComponent(): Nestable {\n\t\treturn this.component;\n\t}\n\n\tpublic get<T>(id: string): T {\n\t\treturn this.getModule().get(id);\n\t}\n\n\tpublic getPrefix(): string {\n\t\treturn this.prefix;\n\t}\n\n\tpublic isConnected(): boolean {\n\t\treturn this.parent !== null && this.parent !== undefined && this.parent.isConnected();\n\t}\n\n\tpublic getScope(): Scope {\n\t\treturn this.scope;\n\t}\n\n\tpublic watch<T>(expression: string, target: (previous: T, current: T) => void, reducerFn?: (input: any) => T): void {\n\t\trequireNotNull(expression, \"expression\");\n\t\trequireNotNull(target, \"target\");\n\t\tthis.mvvm.mediate(expression, reducerFn).watch(this.component, target);\n\t}\n\n\tpublic on(target: (payload: any) => void, messageName: string, channel?: string): void {\n\t\tthis.pubSub.on(messageName).forChannel(channel || INTERNAL_CHANNEL_NAME).invoke((payload: any) => this.$apply(target, [payload]));\n\t}\n\n\tpublic forElement<E extends HTMLElement>(name: string): NamedElementOperations<E> {\n\t\trequireNotNull(name, \"name\");\n\t\tconst element: E = this.mvvm.getNamedElement(name) as E;\n\n\t\tif (!isDefined(element)) {\n\t\t\tthrow new UnknownElementError(\"Unknown element: \" + name);\n\t\t}\n\n\t\treturn new NamedElementOperationsImpl<E>(element);\n\t}\n\n\tpublic getLogger(): Logger {\n\t\treturn this.logger;\n\t}\n\n\tpublic getModule(): Module {\n\t\treturn this.component[MODULE_FIELD_NAME] as Module;\n\t}\n\n\tpublic getParent(): Nestable {\n\t\treturn this.parent;\n\t}\n\n\tpublic setItemFn(itemFn: () => any): void {\n\t\tthis.itemFn = isDefined(itemFn) ? itemFn : EMPTY_OBJECT_FN;\n\t}\n\n\tpublic getData(): any {\n\t\treturn this.itemFn();\n\t}\n\n\tpublic importExternals(): void {\n\t\tthis.externalCache = {};\n\n\t\tfor (const key in this.externalMediators) {\n\t\t\tif (!this.externalMediators.hasOwnProperty(key)) {\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tconst mediator: ExternalMediator<any> = this.externalMediators[key];\n\t\t\tthis.externalCache[key] = mediator.get(this.parentScope);\n\t\t}\n\t}\n\n\tpublic exportExternals(): void {\n\t\tfor (const key in this.externalMediators) {\n\t\t\tif (!this.externalMediators.hasOwnProperty(key)) {\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tconst mediator: ExternalMediator<any> = this.externalMediators[key];\n\t\t\tmediator.set(this.parentScope, this.externalCache[key]);\n\t\t}\n\n\t\tthis.externalCache = {};\n\t}\n\n\tpublic hasExternalMediators(): boolean {\n\t\treturn this.hasExternals;\n\t}\n\n\tpublic getExternalCache(): any {\n\t\treturn this.externalCache;\n\t}\n\n\tpublic getFlags(): ComponentFlags {\n\t\treturn this.flags;\n\t}\n\n\tpublic getId(): string {\n\t\treturn this.id;\n\t}\n\n\tprotected getConfig(): ComponentConfig {\n\t\treturn this.config;\n\t}\n\n\tprotected getRegion(name: string): Region {\n\t\tif (!this.regions[name]) {\n\t\t\tconst created: Region = new Region(name, this);\n\t\t\tthis.regions[name] = created;\n\t\t\tthis.regionsAsArray.push(created);\n\t\t}\n\n\t\treturn this.regions[name];\n\t}\n\n\tprotected getTemplate(): string {\n\t\treturn this.template;\n\t}\n\n\tprotected render(): void {\n\t\tconst templateEl: HTMLTemplateElement = Properties.getWindow().document.createElement(\"template\");\n\t\ttemplateEl.insertAdjacentHTML(\"afterbegin\", this.template.trim());\n\t\tconst count: number = templateEl.childElementCount;\n\n\t\tif (count !== 1) {\n\t\t\tconst parmObj = { \"%count%\": \"\" + count, \"%template%\": this.template };\n\t\t\tconst errmsg = \"Component template must have a single top level element, but had %count% top level elements:\\n\\n%template%\\n\\n\";\n\t\t\tconst error = new TemplateError(errmsg, parmObj);\n\t\t\tthrow error;\n\t\t}\n\n\t\tthis.el = templateEl.firstElementChild as HTMLElement;\n\t}\n\n\tprotected setEl(el: HTMLElement): void {\n\t\tthis.el = el;\n\t}\n\n\tprotected validateModulePresent(): void {\n\t\tconst moduleInstance: Module = this.component[MODULE_FIELD_NAME] as Module;\n\n\t\tif (!isDefined(moduleInstance)) {\n\t\t\tif (ModulesContextImpl.getInstances().length === 0) {\n\t\t\t\tthrow new ModuleAffinityError(\"Component \"+ this.component.constructor.name + \" does not have affinity with a module and no stages are active.  Unable to determine component affinity\");\n\t\t\t} else if (ModulesContextImpl.getInstances().length === 1) {\n\t\t\t\tthis.component[MODULE_FIELD_NAME] = ModulesContextImpl.getInstances()[0].getDefaultModule();\n\t\t\t} else {\n\t\t\t\tthrow new ModuleAffinityError(\"Component \"+ this.component.constructor.name + \" does not have affinity with a module and multiple stages are active.  Unable to determine component affinity\");\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate messageInternalIf(condition: boolean, messageName: string, payload?: any): void {\n\t\tif (condition) {\n\t\t\tthis.message(INTERNAL_CHANNEL_NAME, messageName, payload);\n\t\t}\n\t}\n\n\tprivate messageChildren(channelName: string, messageName: string, payload?: any): void {\n\t\tfor (const id in this.regions) {\n\t\t\tif (!this.regions.hasOwnProperty(id)) {\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tthis.regions[id].message(channelName, messageName, payload);\n\t\t}\n\t}\n\n\tprivate externalize(name: string): void {\n\t\tthis.externalFields[name.toLowerCase()] = name.toLowerCase();\n\t}\n\n\tprivate addExternalAttribute(detail: ExternalAttributeDetail): void {\n\t\tconst fieldName: string = this.externalFields[detail.attributeName];\n\t\tthis.hasExternals = true;\n\n\t\tif (fieldName) {\n\t\t\tthis.externalMediators[fieldName] = new ExternalMediator(detail.expression);\n\t\t}\n\t}\n\n\tprivate setParentScope(scope: ScopeImpl): void {\n\t\tthis.parentScope = scope;\n\t}\n\n\tprivate setParent(parent: Nestable): void {\n\t\tthis.parentSeen = true;\n\t\tconst changed: boolean = this.bothPresentButDifferent(parent, this.parent) || this.exactlyOneDefined(parent, this.parent);\n\t\tconst parentAdded: boolean = !!(parent !== null && this.parent === null);\n\t\tconst parentRemoved: boolean = !!(parent === null && this.parent !== null);\n\t\tthis.messageInternalIf(parentAdded, Events.BEFORE_PARENT_ADDED, {});\n\t\tthis.messageInternalIf(parentRemoved, Events.BEFORE_PARENT_REMOVED, {});\n\t\tthis.message(INTERNAL_CHANNEL_NAME, Events.BEFORE_PARENT_CHANGED, {});\n\t\tthis.parent = parent;\n\n\t\tif (changed) {\n\t\t\tthis.nestingChanged();\n\t\t}\n\n\t\tif (isDefined(this.parent)) {\n\t\t\tthis.digest();\n\t\t}\n\n\t\tthis.message(INTERNAL_CHANNEL_NAME, Events.AFTER_PARENT_CHANGED, {});\n\t\tthis.messageInternalIf(parentAdded, Events.AFTER_PARENT_ADDED, {});\n\t\tthis.messageInternalIf(parentRemoved, Events.AFTER_PARENT_REMOVED, {});\n\t}\n\n\tprivate nestingChanged(): void {\n\t\tif (this.isConnected() && !this.pubSub.isGlobalEnabled()) {\n\t\t\tthis.pubSub.enableGlobal();\n\t\t} else if (!this.isConnected() && this.pubSub.isGlobalEnabled()) {\n\t\t\tthis.pubSub.disableGlobal();\n\t\t}\n\n\t\tthis.mvvm.nestingChanged();\n\t\tthis.messageChildren(INTERNAL_DIRECT_CHANNEL_NAME, DirectEvents.NESTING_CHANGED);\n\t}\n\n\tprivate digest(): void {\n\t\tthis.$apply(NO_OP_FN, []);\n\t}\n\n\tprivate bothPresentButDifferent(first: Nestable, second: Nestable): boolean {\n\t\treturn isDefined(first) && isDefined(second) && first.getId() !== second.getId();\n\t}\n\n\tprivate exactlyOneDefined(first: any, second: any): boolean {\n\t\treturn isDefined(first) ? !isDefined(second) : isDefined(second);\n\t}\n\n}\n\nexport default ComponentInternalsImpl;\n","import Logger from \"@/logger/Logger\";\nimport LoggerFactory from \"@/logger/LoggerFactory\";\nimport ScopeImpl from \"@/model/ScopeImpl\";\n\nclass Getter<T> {\n\n\tprivate expression: string;\n\n\tprivate logger: Logger;\n\n\tconstructor(expression: string) {\n\t\tthis.logger = LoggerFactory.getLogger(\"Getter: \" + expression);\n\t\tthis.expression = expression;\n\t}\n\n\tpublic get(scope: ScopeImpl): T {\n\t\tconst code: string = '\"use strict\"; ' + scope.getCode() + \" return (\" + this.expression + \");\";\n\t\tlet value: any = null;\n\n\t\ttry {\n\t\t\tvalue = Function(code).apply({}, [scope.getItems()]);\n\t\t} catch (e) {\n\t\t\tthis.logInvocationError(code, e);\n\t\t}\n\n\t\treturn value;\n\t}\n\n\tprivate logInvocationError(code: string, e: Error) {\n\t\tthis.logger.ifWarn(() => \"\\nAn exception (\" + e.name + \") was thrown invoking the element mediator expression: \" + this.expression\n\t\t\t+ \"\\n\\nIn context:\\n\" + code + \"\\n\\nException message: \" + e.message + \"\\n\\n\", e);\n\t}\n\n}\n\nexport default Getter;\n","var g;\n\n// This works in non-strict mode\ng = (function() {\n\treturn this;\n})();\n\ntry {\n\t// This works if eval is allowed (see CSP)\n\tg = g || new Function(\"return this\")();\n} catch (e) {\n\t// This works if the window reference is available\n\tif (typeof window === \"object\") g = window;\n}\n\n// g can still be undefined, but nothing to do about it...\n// We return undefined, instead of nothing here, so it's\n// easier to handle this case. if(!global) { ...}\n\nmodule.exports = g;\n","import { CydranError } from \"@/error/AbstractCydranError\";\n\nclass NullValueError extends CydranError {\n\n\tconstructor(msg: string, reps?: any) {\n\t\tsuper(msg, reps);\n\t}\n\n}\n\nexport default NullValueError;\n","import ConsoleOutputStrategy from \"@/logger/ConsoleOutputStrategy\";\nimport Level from \"@/logger/Level\";\nimport Logger from \"@/logger/Logger\";\nimport LoggerService from \"@/logger/LoggerService\";\nimport OutputStrategy from \"@/logger/OutputStrategy\";\n\nclass LoggerServiceImpl implements LoggerService {\n\n\tpublic static INSTANCE: LoggerServiceImpl = new LoggerServiceImpl();\n\n\tprivate level: Level;\n\n\tprivate outputStrategy: OutputStrategy;\n\n\tconstructor() {\n\t\tthis.level = Level.INFO;\n\t\tthis.outputStrategy = new ConsoleOutputStrategy();\n\t}\n\n\tpublic log(logger: Logger, level: Level, payload: any, errorStack?: Error | boolean): void {\n\t\tif (level >= this.level && level !== Level.DISABLED) {\n\t\t\tthis.outputStrategy.log(logger.getName(), level, payload, errorStack);\n\t\t}\n\t}\n\n\tpublic setLevel(level: Level): void {\n\t\tthis.level = level;\n\t}\n\n\tpublic isTrace(): boolean {\n\t\treturn (Level.TRACE >= this.level);\n\t}\n\n\tpublic isDebug(): boolean {\n\t\treturn (Level.DEBUG >= this.level);\n\t}\n\n\tpublic isInfo(): boolean {\n\t\treturn (Level.INFO >= this.level);\n\t}\n\n\tpublic isWarn(): boolean {\n\t\treturn (Level.WARN >= this.level);\n\t}\n\n\tpublic isError(): boolean {\n\t\treturn (Level.ERROR >= this.level);\n\t}\n\n\tpublic isFatal(): boolean {\n\t\treturn (Level.FATAL >= this.level);\n\t}\n\n\tpublic isDisabled(): boolean {\n\t\treturn (Level.DISABLED >= this.level);\n\t}\n\n}\n\nexport default LoggerServiceImpl;\n","class IdGenerator {\n\n\tpublic static readonly INSTANCE: IdGenerator = new IdGenerator();\n\n\tprivate static readonly MAX_VALUE: number = 9007199254740989;\n\n\tprivate major: number;\n\n\tprivate minor: number;\n\n\tprivate micro: number;\n\n\tconstructor() {\n\t\tthis.major = 0;\n\t\tthis.minor = 0;\n\t\tthis.micro = 0;\n\t}\n\n\tpublic generate(): string {\n\t\tconst result: string = this.major + \"-\" + this.minor + \"-\" + this.micro;\n\n\t\tthis.micro++;\n\n\t\tif (this.micro > IdGenerator.MAX_VALUE) {\n\t\t\tthis.micro = 0;\n\t\t\tthis.minor++;\n\t\t}\n\n\t\tif (this.minor > IdGenerator.MAX_VALUE) {\n\t\t\tthis.minor = 0;\n\t\t\tthis.major++;\n\t\t}\n\n\t\treturn result;\n\t}\n\n}\n\nexport default IdGenerator;\n","import { CydranError } from \"@/error/AbstractCydranError\";\n\nclass TemplateError extends CydranError {\n\n\tconstructor(msg: string, reps?: any) {\n\t\tsuper(msg, reps);\n\t}\n\n}\n\nexport default TemplateError;\n","import Logger from \"@/logger/Logger\";\nimport LoggerFactory from \"@/logger/LoggerFactory\";\nimport ScopeImpl from \"@/model/ScopeImpl\";\n\nclass Setter<T> {\n\n\tprivate expression: string;\n\n\tprivate logger: Logger;\n\n\tconstructor(expression: string) {\n\t\tthis.logger = LoggerFactory.getLogger(\"Setter: \" + expression);\n\t\tthis.expression = expression;\n\t}\n\n\tpublic set(scope: ScopeImpl, value: T): void {\n\t\tconst code: string = '\"use strict\"; ' + scope.getCode() + \" \" + this.expression + \" = arguments[1];\";\n\n\t\ttry {\n\t\t\tFunction(code).apply({}, [scope.getItems(), value]);\n\t\t} catch (e) {\n\t\t\tthis.logInvocationError(code, e);\n\t\t}\n\t}\n\n\tprivate logInvocationError(code: string, e: Error) {\n\t\tthis.logger.error(\"\\nAn exception (\" + e.name + \") was thrown invoking the element mediator expression: \" + this.expression\n\t\t\t + \"\\n\\nIn context:\\n\" + code + \"\\n\\nException message: \" + e.message + \"\\n\\n\", e);\n\t}\n\n}\n\nexport default Setter;\n","const DirectEvents: any = {\n\tNESTING_CHANGED: \"NESTING_CHANGED\"\n};\n\nexport default DirectEvents;\n","import Module from \"@/module/Module\";\nimport ObjectUtils from \"@/util/ObjectUtils\";\nimport { VALID_ID } from \"@/constant/ValidationRegExp\";\nimport { DEFAULT_MODULE_KEY } from \"@/constant/Constants\";\nimport ScopeImpl from \"@/model/ScopeImpl\";\nimport Scope from \"@/model/Scope\";\nimport Factories from \"@/mvvm/Factories\";\nimport SimpleMap from \"@/pattern/SimpleMap\";\nimport ModulesContext from \"@/module/ModulesContext\";\nimport ModuleImpl from \"@/module/ModuleImpl\";\nimport ElementMediator from \"@/element/ElementMediator\";\nimport Type from \"@/type/Type\";\n\nconst requireNotNull = ObjectUtils.requireNotNull;\nconst requireValid = ObjectUtils.requireValid;\n\nclass ModulesContextImpl implements ModulesContext {\n\n\tpublic static getInstances(): ModulesContext[] {\n\t\treturn ModulesContextImpl.INSTANCES;\n\t}\n\n\tpublic static resetInstances(): void {\n\t\tModulesContextImpl.INSTANCES = [];\n\t}\n\n\tprivate static INSTANCES: ModulesContext[] = [];\n\n\tprivate readonly defaultModule: Module;\n\n\tprivate modules: SimpleMap<Module>;\n\n\tconstructor() {\n\t\tthis.defaultModule = new ModuleImpl(DEFAULT_MODULE_KEY, this);\n\t\tthis.modules = {\n\t\t\tDEFAULT: this.defaultModule\n\t\t};\n\n\t\tModulesContextImpl.INSTANCES.push(this);\n\t}\n\n\tpublic getModule(name: string): Module {\n\t\trequireValid(name, \"name\", VALID_ID);\n\n\t\tif (!this.modules[name]) {\n\t\t\tthis.modules[name] = new ModuleImpl(name, this, this.defaultModule.getScope() as ScopeImpl);\n\t\t}\n\n\t\treturn this.modules[name];\n\t}\n\n\tpublic getDefaultModule(): Module {\n\t\treturn this.getModule(DEFAULT_MODULE_KEY);\n\t}\n\n\tpublic forEach(fn: (instace: Module) => void): void {\n\t\trequireNotNull(fn, \"fn\");\n\n\t\tfor (const name in this.modules) {\n\t\t\tif (!this.modules.hasOwnProperty(name)) {\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tconst current: Module = this.modules[name];\n\n\t\t\tfn(current);\n\t\t}\n\t}\n\n\tpublic broadcast(channelName: string, messageName: string, payload?: any): void {\n\t\tthis.forEach((instance) => instance.broadcast(channelName, messageName, payload));\n\t}\n\n\tpublic registerConstant(id: string, instance: any): void {\n\t\tthis.getDefaultModule().registerConstant(id, instance);\n\t}\n\n\tpublic registerPrototype(id: string, classInstance: Type<any>, dependencies: string[]): void {\n\t\tthis.getDefaultModule().registerPrototype(id, classInstance, dependencies);\n\t}\n\n\tpublic registerPrototypeWithFactory(id: string, factoryFn: () => any, dependencies: string[]): void {\n\t\tthis.getDefaultModule().registerPrototypeWithFactory(id, factoryFn, dependencies);\n\t}\n\n\tpublic registerSingleton(id: string, classInstance: Type<any>, dependencies: string[]): void {\n\t\tthis.getDefaultModule().registerSingleton(id, classInstance, dependencies);\n\t}\n\n\tpublic registerSingletonWithFactory(id: string, factoryFn: () => any, dependencies: string[]): void {\n\t\tthis.getDefaultModule().registerSingletonWithFactory(id, factoryFn, dependencies);\n\t}\n\n\tpublic registerElementMediator(name: string, supportedTags: string[], elementMediatorClass: Type<ElementMediator<any, HTMLElement | Text, any>>): void {\n\t\tFactories.register(name, supportedTags, elementMediatorClass);\n\t}\n\n\tpublic getScope(): Scope {\n\t\treturn this.getDefaultModule().getScope();\n\t}\n\n\tpublic get<T>(id: string): T {\n\t\trequireValid(id, \"id\", VALID_ID);\n\t\tlet result: T = null;\n\n\t\tconst moduleId: string = ModuleImpl.ALIASES[id];\n\n\t\tif (moduleId) {\n\t\t\tresult = this.getModule(id).getLocal(id);\n\t\t}\n\n\t\tif (!result) {\n\t\t\tresult = this.defaultModule.getLocal(id);\n\t\t}\n\n\t\treturn result;\n\t}\n\n}\n\nexport default ModulesContextImpl;\n","import Level from \"@/logger/Level\";\nimport LoggerServiceImpl from \"@/logger/LoggerServiceImpl\";\n\nclass CydranConfig {\n\n\tconstructor() { /**/ }\n\n\tpublic useTrace(): void {\n\t\tLoggerServiceImpl.INSTANCE.setLevel(Level.TRACE);\n\t}\n\n\tpublic useDebug(): void {\n\t\tLoggerServiceImpl.INSTANCE.setLevel(Level.DEBUG);\n\t}\n\n\tpublic useInfo(): void {\n\t\tLoggerServiceImpl.INSTANCE.setLevel(Level.INFO);\n\t}\n\n\tpublic useWarn(): void {\n\t\tLoggerServiceImpl.INSTANCE.setLevel(Level.WARN);\n\t}\n\n\tpublic useError(): void {\n\t\tLoggerServiceImpl.INSTANCE.setLevel(Level.ERROR);\n\t}\n\n\tpublic useFatal(): void {\n\t\tLoggerServiceImpl.INSTANCE.setLevel(Level.FATAL);\n\t}\n\n\tpublic useDisabled(): void {\n\t\tLoggerServiceImpl.INSTANCE.setLevel(Level.DISABLED);\n\t}\n}\n\nexport default CydranConfig;\n","import \"@/component/\";\nimport \"@/config/\";\nimport \"@/constant/\";\nimport \"@/element/\";\nimport \"@/error/\";\nimport \"@/logger/\";\nimport \"@/message/\";\nimport \"@/model/\";\nimport \"@/module/\";\nimport \"@/mvvm/\";\nimport \"@/pattern/\";\nimport \"@/registry/\";\nimport \"@/stage/\";\nimport \"@/util/\";\n\nimport { ComponentConfigBuilder } from \"@/component/ComponentConfig\";\nimport * as CydranConfig from \"@/config/CydranConfig\";\nimport Events from \"@/constant/Events\";\nimport Logger from \"@/logger/Logger\";\nimport LoggerFactory from \"@/logger/LoggerFactory\";\nimport PubSub from \"@/message/PubSub\";\nimport { builder, Stage, StageBuilder } from \"@/stage/Stage\";\nimport ElementMediator from \"@/element/ElementMediator\";\nimport Component from \"@/component/Component\";\nimport ObjectUtils from \"@/util/ObjectUtils\";\nimport RegistryStrategy from \"@/registry/RegistryStrategy\";\n\nconst isDefined  = ObjectUtils.isDefined;\nconst requireNotNull  = ObjectUtils.requireNotNull;\nconst requireValid  = ObjectUtils.requireValid;\nconst CYDRAN_KEY: string = \"cydran\";\nconst ORIGINAL_CYDRAN: any = window[CYDRAN_KEY];\n\nfunction noConflict() {\n\tconst currentCydran: any = window[CYDRAN_KEY];\n\twindow[CYDRAN_KEY] = ORIGINAL_CYDRAN;\n\n\treturn currentCydran;\n}\n\nexport {\n\tComponentConfigBuilder,\n\tComponent,\n\tEvents,\n\tStage,\n\tStageBuilder,\n\tbuilder,\n\tElementMediator,\n\tLogger,\n\tLoggerFactory,\n\tCydranConfig,\n\tPubSub,\n\tRegistryStrategy,\n\tnoConflict,\n\tisDefined,\n\trequireNotNull,\n\trequireValid\n};\n","import \"@/element/Checked\";\nimport \"@/element/CSSClass\";\nimport \"@/element/Enabled\";\nimport \"@/element/ReadOnly\";\nimport \"@/element/Style\";\nimport \"@/element/ForceFocus\";\nimport \"@/element/MultiSelectValueModel\";\nimport \"@/element/ValuedModel\";\nimport \"@/element/InputValueModel\";\nimport \"@/element/Visible\";\nimport \"@/element/If\";\nimport \"@/element/repeat/Repeat\";\n\nexport { };\n","import Factories from \"@/mvvm/Factories\";\nimport ElementMediator from \"@/element/ElementMediator\";\nimport { asBoolean } from \"@/model/Reducers\";\n\n/**\n *\n */\nclass Checked extends ElementMediator<boolean, HTMLInputElement, any> {\n\n\tconstructor(deps: any) {\n\t\tsuper(deps, false, asBoolean);\n\t}\n\n\tpublic wire(): void {\n\t\tthis.getModelMediator().watch(this, this.onTargetChange);\n\t}\n\n\tpublic unwire(): void {\n\t\t// Intentionally do nothing\n\t}\n\n\tprotected onTargetChange(previous: boolean, current: boolean): void {\n\t\tthis.getEl().checked = !current;\n\t}\n}\n\nFactories.register(\"checked\", [\"input\"], Checked);\n\nexport default Checked;\n","module.exports = function(module) {\n\tif (!module.webpackPolyfill) {\n\t\tmodule.deprecate = function() {};\n\t\tmodule.paths = [];\n\t\t// module.parent = undefined by default\n\t\tif (!module.children) module.children = [];\n\t\tObject.defineProperty(module, \"loaded\", {\n\t\t\tenumerable: true,\n\t\t\tget: function() {\n\t\t\t\treturn module.l;\n\t\t\t}\n\t\t});\n\t\tObject.defineProperty(module, \"id\", {\n\t\t\tenumerable: true,\n\t\t\tget: function() {\n\t\t\t\treturn module.i;\n\t\t\t}\n\t\t});\n\t\tmodule.webpackPolyfill = 1;\n\t}\n\treturn module;\n};\n","import { CydranError } from \"@/error/AbstractCydranError\";\n\nclass ValidationError extends CydranError {\n\n\tconstructor(msg: string, reps?: any) {\n\t\tsuper(msg, reps);\n\t}\n\n}\n\nexport default ValidationError;\n","import Level from \"@/logger/Level\";\nimport Logger from \"@/logger/Logger\";\nimport LoggerService from \"@/logger/LoggerService\";\nimport ObjectUtils from \"@/util/ObjectUtils\";\n\nconst requireNotNull = ObjectUtils.requireNotNull;\n\nconst LOGGER_NAME_LENGTH = 20;\n\nclass LoggerImpl implements Logger {\n\n\tprivate name: string;\n\n\tprivate loggerService: LoggerService;\n\n\tconstructor(name: string, loggerService: LoggerService) {\n\t\trequireNotNull(name, \"name\");\n\n\t\tif (name.length < LOGGER_NAME_LENGTH) {\n\t\t\tlet count: number = LOGGER_NAME_LENGTH - name.length;\n\n\t\t\twhile (count > 0) {\n\t\t\t\tname = name + \" \";\n\t\t\t\t--count;\n\t\t\t}\n\t\t}\n\n\t\tthis.name = name;\n\t\tthis.loggerService = loggerService;\n\t}\n\n\tpublic trace(payload: any, error?: Error): void {\n\t\tthis.loggerService.log(this, Level.TRACE, payload, error);\n\t}\n\n\tpublic ifTrace(payloadFn: () => any, error?: Error): void {\n\t\tif (payloadFn !== null && this.isTrace()) {\n\t\t\tthis.trace(payloadFn(), error);\n\t\t}\n\t}\n\n\tpublic debug(payload: any, error?: Error): void {\n\t\tthis.loggerService.log(this, Level.DEBUG, payload, error);\n\t}\n\n\tpublic ifDebug(payloadFn: () => any, error?: Error): void {\n\t\tif (payloadFn !== null && this.isDebug()) {\n\t\t\tthis.debug(payloadFn(), error);\n\t\t}\n\t}\n\n\tpublic info(payload: any, error?: Error): void {\n\t\tthis.loggerService.log(this, Level.INFO, payload, error);\n\t}\n\n\tpublic ifInfo(payloadFn: () => any, error?: Error): void {\n\t\tif (payloadFn !== null && this.isInfo()) {\n\t\t\tthis.info(payloadFn(), error);\n\t\t}\n\t}\n\n\tpublic warn(payload: any, error?: Error): void {\n\t\tthis.loggerService.log(this, Level.WARN, payload, error);\n\t}\n\n\tpublic ifWarn(payloadFn: () => any, error?: Error): void {\n\t\tif (payloadFn !== null && this.isWarn()) {\n\t\t\tthis.warn(payloadFn(), error);\n\t\t}\n\t}\n\n\tpublic error(payload: any, error?: Error): void {\n\t\tthis.loggerService.log(this, Level.ERROR, payload, error);\n\t}\n\n\tpublic ifError(payloadFn: () => any, error?: Error): void {\n\t\tif (payloadFn !== null && this.isError()) {\n\t\t\tthis.error(payloadFn(), error);\n\t\t}\n\t}\n\n\tpublic fatal(payload: any, error?: Error): void {\n\t\tthis.loggerService.log(this, Level.FATAL, payload, error);\n\t}\n\n\tpublic ifFatal(payloadFn: () => any, error?: Error): void {\n\t\tif (payloadFn !== null && this.isFatal()) {\n\t\t\tthis.fatal(payloadFn(), error);\n\t\t}\n\t}\n\n\tpublic isTrace(): boolean {\n\t\treturn this.loggerService.isTrace();\n\t}\n\n\tpublic isDebug(): boolean {\n\t\treturn this.loggerService.isDebug();\n\t}\n\n\tpublic isInfo(): boolean {\n\t\treturn this.loggerService.isInfo();\n\t}\n\n\tpublic isWarn(): boolean {\n\t\treturn this.loggerService.isWarn();\n\t}\n\n\tpublic isError(): boolean {\n\t\treturn this.loggerService.isError();\n\t}\n\n\tpublic isFatal(): boolean {\n\t\treturn this.loggerService.isFatal();\n\t}\n\n\tpublic isDisabled(): boolean {\n\t\treturn this.loggerService.isDisabled();\n\t}\n\n\tpublic getName(): string {\n\t\treturn this.name;\n\t}\n\n}\n\nexport default LoggerImpl;\n","import Level from \"@/logger/Level\";\nimport OutputStrategy from \"@/logger/OutputStrategy\";\n\nclass ConsoleOutputStrategy implements OutputStrategy {\n\n\tprivate static getNow(): string {\n\t\tconst now = new Date();\n\n\t\treturn now.getUTCFullYear()\n\t\t\t+ \"-\"\n\t\t\t+ now.getUTCMonth()\n\t\t\t+ \":\"\n\t\t\t+ now.getUTCDate()\n\t\t\t+ \":\"\n\t\t\t+ now.getUTCHours()\n\t\t\t+ \":\"\n\t\t\t+ now.getUTCMinutes()\n\t\t\t+ \":\"\n\t\t\t+ now.getUTCSeconds()\n\t\t\t+ \":\"\n\t\t\t+ now.getUTCMilliseconds();\n\t}\n\n\tpublic log(logName: string, level: Level, payload: any, stacked?: Error | boolean): void {\n\t\tif (level === Level.DISABLED) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst preamble: string = ConsoleOutputStrategy.getNow() + \" \" + level + \" [\" + logName + \"]\";\n\t\tconst shortArgs: boolean = payload instanceof Error;\n\t\tconst printFullStack: boolean = !(stacked instanceof Error) ? (null !== stacked ? stacked : false) : false;\n\n\t\tif (level >= Level.WARN) {\n\t\t\tconst logMsg: string = (shortArgs ? payload.stack : payload);\n\t\t\tconst errMsg: string = (stacked instanceof Error) ? stacked.stack : \"\";\n\t\t\tconst secondPreamble = (shortArgs ? \"\" : ((stacked) ? \" - %s\" : \"\"));\n\n\t\t\tswitch (level) {\n\t\t\t\tcase Level.WARN:\n\t\t\t\t\t// tslint:disable-next-line\n\t\t\t\t\tconsole.warn(\"%c\" + preamble + secondPreamble, \"color:#ff9400;\", logMsg, errMsg);\n\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase Level.ERROR:\n\t\t\t\tcase Level.FATAL:\n\t\t\t\tdefault:\n\t\t\t\t\t// tslint:disable-next-line\n\t\t\t\t\tconsole.error(preamble + secondPreamble, logMsg, errMsg);\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t} else {\n\t\t\tswitch (level) {\n\t\t\t\tcase Level.TRACE:\n\t\t\t\t\tif (printFullStack) {\n\t\t\t\t\t\t// tslint:disable-next-line\n\t\t\t\t\t\tconsole.log(\"%c\" + preamble, \"color:#00752d;\", payload);\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// tslint:disable-next-line\n\t\t\t\t\t\tconsole.log(\"%c\" + preamble, \"color:#ff9400;\", payload);\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase Level.DEBUG:\n\t\t\t\t\t// tslint:disable-next-line\n\t\t\t\t\tconsole.log(\"%c\" + preamble, \"color:#00752d;\", payload);\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase Level.INFO:\n\t\t\t\t\t// tslint:disable-next-line\n\t\t\t\t\tconsole.log(\"%c\" + preamble, \"color:#2d57ca;\", payload);\n\t\t\t\t\tbreak;\n\n\t\t\t\tdefault:\n\t\t\t\t\t// tslint:disable-next-line\n\t\t\t\t\tconsole.log(preamble, payload);\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\n}\n\nexport default ConsoleOutputStrategy;\n","function extractParams<T>(tagName: string, el: HTMLElement): T {\n\tconst result: any = {};\n\n\t// tslint:disable-next-line\n\tfor (let i = 0; i < el.children.length; i++) {\n\t\tconst child: HTMLElement = el.children[i] as HTMLElement;\n\n\t\tif (child.tagName.toLowerCase() === tagName.toLowerCase()) {\n\t\t\tconst paramName: string = child.getAttribute(\"name\");\n\t\t\tconst paramValue: string = child.getAttribute(\"value\");\n\t\t\tresult[paramName] = paramValue;\n\t\t}\n\t}\n\n\treturn result;\n}\n\nfunction extractAttributes<T>(prefix: string, el: HTMLElement): T {\n\tconst result: any = {};\n\tconst lowerCasePrefix: string = prefix.toLowerCase() + \":\";\n\n\t// tslint:disable-next-line\n\tfor (let i = 0; i < el.attributes.length; i++) {\n\t\tconst attribute: Attr = el.attributes[i] as Attr;\n\n\t\tconst name: string = attribute.name.toLowerCase();\n\n\t\tif (name.indexOf(lowerCasePrefix) === 0) {\n\t\t\tconst paramName: string = name.slice(lowerCasePrefix.length);\n\t\t\tconst paramValue: string = attribute.value;\n\t\t\tresult[paramName] = paramValue;\n\t\t}\n\t}\n\n\treturn result;\n}\n\nexport { extractParams, extractAttributes };\n","import Listener from \"@/message/Listener\";\nimport SimpleMap from \"@/pattern/SimpleMap\";\n\nclass ListenerImpl implements Listener {\n\n\tprivate context: any;\n\n\tprivate channelName: string;\n\n\tprivate mappings: SimpleMap<((payload: any) => void)[]>;\n\n\tconstructor(channelName: string, context: any) {\n\t\tthis.mappings = {};\n\t\tthis.channelName = channelName;\n\t\tthis.context = context;\n\t}\n\n\tpublic receive(messageName: string, payload: any): void {\n\t\tconst mappings: ((payload: any) => void)[] = this.mappings[messageName];\n\n\t\tif (!mappings) {\n\t\t\treturn;\n\t\t}\n\n\t\tfor (const mapping of mappings) {\n\t\t\tmapping.call(this.context, payload);\n\t\t}\n\t}\n\n\tpublic register(messageName: string, fn: (payload: any) => void): void {\n\t\tif (!this.mappings[messageName]) {\n\t\t\tthis.mappings[messageName] = [];\n\t\t}\n\n\t\tthis.mappings[messageName].push(fn);\n\t}\n\n\tpublic getChannelName(): string {\n\t\treturn this.channelName;\n\t}\n\n\tpublic dispose(): void {\n\t\tthis.mappings = {};\n\t\tthis.context = null;\n\t}\n\n}\n\nexport default ListenerImpl;\n","import ElementMediator from \"@/element/ElementMediator\";\nimport Factories from \"@/mvvm/Factories\";\n\nclass CSSClass extends ElementMediator<any, HTMLElement, any> {\n\n\tpublic wire(): void {\n\t\tthis.getModelMediator().watch(this, this.onTargetChange);\n\t}\n\n\tpublic unwire(): void {\n\t\t// Intentionally do nothing\n\t}\n\n\tprivate onTargetChange(previous: any, current: any): void {\n\t\tconst oldClasses: string[] = (this.getEl().className || \"\").trim().split(\" \");\n\t\tconst newClasses: string[] = [];\n\t\tconst map: any = current || {};\n\n\t\tfor (const value of oldClasses) {\n\t\t\tif (!map.hasOwnProperty(value)) {\n\t\t\t\tnewClasses.push(value);\n\t\t\t}\n\t\t}\n\n\t\tfor (const key in map) {\n\t\t\tif (map.hasOwnProperty(key) && !!map[key]) {\n\t\t\t\tnewClasses.push(key);\n\t\t\t}\n\t\t}\n\n\t\tthis.getEl().className = newClasses.join(\" \");\n\t}\n\n}\n\nFactories.register(\"class\", [\"*\"], CSSClass);\n\nexport default CSSClass;\n","import ElementMediator from \"@/element/ElementMediator\";\nimport Factories from \"@/mvvm/Factories\";\nimport { asBoolean } from \"@/model/Reducers\";\n\nclass Enabled extends ElementMediator<boolean, HTMLInputElement, any> {\n\n\tconstructor(deps: any) {\n\t\tsuper(deps, false, asBoolean);\n\t}\n\n\tpublic wire(): void {\n\t\tthis.getModelMediator().watch(this, this.onTargetChange);\n\t}\n\n\tpublic unwire(): void {\n\t\t// Intentionally do nothing\n\t}\n\n\tprotected onTargetChange(previous: boolean, current: boolean): void {\n\t\tthis.getEl().disabled = !current;\n\t}\n\n}\n\nFactories.register(\"enabled\", [\"*\"], Enabled);\n\nexport default Enabled;\n","import ElementMediator from \"@/element/ElementMediator\";\nimport Factories from \"@/mvvm/Factories\";\nimport { asBoolean } from \"@/model/Reducers\";\n\nclass ReadOnly extends ElementMediator<boolean, HTMLInputElement, any> {\n\n\tconstructor(deps: any) {\n\t\tsuper(deps, false, asBoolean);\n\t}\n\n\tpublic wire(): void {\n\t\tthis.getModelMediator().watch(this, this.onTargetChange);\n\t}\n\n\tpublic unwire(): void {\n\t\t// Intentionally do nothing\n\t}\n\n\tprotected onTargetChange(previous: boolean, current: boolean): void {\n\t\tthis.getEl().readOnly = current;\n\t}\n\n}\n\nFactories.register(\"readonly\", [\"*\"], ReadOnly);\n\nexport default ReadOnly;\n","import ElementMediator from \"@/element/ElementMediator\";\nimport Factories from \"@/mvvm/Factories\";\n\nclass Style extends ElementMediator<any, HTMLElement, any> {\n\n\tpublic wire(): void {\n\t\tthis.getModelMediator().watch(this, this.onTargetChange);\n\t}\n\n\tpublic unwire(): void {\n\t\t// Intentionally do nothing\n\t}\n\n\tprotected onTargetChange(previous: any, current: any): void {\n\t\tif (current === null) {\n\t\t\treturn;\n\t\t}\n\n\t\tfor (const key in current) {\n\t\t\tif (!current.hasOwnProperty(key)) {\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tthis.getEl().style[key] = current[key] + \"\";\n\t\t}\n\t}\n\n}\n\nFactories.register(\"style\", [\"*\"], Style);\n\nexport default Style;\n","import ElementMediator from \"@/element/ElementMediator\";\nimport { INTERNAL_CHANNEL_NAME } from \"@/constant/Constants\";\nimport Events from \"@/constant/Events\";\nimport Factories from \"@/mvvm/Factories\";\nimport { asBoolean } from \"@/model/Reducers\";\n\nclass ForceFocus extends ElementMediator<boolean, HTMLElement, any> {\n\n\tprivate shouldFocus: boolean;\n\n\tconstructor(deps: any) {\n\t\tsuper(deps, false, asBoolean);\n\t}\n\n\tpublic wire(): void {\n\t\tthis.bridge(\"focusout\");\n\t\tthis.on(\"focusout\").forChannel(\"dom\").invoke(this.handleFocus);\n\t\tthis.on(Events.COMPONENT_NESTING_CHANGED).forChannel(INTERNAL_CHANNEL_NAME).invoke(this.handleFocus);\n\t\tthis.shouldFocus = this.getModelMediator().get();\n\t\tthis.getModelMediator().watch(this, this.onTargetChange);\n\t\tthis.handleFocus();\n\t}\n\n\tpublic unwire(): void {\n\t\t// Intentionally do nothing\n\t}\n\n\tpublic handleFocus(): void {\n\t\tif (this.shouldFocus) {\n\t\t\tthis.getEl().focus();\n\t\t}\n\t}\n\n\tprotected onTargetChange(previous: boolean, current: boolean): void {\n\t\tthis.shouldFocus = current;\n\t\tthis.handleFocus();\n\t}\n\n}\n\nFactories.register(\"force-focus\", [\"*\"], ForceFocus);\n\nexport default ForceFocus;\n","import ElementMediator from \"@/element/ElementMediator\";\nimport Factories from \"@/mvvm/Factories\";\n\n/**\n *\n */\nclass MultiSelectValueModel extends ElementMediator<string | string[], HTMLSelectElement, any> {\n\n\tpublic wire(): void {\n\t\tthis.bridge(\"input\");\n\t\tthis.on(\"input\").forChannel(\"dom\").invoke(this.handleInput);\n\t\tthis.getModelMediator().watch(this, this.onTargetChange);\n\t}\n\n\tpublic unwire(): void {\n\t\t// Intentionally do nothing\n\t}\n\n\tpublic handleInput(event: Event): void {\n\t\tif (this.getEl().multiple) {\n\t\t\tconst selectedValues: (string | number)[] = [];\n\n\t\t\tfor (let i = 0; i < this.getEl().selectedOptions.length; i++) {\n\t\t\t\tconst optValue: string = this.getEl().selectedOptions.item(i).getAttribute(\"value\");\n\t\t\t\tselectedValues.push(optValue);\n\t\t\t}\n\n\t\t\tthis.$apply(() => {\n\t\t\t\tthis.getModelMediator().set(selectedValues);\n\t\t\t}, []);\n\t\t} else {\n\t\t\tthis.$apply(() => {\n\t\t\t\tthis.getModelMediator().set(this.getEl()[\"value\"]);\n\t\t\t}, []);\n\t\t}\n\t}\n\n\tprotected onTargetChange(previous: string | string[], current: string | string[]): void {\n\t\tif (this.getEl().multiple) {\n\t\t\tcurrent = (current === null) ? [] : current;\n\n\t\t\tfor (let i = 0; i < this.getEl().options.length; i++) {\n\t\t\t\tconst element: HTMLOptionElement = this.getEl().options.item(i);\n\t\t\t\telement.selected = current.includes(element.value);\n\t\t\t}\n\t\t} else {\n\t\t\tthis.getEl().value = current as string;\n\t\t}\n\t}\n\n}\n\nFactories.register(\"model\", [\"select\"], MultiSelectValueModel);\n\nexport default MultiSelectValueModel;\n","import ElementMediator from \"@/element/ElementMediator\";\nimport Factories from \"@/mvvm/Factories\";\n\n/**\n *\n */\nclass ValuedModel extends ElementMediator<string, HTMLInputElement, any> {\n\n\tpublic wire(): void {\n\t\tthis.bridge(\"input\");\n\t\tthis.on(\"input\").forChannel(\"dom\").invoke(this.handleInput);\n\t\tthis.getModelMediator().watch(this, this.onTargetChange);\n\t}\n\n\tpublic unwire(): void {\n\t\t// Intentionally do nothing\n\t}\n\n\tpublic handleInput(event: Event): void {\n\t\tthis.$apply(() => {\n\t\t\tthis.getModelMediator().set(this.getEl().value);\n\t\t}, []);\n\t}\n\n\tprotected onTargetChange(previous: string, current: string): void {\n\t\tthis.getEl().value = current;\n\t}\n\n}\n\nFactories.register(\"model\", [\"textarea\"], ValuedModel);\n\nexport default ValuedModel;\n","import ElementMediator from \"@/element/ElementMediator\";\nimport Factories from \"@/mvvm/Factories\";\n\n/**\n *\n */\nclass InputValueModel extends ElementMediator<string, HTMLInputElement, any> {\n\n\tpublic wire(): void {\n\t\tthis.bridge(\"input\");\n\t\tconst isRadio: boolean = this.getEl().type.toLowerCase() === \"radio\";\n\t\tthis.on(\"input\").forChannel(\"dom\").invoke(isRadio ? this.handleRadioInput : this.handleInput);\n\t\tthis.getModelMediator().watch(this, (isRadio ? this.onRadioTargetChange : this.onTargetChange));\n\t}\n\n\tpublic unwire(): void {\n\t\t// Intentionally do nothing\n\t}\n\n\tpublic handleInput(event: Event): void {\n\t\tthis.$apply(() => {\n\t\t\tthis.getModelMediator().set(this.getEl().value);\n\t\t}, []);\n\t}\n\n\tpublic handleRadioInput(event: Event): void {\n\t\tif (this.getEl().checked) {\n\t\t\tthis.$apply(() => {\n\t\t\t\tthis.getModelMediator().set(this.getEl().value);\n\t\t\t}, []);\n\t\t}\n\t}\n\n\tprotected onTargetChange(previous: string, current: string): void {\n\t\tthis.getEl().value = current;\n\t}\n\n\tprotected onRadioTargetChange(previous: string, current: string): void {\n\t\tif (this.getEl().value === current) {\n\t\t\tthis.getEl().checked = true;\n\t\t}\n\t}\n\n}\n\nFactories.register(\"model\", [\"input\"], InputValueModel);\n\nexport default InputValueModel;\n","import ElementMediator from \"@/element/ElementMediator\";\nimport Factories from \"@/mvvm/Factories\";\nimport { asBoolean } from \"@/model/Reducers\";\n\n/**\n *\n */\nclass Visible extends ElementMediator<boolean, HTMLElement, any> {\n\n\tconstructor(deps: any) {\n\t\tsuper(deps, false, asBoolean);\n\t}\n\n\tpublic wire(): void {\n\t\tthis.getModelMediator().watch(this, this.onTargetChange);\n\t}\n\n\tpublic unwire(): void {\n\t\t// Intentionally do nothing\n\t}\n\n\tprotected onTargetChange(previous: boolean, current: boolean): void {\n\t\tthis.getEl().hidden = !current;\n\t}\n\n}\n\nFactories.register(\"visible\", [\"*\"], Visible);\n\nexport default Visible;\n","import ElementMediator from \"@/element/ElementMediator\";\nimport Properties from \"@/config/Properties\";\nimport Factories from \"@/mvvm/Factories\";\nimport { asBoolean } from \"@/model/Reducers\";\n\n/**\n *\n */\nclass If extends ElementMediator<boolean, HTMLElement, any> {\n\n\tprivate comment: Comment;\n\n\tprivate initialized: boolean = false;\n\n\tconstructor(deps: any) {\n\t\tsuper(deps, false, asBoolean);\n\t}\n\n\tpublic wire(): void {\n\t\tthis.comment = Properties.getWindow().document.createComment(\" hidden \");\n\t\tthis.getModelMediator().watch(this, this.onTargetChange);\n\t}\n\n\tpublic unwire(): void {\n\t\t// Intentionally do nothing\n\t}\n\n\tprotected onTargetChange(previous: boolean, current: boolean): void {\n\t\tif (this.initialized) {\n\t\t\tconst activeEl: any = current ? this.comment : this.getEl();\n\t\t\tactiveEl.parentElement.replaceChild((current ? this.getEl() : this.comment) as HTMLElement, activeEl as HTMLElement);\n\t\t} else {\n\t\t\tif (!current) {\n\t\t\t\tthis.getEl().parentElement.replaceChild((this.comment as any) as HTMLElement, this.getEl());\n\t\t\t}\n\n\t\t\tthis.initialized = true;\n\t\t}\n\t}\n\n}\n\nFactories.register(\"if\", [\"*\"], If);\n\nexport default If;\n","import Evaluator from \"@/model/Evaluator\";\nimport ObjectUtils from \"@/util/ObjectUtils\";\nimport ScopeImpl from \"@/model/ScopeImpl\";\nimport Properties from \"@/config/Properties\";\nimport { INTERNAL_DIRECT_CHANNEL_NAME } from \"@/constant/Constants\";\nimport ElementMediator from \"@/element/ElementMediator\";\nimport Nestable from \"@/component/Nestable\";\nimport MediatorSource from \"@/mvvm/MediatorSource\";\nimport Factories from \"@/mvvm/Factories\";\nimport SimpleMap from \"@/pattern/SimpleMap\";\nimport IdStrategy from \"@/element/repeat/IdStrategy\";\nimport GeneratedIdStrategyImpl from \"@/element/repeat/GeneratedIdStrategyImpl\";\nimport NoneIdStrategyImpl from \"@/element/repeat/NoneIdStrategyImpl\";\nimport ComponentFactory from \"@/element/repeat/ComponentFactory\";\nimport Params from \"@/element/repeat/Params\";\nimport UtilityComponentFactoryImpl from \"@/element/repeat/UtilityComponentFactoryImpl\";\nimport ItemComponentFactoryImpl from \"@/element/repeat/ItemComponentFactoryImpl\";\nimport EmbeddedComponentFactoryImpl from \"@/element/repeat/EmbeddedComponentFactoryImpl\";\nimport InvalidIdStrategyImpl from \"@/element/repeat/InvalidIdStrategyImpl\";\nimport ExpressionIdStrategyImpl from \"@/element/repeat/ExpressionIdStrategyImpl\";\nimport { asIdentity } from \"@/model/Reducers\";\n\nconst isDefined = ObjectUtils.isDefined;\n\nconst DEFAULT_ID_KEY: string = \"id\";\n\n/**\n *\n */\nclass Repeat extends ElementMediator<any[], HTMLElement, Params> {\n\n\tprivate map: SimpleMap<Nestable>;\n\n\tprivate empty: Nestable;\n\n\tprivate first: Nestable;\n\n\tprivate last: Nestable;\n\n\tprivate ids: string[];\n\n\tprivate localScope: ScopeImpl;\n\n\tprivate scopeItem: any;\n\n\tprivate itemFactory: ComponentFactory;\n\n\tprivate idStrategy: IdStrategy;\n\n\tprivate elIsSelect: boolean;\n\n\tprivate alternatives: {\n\t\ttest: Evaluator;\n\t\tfactory: ComponentFactory;\n\t}[];\n\n\tconstructor(deps: any) {\n\t\tsuper(deps, true, asIdentity);\n\t\tthis.idStrategy = null;\n\t\tthis.elIsSelect = (this.getEl().tagName.toLowerCase() === \"select\");\n\t}\n\n\tpublic wire(): void {\n\t\tthis.map = {};\n\t\tthis.empty = null;\n\t\tthis.ids = [];\n\t\tthis.itemFactory = null;\n\t\tthis.alternatives = [];\n\t\tthis.localScope = new ScopeImpl(false);\n\n\t\tconst modelFn: () => any = () => this.getModelFn();\n\t\tconst itemFn: () => any = () => this.scopeItem;\n\t\tthis.localScope.setParent(this.getParent().scope() as ScopeImpl);\n\t\tthis.localScope.add(\"m\", modelFn);\n\t\tthis.localScope.add(\"model\", modelFn);\n\t\tthis.localScope.add(\"i\", itemFn);\n\t\tthis.localScope.add(\"item\", itemFn);\n\t\tthis.localScope.add(\"v\", itemFn);\n\t\tthis.localScope.add(\"value\", itemFn);\n\n\t\tthis.getModelMediator().watch(this, this.onTargetChange);\n\t\tconst idKey: string = this.getParams().idkey || DEFAULT_ID_KEY;\n\t\tconst idExpression: string = this.getParams().expression;\n\t\tconst mode: string = this.getParams().mode || null;\n\n\t\tswitch (mode) {\n\t\t\tcase \"generated\":\n\t\t\t\tthis.idStrategy = new GeneratedIdStrategyImpl(idKey);\n\t\t\t\tbreak;\n\n\t\t\tcase \"none\":\n\t\t\t\tthis.idStrategy = new NoneIdStrategyImpl(idKey);\n\t\t\t\tbreak;\n\n\t\t\tcase \"expression\":\n\t\t\t\tthis.idStrategy = new ExpressionIdStrategyImpl(idExpression);\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\t\t\t\tthis.idStrategy = new InvalidIdStrategyImpl();\n\t\t}\n\n\t\tthis.idStrategy.init();\n\n\t\tconst children: HTMLCollection = this.getEl().children;\n\n\t\t// tslint:disable-next-line\n\t\tfor (let i = 0; i < children.length; i++) {\n\t\t\tconst child: ChildNode = children[i];\n\n\t\t\tif (\"template\" !== child.nodeName.toLowerCase()) {\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tconst template: HTMLElement = child as HTMLElement;\n\n\t\t\tif (!isDefined(template.innerHTML)) {\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tconst markup: string = template.innerHTML.trim();\n\t\t\tconst type: string = template.getAttribute(\"type\");\n\n\t\t\tswitch (type) {\n\t\t\t\tcase \"empty\":\n\t\t\t\t\tthis.empty = this.createFactory(markup, UtilityComponentFactoryImpl).create();\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"first\":\n\t\t\t\t\tthis.first = this.createFactory(markup, UtilityComponentFactoryImpl).create();\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"after\":\n\t\t\t\t\tthis.last = this.createFactory(markup, UtilityComponentFactoryImpl).create();\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"alt\":\n\t\t\t\t\tconst expression: string = template.getAttribute(\"test\");\n\t\t\t\t\tthis.alternatives.push({\n\t\t\t\t\t\tfactory: this.createFactory(markup, ItemComponentFactoryImpl),\n\t\t\t\t\t\ttest: new Evaluator(expression, this.localScope)\n\t\t\t\t\t});\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"item\":\n\t\t\t\t\tthis.itemFactory = this.createFactory(markup, ItemComponentFactoryImpl);\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\tconst el: HTMLElement = this.getEl();\n\n\t\twhile (el.firstChild) {\n\t\t\tel.removeChild(el.firstChild);\n\t\t}\n\n\t\tif (this.empty) {\n\t\t\tel.appendChild(this.empty.getEl());\n\t\t}\n\t}\n\n\tpublic unwire(): void {\n\t\tif (this.empty) {\n\t\t\tthis.empty.dispose();\n\t\t}\n\n\t\tif (this.first) {\n\t\t\tthis.first.dispose();\n\t\t}\n\n\t\tif (this.last) {\n\t\t\tthis.last.dispose();\n\t\t}\n\n\t\tfor (const key in this.map) {\n\t\t\tif (!this.map.hasOwnProperty(key)) {\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tconst component: Nestable = this.map[key];\n\t\t\tcomponent.dispose();\n\t\t}\n\n\t\tthis.empty = null;\n\t\tthis.map = {};\n\t}\n\n\tpublic requestMediatorSources(sources: MediatorSource[]): void {\n\t\tfor (const key in this.map) {\n\t\t\tif (!this.map.hasOwnProperty(key)) {\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tconst component: Nestable = this.map[key];\n\t\t\tcomponent.message(INTERNAL_DIRECT_CHANNEL_NAME, \"consumeDigestionCandidates\", sources);\n\t\t}\n\n\t\tif (this.first) {\n\t\t\tthis.first.message(INTERNAL_DIRECT_CHANNEL_NAME, \"consumeDigestionCandidates\", sources);\n\t\t}\n\n\t\tif (this.last) {\n\t\t\tthis.last.message(INTERNAL_DIRECT_CHANNEL_NAME, \"consumeDigestionCandidates\", sources);\n\t\t}\n\n\t\tif (this.empty) {\n\t\t\tthis.empty.message(INTERNAL_DIRECT_CHANNEL_NAME, \"consumeDigestionCandidates\", sources);\n\t\t}\n\t}\n\n\tprotected onTargetChange(previous: any[], current: any[]): void {\n\t\tconst newIds: string[] = [];\n\t\tconst items: any[] = current || [];\n\n\t\t// tslint:disable-next-line\n\t\tfor (let i = 0; i < items.length; i++) {\n\t\t\tconst item = items[i];\n\n\t\t\tif (!this.idStrategy.check(item)) {\n\t\t\t\tthis.idStrategy.enrich(item, i);\n\t\t\t}\n\n\t\t\tconst id: string = this.idStrategy.extract(item);\n\t\t\tnewIds.push(id);\n\t\t}\n\n\t\tif (!ObjectUtils.equals(this.ids, newIds)) {\n\t\t\tconst newMap: SimpleMap<Nestable> = {};\n\t\t\tconst components: Nestable[] = [];\n\n\t\t\tfor (const item of items) {\n\t\t\t\tconst id: string = this.idStrategy.extract(item);\n\t\t\t\tconst component: Nestable = this.map[id] ? this.map[id] : this.create(item);\n\t\t\t\tnewMap[id] = component;\n\t\t\t\tcomponents.push(component);\n\t\t\t\tdelete this.map[id];\n\t\t\t}\n\n\t\t\tfor (const key in this.map) {\n\t\t\t\tif (this.map.hasOwnProperty(key)) {\n\t\t\t\t\tconst component: Nestable = this.map[key];\n\t\t\t\t\tcomponent.dispose();\n\t\t\t\t\tdelete this.map[key];\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.map = newMap;\n\t\t\tconst el: HTMLElement = this.getEl();\n\n\t\t\twhile (el.firstChild) {\n\t\t\t\tel.removeChild(el.lastChild);\n\t\t\t}\n\n\t\t\tif (components.length === 0) {\n\t\t\t\tif (this.empty) {\n\t\t\t\t\tel.appendChild(this.empty.getEl());\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tconst workingEl: HTMLElement | DocumentFragment\n\t\t\t\t\t= (this.elIsSelect) ? el : Properties.getWindow().document.createDocumentFragment();\n\n\t\t\t\tif (this.first) {\n\t\t\t\t\tworkingEl.appendChild(this.first.getEl());\n\t\t\t\t}\n\n\t\t\t\tfor (const component of components) {\n\t\t\t\t\tworkingEl.appendChild(component.getEl());\n\t\t\t\t}\n\n\t\t\t\tif (this.last) {\n\t\t\t\t\tworkingEl.appendChild(this.last.getEl());\n\t\t\t\t}\n\t\t\t\tif (!this.elIsSelect) {\n\t\t\t\t\tel.appendChild(workingEl);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tthis.ids = newIds;\n\t}\n\n\tprivate create(item: any): Nestable {\n\t\tlet factory: ComponentFactory = this.itemFactory;\n\t\tthis.scopeItem = item;\n\n\t\ttry {\n\t\t\tif (this.alternatives.length > 0) {\n\t\t\t\tfor (const alternative of this.alternatives) {\n\t\t\t\t\tif (alternative.test.test()) {\n\t\t\t\t\t\tfactory = alternative.factory;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t} finally {\n\t\t\tthis.scopeItem = null;\n\t\t}\n\n\t\treturn factory.create(item);\n\t}\n\n\tprivate createFactory(markup: string, factory: any): ComponentFactory {\n\t\tconst templateEl: HTMLTemplateElement = Properties.getWindow().document.createElement(\"template\");\n\t\ttemplateEl.insertAdjacentHTML(\"afterbegin\", markup.trim());\n\t\tconst expectedTag: string = this.getParent().getPrefix() + \":component\";\n\n\t\tlet result: ComponentFactory = null;\n\n\t\tif (templateEl.childElementCount === 1 && templateEl.firstElementChild.nodeName.toLowerCase() === expectedTag.toLowerCase()) {\n\t\t\tconst componentId: string = templateEl.firstElementChild.getAttribute(\"name\");\n\t\t\tconst moduleId: string = templateEl.firstElementChild.getAttribute(\"module\");\n\t\t\tresult = new EmbeddedComponentFactoryImpl(this.getModule(), componentId, moduleId, this.getParent(), this.getParentId());\n\t\t} else {\n\t\t\tresult = new factory(this.getModule(), markup, this.getParent().getPrefix(), this.getParent(), this.getParentId(), this.getModelFn());\n\t\t}\n\n\t\treturn result;\n\t}\n\n}\n\nFactories.register(\"repeat\", [\"*\"], Repeat);\n\nexport default Repeat;\n","import Logger from \"@/logger/Logger\";\nimport LoggerFactory from \"@/logger/LoggerFactory\";\nimport ScopeImpl from \"@/model/ScopeImpl\";\n\nclass Evaluator {\n\n\tprivate expression: string;\n\n\tprivate logger: Logger;\n\n\tprivate scope: ScopeImpl;\n\n\tprivate code: string;\n\n\tconstructor(expression: string, scope: ScopeImpl) {\n\t\tthis.logger = LoggerFactory.getLogger(\"Evaluator: \" + expression);\n\t\tthis.expression = expression;\n\t\tthis.scope = scope;\n\t\tthis.code = '\"use strict\"; ' + scope.getCode() + \" return (\" + this.expression + \");\";\n\t}\n\n\tpublic test(): boolean {\n\t\tlet value: boolean = null;\n\n\t\ttry {\n\t\t\tvalue = !!Function(this.code).apply({}, [this.scope.getItems()]);\n\t\t} catch (e) {\n\t\t\tthis.logger.error(\"\\nAn exception (\" + e.name + \") was thrown invoking the element mediator expression: \"\n\t\t\t\t+ this.expression + \"\\n\\nIn context:\\n\" + this.code + \"\\n\\nException message: \" + e.message + \"\\n\\n\", e);\n\t\t}\n\n\t\treturn value;\n\t}\n\n}\n\nexport default Evaluator;\n","import { CydranError } from \"@/error/AbstractCydranError\";\n\nclass ScopeError extends CydranError {\n\n\tconstructor(msg: string, reps?: any) {\n\t\tsuper(msg, reps);\n\t}\n\n}\n\nexport default ScopeError;\n","import IdStrategy from \"@/element/repeat/IdStrategy\";\nimport ObjectUtils from \"@/util/ObjectUtils\";\nimport { uuidV4 } from \"@/util/UuidUtils\";\n\nclass GeneratedIdStrategyImpl implements IdStrategy {\n\n\tprivate idKey: string;\n\n\tconstructor(idKey: string) {\n\t\tthis.idKey = idKey;\n\t}\n\n\tpublic check(item: any): boolean {\n\t\treturn ObjectUtils.isDefined(item[this.idKey]);\n\t}\n\n\tpublic enrich(item: any, index: number): void {\n\t\titem[this.idKey] = uuidV4();\n\t}\n\n\tpublic extract(item: any): string {\n\t\treturn item[this.idKey] + \"\";\n\t}\n\n\tpublic init(): void {\n\t\t// Intentionally do nothing\n\t}\n\n}\n\nexport default GeneratedIdStrategyImpl;\n","const CHARS = '0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz'.split('');\n\nfunction uuidV4() {\n\tconst chars = CHARS;\n\tconst uuid = new Array(36);\n\tlet rnd=0;\n\tlet r = null;\n\n\tfor (let i: number = 0; i < 36; i++) {\n\t\tif (i === 8 || i === 13 || i === 18 || i === 23) {\n\t\t\tuuid[i] = '-';\n\t\t} else if (i === 14) {\n\t\t\tuuid[i] = '4';\n\t\t} else {\n\t\t\tif (rnd <= 0x02) {\n\t\t\t\trnd = 0x2000000 + (Math.random()*0x1000000)|0;\n\t\t\t}\n\n\t\t\tr = rnd & 0xf;\n\t\t\trnd = rnd >> 4;\n\t\t\tuuid[i] = chars[(i === 19) ? (r & 0x3) | 0x8 : r];\n\t\t}\n\t}\n\n\treturn uuid.join('');\n}\n\nexport { uuidV4 };\n","import IdStrategy from \"@/element/repeat/IdStrategy\";\nimport ObjectUtils from \"@/util/ObjectUtils\";\n\nclass NoneIdStrategyImpl implements IdStrategy {\n\n\tprivate idKey: string;\n\n\tconstructor(idKey: string) {\n\t\tthis.idKey = idKey;\n\t}\n\n\tpublic check(item: any): boolean {\n\t\treturn ObjectUtils.isDefined(item[this.idKey]);\n\t}\n\n\tpublic enrich(item: any, index: number): void {\n\t\tthrow new Error(\"Missing id in field \" + this.idKey + \" for item at index \" + index\n\t\t\t+ \".  All repeat items must include a string convertable id to be repeated.\");\n\t}\n\n\tpublic extract(item: any): string {\n\t\treturn item[this.idKey] + \"\";\n\t}\n\n\tpublic init(): void {\n\t\t// Intentionally do nothing\n\t}\n\n}\n\nexport default NoneIdStrategyImpl;\n","import ComponentFactory from \"@/element/repeat/ComponentFactory\";\nimport Nestable from \"@/component/Nestable\";\nimport UtilityComponent from \"@/element/repeat/UtilityComponent\";\nimport Module from \"@/module/Module\";\n\nclass UtilityComponentFactoryImpl implements ComponentFactory {\n\n\tprivate template: string;\n\n\tprivate prefix: string;\n\n\tprivate parent: Nestable;\n\n\tprivate parentId: string;\n\n\tprivate parentModelFn: () => any;\n\n\tprivate module: Module;\n\n\tconstructor(module: Module, template: string, prefix: string, parent: Nestable, parentId: string, parentModelFn: () => any) {\n\t\tthis.module = module;\n\t\tthis.template = template;\n\t\tthis.prefix = prefix;\n\t\tthis.parent = parent;\n\t\tthis.parentId = parentId;\n\t\tthis.parentModelFn = parentModelFn;\n\t}\n\n\tpublic create(): Nestable {\n\t\treturn new UtilityComponent(this.module, this.template, this.prefix, this.parent, this.parentId, this.parentModelFn);\n\t}\n\n}\n\nexport default UtilityComponentFactoryImpl;\n","import Component from \"@/component/Component\";\nimport Nestable from \"@/component/Nestable\";\nimport { ComponentConfigImpl } from \"@/component/ComponentConfig\";\nimport { INTERNAL_DIRECT_CHANNEL_NAME } from \"@/constant/Constants\";\nimport Module from \"@/module/Module\";\n\nclass UtilityComponent extends Component {\n\n\tconstructor(module: Module, template: string, prefix: string, parent: Nestable, parentId: string, parentModelFn: () => any) {\n\t\tconst config: ComponentConfigImpl = new ComponentConfigImpl();\n\t\tconfig.withPrefix(prefix);\n\t\tconfig.setParentModelFn(parentModelFn);\n\t\tconfig.setModule(module);\n\t\tsuper(template, config);\n\t\tthis.message(INTERNAL_DIRECT_CHANNEL_NAME, \"skipId\", parentId);\n\t\tthis.message(INTERNAL_DIRECT_CHANNEL_NAME, \"setMode\", \"repeatable\");\n\t\tthis.message(INTERNAL_DIRECT_CHANNEL_NAME, \"setParent\", parent);\n\t}\n\n}\n\nexport default UtilityComponent;\n","import Logger from \"@/logger/Logger\";\nimport LoggerFactory from \"@/logger/LoggerFactory\";\nimport { INTERNAL_DIRECT_CHANNEL_NAME, EMPTY_OBJECT_FN } from \"@/constant/Constants\";\nimport Nestable from \"@/component/Nestable\";\nimport ComponentInternals from \"@/component/ComponentInternals\";\nimport ObjectUtils from \"@/util/ObjectUtils\";\n\nconst isDefined = ObjectUtils.isDefined;\n\nclass Region {\n\n\tprivate logger: Logger;\n\n\tprivate defaultEl: HTMLElement;\n\n\tprivate component: Nestable;\n\n\tprivate parent: ComponentInternals;\n\n\tprivate name: string;\n\n\tprivate itemFn: () => any;\n\n\tprivate expression: string;\n\n\tconstructor(name: string, parent: ComponentInternals) {\n\t\tthis.logger = LoggerFactory.getLogger(\"Region \" + this.name + \" for \" + parent.getId());\n\t\tthis.itemFn = EMPTY_OBJECT_FN;\n\t\tthis.defaultEl = null;\n\t\tthis.component = null;\n\t\tthis.parent = parent;\n\t\tthis.name = name;\n\t\tthis.expression = null;\n\t}\n\n\tpublic setDefaultEl(defaultEl: HTMLElement): void {\n\t\tthis.defaultEl = defaultEl;\n\t}\n\n\tpublic hasExpression(): boolean {\n\t\treturn isDefined(this.expression);\n\t}\n\n\tpublic setExpression(expression: string): void {\n\t\tthis.itemFn = isDefined(expression)\n\t\t\t? () => this.parent.evaluate(expression)\n\t\t\t: EMPTY_OBJECT_FN;\n\n\t\tthis.expression = expression;\n\n\t\tthis.syncComponentMode();\n\t}\n\n\tpublic getComponent<N extends Nestable>(): N {\n\t\treturn this.component as N;\n\t}\n\n\tpublic setComponent(component: Nestable): void {\n\t\tif (this.component === component) {\n\t\t\tthis.logger.trace(\"Component unchanged, so not setting.\");\n\t\t\treturn;\n\t\t}\n\n\t\tif (isDefined(component)) {\n\t\t\tthis.logger.ifTrace(() => \"Setting component \" + component.getId());\n\t\t}\n\n\t\tif (isDefined(this.component)) {\n\t\t\tthis.component.message(INTERNAL_DIRECT_CHANNEL_NAME, \"setItemFn\", EMPTY_OBJECT_FN);\n\t\t\tthis.component.message(INTERNAL_DIRECT_CHANNEL_NAME, \"setMode\", \"\");\n\t\t}\n\n\t\tif (isDefined(component)) {\n\t\t\tcomponent.message(INTERNAL_DIRECT_CHANNEL_NAME, \"setItemFn\", this.itemFn);\n\t\t}\n\n\t\tif (isDefined(component) && !isDefined(this.component)) {\n\t\t\t// Component being set, no existing component\n\t\t\tthis.component = component;\n\t\t\tconst newComponentEl: HTMLElement = component.getEl();\n\t\t\tconst parentElement: HTMLElement = this.defaultEl.parentElement;\n\t\t\tparentElement.replaceChild(newComponentEl, this.defaultEl);\n\t\t\tthis.component.message(INTERNAL_DIRECT_CHANNEL_NAME, \"setParent\", this.parent.getComponent());\n\t\t} else if (!isDefined(component) && isDefined(this.component)) {\n\t\t\t// Component being nulled, existing component present\n\t\t\tthis.component.message(INTERNAL_DIRECT_CHANNEL_NAME, \"setParent\", null);\n\t\t\tconst oldComponentEl: HTMLElement = this.component.getEl();\n\t\t\tthis.component = null;\n\t\t\tconst parentElement: HTMLElement = oldComponentEl.parentElement;\n\t\t\tparentElement.replaceChild(this.defaultEl, oldComponentEl);\n\t\t} else if (isDefined(component) && isDefined(this.component)) {\n\t\t\t// Component being set, existing component present\n\t\t\tthis.component.message(INTERNAL_DIRECT_CHANNEL_NAME, \"setParent\", null);\n\t\t\tconst newComponentEl: HTMLElement = component.getEl();\n\t\t\tconst oldComponentEl: HTMLElement = this.component.getEl();\n\t\t\tconst parentElement: HTMLElement = oldComponentEl.parentElement;\n\t\t\tparentElement.replaceChild(newComponentEl, oldComponentEl);\n\t\t\tthis.component = component;\n\t\t\tthis.component.message(INTERNAL_DIRECT_CHANNEL_NAME, \"setParent\", this.parent.getComponent());\n\t\t}\n\n\t\tthis.syncComponentMode();\n\t}\n\n\tpublic message(channelName: string, messageName: string, payload: any): void {\n\t\tif (isDefined(this.component)) {\n\t\t\tthis.component.message(channelName, messageName, payload);\n\t\t}\n\t}\n\n\tpublic hasComponent(): boolean {\n\t\treturn isDefined(this.component);\n\t}\n\n\tpublic dispose() {\n\t\tif (isDefined(this.component)) {\n\t\t\tthis.component.dispose();\n\t\t}\n\n\t\tthis.setComponent(null);\n\t}\n\n\tprivate syncComponentMode(): void {\n\t\tif (isDefined(this.component)) {\n\t\t\tif (isDefined(this.expression)) {\n\t\t\t\tthis.component.message(INTERNAL_DIRECT_CHANNEL_NAME, \"setMode\", \"repeatable\");\n\t\t\t} else {\n\t\t\t\tthis.component.message(INTERNAL_DIRECT_CHANNEL_NAME, \"setMode\", \"\");\n\t\t\t}\n\t\t}\n\t}\n\n}\n\nexport default Region;\n","import { CydranError } from \"@/error/AbstractCydranError\";\n\nclass UnknownRegionError extends CydranError {\n\n\tconstructor(msg: string, reps?: any) {\n\t\tsuper(msg, reps);\n\t}\n\n}\n\nexport default UnknownRegionError;\n","import { CydranError } from \"@/error/AbstractCydranError\";\n\nclass SetComponentError extends CydranError {\n\n\tconstructor(msg: string, reps?: any) {\n\t\tsuper(msg, reps);\n\t}\n\n}\n\nexport default SetComponentError;\n","import Getter from \"@/model/Getter\";\nimport ScopeImpl from \"@/model/ScopeImpl\";\nimport Setter from \"@/model/Setter\";\n\nclass ExternalMediator<T> {\n\n\tprivate getter: Getter<T>;\n\n\tprivate setter: Setter<T>;\n\n\tconstructor(expression: string) {\n\t\tthis.getter = new Getter(expression);\n\t\tthis.setter = new Setter(expression);\n\t}\n\n\tpublic get(scope: ScopeImpl): T {\n\t\treturn this.getter.get(scope);\n\t}\n\n\tpublic set(scope: ScopeImpl, value: T): void {\n\t\tthis.setter.set(scope, value);\n\t}\n\n}\n\nexport default ExternalMediator;\n","import Mvvm from \"@/mvvm/Mvvm\";\nimport Logger from \"@/logger/Logger\";\nimport Region from \"@/component/Region\";\nimport LoggerFactory from \"@/logger/LoggerFactory\";\nimport ScopeImpl from \"@/model/ScopeImpl\";\nimport { INTERNAL_DIRECT_CHANNEL_NAME, TEXT_NODE_TYPE } from \"@/constant/Constants\";\nimport ModelMediatorImpl from \"@/model/ModelMediatorImpl\";\nimport ModelMediator from \"@/model/ModelMediator\";\nimport DigestionContextImpl from \"@/mvvm/DigestionContextImpl\";\nimport DigestionContext from \"@/mvvm/DigestionContext\";\nimport MalformedOnEventError from \"@/error/MalformedOnEventError\";\nimport Module from \"@/module/Module\";\nimport ElementMediator from \"@/element/ElementMediator\";\nimport ComponentInternals from \"@/component/ComponentInternals\";\nimport Nestable from \"@/component/Nestable\";\nimport TemplateError from \"@/error/TemplateError\";\nimport ExternalAttributeDetail from \"@/model/ExternalAttributeDetail\";\nimport Properties from \"@/config/Properties\";\nimport TextElementMediator from \"@/element/TextElementMediator\";\nimport EventElementMediator from \"@/element/EventElementMediator\";\nimport AttributeElementMediator from \"@/element/AttributeElementMediator\";\nimport Factories from \"@/mvvm/Factories\";\nimport MediatorSource from \"@/mvvm/MediatorSource\";\nimport SimpleMap from \"@/pattern/SimpleMap\";\nimport DigestionCandidateConsumer from \"@/mvvm/DigestionCandidateConsumer\";\nimport DigestionCandidate from \"@/mvvm/DigestionCandidate\";\nimport DirectEvents from \"@/constant/DirectEvents\";\nimport ObjectUtils from \"@/util/ObjectUtils\";\nimport DigestLoopError from \"@/error/DigestLoopError\";\nimport Notifyable from \"@/mvvm/Notifyable\";\nimport ElementMediatorDependencies from \"@/element/ElementMediatorDependencies\";\nimport ModulesContext from \"@/module/ModulesContext\";\nimport Type from \"@/type/Type\";\n\nconst requireNonNull = ObjectUtils.requireNotNull;\nconst isDefined = ObjectUtils.isDefined;\n\nconst MAX_EVALUATIONS: number = 10000;\n\nclass MvvmImpl implements Mvvm {\n\n\tprivate logger: Logger;\n\n\tprivate el: HTMLElement;\n\n\tprivate elementMediators: ElementMediator<any, HTMLElement | Text, any>[];\n\n\tprivate mediators: ModelMediatorImpl<any>[];\n\n\tprivate propagatingElementMediators: ElementMediator<any, HTMLElement | Text, any>[];\n\n\tprivate model: any;\n\n\tprivate parent: ComponentInternals;\n\n\tprivate moduleInstance: Module;\n\n\tprivate elementMediatorPrefix: string;\n\n\tprivate eventElementMediatorPrefix: string;\n\n\tprivate externalAttributePrefix: string;\n\n\tprivate regionPrefix: string;\n\n\tprivate namePrefix: string;\n\n\tprivate componentPrefix: string;\n\n\tprivate components: Nestable[];\n\n\tprivate scope: ScopeImpl;\n\n\tprivate modules: ModulesContext;\n\n\tprivate id: string;\n\n\tprivate namedElements: SimpleMap<HTMLElement>;\n\n\tprivate regionLookupFn: (name: string) => Region;\n\n\tprivate modelFn: () => any;\n\n\tprivate itemFn: () => any;\n\n\tprivate externalFn: () => any;\n\n\tprivate skipableIds: string[];\n\n\tconstructor(id: string, model: any, moduleInstance: Module, prefix: string, scope: ScopeImpl, parentModelFn: () => any) {\n\t\tthis.id = requireNonNull(id, \"id\");\n\t\tthis.elementMediatorPrefix = prefix + \":\";\n\t\tthis.eventElementMediatorPrefix = prefix + \":on\";\n\t\tthis.externalAttributePrefix = prefix + \":property-\";\n\t\tthis.regionPrefix = prefix + \":region\";\n\t\tthis.namePrefix = prefix + \":name\";\n\t\tthis.componentPrefix = prefix + \":component\";\n\t\tthis.logger = LoggerFactory.getLogger(\"Mvvm \" + this.id);\n\t\tthis.propagatingElementMediators = [];\n\t\tthis.scope = new ScopeImpl(false);\n\t\tthis.scope.setParent(scope);\n\t\tthis.elementMediators = [];\n\t\tthis.namedElements = {};\n\t\tthis.mediators = [];\n\t\tthis.model = model;\n\t\tthis.moduleInstance = moduleInstance;\n\t\tthis.components = [];\n\t\tthis.skipableIds = [];\n\n\t\tconst localModelFn: () => any = () => this.model;\n\t\tthis.modelFn = parentModelFn ? parentModelFn : localModelFn;\n\t\tthis.itemFn = () => this.parent.getData();\n\t\tthis.externalFn = () => this.parent.getExternalCache();\n\n\t\tthis.scope.add(\"m\", this.modelFn);\n\t\tthis.scope.add(\"model\", this.modelFn);\n\t\tthis.scope.add(\"i\", this.itemFn);\n\t\tthis.scope.add(\"item\", this.itemFn);\n\t\tthis.scope.add(\"v\", this.itemFn);\n\t\tthis.scope.add(\"value\", this.itemFn);\n\t\tthis.scope.add(\"e\", this.externalFn);\n\t\tthis.scope.add(\"external\", this.externalFn);\n\t}\n\n\tpublic init(el: HTMLElement, parent: ComponentInternals, regionLookupFn: (name: string) => Region): void {\n\t\tthis.el = el;\n\t\tthis.parent = parent;\n\t\tthis.regionLookupFn = regionLookupFn;\n\t\tthis.validateEl();\n\t\tthis.populateElementMediators();\n\t}\n\n\tpublic nestingChanged(): void {\n\t\tfor (const elementMediator of this.elementMediators) {\n\t\t\telementMediator.message(INTERNAL_DIRECT_CHANNEL_NAME, DirectEvents.NESTING_CHANGED);\n\t\t}\n\n\t\tfor (const component of this.components) {\n\t\t\tcomponent.message(INTERNAL_DIRECT_CHANNEL_NAME, DirectEvents.NESTING_CHANGED);\n\t\t}\n\t}\n\n\tpublic dispose(): void {\n\t\tfor (const elementMediator of this.elementMediators) {\n\t\t\telementMediator.dispose();\n\t\t}\n\n\t\tthis.elementMediators = [];\n\t\tthis.components = [];\n\n\t\tfor (const component of this.components) {\n\t\t\tcomponent.dispose();\n\t\t}\n\n\t\tthis.parent = null;\n\t\tthis.namedElements = null;\n\t}\n\n\tpublic getId(): string {\n\t\treturn this.id;\n\t}\n\n\tpublic getNamedElement<E extends HTMLElement>(name: string): E {\n\t\tconst element: E = this.namedElements[name] as E;\n\t\treturn (element === undefined) ? null : element;\n\t}\n\n\tpublic mediate<T>(expression: string, reducerFn?: (input: any) => T): ModelMediator<T> {\n\t\tconst mediator: ModelMediator<T> = new ModelMediatorImpl<T>(this.model, expression, this.scope, this, reducerFn);\n\t\tthis.mediators.push(mediator as ModelMediatorImpl<any>);\n\n\t\treturn mediator;\n\t}\n\n\tpublic getScope(): ScopeImpl {\n\t\treturn this.scope;\n\t}\n\n\tpublic digest(): void {\n\t\tthis.logger.ifTrace(() => \"Started digest on \" + this.parent.getComponent().constructor.name);\n\t\tconst start: number = Date.now();\n\n\t\tlet remainingEvaluations: number = MAX_EVALUATIONS;\n\t\tlet pending: boolean = true;\n\n\t\twhile (pending && remainingEvaluations > 0) {\n\t\t\tremainingEvaluations--;\n\n\t\t\tconst context: DigestionContext = new DigestionContextImpl();\n\t\t\tconst seen: SimpleMap<boolean> = {};\n\t\t\tconst sources: MediatorSource[] = [];\n\n\t\t\twhile (this.skipableIds.length > 0) {\n\t\t\t\tconst skipableId: string = this.skipableIds.pop();\n\n\t\t\t\tif (skipableId !== null) {\n\t\t\t\t\tseen[skipableId] = true;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tsources.push(this);\n\n\t\t\tfor (const component of this.components) {\n\t\t\t\tcomponent.message(INTERNAL_DIRECT_CHANNEL_NAME, \"consumeDigestionCandidates\", sources);\n\t\t\t}\n\n\t\t\twhile (sources.length > 0) {\n\t\t\t\tconst source: MediatorSource = sources.pop();\n\t\t\t\tconst id: string = source.getId();\n\n\t\t\t\tif (id !== null && seen[id]) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tseen[id] = true;\n\t\t\t\tsource.requestMediatorSources(sources);\n\t\t\t\tsource.requestMediators(context);\n\t\t\t}\n\n\t\t\tconst changedMediators: Notifyable[] = context.digest();\n\n\t\t\tif (changedMediators.length === 0) {\n\t\t\t\tpending = false;\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tfor (const changedMediator of changedMediators) {\n\t\t\t\tchangedMediator.notify();\n\t\t\t}\n\t\t}\n\n\t\tif (remainingEvaluations === 0) {\n\t\t\tthrow new DigestLoopError(\"Loop detected in digest cycle.\");\n\t\t}\n\n\t\tthis.logger.ifTrace(() => this.getId() + \" - Elapsed millis \" + (Date.now() - start));\n\t\tthis.logger.ifTrace(() => \"Ended digest on \" + this.parent.getComponent().constructor.name);\n\t}\n\n\tpublic requestMediators(consumer: DigestionCandidateConsumer): void {\n\t\tif (this.parent.hasExternalMediators()) {\n\t\t\tconst mediators: DigestionCandidate[] = [];\n\n\t\t\tmediators.push({\n\t\t\t\tevaluate: () => {\n\t\t\t\t\tthis.parent.importExternals();\n\n\t\t\t\t\treturn false;\n\t\t\t\t},\n\t\t\t\tnotify: () => {\n\t\t\t\t\t// Intentionally do nothing\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tfor (const mediator of this.mediators) {\n\t\t\t\tmediators.push(mediator);\n\t\t\t}\n\n\t\t\tmediators.push({\n\t\t\t\tevaluate: () => {\n\t\t\t\t\tthis.parent.exportExternals();\n\n\t\t\t\t\treturn false;\n\t\t\t\t},\n\t\t\t\tnotify: () => {\n\t\t\t\t\t// Intentionally do nothing\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tconsumer.add(this.getId(), mediators);\n\t\t} else {\n\t\t\tconsumer.add(this.getId(), this.mediators);\n\t\t}\n\t}\n\n\tpublic requestMediatorSources(sources: MediatorSource[]): void {\n\t\tif (this.parent.hasExternalMediators() || this.parent.getFlags().repeatable) {\n\t\t\tif (isDefined(this.parent.getParent())) {\n\t\t\t\tthis.parent.getParent().message(INTERNAL_DIRECT_CHANNEL_NAME, \"consumeDigestionCandidates\", sources);\n\t\t\t}\n\t\t}\n\n\t\tthis.parent.message(INTERNAL_DIRECT_CHANNEL_NAME, \"consumeRegionDigestionCandidates\", sources);\n\n\t\tfor (const source of this.propagatingElementMediators) {\n\t\t\tsources.push(source);\n\t\t}\n\t}\n\n\tpublic getParent(): ComponentInternals {\n\t\treturn this.parent;\n\t}\n\n\tpublic $apply(fn: Function, args: any[]): any {\n\t\tlet result: any = null;\n\n\t\ttry {\n\t\t\tthis.parent.importExternals();\n\t\t} catch (e) {\n\t\t\tthis.logger.error(\"Error importing externals\");\n\t\t}\n\n\t\tresult = fn.apply(this.model, args);\n\n\t\ttry {\n\t\t\tthis.parent.exportExternals();\n\t\t} catch (e) {\n\t\t\tthis.logger.error(\"Error exporting externals\");\n\t\t}\n\n\t\tthis.digest();\n\n\t\treturn result;\n\t}\n\n\tpublic getModelFn(): () => any {\n\t\treturn this.modelFn;\n\t}\n\n\tpublic getItemFn(): () => any {\n\t\treturn this.itemFn;\n\t}\n\n\tpublic getExternalFn(): () => any {\n\t\treturn this.externalFn;\n\t}\n\n\tpublic skipId(id: string): void {\n\t\tif (id !== null && id !== undefined) {\n\t\t\tthis.skipableIds.push(id);\n\t\t}\n\t}\n\n\tprivate validateEl(): void {\n\t\tif (this.el.tagName.toLowerCase() === this.componentPrefix.toLowerCase()) {\n\t\t\tthrow new TemplateError(\"Templates must not have a component tag as the top level tag.\");\n\t\t}\n\t}\n\n\tprivate populateElementMediators(): void {\n\t\tconst queue: HTMLElement[] = [this.el];\n\n\t\twhile (queue.length > 0) {\n\t\t\tthis.processChild(queue);\n\t\t}\n\t}\n\n\tprivate processChild(queue: HTMLElement[]): void {\n\t\tconst el: HTMLElement = queue.pop();\n\t\tconst EVT_NAME_ERR = \"Event expressor \\'%eventName%\\' MUST correspond to a valid event in the target environment: \\'\";\n\t\tconst regex = /^[A-Za-z]+$/;\n\t\tconst elName: string = el.tagName.toLowerCase();\n\n\t\tif (elName === this.regionPrefix) {\n\t\t\tconst regionName: string = el.getAttribute(\"name\");\n\t\t\tconst valueExpression: string = el.getAttribute(\"value\") || null;\n\t\t\tconst region: Region = this.regionLookupFn(regionName);\n\t\t\tregion.setDefaultEl(el as HTMLElement);\n\t\t\tregion.setExpression(valueExpression);\n\t\t\treturn;\n\t\t} else if (elName === this.componentPrefix) {\n\t\t\tconst componentName: string = el.getAttribute(\"name\");\n\t\t\tconst moduleName: string = el.getAttribute(\"module\");\n\t\t\tconst moduleToUse: Module = moduleName ? this.moduleInstance.getModule(moduleName) : this.moduleInstance;\n\t\t\tconst component: Nestable = (moduleToUse || this.moduleInstance).get(componentName);\n\t\t\tel.parentElement.replaceChild(component.getEl(), el);\n\n\t\t\tfor (let i = el.attributes.length - 1; i >= 0; i--) {\n\t\t\t\tconst attributeName: string = el.attributes[i].name.toLowerCase();\n\t\t\t\tconst attributeValue: string = el.attributes[i].value;\n\n\t\t\t\tif (attributeName.indexOf(this.externalAttributePrefix) === 0) {\n\t\t\t\t\tconst propertyName: string = attributeName.substr(this.externalAttributePrefix.length);\n\t\t\t\t\tconst detail: ExternalAttributeDetail = {\n\t\t\t\t\t\tattributeName: propertyName,\n\t\t\t\t\t\texpression: attributeValue\n\t\t\t\t\t};\n\n\t\t\t\t\tcomponent.message(INTERNAL_DIRECT_CHANNEL_NAME, \"addExternalAttribute\", detail);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tcomponent.message(INTERNAL_DIRECT_CHANNEL_NAME, \"setParentScope\", this.scope);\n\t\t\tcomponent.message(INTERNAL_DIRECT_CHANNEL_NAME, \"setParent\", this.parent.getComponent());\n\t\t\tcomponent.message(INTERNAL_DIRECT_CHANNEL_NAME, \"setMode\", \"repeatable\");\n\t\t\tthis.components.push(component);\n\t\t\treturn;\n\t\t}\n\n\t\t// tslint:disable-next-line\n\t\tfor (let i = 0; i < el.children.length; i++) {\n\t\t\tqueue.push(el.children[i] as HTMLElement);\n\t\t}\n\n\t\tthis.processTextChildren(el.childNodes);\n\n\t\tconst attributes: NamedNodeMap = el.attributes;\n\t\tconst length: number = attributes.length;\n\t\tconst names: string[] = [];\n\n\t\tfor (let i = 0; i < length; i++) {\n\t\t\tnames.push(attributes[i].name);\n\t\t}\n\n\t\tfor (const name of names) {\n\t\t\tconst expression: string = el.getAttribute(name);\n\n\t\t\tif (name.indexOf(this.eventElementMediatorPrefix) === 0) {\n\t\t\t\tconst eventName: string = name.substr(this.eventElementMediatorPrefix.length);\n\n\t\t\t\tif (!regex.test(eventName)) {\n\t\t\t\t\tthrow new MalformedOnEventError(EVT_NAME_ERR, { \"%eventName%\": eventName });\n\t\t\t\t}\n\n\t\t\t\tthis.addEventElementMediator(eventName.toLowerCase(), this.trimExpression(expression), el as HTMLElement);\n\t\t\t\tel.removeAttribute(name);\n\t\t\t} else if (name.indexOf(this.namePrefix) === 0) {\n\t\t\t\tconst namedElementName: string = el.getAttribute(name);\n\t\t\t\tthis.namedElements[namedElementName] = el;\n\t\t\t\tel.removeAttribute(name);\n\t\t\t} else if (name.indexOf(this.elementMediatorPrefix) === 0) {\n\t\t\t\tconst elementMediatorType: string = name.substr(this.elementMediatorPrefix.length);\n\t\t\t\tthis.addElementMediator(el.tagName.toLowerCase(), elementMediatorType, this.trimExpression(expression), el as HTMLElement);\n\t\t\t\tel.removeAttribute(name);\n\t\t\t} else if (expression.length > 4 && expression.indexOf(\"{{\") === 0 && expression.indexOf(\"}}\", expression.length - 2) !== -1) {\n\t\t\t\tthis.addAttributeElementMediator(name, this.trimExpression(expression), el as HTMLElement);\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate processTextChildren(children: NodeListOf<ChildNode>): void {\n\t\tconst discoveredNodes: ChildNode[] = [];\n\n\t\t// tslint:disable-next-line\n\t\tfor (let i = 0; i < children.length; i++) {\n\t\t\tconst child: ChildNode = children[i];\n\n\t\t\tif (TEXT_NODE_TYPE === child.nodeType) {\n\t\t\t\tdiscoveredNodes.push(child);\n\t\t\t}\n\t\t}\n\n\t\tfor (const node of discoveredNodes) {\n\t\t\tconst result: Node[] = this.splitChild(node);\n\n\t\t\tif (result.length > 1) {\n\t\t\t\tfor (const newNode of result) {\n\t\t\t\t\tnode.parentNode.insertBefore(newNode, node);\n\t\t\t\t}\n\n\t\t\t\tnode.remove();\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate trimExpression(input: string): string {\n\t\tconst result: string = (input.length > 4 && input.indexOf(\"{{\") === 0 && input.indexOf(\"}}\", input.length - 2) !== -1)\n\t\t\t? input.substring(2, input.length - 2)\n\t\t\t: input;\n\n\t\treturn result;\n\t}\n\n\tprivate splitChild(node: Node): Node[] {\n\t\tconst source: string = node.textContent || \"\";\n\t\tconst sections: string[] = source.split(/(\\{\\{|\\}\\})/);\n\n\t\tif (sections.length < 2) {\n\t\t\treturn [node];\n\t\t}\n\n\t\tlet inside: boolean = false;\n\n\t\tconst collected: Node[] = [];\n\n\t\tfor (const section of sections) {\n\t\t\tswitch (section) {\n\t\t\t\tcase \"{{\":\n\t\t\t\t\tinside = true;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"}}\":\n\t\t\t\t\tinside = false;\n\t\t\t\t\tbreak;\n\n\t\t\t\tdefault:\n\t\t\t\t\tif (inside) {\n\t\t\t\t\t\tconst beginComment: Comment = Properties.getWindow().document.createComment(\"#\");\n\t\t\t\t\t\tcollected.push(beginComment);\n\t\t\t\t\t\tconst textNode: Text = Properties.getWindow().document.createTextNode(section);\n\t\t\t\t\t\ttextNode.textContent = \"\";\n\t\t\t\t\t\tthis.addTextElementMediator(section, textNode);\n\t\t\t\t\t\tcollected.push(textNode);\n\t\t\t\t\t\tconst endComment: Comment = Properties.getWindow().document.createComment(\"#\");\n\t\t\t\t\t\tcollected.push(endComment);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tconst textNode: Text = Properties.getWindow().document.createTextNode(section);\n\t\t\t\t\t\tcollected.push(textNode);\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\treturn collected;\n\t}\n\n\tprivate addTextElementMediator(expression: string, el: Text): void {\n\t\tconst deps: ElementMediatorDependencies = {\n\t\t\tmvvm: this,\n\t\t\tparent: this.parent,\n\t\t\tel: el,\n\t\t\texpression: expression,\n\t\t\tmodel: this.model,\n\t\t\tprefix: \"Text\",\n\t\t\tmodule: this.moduleInstance\n\t\t};\n\n\t\tconst elementMediator: TextElementMediator = new TextElementMediator(deps);\n\t\telementMediator.init();\n\t\tthis.elementMediators.push(elementMediator);\n\t}\n\n\tprivate addEventElementMediator(eventName: string, expression: string, el: HTMLElement): void {\n\t\tconst deps: ElementMediatorDependencies = {\n\t\t\tmvvm: this,\n\t\t\tparent: this.parent,\n\t\t\tel: el,\n\t\t\texpression: expression,\n\t\t\tmodel: this.model,\n\t\t\tprefix: \"Event\",\n\t\t\tmodule: this.moduleInstance\n\t\t};\n\n\t\tconst elementMediator: EventElementMediator = new EventElementMediator(deps);\n\t\telementMediator.setEventKey(eventName);\n\t\telementMediator.init();\n\t\tthis.elementMediators.push(elementMediator);\n\t}\n\n\tprivate addAttributeElementMediator(attributeName: string, expression: string, el: HTMLElement): void {\n\t\tconst deps: ElementMediatorDependencies = {\n\t\t\tmvvm: this,\n\t\t\tparent: this.parent,\n\t\t\tel: el,\n\t\t\texpression: expression,\n\t\t\tmodel: this.model,\n\t\t\tprefix: \"Event\",\n\t\t\tmodule: this.moduleInstance\n\t\t};\n\n\t\tconst elementMediator: AttributeElementMediator = new AttributeElementMediator(deps);\n\t\telementMediator.setAttributeName(attributeName);\n\t\telementMediator.init();\n\t\tthis.elementMediators.push(elementMediator);\n\t}\n\n\tprivate addElementMediator(tag: string, elementMediatorType: string, attributeValue: string, el: HTMLElement): void {\n\t\tconst tags: SimpleMap<Type<ElementMediator<any, HTMLElement, any>>> = Factories.get(elementMediatorType);\n\t\tconst prefix: string = this.elementMediatorPrefix + elementMediatorType;\n\n\t\tlet elementMediator: ElementMediator<any, HTMLElement, any> = null;\n\n\t\tif (!tags) {\n\t\t\treturn;\n\t\t}\n\n\t\tlet elementMediatorClass: Type<ElementMediator<any, HTMLElement, any>> = tags[tag];\n\n\t\tif (!elementMediatorClass) {\n\t\t\telementMediatorClass = tags[\"*\"];\n\t\t}\n\n\t\tif (!elementMediatorClass) {\n\t\t\tthis.logger.error(\"Unsupported tag: \" + tag + \" for elementMediator \" + elementMediatorType + \".\");\n\t\t\treturn;\n\t\t}\n\n\t\tconst deps: ElementMediatorDependencies = {\n\t\t\tmvvm: this,\n\t\t\tparent: this.parent,\n\t\t\tel: el,\n\t\t\texpression: attributeValue,\n\t\t\tmodel: this.model,\n\t\t\tprefix: prefix,\n\t\t\tmodule: this.moduleInstance\n\t\t};\n\n\t\telementMediator = new elementMediatorClass(deps);\n\t\telementMediator.init();\n\n\t\tthis.elementMediators.push(elementMediator);\n\n\t\tif (elementMediator.hasPropagation()) {\n\t\t\tthis.propagatingElementMediators.push(elementMediator);\n\t\t}\n\t}\n\n}\n\nexport default MvvmImpl;\n","import Getter from \"@/model/Getter\";\nimport Invoker from \"@/model/Invoker\";\nimport Logger from \"@/logger/Logger\";\nimport LoggerFactory from \"@/logger/LoggerFactory\";\nimport ModelMediator from \"@/model/ModelMediator\";\nimport ObjectUtils from \"@/util/ObjectUtils\";\nimport ScopeImpl from \"@/model/ScopeImpl\";\nimport Setter from \"@/model/Setter\";\nimport Mvvm from \"@/mvvm/Mvvm\";\nimport { asIdentity } from \"@/model/Reducers\";\n\nconst requireNotNull = ObjectUtils.requireNotNull;\nconst isDefined = ObjectUtils.isDefined;\n\nclass ModelMediatorImpl<T> implements ModelMediator<T> {\n\n\tprivate logger: Logger;\n\n\tprivate model: any;\n\n\tprivate expression: string;\n\n\tprivate previous: T;\n\n\tprivate watchPrevious: T;\n\n\tprivate watchCurrent: T;\n\n\tprivate watchDispatchPending: boolean;\n\n\tprivate scope: ScopeImpl;\n\n\tprivate context: any;\n\n\tprivate digested: boolean = false;\n\n\tprivate target: (previous: T, current: T) => void;\n\n\tprivate invoker: Invoker;\n\n\tprivate getter: Getter<T>;\n\n\tprivate setter: Setter<T>;\n\n\tprivate mvvm: Mvvm;\n\n\tprivate reducerFn: (input: any) => T;\n\n\tconstructor(model: any, expression: string, scope: ScopeImpl, mvvm: Mvvm, reducerFn: (input: any) => T) {\n\t\tthis.reducerFn = isDefined(reducerFn) ? reducerFn : asIdentity;\n\t\tthis.model = requireNotNull(model, \"model\");\n\t\tthis.expression = requireNotNull(expression, \"expression\");\n\t\tthis.scope = requireNotNull(scope, \"scope\");\n\t\tthis.mvvm = requireNotNull(mvvm, \"mvvm\");\n\t\tthis.logger = LoggerFactory.getLogger(\"ModelMediator: \" + expression);\n\t\tthis.previous = null;\n\t\tthis.context = {};\n\t\tthis.target = null;\n\t\tthis.watchDispatchPending = false;\n\t\tthis.invoker = new Invoker(expression);\n\t\tthis.getter = new Getter(expression);\n\t\tthis.setter = new Setter(expression);\n\t}\n\n\tpublic invoke(params?: any): void {\n\t\tthis.invoker.invoke(this.scope, params || {});\n\t}\n\n\tpublic get(): T {\n\t\treturn this.reducerFn.apply({}, [this.getter.get(this.scope)]);\n\t}\n\n\tpublic set(value: T): void {\n\t\tthis.setter.set(this.scope, value);\n\t}\n\n\tpublic evaluate(): boolean {\n\t\tif (!this.target) {\n\t\t\treturn false;\n\t\t}\n\n\t\tlet changed: boolean = false;\n\t\tconst value: T = this.get();\n\n\t\tif (this.digested) {\n\t\t\tif (ObjectUtils.equals(this.previous, value)) {\n\t\t\t\tthis.logger.trace(\"Not different.\");\n\t\t\t} else {\n\t\t\t\tif (this.logger.isTrace()) {\n\t\t\t\t\tthis.logger.trace({ current: value, previous: this.previous });\n\t\t\t\t}\n\n\t\t\t\tthis.logger.trace(\"Invoking listener\");\n\t\t\t\tthis.swap(value);\n\t\t\t\tchanged = true;\n\t\t\t}\n\t\t} else {\n\t\t\tthis.swap(value);\n\t\t\tchanged = true;\n\t\t\tthis.digested = true;\n\t\t}\n\n\t\treturn changed;\n\t}\n\n\tpublic notify(): void {\n\t\tif (this.watchDispatchPending) {\n\t\t\tthis.mvvm.getParent().importExternals();\n\t\t\tthis.target.apply(this.context, [this.watchPrevious, this.watchCurrent]);\n\t\t\tthis.mvvm.getParent().exportExternals();\n\t\t\tthis.watchDispatchPending = false;\n\t\t}\n\t}\n\n\tpublic watch(context: any, target: (previous: T, current: T) => void): void {\n\t\tthis.context = requireNotNull(context, \"context\");\n\t\tthis.target = requireNotNull(target, \"target\");\n\t}\n\n\tpublic dispose(): void {\n\t\tthis.model = null;\n\t\tthis.mvvm = null;\n\t\tthis.previous = null;\n\t\tthis.context = null;\n\t\tthis.target = null;\n\t\tthis.watchPrevious = null;\n\t\tthis.watchCurrent = null;\n\t\tthis.watchDispatchPending = false;\n\t}\n\n\tprotected getExpression(): string {\n\t\treturn this.expression;\n\t}\n\n\tprivate swap(value: T): void {\n\t\tconst newPrevious: T = ObjectUtils.clone(value);\n\t\tthis.watchPrevious = this.previous;\n\t\tthis.watchCurrent = value;\n\t\tthis.watchDispatchPending = true;\n\t\tthis.previous = newPrevious;\n\t}\n\n}\n\nexport default ModelMediatorImpl;\n","import Logger from \"@/logger/Logger\";\nimport LoggerFactory from \"@/logger/LoggerFactory\";\nimport ScopeImpl from \"@/model/ScopeImpl\";\nimport SimpleMap from \"@/pattern/SimpleMap\";\n\nclass Invoker {\n\n\tprivate expression: string;\n\n\tprivate logger: Logger;\n\n\tconstructor(expression: string) {\n\t\tthis.expression = expression;\n\t\tthis.logger = LoggerFactory.getLogger(\"Invoker: \" + expression);\n\t}\n\n\tpublic invoke(scope: ScopeImpl, params: any): void {\n\t\tconst aggregateScope: SimpleMap<any> = {};\n\t\tconst scopeItems: SimpleMap<any> = scope.getItems();\n\n\t\tfor (const key in scopeItems) {\n\t\t\tif (!scopeItems.hasOwnProperty(key)) {\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\taggregateScope[key] = scopeItems[key];\n\t\t}\n\n\t\tif (params !== null && params !== undefined) {\n\t\t\tfor (const key in params) {\n\t\t\t\tif (!params.hasOwnProperty(key)) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\taggregateScope[key] = params[key];\n\t\t\t}\n\t\t}\n\n\t\tlet aggregateScopeCode: string = \"\";\n\n\t\tfor (const key in aggregateScope) {\n\t\t\tif (!aggregateScope.hasOwnProperty(key)) {\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tconst statement: string = \"var \" + key + \" = arguments[0]['\" + key + \"'];\\n\";\n\t\t\taggregateScopeCode += statement;\n\t\t}\n\n\t\tconst code: string = '\"use strict\"; ' + aggregateScopeCode + \" (\" + this.expression + \");\";\n\n\t\ttry {\n\t\t\tFunction(code).apply({}, [aggregateScope]);\n\t\t} catch (e) {\n\t\t\tthis.logInvocationError(code, e);\n\t\t}\n\t}\n\n\tprivate logInvocationError(code: string, e: Error) {\n\t\tthis.logger.error(\"\\nAn exception (\" + e.name + \") was thrown invoking the element mediator expression: \" + this.expression\n\t\t\t + \"\\n\\nIn context:\\n\" + code + \"\\n\\nException message: \" + e.message + \"\\n\\n\", e);\n\t}\n\n}\n\nexport default Invoker;\n","import DigestionCandidate from \"@/mvvm/DigestionCandidate\";\nimport SimpleMap from \"@/pattern/SimpleMap\";\nimport DigestionContext from \"@/mvvm/DigestionContext\";\nimport Logger from \"@/logger/Logger\";\nimport LoggerFactory from \"@/logger/LoggerFactory\";\nimport Notifyable from \"@/mvvm/Notifyable\";\n\nclass DigestionContextImpl implements DigestionContext {\n\n\tprivate readonly logger: Logger = LoggerFactory.getLogger(\"DigestionContextImpl\");\n\n\tprivate mediators: SimpleMap<DigestionCandidate[]>;\n\n\tconstructor() {\n\t\tthis.mediators = {};\n\t}\n\n\tpublic add(key: string, mediators: DigestionCandidate[]): void {\n\t\tif (!this.mediators[key]) {\n\t\t\tthis.mediators[key] = [];\n\n\t\t\tfor (const mediator of mediators) {\n\t\t\t\tthis.mediators[key].push(mediator);\n\t\t\t}\n\t\t}\n\t}\n\n\tpublic digest(): Notifyable[] {\n\t\tconst changedMediators: DigestionCandidate[] = [];\n\n\t\tfor (const key in this.mediators) {\n\t\t\tif (!this.mediators.hasOwnProperty(key)) {\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tconst current: DigestionCandidate[] = this.mediators[key];\n\t\t\tthis.digestSegment(changedMediators, current);\n\t\t}\n\n\t\treturn changedMediators;\n\t}\n\n\tprivate digestSegment(changedMediators: DigestionCandidate[], mediators: DigestionCandidate[]): void {\n\t\tfor (const mediator of mediators) {\n\t\t\tlet changed: boolean = false;\n\n\t\t\ttry {\n\t\t\t\tchanged = mediator.evaluate();\n\t\t\t} catch (e) {\n\t\t\t\tthis.logger.error(\"Error evaluating mediator: \" + mediator.constructor.name);\n\t\t\t}\n\n\t\t\tif (changed) {\n\t\t\t\tchangedMediators.push(mediator);\n\t\t\t}\n\t\t}\n\t}\n\n}\n\nexport default DigestionContextImpl;\n","import { CydranError } from \"@/error/AbstractCydranError\";\n\nclass MalformedOnEventError extends CydranError {\n\n\tconstructor(msg: string, reps?: any) {\n\t\tsuper(msg, reps);\n\t}\n\n}\n\nexport default MalformedOnEventError;\n","import ElementMediator from \"@/element/ElementMediator\";\nimport { asString } from \"@/model/Reducers\";\n\nclass TextElementMediator extends ElementMediator<string, Text, any> {\n\n\tconstructor(dependencies: any) {\n\t\tsuper(dependencies, false, asString);\n\t}\n\n\tpublic wire(): void {\n\t\tthis.getModelMediator().watch(this, this.onTargetChange);\n\t}\n\n\tpublic unwire(): void {\n\t\t// Intentionally do nothing\n\t}\n\n\tprotected onTargetChange(previous: any, current: any): void {\n\t\tthis.getEl().textContent = current;\n\t}\n\n}\n\nexport default TextElementMediator;\n","import ElementMediator from \"@/element/ElementMediator\";\nimport { asIdentity } from \"@/model/Reducers\";\n\nclass EventElementMediator extends ElementMediator<any, HTMLElement, any> {\n\n\tprivate eventKey: string;\n\n\tconstructor(dependencies: any) {\n\t\tsuper(dependencies, false, asIdentity);\n\t}\n\n\tpublic unwire(): void {\n\t\t// Intentionally do nothing\n\t}\n\n\tpublic handleEvent(event: Event): void {\n\t\tthis.$apply(() => {\n\t\t\tthis.getModelMediator().invoke({\n\t\t\t\tevent: event\n\t\t\t});\n\t\t}, [event]);\n\t}\n\n\tpublic wire(): void {\n\t\tthis.bridge(this.eventKey);\n\t\tthis.on(this.eventKey).forChannel(\"dom\").invoke(this.handleEvent);\n\t}\n\n\tpublic setEventKey(eventKey: string): void {\n\t\tthis.eventKey = eventKey;\n\t}\n\n}\n\nexport default EventElementMediator;\n","import ElementMediator from \"@/element/ElementMediator\";\nimport { asString } from \"@/model/Reducers\";\n\nclass AttributeElementMediator extends ElementMediator<string, HTMLElement, any> {\n\n\tprivate attributeName: string;\n\n\tconstructor(dependencies: any) {\n\t\tsuper(dependencies, false, asString);\n\t}\n\n\tpublic wire(): void {\n\t\tthis.getModelMediator().watch(this, this.onTargetChange);\n\t}\n\n\tpublic unwire(): void {\n\t\t// Intentionally do nothing\n\t}\n\n\tpublic setAttributeName(attributeName: string): void {\n\t\tthis.attributeName = attributeName;\n\t}\n\n\tprotected onTargetChange(previous: string, current: string): void {\n\t\tthis.getEl().setAttribute(this.attributeName, current);\n\t}\n\n}\n\nexport default AttributeElementMediator;\n","import { CydranError } from \"@/error/AbstractCydranError\";\n\nclass DigestLoopError extends CydranError {\n\n\tconstructor(msg: string, reps?: any) {\n\t\tsuper(msg, reps);\n\t}\n\n}\n\nexport default DigestLoopError;\n","import NamedElementOperations from \"@/component/NamedElementOperations\";\n\nclass NamedElementOperationsImpl<E extends HTMLElement> implements NamedElementOperations<E> {\n\n\tprivate element: E;\n\n\tconstructor(element: E) {\n\t\tthis.element = element;\n\t}\n\n\tpublic get(): E {\n\t\treturn this.element;\n\t}\n\n\tpublic focus(): void {\n\t\tsetTimeout(() => {\n\t\t\tthis.element.focus();\n\t\t}, 1);\n\t}\n\n\tpublic blur(): void {\n\t\tsetTimeout(() => {\n\t\t\tthis.element.blur();\n\t\t}, 1);\n\t}\n\n}\n\nexport default NamedElementOperationsImpl;\n","import { CydranError } from \"@/error/AbstractCydranError\";\n\nclass UnknownElementError extends CydranError {\n\n\tconstructor(msg: string, reps?: any) {\n\t\tsuper(msg, reps);\n\t}\n\n}\n\nexport default UnknownElementError;\n","import { CydranError } from \"@/error/AbstractCydranError\";\n\nclass ModuleAffinityError extends CydranError {\n\n\tconstructor(msg: string, reps?: any) {\n\t\tsuper(msg, reps);\n\t}\n\n}\n\nexport default ModuleAffinityError;\n","import Module from \"@/module/Module\";\nimport Register from \"@/registry/Register\";\nimport SimpleMap from \"@/pattern/SimpleMap\";\nimport { Registry, RegistryImpl } from \"@/registry/Registry\";\nimport Broker from \"@/message/Broker\";\nimport ScopeImpl from \"@/model/ScopeImpl\";\nimport BrokerImpl from \"@/message/BrokerImpl\";\nimport Logger from \"@/logger/Logger\";\nimport LoggerFactory from \"@/logger/LoggerFactory\";\nimport ObjectUtils from \"@/util/ObjectUtils\";\nimport { MODULE_FIELD_NAME, INTERNAL_DIRECT_CHANNEL_NAME } from \"@/constant/Constants\";\nimport Listener from \"@/message/Listener\";\nimport ModulesContext from \"@/module/ModulesContext\";\nimport { VALID_ID } from \"@/constant/ValidationRegExp\";\nimport Scope from \"@/model/Scope\";\nimport RegistrationError from \"@/error/RegistrationError\";\nimport RegistryStrategy from \"@/registry/RegistryStrategy\";\nimport PubSub from \"@/message/PubSub\";\nimport PubSubImpl from \"@/message/PubSubImpl\";\nimport Type from \"@/type/Type\";\nimport Nestable from \"@/component/Nestable\";\n\nconst requireNotNull = ObjectUtils.requireNotNull;\nconst requireValid = ObjectUtils.requireValid;\n\nclass ModuleImpl implements Module, Register {\n\n\tpublic static readonly ALIASES: SimpleMap<string> = {};\n\n\tprivate name: string;\n\n\tprivate registry: Registry;\n\n\tprivate broker: Broker;\n\n\tprivate scope: ScopeImpl;\n\n\tprivate modules: ModulesContext;\n\n\tconstructor(name: string, modules: ModulesContext, scope?: ScopeImpl) {\n\t\tthis.name = name;\n\t\tthis.registry = new RegistryImpl(this);\n\t\tthis.broker = new BrokerImpl();\n\t\tthis.scope = new ScopeImpl();\n\t\tthis.modules = modules;\n\n\t\tif (scope) {\n\t\t\tthis.scope.setParent(scope);\n\t\t}\n\t}\n\n\tpublic getLogger(): Logger {\n\t\treturn LoggerFactory.getLogger(this.name);\n\t}\n\n\tpublic getName(): string {\n\t\treturn this.name;\n\t}\n\n\tpublic associate(...componentClasses: Type<Nestable>[]): Module {\n\t\tcomponentClasses.forEach((componentClass) => {\n\t\t\trequireNotNull(componentClass, \"componentClass\");\n\t\t\tcomponentClass[\"prototype\"][MODULE_FIELD_NAME] = this;\n\t\t});\n\n\t\treturn this;\n\t}\n\n\tpublic disassociate(...componentClasses: Type<Nestable>[]): Module {\n\t\tcomponentClasses.forEach((componentClass) => {\n\t\t\trequireNotNull(componentClass, \"componentClass\");\n\t\t\tcomponentClass[\"prototype\"][MODULE_FIELD_NAME] = this;\n\t\t});\n\n\t\treturn this;\n\t}\n\n\tpublic clear(): Module {\n\t\treturn this;\n\t}\n\n\tpublic broadcast(channelName: string, messageName: string, payload?: any): void {\n\t\trequireNotNull(channelName, \"channelName\");\n\t\trequireNotNull(messageName, \"messageName\");\n\t\tthis.broker.broadcast(channelName, messageName, payload);\n\t}\n\n\tpublic broadcastGlobally(channelName: string, messageName: string, payload?: any): void {\n\t\tthis.modules.broadcast(channelName, messageName, payload);\n\t}\n\n\tpublic message(channelName: string, messageName: string, payload?: any): void {\n\t\trequireNotNull(channelName, \"channelName\");\n\t\trequireNotNull(messageName, \"messageName\");\n\t\tconst actualPayload: any = (payload === null || payload === undefined) ? {} : payload;\n\n\t\tif (channelName === INTERNAL_DIRECT_CHANNEL_NAME) {\n\t\t\tif (messageName === \"addListener\") {\n\t\t\t\tthis.addListener(actualPayload as Listener);\n\t\t\t} else if (messageName === \"removeListener\") {\n\t\t\t\tthis.removeListener(actualPayload as Listener);\n\t\t\t}\n\t\t}\n\t}\n\n\tpublic get<T>(id: string): T {\n\t\trequireValid(id, \"id\", VALID_ID);\n\n\t\tlet result: T = this.registry.get(id);\n\n\t\tif (!result) {\n\t\t\tresult = this.modules.get(id);\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tpublic getLocal<T>(id: string): T {\n\t\trequireValid(id, \"id\", VALID_ID);\n\t\treturn this.registry.get(id);\n\t}\n\n\tpublic getModule(name: string): Module {\n\t\treturn this.modules.getModule(name);\n\t}\n\n\tpublic getDefaultModule(): Module {\n\t\treturn this.modules.getDefaultModule();\n\t}\n\n\tpublic getScope(): Scope {\n\t\treturn this.scope;\n\t}\n\n\tpublic registerConstant(id: string, instance: any): Module {\n\t\trequireValid(id, \"id\", VALID_ID);\n\t\trequireNotNull(instance, \"instance\");\n\t\tthis.registry.registerConstant(id, instance);\n\t\treturn this;\n\t}\n\n\tpublic registerPrototype(id: string, classInstance: Type<any>, dependencies?: string[]): Module {\n\t\trequireValid(id, \"id\", VALID_ID);\n\t\trequireNotNull(classInstance, \"classInstance\");\n\t\tthis.registry.registerPrototype(id, classInstance, dependencies);\n\t\treturn this;\n\t}\n\n\tpublic registerPrototypeWithFactory(id: string, factoryFn: () => any, dependencies?: string[]): any | void {\n\t\trequireValid(id, \"id\", VALID_ID);\n\t\trequireNotNull(factoryFn, \"factoryFn\");\n\t\tthis.registry.registerPrototypeWithFactory(id, factoryFn, dependencies);\n\t\treturn this;\n\t}\n\n\tpublic registerSingleton(id: string, classInstance: Type<any>, dependencies?: string[]): Module {\n\t\trequireValid(id, \"id\", VALID_ID);\n\t\trequireNotNull(classInstance, \"classInstance\");\n\t\tthis.registry.registerSingleton(id, classInstance, dependencies);\n\t\treturn this;\n\t}\n\n\tpublic registerSingletonWithFactory(id: string, factoryFn: () => any, dependencies?: string[]): any | void {\n\t\trequireValid(id, \"id\", VALID_ID);\n\t\trequireNotNull(factoryFn, \"factoryFn\");\n\t\tthis.registry.registerSingletonWithFactory(id, factoryFn, dependencies);\n\t\treturn this;\n\t}\n\n\tpublic addStrategy(strategy: RegistryStrategy): Module {\n\t\trequireNotNull(strategy, \"strategy\");\n\t\tthis.registry.addStrategy(strategy);\n\t\treturn this;\n\t}\n\n\tpublic expose(id: string): Module {\n\t\trequireValid(id, \"id\", VALID_ID);\n\t\tModuleImpl.ALIASES[id] = this.name;\n\t\treturn this;\n\t}\n\n\tpublic createPubSubFor(context: any): PubSub {\n\t\treturn new PubSubImpl(context, this);\n\t}\n\n\tprivate addListener(listener: Listener): void {\n\t\tthis.broker.addListener(listener);\n\t}\n\n\tprivate removeListener(listener: Listener): void {\n\t\tthis.broker.removeListener(listener);\n\t}\n\n\tprivate logError(e: RegistrationError) {\n\t\tthis.getLogger().error(e);\n\t}\n\n}\n\nexport default ModuleImpl;\n","import RegistrationError from \"@/error/RegistrationError\";\nimport ObjectUtils from \"@/util/ObjectUtils\";\nimport Register from \"@/registry/Register\";\nimport { VALID_ID } from \"@/constant/ValidationRegExp\";\nimport SimpleMap from \"@/pattern/SimpleMap\";\nimport Instantiator from \"@/registry/Instantiator\";\nimport PubSubImpl from \"@/message/PubSubImpl\";\nimport Module from \"@/module/Module\";\nimport Gettable from \"@/registry/Gettable\";\nimport RegistryStrategy from \"@/registry/RegistryStrategy\";\nimport Type from \"@/type/Type\";\n\nconst requireValid = ObjectUtils.requireValid;\nconst requireNotNull = ObjectUtils.requireNotNull;\n\ninterface Factory<T> {\n\n\tget(gettable: Gettable): T;\n\n}\n\nclass DefaultRegistryStrategyImpl implements RegistryStrategy, Register {\n\n\tprivate factories: SimpleMap<Factory<any>>;\n\n\tprivate module: Module;\n\n\tconstructor(module: Module) {\n\t\tthis.factories = {};\n\t\tthis.module = module;\n\t}\n\n\tpublic get<T>(id: string, gettable: Gettable): T {\n\t\trequireValid(id, \"id\", VALID_ID);\n\t\tlet instance: T = null;\n\n\t\tif (this.factories[id]) {\n\t\t\tinstance = this.factories[id].get(gettable);\n\t\t}\n\n\t\treturn instance;\n\t}\n\n\tpublic registerConstant(id: string, instance: any): void {\n\t\tthis.registerFactory(id, new ConstantFactory(instance));\n\t}\n\n\tpublic registerPrototype(id: string, classInstance: Type<any>, dependencies?: string[]): void {\n\t\tthis.registerFactory(id, new PrototypeFactory(this.module, Instantiator.create(classInstance), dependencies || []));\n\t}\n\n\tpublic registerPrototypeWithFactory(id: string, factoryFn: () => any, dependencies?: string[]): void {\n\t\tthis.registerFactory(id, new PrototypeFactory(this.module, factoryFn, dependencies || []));\n\t}\n\n\tpublic registerSingleton(id: string, classInstance: Type<any>, dependencies?: string[]): void {\n\t\tthis.registerFactory(id, new SingletonFactory(this.module, Instantiator.create(classInstance), dependencies || []));\n\t}\n\n\tpublic registerSingletonWithFactory(id: string, factoryFn: () => any, dependencies?: string[]): void {\n\t\tthis.registerFactory(id, new SingletonFactory(this.module, factoryFn, dependencies || []));\n\t}\n\n\tprivate registerFactory(id: string, factory: Factory<any>): void {\n\t\trequireValid(id, \"id\", VALID_ID);\n\n\t\tif (id && factory) {\n\t\t\tif (this.factories[id]) {\n\t\t\t\tthrow new RegistrationError(\"'%id%' key is considered unique and already exists\", { \"%id%\": id });\n\t\t\t}\n\n\t\t\tthis.factories[id] = factory;\n\t\t}\n\t}\n}\n\nexport interface Registry extends Register, Gettable {\n\n\taddStrategy(strategy: RegistryStrategy): void;\n\n}\n\nexport class RegistryImpl implements Registry {\n\n\tprivate strategies: RegistryStrategy[];\n\n\tprivate defaultStrategy: DefaultRegistryStrategyImpl;\n\n\tprivate module: Module;\n\n\tconstructor(module: Module) {\n\t\tthis.module = module;\n\t\tthis.defaultStrategy = new DefaultRegistryStrategyImpl(this.module);\n\t\tthis.strategies = [this.defaultStrategy];\n\t}\n\n\tpublic get<T>(id: string): T {\n\t\trequireValid(id, \"id\", VALID_ID);\n\t\tlet i: number = 0;\n\n\t\tlet instance: T = null;\n\n\t\twhile (!instance && i < this.strategies.length) {\n\t\t\tinstance = this.strategies[i].get(id, this);\n\t\t\ti++;\n\t\t}\n\n\t\treturn instance;\n\t}\n\n\tpublic registerConstant(id: string, instance: any): Registry {\n\t\trequireValid(id, \"id\", VALID_ID);\n\t\trequireNotNull(instance, \"instance\");\n\t\tthis.defaultStrategy.registerConstant(id, instance);\n\t\treturn this;\n\t}\n\n\tpublic registerPrototype(id: string, classInstance: Type<any>, dependencies: string[]): Registry {\n\t\trequireValid(id, \"id\", VALID_ID);\n\t\trequireNotNull(classInstance, \"classInstance\");\n\t\tthis.defaultStrategy.registerPrototype(id, classInstance, dependencies);\n\t\treturn this;\n\t}\n\n\tpublic registerPrototypeWithFactory(id: string, factoryFn: () => any, dependencies?: string[]): Registry {\n\t\trequireValid(id, \"id\", VALID_ID);\n\t\trequireNotNull(factoryFn, \"factoryFn\");\n\t\tthis.defaultStrategy.registerPrototypeWithFactory(id, factoryFn, dependencies);\n\t\treturn this;\n\t}\n\n\tpublic registerSingleton(id: string, classInstance: Type<any>, dependencies: string[]): Registry {\n\t\trequireValid(id, \"id\", VALID_ID);\n\t\trequireNotNull(classInstance, \"classInstance\");\n\t\tthis.defaultStrategy.registerSingleton(id, classInstance, dependencies);\n\t\treturn this;\n\t}\n\n\tpublic registerSingletonWithFactory(id: string, factoryFn: () => any, dependencies?: string[]): Registry {\n\t\trequireValid(id, \"id\", VALID_ID);\n\t\trequireNotNull(factoryFn, \"factoryFn\");\n\t\tthis.defaultStrategy.registerSingletonWithFactory(id, factoryFn, dependencies);\n\t\treturn this;\n\t}\n\n\tpublic addStrategy(strategy: RegistryStrategy): void {\n\t\trequireNotNull(strategy, \"strategy\");\n\t\tthis.strategies.push(strategy);\n\t}\n\n}\n\nclass ConstantFactory<T> implements Factory<T> {\n\n\tprivate instance: T;\n\n\tconstructor(instance: T) {\n\t\tthis.instance = instance;\n\t}\n\n\tpublic get(gettable: Gettable): T {\n\t\treturn this.instance;\n\t}\n\n}\n\nabstract class AbstractFunctionalFactory<T> implements Factory<T> {\n\n\tprivate fn: (args: any[]) => T;\n\n\tprivate dependencies: string[];\n\n\tprivate module: Module;\n\n\tconstructor(module: Module, fn: (args: any[]) => T, dependencies: string[]) {\n\t\tthis.module = module;\n\t\tthis.dependencies = dependencies;\n\t\tthis.fn = fn;\n\t}\n\n\tpublic abstract get(gettable: Gettable): T;\n\n\tprotected create(gettable: Gettable) {\n\t\tconst params: any[] = [];\n\n\t\tconst pubSubs: PubSubImpl[] = [];\n\n\t\tfor (const id of this.dependencies) {\n\n\t\t\tswitch (id) {\n\t\t\t\tcase \"$pubSub\":\n\t\t\t\t\tconst pubSub: PubSubImpl = new PubSubImpl(null, null);\n\t\t\t\t\tparams.push(pubSub);\n\t\t\t\t\tpubSubs.push(pubSub);\n\t\t\t\t\tbreak;\n\n\t\t\t\tdefault:\n\t\t\t\t\tconst param: any = gettable.get(id);\n\t\t\t\t\tparams.push(param);\n\t\t\t\t\tbreak;\n\t\t\t}\n\n\t\t}\n\n\t\tconst result: T = this.fn.apply({}, params);\n\n\t\tfor (const pubSub of pubSubs) {\n\t\t\tpubSub.setContext(result);\n\t\t\tpubSub.setModule(this.module);\n\t\t}\n\n\t\treturn result;\n\t}\n\n}\n\nclass PrototypeFactory<T> extends AbstractFunctionalFactory<T> {\n\n\tconstructor(module: Module, fn: (args: any[]) => T, dependencies: string[]) {\n\t\tsuper(module, fn, dependencies);\n\t}\n\n\tpublic get(gettable: Gettable): T {\n\t\treturn this.create(gettable);\n\t}\n\n}\n\nclass SingletonFactory<T> extends AbstractFunctionalFactory<T> {\n\n\tprivate instance: T;\n\n\tconstructor(module: Module, fn: (args: any[]) => T, dependencies: string[]) {\n\t\tsuper(module, fn, dependencies);\n\t\tthis.instance = null;\n\t}\n\n\tpublic get(gettable: Gettable): T {\n\t\tif (!this.instance) {\n\t\t\tthis.instance = this.create(gettable);\n\t\t}\n\n\t\treturn this.instance;\n\t}\n\n}\n","import { CydranError } from \"@/error/AbstractCydranError\";\n\nclass RegistrationError extends CydranError {\n\n\tconstructor(msg: string, reps?: any) {\n\t\tsuper(msg, reps);\n\t}\n\n}\n\nexport default RegistrationError;\n","import Type from \"@/type/Type\";\n\nclass Instantiator {\n\n\tpublic static create<T>(classInstance: Type<T>): (...args: any[]) => T {\n\t\tconst fn: (...args: any[]) => T = (...args: any[]) => {\n\t\t\tif (args.length === 0) {\n\t\t\t\treturn new classInstance();\n\t\t\t}\n\n\t\t\tlet argumentsCode: string = \"\";\n\n\t\t\tfor (let i: number = 0; i < args.length; i++) {\n\t\t\t\tif (i > 0) {\n\t\t\t\t\targumentsCode += \",\";\n\t\t\t\t}\n\n\t\t\t\targumentsCode += \"arguments[1][\" + i + \"]\";\n\t\t\t}\n\n\t\t\tconst code: string = '\"use strict\"; var classInstance = arguments[0]; return new classInstance(' + argumentsCode + \");\";\n\n\t\t\treturn Function(code).apply({}, [classInstance, args]) as T;\n\t\t};\n\n\t\treturn fn;\n\t}\n\n}\n\nexport default Instantiator;\n","import Broker from \"@/message/Broker\";\nimport Logger from \"@/logger/Logger\";\nimport Listener from \"@/message/Listener\";\nimport LoggerFactory from \"@/logger/LoggerFactory\";\nimport ObjectUtils from \"@/util/ObjectUtils\";\nimport SimpleMap from \"@/pattern/SimpleMap\";\n\nconst requireNotNull = ObjectUtils.requireNotNull;\n\nclass BrokerImpl implements Broker {\n\n\tpublic static INSTANCE: Broker;\n\n\tprivate logger: Logger;\n\n\tprivate listeners: SimpleMap<Listener[]>;\n\n\tconstructor() {\n\t\tthis.logger = LoggerFactory.getLogger(\"Broker\");\n\t\tthis.listeners = {};\n\t}\n\n\tpublic broadcast(channelName: string, messageName: string, payload?: any): void {\n\t\trequireNotNull(channelName, \"channelName\");\n\t\trequireNotNull(messageName, \"messageName\");\n\n\t\tconst actualPayload: any = (payload === null || payload === undefined) ? {} : payload;\n\n\t\tthis.logger.trace({\n\t\t\tchannelName: channelName,\n\t\t\tmessageName: messageName,\n\t\t\tpayload: actualPayload\n\t\t});\n\n\t\tif (!this.listeners[channelName]) {\n\t\t\tthis.logger.trace(\"no listeners for channel, returning\");\n\t\t\treturn;\n\t\t}\n\n\t\tconst listeners = this.listeners[channelName];\n\n\t\tfor (const listener of listeners) {\n\t\t\tlistener.receive(messageName, actualPayload);\n\t\t}\n\t}\n\n\tpublic addListener(listener: Listener): void {\n\t\tconst channelName: string = listener.getChannelName();\n\n\t\tif (!this.listeners[channelName]) {\n\t\t\tthis.listeners[channelName] = [];\n\t\t}\n\n\t\tconst listeners: Listener[] = this.listeners[channelName];\n\n\t\tif (!this.contains(listeners, listener)) {\n\t\t\tlisteners.push(listener);\n\t\t}\n\t}\n\n\tpublic removeListener(listener: Listener): void {\n\t\tconst channelName: string = listener.getChannelName();\n\t\tconst listeners: Listener[] = this.listeners[channelName];\n\n\t\tif (!listeners) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.remove(listeners, listener);\n\n\t\tif (0 === listeners.length) {\n\t\t\tdelete this.listeners[channelName];\n\t\t}\n\t}\n\n\tpublic dispose(): void {\n\t\tthis.listeners = {};\n\t}\n\n\tprivate contains(array: any[], instance: any): boolean {\n\t\tlet i = array.length;\n\n\t\twhile (i--) {\n\t\t\tif (array[i] === instance) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tprivate remove(array: any[], instance: any): void {\n\t\tlet i = array.length;\n\n\t\twhile (i--) {\n\t\t\tif (array[i] === instance) {\n\t\t\t\tarray.splice(i, 1);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\n}\n\nexport default BrokerImpl;\n","import ComponentFactory from \"@/element/repeat/ComponentFactory\";\nimport Nestable from \"@/component/Nestable\";\nimport ItemComponent from \"@/element/repeat/ItemComponent\";\nimport Module from \"@/module/Module\";\n\nclass ItemComponentFactoryImpl implements ComponentFactory {\n\n\tprivate template: string;\n\n\tprivate prefix: string;\n\n\tprivate parent: Nestable;\n\n\tprivate parentId: string;\n\n\tprivate parentModelFn: () => any;\n\n\tprivate module: Module;\n\n\tconstructor(module: Module, template: string, prefix: string, parent: Nestable, parentId: string, parentModelFn: () => any) {\n\t\tthis.module = module;\n\t\tthis.template = template;\n\t\tthis.prefix = prefix;\n\t\tthis.parent = parent;\n\t\tthis.parentId = parentId;\n\t\tthis.parentModelFn = parentModelFn;\n\t}\n\n\tpublic create(item?: any): Nestable {\n\t\treturn new ItemComponent(this.module, this.template, this.prefix, this.parent, this.parentId, this.parentModelFn, () => item);\n\t}\n\n}\n\nexport default ItemComponentFactoryImpl;\n\n","import Component from \"@/component/Component\";\nimport Nestable from \"@/component/Nestable\";\nimport { ComponentConfigImpl, ComponentConfig } from \"@/component/ComponentConfig\";\nimport { INTERNAL_DIRECT_CHANNEL_NAME, COMPONENT_INTERNALS_FIELD_NAME } from \"@/constant/Constants\";\nimport ComponentInternalsImpl from \"@/component/ComponentInternalsImpl\";\nimport Module from \"@/module/Module\";\n\nclass ItemComponent extends Component {\n\n\tconstructor(module: Module, template: string, prefix: string, parent: Nestable, parentId: string, parentModelFn: () => any, itemFn: () => any) {\n\t\tconst config: ComponentConfigImpl = new ComponentConfigImpl();\n\t\tconfig.withPrefix(prefix);\n\t\tconfig.setParentModelFn(parentModelFn);\n\t\tconfig.setModule(module);\n\t\tsuper(template, config);\n\t\tthis.message(INTERNAL_DIRECT_CHANNEL_NAME, \"setMode\", \"repeatable\");\n\t\tthis.message(INTERNAL_DIRECT_CHANNEL_NAME, \"setItemFn\", itemFn);\n\t\tthis.message(INTERNAL_DIRECT_CHANNEL_NAME, \"skipId\", parentId);\n\t\tthis.message(INTERNAL_DIRECT_CHANNEL_NAME, \"setParent\", parent);\n\t}\n\n\tprotected ____internal$$cydran$$init____(template: string, config: ComponentConfig): void {\n\t\tthis[COMPONENT_INTERNALS_FIELD_NAME] = new ComponentInternalsImpl(this, template, config);\n\t\tthis[COMPONENT_INTERNALS_FIELD_NAME][\"init\"]();\n\t}\n\n}\n\nexport default ItemComponent;\n","import { INTERNAL_DIRECT_CHANNEL_NAME } from \"@/constant/Constants\";\nimport ComponentFactory from \"@/element/repeat/ComponentFactory\";\nimport Nestable from \"@/component/Nestable\";\nimport Module from \"@/module/Module\";\nimport ObjectUtils from \"@/util/ObjectUtils\";\n\nclass EmbeddedComponentFactoryImpl implements ComponentFactory {\n\n\tprivate module: Module;\n\n\tprivate componentId: string;\n\n\tprivate moduleId: string;\n\n\tprivate parent: Nestable;\n\n\tprivate parentId: string;\n\n\tconstructor(module: Module, componentId: string, moduleId, parent: Nestable, parentId: string) {\n\t\tthis.module = module;\n\t\tthis.componentId = componentId;\n\t\tthis.moduleId = moduleId;\n\t\tthis.parent = parent;\n\t\tthis.parentId = parentId;\n\t}\n\n\tpublic create(item: any): Nestable {\n\t\tconst module: Module = ObjectUtils.isDefined(this.moduleId) && this.moduleId.trim().length > 0\n\t\t\t? this.module.getModule(this.moduleId)\n\t\t\t: this.module.getDefaultModule();\n\n\t\tconst component: Nestable = module.get(this.componentId);\n\t\tcomponent.message(INTERNAL_DIRECT_CHANNEL_NAME, \"setMode\", \"repeatable\");\n\t\tcomponent.message(INTERNAL_DIRECT_CHANNEL_NAME, \"setItemFn\", () => item);\n\t\tcomponent.message(INTERNAL_DIRECT_CHANNEL_NAME, \"skipId\", this.parentId);\n\t\tcomponent.message(INTERNAL_DIRECT_CHANNEL_NAME, \"setParent\", this.parent);\n\n\t\treturn component;\n\t}\n\n}\n\nexport default EmbeddedComponentFactoryImpl;\n","import IdStrategy from \"@/element/repeat/IdStrategy\";\n\nclass InvalidIdStrategyImpl implements IdStrategy {\n\n\tpublic check(item: any): boolean {\n\t\treturn true;\n\t}\n\n\tpublic enrich(item: any, index: number): void {\n\t\t// Intentionally do nothing\n\t}\n\n\tpublic extract(item: any): string {\n\t\treturn null;\n\t}\n\n\tpublic init(): void {\n\t\tthrow new Error(\"Invalid strategy for repeat.  Please see [URL] for further details on properly using the repeat element mediator.\");\n\t}\n\n}\n\nexport default InvalidIdStrategyImpl;\n","import IdStrategy from \"@/element/repeat/IdStrategy\";\nimport Logger from \"@/logger/Logger\";\nimport LoggerFactory from \"@/logger/LoggerFactory\";\n\nclass ExpressionIdStrategyImpl implements IdStrategy {\n\n\tprivate logger: Logger;\n\n\tprivate code: string;\n\n\tprivate expression: string;\n\n\tprivate fn: Function;\n\n\tconstructor(expression: string) {\n\t\tthis.logger = LoggerFactory.getLogger(\"Id Function: \" + expression);\n\t\tthis.expression = expression;\n\t\tthis.code = '\"use strict\"; return function(i,item,v,value) { return ' + expression + ' }(arguments[0], arguments[0], arguments[0], arguments[0]);';\n\t\tthis.fn = Function(this.code);\n\t}\n\n\tpublic check(item: any): boolean {\n\t\treturn false;\n\t}\n\n\tpublic enrich(item: any, index: number): void {\n\t\t// Intentionally do nothing\n\t}\n\n\tpublic extract(item: any): string {\n\t\tlet id: string = null;\n\n\t\ttry {\n\t\t\tconst itemFn: () => any = () => item;\n\t\t\tid = this.fn.apply({}, [itemFn]);\n\t\t} catch (e) {\n\t\t\tthis.logger.error(\"\\nAn exception (\" + e.name + \") was thrown invoking the id function expression: \" + this.expression\n\t\t\t + \"\\n\\nIn context:\\n\" + this.code + \"\\n\\nException message: \" + e.message + \"\\n\\n\", e);\n\n\t\t\t throw e;\n\t\t}\n\n\t\treturn id;\n\t}\n\n\tpublic init(): void {\n\t\t// Intentionally do nothing\n\t}\n\n}\n\nexport default ExpressionIdStrategyImpl;\n","import { ComponentIdPair, ComponentConfig } from \"@/component/ComponentConfig\";\nimport CydranConfig from \"@/config/CydranConfig\";\nimport DomUtils from \"@/util/DomUtils\";\nimport Logger from \"@/logger/Logger\";\nimport LoggerFactory from \"@/logger/LoggerFactory\";\nimport Module from \"@/module/Module\";\nimport ObjectUtils from \"@/util/ObjectUtils\";\nimport Scope from \"@/model/Scope\";\nimport { VALID_ID } from \"@/constant/ValidationRegExp\";\nimport ModulesContext from \"@/module/ModulesContext\";\nimport Nestable from \"@/component/Nestable\";\nimport StageComponent from \"@/stage/StageComponent\";\nimport { DEFAULT_MODULE_KEY, INTERNAL_DIRECT_CHANNEL_NAME } from \"@/constant/Constants\";\nimport ModulesContextImpl from \"@/module/ModulesContextImpl\";\nimport AnonymousComponent from \"@/component/AnonymousComponent\";\nimport Type from \"@/type/Type\";\nimport ElementMediator from \"@/element/ElementMediator\";\n\nconst requireNotNull = ObjectUtils.requireNotNull;\nconst requireValid = ObjectUtils.requireValid;\n\ninterface StageBuilder {\n\n\tgetModule(name: string): Module;\n\n\tgetDefaultModule(): Module;\n\n\tforEach(fn: (instace: Module) => void): StageBuilder;\n\n\twithComponentBefore(id: string, moduleName?: string): StageBuilder;\n\n\twithComponentAfter(id: string, moduleName?: string): StageBuilder;\n\n\twithComponent(id: string): StageBuilder;\n\n\twithInitializer(callback: (stage?: Stage) => void): StageBuilder;\n\n\twithTraceLogging(): StageBuilder;\n\n\twithDebugLogging(): StageBuilder;\n\n\twithInfoLogging(): StageBuilder;\n\n\twithWarnLogging(): StageBuilder;\n\n\twithErrorLogging(): StageBuilder;\n\n\twithFatalLogging(): StageBuilder;\n\n\twithLoggingDisabled(): StageBuilder;\n\n\twithElementMediator(name: string, supportedTags: string[],\n\t\telementMediatorClass: Type<ElementMediator<any, HTMLElement | Text, any>>): StageBuilder;\n\n\twithConstant(id: string, instance: any): StageBuilder;\n\n\twithPrototype(id: string, classInstance: Type<any>, dependencies?: string[]): StageBuilder;\n\n\twithPrototypeFromFactory(id: string, factoryFn: () => any, dependencies?: string[]): StageBuilder;\n\n\twithSingleton(id: string, classInstance: Type<any>, dependencies?: string[]): StageBuilder;\n\n\twithSingletonFromFactory(id: string, factoryFn: () => any, dependencies?: string[]): StageBuilder;\n\n\twithImplicit(id: string, template: string, config?: ComponentConfig): StageBuilder;\n\n\twithCapability(capability: (builder: StageBuilder) => void): StageBuilder;\n\n\twithScopeItem(name: string, item: any): StageBuilder;\n\n\tbuild(): Stage;\n\n}\n\nclass StageBuilderImpl implements StageBuilder {\n\n\tprivate config: CydranConfig;\n\n\tprivate instance: StageImpl;\n\n\tconstructor(rootSelector: string) {\n\t\tthis.config = new CydranConfig();\n\t\tthis.instance = new StageImpl(rootSelector);\n\t}\n\n\tpublic withComponentBefore(id: string, moduleName?: string): StageBuilder {\n\t\tthis.instance.withComponentBefore(id, moduleName);\n\t\treturn this;\n\t}\n\n\tpublic withComponentAfter(id: string, moduleName?: string): StageBuilder {\n\t\tthis.instance.withComponentAfter(id, moduleName);\n\t\treturn this;\n\t}\n\n\tpublic withComponent(id: string, moduleName?: string): StageBuilder {\n\t\treturn this.withComponentAfter(id, moduleName);\n\t}\n\n\tpublic withInitializer(callback: (stage?: Stage) => void): StageBuilder {\n\t\tthis.instance.withInitializer(callback);\n\t\treturn this;\n\t}\n\n\tpublic withTraceLogging(): StageBuilder {\n\t\tthis.config.useTrace();\n\t\treturn this;\n\t}\n\n\tpublic withDebugLogging(): StageBuilder {\n\t\tthis.config.useDebug();\n\t\treturn this;\n\t}\n\n\tpublic withInfoLogging(): StageBuilder {\n\t\tthis.config.useInfo();\n\t\treturn this;\n\t}\n\n\tpublic withWarnLogging(): StageBuilder {\n\t\tthis.config.useWarn();\n\t\treturn this;\n\t}\n\n\tpublic withErrorLogging(): StageBuilder {\n\t\tthis.config.useError();\n\t\treturn this;\n\t}\n\n\tpublic withFatalLogging(): StageBuilder {\n\t\tthis.config.useFatal();\n\t\treturn this;\n\t}\n\n\tpublic withLoggingDisabled(): StageBuilder {\n\t\tthis.config.useDisabled();\n\t\treturn this;\n\t}\n\n\tpublic getModule(name: string): Module {\n\t\treturn this.instance.getModules().getModule(name);\n\t}\n\n\tpublic getDefaultModule(): Module {\n\t\treturn this.instance.getModules().getDefaultModule();\n\t}\n\n\tpublic forEach(fn: (instace: Module) => void): StageBuilder {\n\t\tthis.instance.getModules().forEach(fn);\n\t\treturn this;\n\t}\n\n\tpublic withElementMediator(name: string, supportedTags: string[],\n\t\telementMediatorClass: Type<ElementMediator<any, HTMLElement | Text, any>>): StageBuilder {\n\t\tthis.instance.getModules().registerElementMediator(name, supportedTags, elementMediatorClass);\n\t\treturn this;\n\t}\n\n\tpublic withConstant(id: string, instance: any): StageBuilder {\n\t\tthis.instance.getModules().registerConstant(id, instance);\n\t\treturn this;\n\t}\n\n\tpublic withPrototype(id: string, classInstance: Type<any>, dependencies?: string[]): StageBuilder {\n\t\tthis.instance.getModules().registerPrototype(id, classInstance, dependencies);\n\t\treturn this;\n\t}\n\n\tpublic withPrototypeFromFactory(id: string, factoryFn: () => any, dependencies?: string[]): StageBuilder {\n\t\tthis.instance.getModules().registerPrototypeWithFactory(id, factoryFn, dependencies);\n\t\treturn this;\n\t}\n\n\tpublic withSingleton(id: string, classInstance: Type<any>, dependencies?: string[]): StageBuilder {\n\t\tthis.instance.getModules().registerSingleton(id, classInstance, dependencies);\n\t\treturn this;\n\t}\n\n\tpublic withSingletonFromFactory(id: string, factoryFn: () => any, dependencies?: string[]): StageBuilder {\n\t\tthis.instance.getModules().registerSingletonWithFactory(id, factoryFn, dependencies);\n\t\treturn this;\n\t}\n\n\tpublic withImplicit(id: string, template: string, config?: ComponentConfig): StageBuilder {\n\t\tthis.withPrototypeFromFactory(id, () => new AnonymousComponent(this.getDefaultModule(), template, config));\n\t\treturn this;\n\t}\n\n\tpublic withCapability(capability: (builder: StageBuilder) => void): StageBuilder {\n\t\trequireNotNull(capability, \"capability\")(this);\n\t\treturn this;\n\t}\n\n\tpublic withScopeItem(name: string, item: any): StageBuilder {\n\t\tthis.instance.getModules().getScope().add(name, item);\n\t\treturn this;\n\t}\n\n\tpublic build(): Stage {\n\t\treturn this.instance;\n\t}\n\n}\n\ninterface Stage {\n\n\tsetComponent(component: Nestable): Stage;\n\n\tsetComponentFromRegistry(componentName: string, defaultComponentName?: string): void;\n\n\tget<T>(id: string): T;\n\n\tstart(): void;\n\n\tgetModule(name: string): Module;\n\n\tgetDefaultModule(): Module;\n\n\tforEach(fn: (instace: Module) => void): void;\n\n\tbroadcast(channelName: string, messageName: string, payload?: any): void;\n\n\tregisterConstant(id: string, instance: any): void;\n\n\tregisterPrototype(id: string, classInstance: Type<any>): void;\n\n\tregisterSingleton(id: string, classInstance: Type<any>): void;\n\n\tgetScope(): Scope;\n\n}\n\nclass StageImpl implements Stage {\n\n\tprivate started: boolean;\n\n\tprivate rootSelector: string;\n\n\tprivate logger: Logger;\n\n\tprivate initializers: ((stage?: Stage) => void)[];\n\n\tprivate root: StageComponent;\n\n\tprivate topComponentIds: ComponentIdPair[];\n\n\tprivate bottomComponentIds: ComponentIdPair[];\n\n\tprivate modules: ModulesContext;\n\n\tconstructor(rootSelector: string) {\n\t\tthis.rootSelector = requireNotNull(rootSelector, \"rootSelector\");\n\t\tthis.logger = LoggerFactory.getLogger(\"Stage\");\n\t\tthis.modules = new ModulesContextImpl();\n\t\tthis.started = false;\n\t\tthis.initializers = [];\n\t\tthis.topComponentIds = [];\n\t\tthis.bottomComponentIds = [];\n\t\tthis.root = null;\n\t}\n\n\tpublic withInitializer(callback: (stage?: Stage) => void): Stage {\n\t\trequireNotNull(callback, \"callback\");\n\t\tthis.initializers.push(callback);\n\t\treturn this;\n\t}\n\n\tpublic withComponentBefore(id: string, moduleName?: string): void {\n\t\trequireValid(id, \"id\", VALID_ID);\n\n\t\tthis.topComponentIds.push({\n\t\t\tcomponentId: id,\n\t\t\tmoduleId: moduleName || DEFAULT_MODULE_KEY\n\t\t});\n\t}\n\n\tpublic withComponentAfter(id: string, moduleName?: string): void {\n\t\trequireValid(id, \"id\", VALID_ID);\n\n\t\tthis.bottomComponentIds.push({\n\t\t\tcomponentId: id,\n\t\t\tmoduleId: moduleName || DEFAULT_MODULE_KEY\n\t\t});\n\t}\n\n\tpublic start(): void {\n\t\tthis.logger.debug(\"Start Requested\");\n\n\t\tif (this.started) {\n\t\t\tthis.logger.debug(\"Aleady Started\");\n\t\t\treturn;\n\t\t}\n\n\t\tthis.logger.debug(\"Cydran Starting\");\n\t\tthis.modules.registerConstant(\"stage\", this);\n\t\tDomUtils.domReady(() => this.domReady());\n\t}\n\n\tpublic setComponent(component: Nestable): Stage {\n\t\tthis.root.setChild(\"body\", component);\n\t\treturn this;\n\t}\n\n\tpublic setComponentFromRegistry(componentName: string, defaultComponentName?: string): Stage {\n\t\trequireNotNull(componentName, \"componentName\");\n\t\tthis.root.setChildFromRegistry(\"body\", componentName, defaultComponentName);\n\t\treturn this;\n\t}\n\n\tpublic get<T>(id: string): T {\n\t\trequireValid(id, \"id\", VALID_ID);\n\t\treturn this.root.get(id);\n\t}\n\n\tpublic getModules(): ModulesContext {\n\t\treturn this.modules;\n\t}\n\n\tpublic getModule(name: string): Module {\n\t\treturn this.modules.getModule(name);\n\t}\n\n\tpublic getDefaultModule(): Module {\n\t\treturn this.modules.getDefaultModule();\n\t}\n\n\tpublic forEach(fn: (instace: Module) => void): void {\n\t\tthis.modules.forEach(fn);\n\t}\n\n\tpublic broadcast(channelName: string, messageName: string, payload?: any): void {\n\t\tthis.modules.broadcast(channelName, messageName, payload);\n\t}\n\n\tpublic registerConstant(id: string, instance: any): void {\n\t\tthis.modules.registerConstant(id, instance);\n\t}\n\n\tpublic registerPrototype(id: string, classInstance: Type<any>, dependencies?: string[]): void {\n\t\tthis.modules.registerPrototype(id, classInstance, dependencies);\n\t}\n\n\tpublic registerSingleton(id: string, classInstance: Type<any>, dependencies?: string[]): void {\n\t\tthis.modules.registerSingleton(id, classInstance, dependencies);\n\t}\n\n\tpublic getScope(): Scope {\n\t\treturn this.modules.getScope();\n\t}\n\n\tprivate domReady(): void {\n\t\tthis.logger.debug(\"DOM Ready\");\n\t\tthis.root = new StageComponent(this.modules.getDefaultModule(), this.rootSelector, this.topComponentIds, this.bottomComponentIds);\n\t\tthis.root.message(INTERNAL_DIRECT_CHANNEL_NAME, \"setParent\", null);\n\t\tthis.started = true;\n\t\tthis.logger.debug(\"Running initializers\");\n\n\t\tfor (const initializer of this.initializers) {\n\t\t\tinitializer.apply(this, [this]);\n\t\t}\n\n\t\tthis.logger.debug(\"Startup Complete\");\n\t}\n\n}\n\nconst builder = function(rootSelector: string): StageBuilder {\n\treturn new StageBuilderImpl(rootSelector);\n};\n\nexport { builder, Stage, StageBuilder, StageImpl };\n","import Properties from \"@/config/Properties\";\nconst WIN = Properties.getWindow();\nconst DOC = WIN.document;\n\nlet readyList: any = [];\nlet readyFired = false;\nlet readyEventHandlersInstalled = false;\n\nfunction ready() {\n\tif (!readyFired) {\n\t\t// this must be set to true before we start calling callbacks\n\t\treadyFired = true;\n\n\t\t// tslint:disable-next-line\n\t\tfor (let i = 0; i < readyList.length; i++) {\n\t\t\t// if a callback here happens to add new ready handlers,\n\t\t\t// the docReady() function will see that it already fired\n\t\t\t// and will schedule the callback to run right after\n\t\t\t// this event loop finishes so all handlers will still execute\n\t\t\t// in order and no new ones will be added to the readyList\n\t\t\t// while we are processing the list\n\t\t\treadyList[i].fn.call(WIN, readyList[i].ctx);\n\t\t}\n\t\t// allow any closures held by these functions to free\n\t\treadyList = [];\n\t}\n}\n\nfunction readyStateChange() {\n\tif (DOC.readyState === \"complete\") {\n\t\tready();\n\t}\n}\n\nfunction domReady(callback?: any, context?: any) {\n\tif (typeof callback !== \"function\") {\n\t\tthrow new TypeError(\"callback for docReady(fn) must be a function\");\n\t}\n\n\t// if ready has already fired, then just schedule the callback\n\t// to fire asynchronously, but right away\n\tif (readyFired) {\n\t\tsetTimeout(function() { callback(context); }, 1);\n\t\treturn;\n\t} else {\n\t\t// add the function and context to the list\n\t\treadyList.push({ fn: callback, ctx: context });\n\t}\n\n\t// if document already ready to go, schedule the ready function to run\n\t// IE only safe when readyState is \"complete\", others safe when readyState is \"interactive\"\n\tif (DOC.readyState === \"complete\" || (!DOC[\"attachEvent\"] && DOC.readyState === \"interactive\")) {\n\t\tsetTimeout(ready, 1);\n\t} else if (!readyEventHandlersInstalled) {\n\t\t// otherwise if we don't have event handlers installed, install them\n\t\tif (DOC.addEventListener) {\n\t\t\t// first choice is DOMContentLoaded event\n\t\t\tDOC.addEventListener(\"DOMContentLoaded\", ready, false);\n\t\t\t// backup is window load event\n\t\t\tWIN.addEventListener(\"load\", ready, false);\n\t\t} else {\n\t\t\t// must be IE\n\t\t\tDOC[\"attachEvent\"](\"onreadystatechange\", readyStateChange);\n\t\t\tWIN[\"attachEvent\"](\"onload\", ready);\n\t\t}\n\n\t\treadyEventHandlersInstalled = true;\n\t}\n}\n\nconst result = {\n\tdomReady: domReady\n};\n\nexport default result;\n","import { COMPONENT_INTERNALS_FIELD_NAME, MODULE_FIELD_NAME } from \"@/constant/Constants\";\nimport StageComponentInternals from \"@/stage/StageComponentInternals\";\nimport { ComponentIdPair, ComponentConfigImpl, ComponentConfig } from \"@/component/ComponentConfig\";\nimport Component from \"@/component/Component\";\nimport Nestable from \"@/component/Nestable\";\nimport Module from \"@/module/Module\";\n\nclass StageComponent extends Component {\n\n\tconstructor(module: Module, selector: string, topComponentIds: ComponentIdPair[], bottomComponentIds: ComponentIdPair[]) {\n\t\tconst config: ComponentConfigImpl = new ComponentConfigImpl();\n\t\tconfig.setTopComponentIds(topComponentIds);\n\t\tconfig.setBottomComponentIds(bottomComponentIds);\n\t\tconfig.setModule(module);\n\t\tsuper(selector, config);\n\t}\n\n\tpublic setComponent(component: Nestable): StageComponent {\n\t\tthis.setChild(\"body\", component);\n\t\treturn this;\n\t}\n\n\tpublic isConnected(): boolean {\n\t\treturn true;\n\t}\n\n\tprotected ____internal$$cydran$$init____(template: string, config: ComponentConfig): void {\n\t\tthis[COMPONENT_INTERNALS_FIELD_NAME] = new StageComponentInternals(this, template, config);\n\t\tthis[COMPONENT_INTERNALS_FIELD_NAME][\"init\"]();\n\t}\n\n}\n\nexport default StageComponent;\n","import Properties from \"@/config/Properties\";\nimport SelectorError from \"@/error/SelectorError\";\nimport { ComponentIdPair, ComponentConfigImpl } from \"@/component/ComponentConfig\";\nimport ComponentInternalsImpl from \"@/component/ComponentInternalsImpl\";\n\nclass StageComponentInternals extends ComponentInternalsImpl {\n\n\tprotected render(): void {\n\t\tconst elements: NodeListOf<HTMLElement> = Properties.getWindow().document.querySelectorAll(this.getTemplate());\n\t\tconst eLength = ((elements) ? elements.length : 0);\n\t\tconst errMsg = (eLength !== 1) ? \"CSS selector MUST identify single HTMLElement: '%pattern%' - %qty% found\" : null;\n\n\t\tif (errMsg) {\n\t\t\tconst patSubObj = { \"%pattern%\": this.getTemplate(), \"%qty%\": eLength };\n\t\t\tconst error: SelectorError = new SelectorError(errMsg, patSubObj);\n\t\t\tthis.getLogger().fatal(error);\n\t\t\tthrow error;\n\t\t}\n\n\t\tconst element: HTMLElement = elements[0];\n\t\tconst topIds: ComponentIdPair[] = (this.getConfig() as ComponentConfigImpl).getTopComponentIds();\n\t\tconst bottomIds: ComponentIdPair[] = (this.getConfig() as ComponentConfigImpl).getBottomComponentIds();\n\n\t\twhile (element.hasChildNodes()) {\n\t\t\telement.removeChild(element.firstChild);\n\t\t}\n\n\t\tfor (const pair of topIds) {\n\t\t\tconst componentDiv: HTMLElement = Properties.getWindow().document.createElement(\"c:component\");\n\t\t\tcomponentDiv.setAttribute(\"name\", pair.componentId);\n\t\t\tcomponentDiv.setAttribute(\"module\", pair.moduleId);\n\t\t\telement.appendChild(componentDiv);\n\t\t}\n\n\t\tconst regionDiv: HTMLElement = Properties.getWindow().document.createElement(\"c:region\");\n\t\tregionDiv.setAttribute(\"name\", \"body\");\n\t\telement.appendChild(regionDiv);\n\t\tthis.setEl(element);\n\n\t\tfor (const pair of bottomIds) {\n\t\t\tconst componentDiv: HTMLElement = Properties.getWindow().document.createElement(\"c:component\");\n\t\t\tcomponentDiv.setAttribute(\"name\", pair.componentId);\n\t\t\tcomponentDiv.setAttribute(\"module\", pair.moduleId);\n\t\t\telement.appendChild(componentDiv);\n\t\t}\n\t}\n\n\tprotected validateModulePresent(): void {\n\t\t// Intentionally do nothing\n\t}\n\n}\n\nexport default StageComponentInternals;\n","import { CydranError } from \"@/error/AbstractCydranError\";\n\nclass SelectorError extends CydranError {\n\n\tconstructor(msg: string, reps?: any) {\n\t\tsuper(msg, reps);\n\t}\n\n}\n\nexport default SelectorError;\n","import Component from \"@/component/Component\";\nimport { ComponentConfigImpl, ComponentConfig } from \"@/component/ComponentConfig\";\nimport ObjectUtils from \"@/util/ObjectUtils\";\nimport Module from \"@/module/Module\";\n\nconst isDefined = ObjectUtils.isDefined;\n\nclass AnonymousComponent extends Component {\n\n\tconstructor(module: Module, template: string, config?: ComponentConfig) {\n\t\tconst configInstance: ComponentConfigImpl = isDefined(config) ? config as ComponentConfigImpl : new ComponentConfigImpl();\n\t\tconfigInstance.setModule(module);\n\t\tsuper(template, configInstance);\n\t}\n\n}\n\nexport default AnonymousComponent;\n"],"sourceRoot":""}