{"version":3,"sources":["webpack://cydran/webpack/universalModuleDefinition","webpack://cydran/webpack/bootstrap","webpack://cydran/./src/Core.ts","webpack://cydran/./src/error/AbstractCydranError.ts","webpack://cydran/./src/logger/LoggerFactory.ts","webpack://cydran/./src/logger/Level.ts","webpack://cydran/./src/ObjectUtils.ts","webpack://cydran/./src/ComponentConfig.ts","webpack://cydran/./src/Getter.ts","webpack://cydran/./src/logger/LoggerImpl.ts","webpack://cydran/./src/logger/LoggerService.ts","webpack://cydran/./src/Setter.ts","webpack://cydran/./src/messaging/PubSub.ts","webpack://cydran/(webpack)/buildin/global.js","webpack://cydran/./src/CydranConfig.ts","webpack://cydran/./src/index.ts","webpack://cydran/./src/error/DigestLoopError.ts","webpack://cydran/./src/error/MalformedOnEventError.ts","webpack://cydran/./src/error/SelectorError.ts","webpack://cydran/./src/error/SetComponentError.ts","webpack://cydran/./src/error/TemplateError.ts","webpack://cydran/./src/error/UnknownRegionError.ts","webpack://cydran/./src/ExternalMediator.ts","webpack://cydran/./src/logger/ConsoleOutputStrategy.ts","webpack://cydran/./src/logger/LevelUtils.ts","webpack://cydran/./src/GuardGenerator.ts","webpack://cydran/./src/GuardImpl.ts","webpack://cydran/./src/messaging/ListenerImpl.ts","webpack://cydran/./src/ModelMediatorImpl.ts","webpack://cydran/./src/Invoker.ts","webpack://cydran/(webpack)/buildin/module.js","webpack://cydran/./src/Properties.ts","webpack://cydran/./src/Registry.ts","webpack://cydran/./src/error/RegistrationError.ts","webpack://cydran/./src/ScopeImpl.ts","webpack://cydran/./src/error/ScopeError.ts","webpack://cydran/./src/SequenceGenerator.ts","webpack://cydran/./src/mediator/index.ts","webpack://cydran/./src/mediator/Checked.ts","webpack://cydran/./src/mediator/CSSClass.ts","webpack://cydran/./src/mediator/Content.ts","webpack://cydran/./src/mediator/Enabled.ts","webpack://cydran/./src/mediator/ReadOnly.ts","webpack://cydran/./src/mediator/Style.ts","webpack://cydran/./src/mediator/ForceFocus.ts","webpack://cydran/./src/mediator/MultiSelectValueModel.ts","webpack://cydran/./src/mediator/ValuedModel.ts","webpack://cydran/./src/mediator/InputValueModel.ts","webpack://cydran/./src/mediator/Visible.ts","webpack://cydran/./src/mediator/Repeat.ts","webpack://cydran/./src/Stage.ts","webpack://cydran/./src/DomUtils.ts"],"names":["root","factory","exports","module","define","amd","window","installedModules","__webpack_require__","moduleId","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","Properties","INTERNAL_DIRECT_CHANNEL_NAME","INTERNAL_CHANNEL_NAME","MODULE_FIELD_NAME","Events","AFTER_CHILD_ADDED","AFTER_CHILD_CHANGED","AFTER_CHILD_REMOVED","AFTER_PARENT_ADDED","AFTER_PARENT_CHANGED","AFTER_PARENT_REMOVED","BEFORE_CHILD_ADDED","BEFORE_CHILD_CHANGED","BEFORE_CHILD_REMOVED","BEFORE_DISPOSE","BEFORE_PARENT_ADDED","BEFORE_PARENT_CHANGED","BEFORE_PARENT_REMOVED","DEFAULT_COMPONENT_CONFIG","ComponentConfigBuilder","build","this","logger","getLogger","listeners","broadcast","channelName","messageName","payload","trace","receive","addListener","listener","getChannelName","contains","push","removeListener","remove","length","dispose","array","instance","splice","ALIASES","scope","registry","RegistryImpl","broker","BrokerImpl","setParent","getName","associate","componentClasses","forEach","componentClass","disassociate","clear","message","id","result","Modules","getLocal","getScope","registerConstant","e","logError","registerPrototype","classInstance","registerSingleton","addStrategy","strategy","expose","error","ModuleImpl","DEFAULT_MODULE","getModule","getDefaultModule","fn","registerElementMediator","supportedTags","elementMediatorClass","Mvvm","register","DEFAULT","source","template","config","____internal$$cydran$$init____","metadata","internal","____internal$$cydran____","getMetadata","has","hasMetadata","hasRegion","setChild","component","setChildFromRegistry","componentName","defaultComponentName","getParent","getEl","reset","init","getItem","getData","getExternals","getExternalCache","broadcastGlobally","$apply","args","watch","expression","target","on","forChannel","channel","invoke","ComponentInternals","Component","guard","INSTANCE","generate","next","constructor","parent","prefix","getPrefix","toLowerCase","trim","externalMediators","externalCache","externalFields","getAttributes","attribute","externalize","flags","repeatable","regions","pubSub","mvvm","render","el","getRegion","localGuard","down","seen","mark","hasComponent","childAdded","childRemoved","setComponent","propagateDigest","digest","setParentScope","setData","addExternalAttribute","parentScope","getId","getComponent","mediate","targetChannel","data","importExternals","mediator","exportExternals","set","getGuard","Region","getTemplate","templateEl","getWindow","document","createElement","insertAdjacentHTML","count","childElementCount","parmObj","fatal","firstElementChild","setEl","detail","fieldName","attributeName","parentAdded","parentRemoved","up","isPropagateUp","elements","querySelectorAll","eLength","errMsg","patSubObj","element","hasChildNodes","removeChild","firstChild","regionDiv","setAttribute","appendChild","selector","StageComponentInternals","StageComponent","dependencies","domListeners","removeDomListeners","unwire","getExpression","wire","moduleInstance","setModule","listenTo","apply","listenToFramework","bridge","event","addEventListener","getModel","model","getModelMediator","removeEventListener","ElementMediator","defaultEl","setDefaultEl","newComponentEl","parentElement","replaceChild","oldComponentEl","onTargetChange","previous","current","replacement","encodeHtml","innerHTML","handleEvent","eventKey","setEventKey","setAttributeName","elementMediatorPrefix","eventElementMediatorPrefix","externalAttributePrefix","regionPrefix","componentPrefix","elementMediators","mediators","components","add","factories","supportedTag","regionLookupFn","populateElementMediators","localGuardDown","remainingEvaluations","pending","changedMediators","evaluate","notifyWatcher","executeCallback","localGuardUp","queue","processChild","pop","regex","elName","tagName","getAttribute","moduleName","attributes","attributeValue","indexOf","substr","children","processTextChildren","childNodes","getAttributeNames","eventName","test","addEventElementMediator","removeAttribute","elementMediatorType","addElementMediator","trimmedExpression","substring","addAttributeElementMediator","regionName","discoveredNodes","child","nodeType","node","splitChild","newNode","parentNode","insertBefore","sections","textContent","split","inside","collected","section","span","addTextElementMediator","textNode","createTextNode","deps","elementMediator","TextElementMediator","EventElementMediator","AttributeElementMediator","tag","tags","msg","reps","CydranError","TypeError","doMsgFilling","replace","all","Error","NEWI","LoggerFactory","Level","CLONE_DEEP_FLAG","CLONE_FLAT_FLAG","CLONE_SYMBOLS_FLAG","COMPARE_PARTIAL_FLAG","COMPARE_UNORDERED_FLAG","MAX_SAFE_INTEGER","argsTag","arrayTag","asyncTag","boolTag","dateTag","errorTag","funcTag","genTag","mapTag","numberTag","nullTag","objectTag","proxyTag","regexpTag","setTag","stringTag","symbolTag","undefinedTag","weakMapTag","arrayBufferTag","dataViewTag","float32Tag","float64Tag","int8Tag","int16Tag","int32Tag","uint8Tag","uint8ClampedTag","uint16Tag","uint32Tag","reFlags","reIsHostCtor","reIsUint","typedArrayTags","cloneableTags","freeGlobal","global","freeSelf","self","Function","freeExports","freeModule","moduleExports","arrayPush","values","offset","index","mapToArray","map","Array","size","overArg","func","transform","arg","setToArray","uid","context","arrayProto","funcProto","objectProto","coreJsData","funcToString","toString","maskSrcKey","exec","keys","IE_PROTO","nativeObjectToString","reIsNative","RegExp","Buffer","undefined","Uint8Array","allocUnsafe","getPrototype","getPrototypeOf","objectCreate","propertyIsEnumerable","symToStringTag","nativeGetSymbols","getOwnPropertySymbols","nativeIsBuffer","isBuffer","nativeKeys","DataView","getNative","Map","Promise","Set","WeakMap","nativeCreate","dataViewCtorString","toSource","mapCtorString","promiseCtorString","setCtorString","weakMapCtorString","symbolProto","symbolValueOf","valueOf","baseCreate","proto","isObject","entries","entry","__DATA__","delete","assocIndexOf","hash","Hash","ListCache","string","getMapData","MapCache","pairs","LARGE_ARRAY_SIZE","arrayLikeKeys","inherited","isArr","isArray","isArg","isArguments","isBuff","isType","isTypedArray","skipIndexes","iteratee","baseTimes","String","isIndex","assignValue","objValue","eq","baseAssignValue","configurable","writable","baseClone","bitmask","customizer","stack","isDeep","isFlat","isFull","input","initCloneArray","copyArray","getTag","isFunc","buffer","slice","copy","cloneBuffer","isPrototype","initCloneObject","copyObject","getSymbolsIn","copySymbolsIn","keysIn","baseAssignIn","getSymbols","copySymbols","baseAssign","Ctor","cloneArrayBuffer","dataView","byteOffset","byteLength","cloneDataView","typedArray","cloneTypedArray","regexp","lastIndex","cloneRegExp","symbol","initCloneByTag","stacked","Stack","isSet","subValue","isMap","props","getAllKeysIn","getAllKeys","arrayEach","baseGetAllKeys","keysFunc","symbolsFunc","baseGetTag","isOwn","unmasked","getRawTag","objectToString","baseIsArguments","isObjectLike","baseIsEqual","other","equalFunc","objIsArr","othIsArr","objTag","othTag","objIsObj","othIsObj","isSameTag","equalArrays","convert","isPartial","equalByTag","objIsWrapped","othIsWrapped","objUnwrapped","othUnwrapped","objProps","objLength","othLength","skipCtor","othValue","compared","objCtor","othCtor","equalObjects","baseIsEqualDeep","baseIsNative","isFunction","baseKeysIn","nativeKeysIn","isProto","arrayBuffer","ctor","isNew","newValue","arrLength","SetCache","arrValue","predicate","arraySome","othIndex","type","getValue","resIndex","arrayFilter","stubArray","ArrayBuffer","resolve","ctorString","arguments","isArrayLike","isLength","baseKeys","encodeHtmlMap","lookupEncodeHtmlMap","clone","equals","first","second","withMetadata","withAttribute","withPrefix","ComponentConfigImpl","code","getCode","getItems","logInvocationError","Getter","LOGGER_NAME_LENGTH","loggerService","log","TRACE","ifTrace","payloadFn","isTrace","debug","DEBUG","ifDebug","isDebug","info","INFO","ifInfo","isInfo","warn","WARN","ifWarn","isWarn","ERROR","ifError","isError","FATAL","ifFatal","isFatal","isDisable","LoggerImpl","level","outputStrategy","errorStack","DISABLE","setLevel","stringValueOf","LoggerService","Setter","globalEnabled","listenersByChannel","enableGlobal","disableGlobal","mine","PubSub","g","CydranConfig","useTrace","useDebug","useInfo","useWarn","useError","useFatal","useDisable","Stage","CYDRAN_KEY","ORIGINAL_CYDRAN","noConflict","currentCydran","DigestLoopError","MalformedOnEventError","SelectorError","SetComponentError","TemplateError","UnknownRegionError","setter","ExternalMediator","getNow","now","Date","getUTCFullYear","getUTCMonth","getUTCDate","getUTCHours","getUTCMinutes","getUTCSeconds","getUTCMilliseconds","preamble","ConsoleOutputStrategy","shortArgs","printFullStack","logMsg","secondPreamble","console","lvl","getKeys","k","rx","Number","parseInt","LevelUtils","major","minor","micro","GuardGenerator","MAX_VALUE","propagateUp","state","original","GuardImpl","isPropagateDown","mappings","ListenerImpl","DEFAULT_REDUCER","digested","digestCallbackContext","digestCallback","watchDispatchPending","reducerFn","invoker","changed","valueFragment","previousFragment","swap","watchPrevious","watchCurrent","onDigest","setReducer","newPrevious","newPreviousFragment","ModelMediatorImpl","Invoker","webpackPolyfill","deprecate","paths","setWindow","registerFactory","ConstantFactory","PrototypeFactory","SingletonFactory","defaultStrategy","DefaultRegistryStrategyImpl","strategies","RegistrationError","EXCLUSIONS","item","VALID_KEY_REGEX","restricted","localItems","items","addChild","refresh","checkName","refreshChildren","parentItems","refreshCode","statement","ScopeImpl","ScopeError","SequenceGenerator","KEY","checked","Checked","newClasses","className","join","CSSClass","Content","disabled","Enabled","readOnly","ReadOnly","style","Style","handleFocusout","shouldFocus","focus","ForceFocus","handleInput","multiple","selectedOptions","optValue","options","selected","includes","MultiSelectValueModel","ValuedModel","isRadio","handleRadioInput","onRadioTargetChange","InputValueModel","hidden","Visible","DOCUMENT","initialized","empty","ids","itemTemplate","last","nodeName","markup","idKey","itemComponentName","initAsRepeatable","newIds","newMap","fragment","createDocumentFragment","Repeat","rootSelector","started","initializers","withInitializer","callback","start","domReady","getConfig","ready","WIN","DOC","detach","completed","readyState","frameElement","documentElement","scrollCheck","setTimeout"],"mappings":"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","file":"cydran.min.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"cydran\"] = factory();\n\telse\n\t\troot[\"cydran\"] = factory();\n})(window, function() {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 13);\n","import { ComponentConfig, ComponentConfigBuilder } from \"./ComponentConfig\";\nimport { OnContinuation } from \"./Continuation\";\nimport Digestable from \"./Digestable\";\nimport Disposable from \"./Disposable\";\nimport DigestLoopError from \"./error/DigestLoopError\";\nimport MalformedOnEventError from \"./error/MalformedOnEventError\";\nimport RegistrationError from \"./error/RegistrationError\";\nimport SelectorError from \"./error/SelectorError\";\nimport SetComponentError from \"./error/SetComponentError\";\nimport TemplateError from \"./error/TemplateError\";\nimport UnknownRegionError from \"./error/UnknownRegionError\";\nimport ExternalMediator from \"./ExternalMediator\";\nimport Guard from \"./Guard\";\nimport GuardGenerator from \"./GuardGenerator\";\nimport GuardImpl from \"./GuardImpl\";\nimport Logger from \"./logger/Logger\";\nimport LoggerFactory from \"./logger/LoggerFactory\";\nimport Broker from \"./messaging/Broker\";\nimport Listener from \"./messaging/Listener\";\nimport PubSub from \"./messaging/PubSub\";\nimport ModelMediator from \"./ModelMediator\";\nimport ModelMediatorImpl from \"./ModelMediatorImpl\";\nimport Module from \"./Module\";\nimport ObjectUtils from \"./ObjectUtils\";\nimport Properties from \"./Properties\";\nimport Register from \"./Register\";\nimport { Registry, RegistryImpl } from \"./Registry\";\nimport RegistryStrategy from \"./RegistryStrategy\";\nimport Scope from \"./Scope\";\nimport ScopeImpl from \"./ScopeImpl\";\nimport SequenceGenerator from \"./SequenceGenerator\";\n\nconst MAX_EVALUATIONS: number = 10000;\nconst INTERNAL_DIRECT_CHANNEL_NAME: string = \"Cydran$$Direct$$Internal$$Channel\";\nconst INTERNAL_CHANNEL_NAME: string = \"Cydran$$Internal$$Channel\";\nconst TEXT_NODE_TYPE: number = 3;\nconst COMPONENT_INTERNALS_FIELD_NAME: string = \"____internal$$cydran____\";\nconst MODULE_FIELD_NAME: string = \"____internal$$cydran$$module____\";\n\nconst Events = {\n\tAFTER_CHILD_ADDED: \"AFTER_CHILD_ADDED\",\n\tAFTER_CHILD_CHANGED: \"AFTER_CHILD_CHANGED\",\n\tAFTER_CHILD_REMOVED: \"AFTER_CHILD_REMOVED\",\n\tAFTER_PARENT_ADDED: \"AFTER_PARENT_ADDED\",\n\tAFTER_PARENT_CHANGED: \"AFTER_PARENT_CHANGED\",\n\tAFTER_PARENT_REMOVED: \"AFTER_PARENT_REMOVED\",\n\tBEFORE_CHILD_ADDED: \"BEFORE_CHILD_ADDED\",\n\tBEFORE_CHILD_CHANGED: \"BEFORE_CHILD_CHANGED\",\n\tBEFORE_CHILD_REMOVED: \"BEFORE_CHILD_REMOVED\",\n\tBEFORE_DISPOSE: \"BEFORE_DISPOSE\",\n\tBEFORE_PARENT_ADDED: \"BEFORE_PARENT_ADDED\",\n\tBEFORE_PARENT_CHANGED: \"BEFORE_PARENT_CHANGED\",\n\tBEFORE_PARENT_REMOVED: \"BEFORE_PARENT_REMOVED\",\n};\n\nconst NOOP_FN: () => void = function() {\n\t// Intentionally do nothing\n};\n\ninterface SimpleMap<T> {\n\n\t[key: string]: T;\n\n}\n\nconst DEFAULT_COMPONENT_CONFIG: ComponentConfig = new ComponentConfigBuilder().build();\n\nclass BrokerImpl implements Broker {\n\n\tpublic static INSTANCE: Broker;\n\n\tprivate logger: Logger;\n\n\tprivate listeners: {\n\t\t[channelName: string]: Listener[];\n\t};\n\n\tconstructor() {\n\t\tthis.logger = LoggerFactory.getLogger(\"Broker\");\n\t\tthis.listeners = {};\n\t}\n\n\tpublic broadcast(channelName: string, messageName: string, payload: any): void {\n\t\tthis.logger.trace({\n\t\t\tchannelName: channelName,\n\t\t\tmessageName: messageName,\n\t\t\tpayload: payload,\n\t\t});\n\n\t\tif (!this.listeners[channelName]) {\n\t\t\tthis.logger.trace(\"no listeners for channel, returning\");\n\t\t\treturn;\n\t\t}\n\n\t\tconst listeners = this.listeners[channelName];\n\n\t\tfor (const listener of listeners) {\n\t\t\tlistener.receive(messageName, payload);\n\t\t}\n\t}\n\n\tpublic addListener(listener: Listener): void {\n\t\tconst channelName: string = listener.getChannelName();\n\n\t\tif (!this.listeners[channelName]) {\n\t\t\tthis.listeners[channelName] = [];\n\t\t}\n\n\t\tconst listeners: Listener[] = this.listeners[channelName];\n\n\t\tif (!this.contains(listeners, listener)) {\n\t\t\tlisteners.push(listener);\n\t\t}\n\t}\n\n\tpublic removeListener(listener: Listener): void {\n\t\tconst channelName: string = listener.getChannelName();\n\n\t\tconst listeners: Listener[] = this.listeners[channelName];\n\n\t\tif (!listeners) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.remove(listeners, listener);\n\n\t\tif (0 === listeners.length) {\n\t\t\tdelete this.listeners[channelName];\n\t\t}\n\t}\n\n\tpublic dispose(): void {\n\t\tthis.listeners = {};\n\t}\n\n\tprivate contains(array: any[], instance: any): boolean {\n\t\tlet i = array.length;\n\n\t\twhile (i--) {\n\t\t\tif (array[i] === instance) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tprivate remove(array: any[], instance: any): void {\n\t\tlet i = array.length;\n\n\t\twhile (i--) {\n\t\t\tif (array[i] === instance) {\n\t\t\t\tarray.splice(i, 1);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\n}\n\nconst ALIASES: {\n\t[id: string]: string;\n} = {};\n\nclass ModuleImpl implements Module, Register {\n\n\tprivate name: string;\n\n\tprivate registry: Registry;\n\n\tprivate broker: Broker;\n\n\tprivate scope: ScopeImpl;\n\n\tconstructor(name: string, scope?: ScopeImpl) {\n\t\tthis.name = name;\n\t\tthis.registry = new RegistryImpl();\n\t\tthis.broker = new BrokerImpl();\n\t\tthis.scope = new ScopeImpl();\n\n\t\tif (scope) {\n\t\t\tthis.scope.setParent(scope);\n\t\t}\n\t}\n\n\tpublic getLogger(): Logger {\n\t\treturn LoggerFactory.getLogger(this.name);\n\t}\n\n\tpublic getName(): string {\n\t\treturn this.name;\n\t}\n\n\tpublic associate(...componentClasses: any[]): Module {\n\t\tcomponentClasses.forEach((componentClass) => {\n\t\t\tcomponentClass[\"prototype\"][MODULE_FIELD_NAME] = this;\n\t\t});\n\n\t\treturn this;\n\t}\n\n\tpublic disassociate(...componentClasses: any[]): Module {\n\t\tcomponentClasses.forEach((componentClass) => {\n\t\t\tcomponentClass[\"prototype\"][MODULE_FIELD_NAME] = this;\n\t\t});\n\n\t\treturn this;\n\t}\n\n\tpublic clear(): Module {\n\t\treturn this;\n\t}\n\n\tpublic broadcast(channelName: string, messageName: string, payload: any): void {\n\t\tthis.broker.broadcast(channelName, messageName, payload);\n\t}\n\n\tpublic message(channelName: string, messageName: string, payload: any): void {\n\t\tif (channelName === INTERNAL_DIRECT_CHANNEL_NAME) {\n\t\t\tif (messageName === \"addListener\") {\n\t\t\t\tthis.addListener(payload as Listener);\n\t\t\t} else if (messageName === \"removeListener\") {\n\t\t\t\tthis.removeListener(payload as Listener);\n\t\t\t}\n\t\t}\n\t}\n\n\tpublic get<T>(id: string): T {\n\t\tlet result: T = this.registry.get(id);\n\n\t\tif (!result) {\n\t\t\tresult = Modules.get(id);\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tpublic getLocal<T>(id: string): T {\n\t\treturn this.registry.get(id);\n\t}\n\n\tpublic getScope(): Scope {\n\t\treturn this.scope;\n\t}\n\n\tpublic registerConstant(id: string, instance: any): Module {\n\t\ttry {\n\t\t\tthis.registry.registerConstant(id, instance);\n\t\t} catch (e) {\n\t\t\tthis.logError(e);\n\t\t}\n\t\treturn this;\n\t}\n\n\tpublic registerPrototype(id: string, classInstance: any): Module {\n\t\ttry {\n\t\t\tthis.registry.registerPrototype(id, classInstance);\n\t\t} catch (e) {\n\t\t\tthis.logError(e);\n\t\t}\n\t\treturn this;\n\t}\n\n\tpublic registerSingleton(id: string, classInstance: any): Module {\n\t\ttry {\n\t\t\tthis.registry.registerSingleton(id, classInstance);\n\t\t} catch (e) {\n\t\t\tthis.logError(e);\n\t\t}\n\t\treturn this;\n\t}\n\n\tpublic addStrategy(strategy: RegistryStrategy): Module {\n\t\tthis.registry.addStrategy(strategy);\n\t\treturn this;\n\t}\n\n\tpublic expose(id: string): Module {\n\t\tALIASES[id] = this.name;\n\n\t\treturn this;\n\t}\n\n\tprivate addListener(listener: Listener): void {\n\t\tthis.broker.addListener(listener);\n\t}\n\n\tprivate removeListener(listener: Listener): void {\n\t\tthis.broker.removeListener(listener);\n\t}\n\n\tprivate logError(e: RegistrationError) {\n\t\tthis.getLogger().error(e);\n\t}\n\n}\n\nconst DEF_KEY: string = \"DEFAULT\";\nconst DEFAULT_MODULE: Module = new ModuleImpl(DEF_KEY);\n\nclass Modules {\n\n\tpublic static getModule(name: string): Module {\n\t\tif (!Modules.modules[name]) {\n\t\t\tModules.modules[name] = new ModuleImpl(name, DEFAULT_MODULE.getScope() as ScopeImpl);\n\t\t}\n\n\t\treturn Modules.modules[name];\n\t}\n\n\tpublic static getDefaultModule(): Module {\n\t\treturn this.getModule(DEF_KEY);\n\t}\n\n\tpublic static forEach(fn: (instace: Module) => void): void {\n\t\tfor (const name in Modules.modules) {\n\t\t\tif (!Modules.modules.hasOwnProperty(name)) {\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tconst current: Module = Modules.modules[name];\n\n\t\t\tfn(current);\n\t\t}\n\t}\n\n\tpublic static broadcast(channelName: string, messageName: string, payload: any): void {\n\t\tModules.forEach((instance) => instance.broadcast(channelName, messageName, payload));\n\t}\n\n\tpublic static registerConstant(id: string, instance: any): void {\n\t\tthis.getDefaultModule().registerConstant(id, instance);\n\t}\n\n\tpublic static registerPrototype(id: string, classInstance: any): void {\n\t\tthis.getDefaultModule().registerPrototype(id, classInstance);\n\t}\n\n\tpublic static registerSingleton(id: string, classInstance: any): void {\n\t\tthis.getDefaultModule().registerSingleton(id, classInstance);\n\t}\n\n\tpublic static registerElementMediator(name: string, supportedTags: string[], elementMediatorClass: any): void {\n\t\ttry {\n\t\t\tMvvm.register(name, supportedTags, elementMediatorClass);\n\t\t} catch (e) {\n\t\t\tthis.logger.error(e.message);\n\t\t}\n\t}\n\n\tpublic static getScope(): Scope {\n\t\treturn this.getDefaultModule().getScope();\n\t}\n\n\tpublic static get<T>(id: string): T {\n\t\tlet result: T = null;\n\n\t\tconst moduleId: string = ALIASES[id];\n\n\t\tif (moduleId) {\n\t\t\tresult = Modules.getModule(id).getLocal(id);\n\t\t}\n\n\t\tif (!result) {\n\t\t\tresult = DEFAULT_MODULE.getLocal(id);\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tprivate static logger: Logger = LoggerFactory.getLogger(\"Modules:static\");\n\n\tprivate static modules: {\n\t\t[id: string]: Module;\n\t} = {\n\t\t\tDEFAULT: DEFAULT_MODULE,\n\t\t};\n\n}\n\nclass Deferred<S, T> {\n\n\tprivate instance: T;\n\n\tprivate factory: (source: S) => T;\n\n\tconstructor(factory: (source: S) => T) {\n\t\tthis.factory = factory;\n\t}\n\n\tpublic get(source: S): T {\n\t\tif (!this.instance) {\n\t\t\tthis.instance = this.factory(source);\n\t\t}\n\n\t\treturn this.instance;\n\t}\n\n}\n\ninterface MetadataContinuation {\n\n\thas: (name: string) => boolean;\n\n\tget: (name: string) => any;\n\n}\n\nclass Component {\n\n\t// tslint:disable-next-line\n\tprivate ____internal$$cydran____: ComponentInternals;\n\n\t// tslint:disable-next-line\n\tprivate ____internal$$cydran$$module____: any;\n\n\tconstructor(template: string, config?: ComponentConfig) {\n\t\tthis.____internal$$cydran$$init____(template, config);\n\t}\n\n\tpublic metadata(): MetadataContinuation {\n\t\tconst internal: ComponentInternals = this.____internal$$cydran____;\n\n\t\treturn {\n\t\t\tget: (name: string) => internal.getMetadata(name),\n\t\t\thas: (name: string) => internal.hasMetadata(name),\n\t\t};\n\t}\n\n\tpublic hasRegion(name: string): boolean {\n\t\treturn this.____internal$$cydran____.hasRegion(name);\n\t}\n\n\tpublic setChild(name: string, component: Component): void {\n\t\tthis.____internal$$cydran____.setChild(name, component);\n\t}\n\n\tpublic setChildFromRegistry(name: string, componentName: string, defaultComponentName?: string): void {\n\t\tthis.____internal$$cydran____.setChildFromRegistry(name, componentName, defaultComponentName);\n\t}\n\n\tpublic message(channelName: string, messageName: string, payload: any): void {\n\t\tthis.____internal$$cydran____.message(channelName, messageName, payload);\n\t}\n\n\tpublic dispose(): void {\n\t\tthis.____internal$$cydran____.dispose();\n\t}\n\n\tpublic getParent(): Component {\n\t\treturn this.____internal$$cydran____.getParent();\n\t}\n\n\tpublic getEl(): HTMLElement {\n\t\treturn this.____internal$$cydran____.getEl();\n\t}\n\n\tpublic get<T>(id: string): T {\n\t\treturn this.____internal$$cydran____.get(id);\n\t}\n\n\tpublic scope(): Scope {\n\t\treturn this.____internal$$cydran____.getScope();\n\t}\n\n\tpublic reset(): void {\n\t\tthis.init();\n\t}\n\n\tprotected init(): void {\n\t\t// Intentionally do nothing by default\n\t}\n\n\tprotected getItem<T>(): T {\n\t\treturn this.____internal$$cydran____.getData() as T;\n\t}\n\n\tprotected getExternals<T>(): T {\n\t\treturn this.____internal$$cydran____.getExternalCache() as T;\n\t}\n\n\tprotected broadcast(channelName: string, messageName: string, payload: any): void {\n\t\tthis.____internal$$cydran____.broadcast(channelName, messageName, payload);\n\t}\n\n\tprotected broadcastGlobally(channelName: string, messageName: string, payload: any): void {\n\t\tthis.____internal$$cydran____.broadcastGlobally(channelName, messageName, payload);\n\t}\n\n\tprotected $apply(fn: Function, args: any[]): void {\n\t\tthis.____internal$$cydran____.$apply(fn, args);\n\t}\n\n\tprotected watch(expression: string, target: (previous: any, current: any) => void): void {\n\t\tthis.____internal$$cydran____.watch(expression, target);\n\t}\n\n\tprotected on(messageName: string): OnContinuation {\n\t\treturn {\n\t\t\tforChannel: (channel: string) => {\n\t\t\t\treturn {\n\t\t\t\t\tinvoke: (target: (payload: any) => void) => {\n\t\t\t\t\t\tthis.____internal$$cydran____.on(target, messageName, channel);\n\t\t\t\t\t},\n\t\t\t\t};\n\t\t\t},\n\t\t\tinvoke: (target: (payload: any) => void) => {\n\t\t\t\tthis.____internal$$cydran____.on(target, messageName, INTERNAL_CHANNEL_NAME);\n\t\t\t},\n\t\t};\n\t}\n\n\tprotected getLogger(): Logger {\n\t\treturn this.____internal$$cydran____.getLogger();\n\t}\n\n\tprotected ____internal$$cydran$$init____(template: string, config: ComponentConfig): void {\n\t\tthis.____internal$$cydran____ = new ComponentInternals(this, template, config);\n\t\tthis.____internal$$cydran____.init();\n\t}\n\n}\n\nComponent[\"prototype\"][MODULE_FIELD_NAME] = DEFAULT_MODULE;\n\ninterface ComponentFlags {\n\n\trepeatable: boolean;\n\n}\n\ninterface ExternalAttributeDetail {\n\n\tattributeName: string;\n\n\texpression: string;\n\n}\n\nclass ComponentInternals implements Digestable {\n\n\tprivate flags: ComponentFlags;\n\n\tprivate component: Component;\n\n\tprivate logger: Logger;\n\n\tprivate el: HTMLElement;\n\n\tprivate regions: { [id: string]: Region; };\n\n\tprivate parent: Component;\n\n\tprivate data: any;\n\n\tprivate id: number;\n\n\tprivate template: string;\n\n\tprivate mvvm: Mvvm;\n\n\tprivate pubSub: PubSub;\n\n\tprivate scope: ScopeImpl;\n\n\tprivate parentScope: ScopeImpl;\n\n\tprivate externalCache: any;\n\n\tprivate externalMediators: SimpleMap<ExternalMediator<any>>;\n\n\tprivate externalFields: SimpleMap<string>;\n\n\tprivate readonly prefix: string;\n\n\tprivate guard: string;\n\n\tprivate config: ComponentConfig;\n\n\tconstructor(component: Component, template: string, config: ComponentConfig) {\n\t\tif (typeof template !== \"string\") {\n\t\t\tthrow new TemplateError(\"Template must be a non-null string\");\n\t\t}\n\n\t\tthis.config = config || DEFAULT_COMPONENT_CONFIG;\n\n\t\tthis.guard = GuardGenerator.INSTANCE.generate();\n\t\tthis.id = SequenceGenerator.INSTANCE.next();\n\t\tthis.logger = LoggerFactory.getLogger(component.constructor.name + \" Component \" + this.id);\n\t\tthis.parent = null;\n\t\tthis.component = component;\n\t\tthis.prefix = this.config.getPrefix().toLowerCase();\n\t\tthis.template = template.trim();\n\t\tthis.scope = new ScopeImpl();\n\t\tthis.externalMediators = {};\n\t\tthis.externalCache = {};\n\t\tthis.externalFields = {};\n\n\t\tconst effectiveExternalAttributes: string[] = this.config.getAttributes();\n\n\t\tfor (const attribute of effectiveExternalAttributes) {\n\t\t\tthis.externalize(attribute);\n\t\t}\n\n\t\tthis.flags = {\n\t\t\trepeatable: false,\n\t\t};\n\n\t\tif (this.getModule()) {\n\t\t\tthis.scope.setParent(this.getModule().getScope() as ScopeImpl);\n\t\t}\n\n\t\tthis.regions = {};\n\t\tthis.pubSub = new PubSub(this.component, this.getModule());\n\t}\n\n\tpublic init() {\n\t\tthis.component.reset();\n\t\tthis.mvvm = new Mvvm(this.component, this.getModule(), this.prefix, this.scope);\n\t\tthis.render();\n\t\tthis.mvvm.init(this.el, this, (name: string) => this.getRegion(name));\n\t}\n\n\tpublic hasMetadata(name: string): boolean {\n\t\treturn this.getMetadata(name) ? true : false;\n\t}\n\n\tpublic getMetadata(name: string): any {\n\t\treturn this.config.getMetadata(name);\n\t}\n\n\tpublic hasRegion(name: string): boolean {\n\t\treturn ((this.regions[name]) ? true : false);\n\t}\n\n\tpublic $apply(fn: Function, args: any[], guard?: Guard): void {\n\t\tconst localGuard: GuardImpl = GuardImpl.down(guard) as GuardImpl;\n\n\t\tif (localGuard.seen(this.guard)) {\n\t\t\tthis.getLogger().trace(\"Breaking digest loop\");\n\t\t\treturn;\n\t\t}\n\n\t\tlocalGuard.mark(this.guard);\n\n\t\tthis.mvvm.$apply(fn, args, localGuard);\n\t}\n\n\tpublic setChild(name: string, component: Component): void {\n\t\tif (!this.hasRegion(name)) {\n\t\t\tthrow new UnknownRegionError(\"Region \\'%rName%\\' is unkown and must be declared in component template.\", { \"%rName%\": name });\n\t\t}\n\n\t\tconst hasComponent: boolean = this.getRegion(name).hasComponent();\n\n\t\tconst childAdded: boolean = !!(component !== null && !hasComponent);\n\t\tconst childRemoved: boolean = !!(component === null && hasComponent);\n\n\t\tif (childAdded) {\n\t\t\tthis.message(INTERNAL_CHANNEL_NAME, Events.BEFORE_CHILD_ADDED, {\n\t\t\t\tname: name,\n\t\t\t});\n\t\t}\n\n\t\tif (childRemoved) {\n\t\t\tthis.message(INTERNAL_CHANNEL_NAME, Events.BEFORE_CHILD_REMOVED, {\n\t\t\t\tname: name,\n\t\t\t});\n\t\t}\n\n\t\tthis.message(INTERNAL_CHANNEL_NAME, Events.BEFORE_CHILD_CHANGED, {\n\t\t\tname: name,\n\t\t});\n\n\t\tthis.getRegion(name).setComponent(component);\n\n\t\tthis.message(INTERNAL_CHANNEL_NAME, Events.AFTER_CHILD_CHANGED, {\n\t\t\tname: name,\n\t\t});\n\n\t\tif (childAdded) {\n\t\t\tthis.message(INTERNAL_CHANNEL_NAME, Events.AFTER_CHILD_ADDED, {\n\t\t\t\tname: name,\n\t\t\t});\n\t\t}\n\n\t\tif (childRemoved) {\n\t\t\tthis.message(INTERNAL_CHANNEL_NAME, Events.AFTER_CHILD_REMOVED, {\n\t\t\t\tname: name,\n\t\t\t});\n\t\t}\n\t}\n\n\tpublic setChildFromRegistry(name: string, componentName: string, defaultComponentName?: string): void {\n\t\tlet component: Component = this.get(componentName);\n\n\t\tif (!component && defaultComponentName) {\n\t\t\tcomponent = this.get(defaultComponentName);\n\t\t}\n\n\t\tif (component) {\n\t\t\tthis.setChild(name, component);\n\t\t} else {\n\t\t\tconst error = new SetComponentError(\"Unable to set component %cName% on region %name%\", { \"%cName%\": componentName, \"%name%\": name });\n\t\t\tthis.getLogger().error(error);\n\t\t}\n\t}\n\n\tpublic message(channelName: string, messageName: string, payload: any): void {\n\t\tif (channelName === INTERNAL_DIRECT_CHANNEL_NAME) {\n\t\t\tif (messageName === \"propagateDigest\") {\n\t\t\t\tif (this.flags.repeatable) {\n\t\t\t\t\tthis.propagateDigest(payload);\n\t\t\t\t}\n\t\t\t} else if (messageName === \"setMode\") {\n\t\t\t\tswitch (payload) {\n\t\t\t\t\tcase \"repeatable\":\n\t\t\t\t\t\tthis.flags.repeatable = true;\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tthis.flags.repeatable = false;\n\t\t\t\t}\n\t\t\t} else if (messageName === \"digest\") {\n\t\t\t\tthis.digest(payload as Guard);\n\t\t\t} else if (messageName === \"setParent\") {\n\t\t\t\tthis.setParent(payload as Component);\n\t\t\t} else if (messageName === \"setParentScope\") {\n\t\t\t\tthis.setParentScope(payload as ScopeImpl);\n\t\t\t} else if (messageName === \"setData\") {\n\t\t\t\tthis.setData(payload);\n\t\t\t} else if (messageName === \"addExternalAttribute\") {\n\t\t\t\tthis.addExternalAttribute(payload as ExternalAttributeDetail);\n\t\t\t}\n\t\t} else {\n\t\t\tthis.pubSub.message(channelName, messageName, payload);\n\t\t}\n\t}\n\n\tpublic broadcast(channelName: string, messageName: string, payload: any): void {\n\t\tthis.getModule().broadcast(channelName, messageName, payload);\n\t}\n\n\tpublic broadcastGlobally(channelName: string, messageName: string, payload: any): void {\n\t\tModules.broadcast(channelName, messageName, payload);\n\t}\n\n\tpublic dispose(): void {\n\t\tthis.message(INTERNAL_CHANNEL_NAME, Events.BEFORE_DISPOSE, {});\n\t\tthis.pubSub.dispose();\n\t\tthis.parent = null;\n\t\tthis.parentScope = null;\n\t\tthis.scope = null;\n\t}\n\n\tpublic getId(): number {\n\t\treturn this.id;\n\t}\n\n\tpublic getEl(): HTMLElement {\n\t\treturn this.el;\n\t}\n\n\tpublic getComponent(): Component {\n\t\treturn this.component;\n\t}\n\n\tpublic get<T>(id: string): T {\n\t\treturn this.getModule().get(id);\n\t}\n\n\tpublic getPrefix(): string {\n\t\treturn this.prefix;\n\t}\n\n\tpublic getScope(): Scope {\n\t\treturn this.scope;\n\t}\n\n\tpublic watch(expression: string, target: (previous: any, current: any) => void): void {\n\t\tthis.mvvm.mediate(expression).watch(this, target);\n\t}\n\n\tpublic on(target: (payload: any) => void, messageName: string, channel?: string): void {\n\t\tconst targetChannel: string = channel || INTERNAL_CHANNEL_NAME;\n\n\t\tthis.pubSub.on(messageName).forChannel(targetChannel).invoke((payload: any) => {\n\t\t\tthis.$apply(target, [payload]);\n\t\t});\n\t}\n\n\tpublic getLogger(): Logger {\n\t\treturn this.logger;\n\t}\n\n\tpublic getModule(): Module {\n\t\treturn this.component[MODULE_FIELD_NAME] as Module;\n\t}\n\n\tpublic getParent(): Component {\n\t\treturn this.parent;\n\t}\n\n\tpublic setData(data: any): void {\n\t\tthis.data = data;\n\t}\n\n\tpublic getData(): any {\n\t\treturn this.data;\n\t}\n\n\tpublic importExternals(): void {\n\t\tthis.externalCache = {};\n\n\t\tfor (const key in this.externalMediators) {\n\t\t\tif (this.externalMediators.hasOwnProperty(key)) {\n\t\t\t\tconst mediator: ExternalMediator<any> = this.externalMediators[key];\n\t\t\t\tthis.externalCache[key] = mediator.get(this.parentScope);\n\t\t\t}\n\t\t}\n\t}\n\n\tpublic exportExternals(): void {\n\t\tfor (const key in this.externalMediators) {\n\t\t\tif (this.externalMediators.hasOwnProperty(key)) {\n\t\t\t\tconst mediator: ExternalMediator<any> = this.externalMediators[key];\n\t\t\t\tmediator.set(this.parentScope, this.externalCache[key]);\n\t\t\t}\n\t\t}\n\n\t\tthis.externalCache = {};\n\t}\n\n\tpublic getExternalCache(): any {\n\t\treturn this.externalCache;\n\t}\n\n\tprotected getGuard(): string {\n\t\treturn this.guard;\n\t}\n\n\tprotected getRegion(name: string): Region {\n\t\tif (!this.regions[name]) {\n\t\t\tthis.getLogger().trace(\"Creating region \" + name);\n\t\t\tthis.regions[name] = new Region(name, this);\n\t\t}\n\n\t\treturn this.regions[name];\n\t}\n\n\tprotected getTemplate(): string {\n\t\treturn this.template;\n\t}\n\n\tprotected render(): void {\n\t\tthis.getLogger().trace(\"Rendering\");\n\t\tconst templateEl: HTMLTemplateElement = Properties.getWindow().document.createElement(\"template\");\n\t\ttemplateEl.insertAdjacentHTML(\"afterbegin\", this.template.trim());\n\t\tconst count: number = templateEl.childElementCount;\n\n\t\tif (count !== 1) {\n\t\t\tconst parmObj = { \"%count%\": \"\" + count, \"%template%\": this.template };\n\t\t\tconst errmsg = \"Component template must have a single top level element, but had %count% top level elements:\\n\\n%template%\\n\\n\";\n\t\t\tconst error = new TemplateError(errmsg, parmObj);\n\t\t\tthis.getLogger().fatal(error);\n\t\t\tthrow error;\n\t\t}\n\n\t\tthis.el = templateEl.firstElementChild as HTMLElement;\n\t}\n\n\tprotected setEl(el: HTMLElement): void {\n\t\tthis.el = el;\n\t}\n\n\tprivate externalize(name: string): void {\n\t\tconst key: string = name.toLowerCase();\n\t\tconst value: string = key;\n\n\t\t// TODO - add guard code\n\t\tthis.externalFields[key] = value;\n\t}\n\n\tprivate addExternalAttribute(detail: ExternalAttributeDetail): void {\n\t\tconst fieldName: string = this.externalFields[detail.attributeName];\n\n\t\tif (fieldName) {\n\t\t\tthis.externalMediators[fieldName] = new ExternalMediator(detail.expression);\n\t\t}\n\t}\n\n\tprivate setParentScope(scope: ScopeImpl): void {\n\t\tthis.parentScope = scope;\n\t}\n\n\tprivate setParent(parent: Component): void {\n\t\tif (parent === null) {\n\t\t\tthis.pubSub.message(INTERNAL_DIRECT_CHANNEL_NAME, \"disableGlobal\", {});\n\t\t\tthis.getLogger().trace(\"Clearing parent view\");\n\t\t} else {\n\t\t\tthis.pubSub.message(INTERNAL_DIRECT_CHANNEL_NAME, \"enableGlobal\", {});\n\t\t}\n\n\t\tconst parentAdded: boolean = !!(parent !== null && this.parent === null);\n\t\tconst parentRemoved: boolean = !!(parent === null && this.parent !== null);\n\n\t\tif (parentAdded) {\n\t\t\tthis.message(INTERNAL_CHANNEL_NAME, Events.BEFORE_PARENT_ADDED, {});\n\t\t}\n\n\t\tif (parentRemoved) {\n\t\t\tthis.message(INTERNAL_CHANNEL_NAME, Events.BEFORE_PARENT_REMOVED, {});\n\t\t}\n\n\t\tthis.message(INTERNAL_CHANNEL_NAME, Events.BEFORE_PARENT_CHANGED, {});\n\t\tthis.parent = parent;\n\t\tthis.digest();\n\t\tthis.message(INTERNAL_CHANNEL_NAME, Events.AFTER_PARENT_CHANGED, {});\n\n\t\tif (parentAdded) {\n\t\t\tthis.message(INTERNAL_CHANNEL_NAME, Events.AFTER_PARENT_ADDED, {});\n\t\t}\n\n\t\tif (parentRemoved) {\n\t\t\tthis.message(INTERNAL_CHANNEL_NAME, Events.AFTER_PARENT_REMOVED, {});\n\t\t}\n\t}\n\n\tprivate digest(guard?: Guard): void {\n\t\tthis.$apply(() => {\n\t\t\t// Intentionally do nothing\n\t\t}, [], guard);\n\t}\n\n\tprivate propagateDigest(guard: Guard): void {\n\t\tconst localGuard: GuardImpl = GuardImpl.up(guard) as GuardImpl;\n\n\t\tif (localGuard.seen(this.getGuard())) {\n\t\t\tthis.getLogger().trace(\"Breaking digest loop\");\n\t\t\treturn;\n\t\t}\n\n\t\tlocalGuard.mark(this.getGuard());\n\n\t\tif (this.getParent() && localGuard.isPropagateUp()) {\n\t\t\tthis.getParent().message(INTERNAL_DIRECT_CHANNEL_NAME, \"digest\", guard);\n\t\t} else {\n\t\t\tthis.getLogger().trace(\"Not propagating to parent\");\n\t\t}\n\t}\n\n}\n\nclass StageComponentInternals extends ComponentInternals {\n\n\tprotected render(): void {\n\t\tconst elements: NodeListOf<HTMLElement> = Properties.getWindow().document.querySelectorAll(this.getTemplate());\n\t\tconst eLength = ((elements) ? elements.length : 0);\n\t\tconst errMsg = (eLength !== 1) ? \"CSS selector MUST identify single HTMLElement: '%pattern%' - %qty% found\" : null;\n\n\t\tif (errMsg) {\n\t\t\tconst patSubObj = { \"%pattern%\": this.getTemplate(), \"%qty%\": eLength };\n\t\t\tconst error: SelectorError = new SelectorError(errMsg, patSubObj);\n\t\t\tthis.getLogger().fatal(error);\n\t\t\tthrow error;\n\t\t}\n\n\t\tconst element: HTMLElement = elements[0];\n\n\t\twhile (element.hasChildNodes()) {\n\t\t\telement.removeChild(element.firstChild);\n\t\t}\n\n\t\tconst regionDiv: HTMLElement = Properties.getWindow().document.createElement(\"c:region\");\n\t\tregionDiv.setAttribute(\"name\", \"body\");\n\t\telement.appendChild(regionDiv);\n\t\tthis.setEl(element);\n\t}\n\n}\n\nclass StageComponent extends Component {\n\n\tconstructor(selector: string) {\n\t\tsuper(selector);\n\t}\n\n\tpublic setComponent(component: Component): StageComponent {\n\t\tthis.setChild(\"body\", component);\n\n\t\treturn this;\n\t}\n\n\tprotected ____internal$$cydran$$init____(template: string, config: ComponentConfig): void {\n\t\tthis[COMPONENT_INTERNALS_FIELD_NAME] = new StageComponentInternals(this, template, config);\n\t\tthis[COMPONENT_INTERNALS_FIELD_NAME][\"init\"]();\n\t}\n}\n\nStageComponent[\"prototype\"][MODULE_FIELD_NAME] = DEFAULT_MODULE;\n\ninterface ElementMediatorDependencies {\n\n\tmvvm: Mvvm;\n\n\tparent: ComponentInternals;\n\n\tel: HTMLElement;\n\n\texpression: string;\n\n\tmodel: any;\n\n\tprefix: string;\n\n}\n\nabstract class ElementMediator<M, E extends HTMLElement> implements Disposable {\n\n\tprivate logger: Logger;\n\n\t// tslint:disable-next-line\n\tprivate ____internal$$cydran____: ElementMediatorDependencies;\n\n\tprivate moduleInstance: Module;\n\n\tprivate mediator: ModelMediator<M>;\n\n\tprivate pubSub: PubSub;\n\n\tprivate domListeners: {\n\t\t[name: string]: any;\n\t};\n\n\tconstructor(dependencies: any) {\n\t\tthis.logger = LoggerFactory.getLogger(\"ElementMediator: \" + dependencies.prefix);\n\t\tthis.____internal$$cydran____ = dependencies;\n\t\tthis.domListeners = {};\n\t\tthis.pubSub = new PubSub(this, this.getModule());\n\t}\n\n\t/**\n\t * Dispose of ElementMediator when released.\n\t * + All event listeners will be removed.\n\t * + This element mediator will be unwired from any other DOM entanglements\n\t * + The mediator reference to the model is released/nulled\n\t * + Any value representation of this element mediator is released/nulled\n\t * + The [[Mvvm|mvvm]] refernce is released/nulled\n\t * + The parental reference is released/nulled\n\t */\n\tpublic dispose(): void {\n\t\tthis.removeDomListeners();\n\t\tthis.unwire();\n\t\tthis.____internal$$cydran____ = null;\n\t\tthis.mediator = null;\n\t}\n\n\t/**\n\t * Initialize this element mediator.\n\t */\n\tpublic init(): void {\n\t\tthis.mediator = this.mediate(this.getExpression());\n\t\tthis.wire();\n\t}\n\n\t/**\n\t * Get the active module instance reference by id\n\t * @return U\n\t */\n\tpublic get<U>(id: string): U {\n\t\treturn this.moduleInstance.get(id);\n\t}\n\n\t/**\n\t * Set the [[Module|module]] instance reference\n\t * @param {Module} moduleInstance\n\t */\n\tpublic setModule(moduleInstance: Module): void {\n\t\tthis.moduleInstance = moduleInstance;\n\t}\n\n\t/**\n\t * [message description]\n\t * @param {string} channelName [description]\n\t * @param {string} messageName [description]\n\t * @param {any}    payload     [description]\n\t */\n\tpublic message(channelName: string, messageName: string, payload: any): void {\n\t\tthis.pubSub.message(channelName, messageName, payload);\n\t}\n\n\t/**\n\t * Broadcast a message\n\t * @param {string} channelName [description]\n\t * @param {string} messageName [description]\n\t * @param {any}    payload     [description]\n\t */\n\tpublic broadcast(channelName: string, messageName: string, payload: any): void {\n\t\tthis.getModule().broadcast(channelName, messageName, payload);\n\t}\n\n\t/**\n\t * Broadcast a message in the Global context\n\t * @param {string} channelName [description]\n\t * @param {string} messageName [description]\n\t * @param {any}    payload     [description]\n\t */\n\tpublic broadcastGlobally(channelName: string, messageName: string, payload: any): void {\n\t\tModules.broadcast(channelName, messageName, payload);\n\t}\n\n\tprotected listenTo(channel: string, messageName: string, target: (payload: any) => void): void {\n\t\tthis.pubSub.on(messageName).forChannel(channel).invoke((payload: any) => {\n\t\t\ttarget.apply(this, [payload]);\n\t\t});\n\t}\n\n\tprotected listenToFramework(messageName: string, target: (payload: any) => void): void {\n\t\tthis.listenTo(INTERNAL_CHANNEL_NAME, messageName, target);\n\t}\n\n\tprotected bridge(name: string): void {\n\t\tconst listener = (event: Event) => {\n\t\t\tthis.message(\"dom\", name, event);\n\t\t};\n\n\t\tif (!this.domListeners[name]) {\n\t\t\tthis.domListeners[name] = listener;\n\t\t\tthis.getEl().addEventListener(name, listener, false);\n\t\t}\n\t}\n\n\t/**\n\t * Get the associated {HTMLElement html element} of this element mediator.\n\t * @return {HTMLElement} [description]\n\t */\n\tprotected getEl(): E {\n\t\treturn this.____internal$$cydran____.el as E;\n\t}\n\n\t/**\n\t * [getModule description]\n\t * @return {Module} [description]\n\t */\n\tprotected getModule(): Module {\n\t\treturn this[\"moduleInstance\"] as Module;\n\t}\n\n\t/**\n\t * [mediate description]\n\t * @param  {string}        expression [description]\n\t * @return {ModelMediator}            [description]\n\t */\n\tprotected mediate<T>(expression: string): ModelMediator<T> {\n\t\treturn this.____internal$$cydran____.mvvm.mediate(expression);\n\t}\n\n\t/**\n\t * [getModel description]\n\t * @return {any} [description]\n\t */\n\tprotected getModel(): any {\n\t\treturn this.____internal$$cydran____.model;\n\t}\n\n\t/**\n\t * [getParent description]\n\t * @return {Component} [description]\n\t */\n\tprotected getParent(): Component {\n\t\treturn this.____internal$$cydran____.parent.getComponent();\n\t}\n\n\t/**\n\t * [getMediator description]\n\t * @return {ModelMediator} [description]\n\t */\n\tprotected getModelMediator(): ModelMediator<M> {\n\t\treturn this.mediator;\n\t}\n\n\tprotected $apply(fn: Function, args: any[], guard?: Guard): any {\n\t\tif (this.____internal$$cydran____ && this.____internal$$cydran____.mvvm) {\n\t\t\tthis.____internal$$cydran____.mvvm.$apply(fn, args, guard);\n\t\t}\n\t}\n\n\t/**\n\t * Get the expression specified\n\t * @return {string} [description]\n\t */\n\tprotected getExpression(): string {\n\t\treturn this.____internal$$cydran____.expression;\n\t}\n\n\t/**\n\t * Gets the logger.\n\t * @return {Logger} logger instance\n\t */\n\tprotected getLogger(): Logger {\n\t\treturn this.logger;\n\t}\n\n\t/**\n\t * Wire the element mediator\n\t */\n\tprotected abstract wire(): void;\n\n\t/**\n\t * Unwire the element mediator\n\t */\n\tprotected abstract unwire(): void;\n\n\tprivate removeDomListeners(): void {\n\t\tfor (const name in this.domListeners) {\n\t\t\tif (!this.domListeners.hasOwnProperty(name)) {\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tconst listener: any = this.domListeners[name];\n\n\t\t\tthis.getEl().removeEventListener(name, listener);\n\t\t}\n\n\t\tthis.domListeners = {};\n\t}\n\n}\n\nclass Region {\n\n\tprivate logger: Logger;\n\n\tprivate defaultEl: HTMLElement;\n\n\tprivate component: Component;\n\n\tprivate parent: ComponentInternals;\n\n\tprivate name: string;\n\n\tconstructor(name: string, parent: ComponentInternals) {\n\t\tthis.defaultEl = null;\n\t\tthis.component = null;\n\t\tthis.parent = parent;\n\t\tthis.name = name;\n\t\tthis.logger = LoggerFactory.getLogger(\"Region \" + this.name + \" for \" + parent.getId());\n\t}\n\n\tpublic setDefaultEl(defaultEl: HTMLElement): void {\n\t\tthis.defaultEl = defaultEl;\n\t}\n\n\tpublic setComponent(component: Component): void {\n\t\tthis.logger.trace(\"Setting component\");\n\n\t\tif (this.component === component) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (component !== null && this.component === null) {\n\t\t\tthis.component = component;\n\t\t\tconst newComponentEl: HTMLElement = component.getEl();\n\t\t\tconst parentElement: HTMLElement = this.defaultEl.parentElement;\n\t\t\tparentElement.replaceChild(newComponentEl, this.defaultEl);\n\t\t\tthis.component.message(INTERNAL_DIRECT_CHANNEL_NAME, \"setParent\", this.parent.getComponent());\n\t\t} else if (component === null && this.component !== null) {\n\t\t\tthis.component.message(INTERNAL_DIRECT_CHANNEL_NAME, \"setParent\", null);\n\t\t\tconst oldComponentEl: HTMLElement = this.component.getEl();\n\t\t\tthis.component = null;\n\t\t\tconst parentElement: HTMLElement = oldComponentEl.parentElement;\n\t\t\tparentElement.replaceChild(this.defaultEl, oldComponentEl);\n\t\t} else if (component !== null && this.component !== null) {\n\t\t\tthis.component.message(INTERNAL_DIRECT_CHANNEL_NAME, \"setParent\", null);\n\t\t\tconst newComponentEl: HTMLElement = component.getEl();\n\t\t\tconst oldComponentEl: HTMLElement = this.component.getEl();\n\t\t\tconst parentElement: HTMLElement = oldComponentEl.parentElement;\n\t\t\tparentElement.replaceChild(newComponentEl, oldComponentEl);\n\t\t\tthis.component = component;\n\t\t\tthis.component.message(INTERNAL_DIRECT_CHANNEL_NAME, \"setParent\", this.parent.getComponent());\n\t\t}\n\t}\n\n\tpublic hasComponent(): boolean {\n\t\treturn !!this.component;\n\t}\n\n\tpublic dispose() {\n\t\tif (this.component) {\n\t\t\tthis.component.dispose();\n\t\t}\n\n\t\tthis.setComponent(null);\n\t}\n\n}\n\nclass TextElementMediator extends ElementMediator<string, HTMLElement> {\n\n\tpublic wire(): void {\n\t\tthis.getModelMediator().watch(this, this.onTargetChange);\n\t}\n\n\tpublic unwire(): void {\n\t\t// Intentionally do nothing\n\t}\n\n\tprotected onTargetChange(previous: any, current: any): void {\n\t\tconst replacement: string = ObjectUtils.encodeHtml(current);\n\t\tthis.getEl().innerHTML = replacement;\n\t}\n\n}\n\nclass EventElementMediator extends ElementMediator<any, HTMLElement> {\n\n\tprivate eventKey: string;\n\n\tpublic unwire(): void {\n\t\t// Intentionally do nothing\n\t}\n\n\tpublic handleEvent(event: Event): void {\n\t\tthis.$apply(() => {\n\t\t\tthis.getModelMediator().invoke(event);\n\t\t}, [event], null);\n\t}\n\n\tpublic wire(): void {\n\t\tthis.bridge(this.eventKey);\n\t\tthis.listenTo(\"dom\", this.eventKey, this.handleEvent);\n\t}\n\n\tpublic setEventKey(eventKey: string): void {\n\t\tthis.eventKey = eventKey;\n\t}\n\n}\n\nclass AttributeElementMediator extends ElementMediator<string, HTMLElement> {\n\n\tprivate attributeName: string;\n\n\tpublic wire(): void {\n\t\tthis.getModelMediator().watch(this, this.onTargetChange);\n\t}\n\n\tpublic unwire(): void {\n\t\t// Intentionally do nothing\n\t}\n\n\tpublic setAttributeName(attributeName: string): void {\n\t\tthis.attributeName = attributeName;\n\t}\n\n\tprotected onTargetChange(previous: string, current: string): void {\n\t\tthis.getEl().setAttribute(this.attributeName, current + \"\");\n\t}\n\n}\n\nclass Mvvm {\n\n\tpublic static register(name: string, supportedTags: string[], elementMediatorClass: any): void {\n\t\tif (!Mvvm.factories[name]) {\n\t\t\tMvvm.factories[name] = {};\n\t\t}\n\n\t\tfor (const supportedTag of supportedTags) {\n\t\t\tMvvm.factories[name][supportedTag] = elementMediatorClass;\n\t\t}\n\t}\n\n\tprivate static factories: {\n\t\t[elementMediatorType: string]: {\n\t\t\t[tag: string]: new () => ElementMediator<any, HTMLElement>;\n\t\t},\n\t} = {};\n\n\tprivate logger: Logger;\n\n\tprivate el: HTMLElement;\n\n\tprivate elementMediators: Array<ElementMediator<any, HTMLElement>>;\n\n\tprivate mediators: Array<ModelMediatorImpl<any>>;\n\n\tprivate model: any;\n\n\tprivate parent: ComponentInternals;\n\n\tprivate moduleInstance: Module;\n\n\tprivate elementMediatorPrefix: string;\n\n\tprivate eventElementMediatorPrefix: string;\n\n\tprivate externalAttributePrefix: string;\n\n\tprivate regionPrefix: string;\n\n\tprivate componentPrefix: string;\n\n\tprivate components: Component[];\n\n\tprivate scope: ScopeImpl;\n\n\tprivate regionLookupFn: (name: string) => Region;\n\n\tconstructor(model: any, moduleInstance: Module, prefix: string, scope: ScopeImpl) {\n\t\tthis.elementMediatorPrefix = prefix + \":\";\n\t\tthis.eventElementMediatorPrefix = prefix + \":on\";\n\t\tthis.externalAttributePrefix = prefix + \":property-\";\n\t\tthis.regionPrefix = prefix + \":region\";\n\t\tthis.componentPrefix = prefix + \":component\";\n\t\tthis.logger = LoggerFactory.getLogger(\"Mvvm\");\n\t\tthis.scope = new ScopeImpl(false);\n\t\tthis.scope.setParent(scope);\n\t\tthis.elementMediators = [];\n\t\tthis.mediators = [];\n\t\tthis.model = model;\n\t\tthis.moduleInstance = moduleInstance;\n\t\tthis.components = [];\n\t\tthis.scope.add(\"m\", () => this.model);\n\t\tthis.scope.add(\"model\", () => this.model);\n\t\tthis.scope.add(\"i\", () => this.parent.getData());\n\t\tthis.scope.add(\"item\", () => this.parent.getData());\n\t\tthis.scope.add(\"p\", () => this.parent.getComponent().getParent());\n\t\tthis.scope.add(\"parent\", () => this.parent.getComponent().getParent());\n\t\tthis.scope.add(\"e\", () => this.parent.getExternalCache());\n\t\tthis.scope.add(\"external\", () => this.parent.getExternalCache());\n\t}\n\n\tpublic init(el: HTMLElement, parent: ComponentInternals, regionLookupFn: (name: string) => Region): void {\n\t\tthis.el = el;\n\t\tthis.parent = parent;\n\t\tthis.regionLookupFn = regionLookupFn;\n\t\tthis.populateElementMediators();\n\t}\n\n\tpublic dispose(): void {\n\t\tfor (const elementMediator of this.elementMediators) {\n\t\t\telementMediator.dispose();\n\t\t}\n\n\t\tthis.elementMediators = [];\n\t\tthis.components = [];\n\n\t\tfor (const component of this.components) {\n\t\t\tcomponent.dispose();\n\t\t}\n\n\t\tthis.parent = null;\n\t}\n\n\tpublic mediate<T>(expression: string): ModelMediator<T> {\n\t\tconst mediator: ModelMediator<T> = new ModelMediatorImpl<T>(this.model, expression, this.scope);\n\t\tthis.mediators.push(mediator as ModelMediatorImpl<any>);\n\n\t\treturn mediator;\n\t}\n\n\tpublic digest(guard: Guard): void {\n\t\tconst localGuardDown: GuardImpl = GuardImpl.down(guard) as GuardImpl;\n\n\t\tlet remainingEvaluations: number = MAX_EVALUATIONS;\n\t\tlet pending: boolean = true;\n\n\t\twhile (pending && remainingEvaluations > 0) {\n\t\t\tremainingEvaluations--;\n\n\t\t\tconst changedMediators: Array<ModelMediator<any>> = [];\n\n\t\t\tfor (const mediator of this.mediators) {\n\t\t\t\tconst changed: boolean = mediator.evaluate(localGuardDown);\n\n\t\t\t\tif (changed) {\n\t\t\t\t\tchangedMediators.push(mediator);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (changedMediators.length === 0) {\n\t\t\t\tpending = false;\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tfor (const changedMediator of changedMediators) {\n\t\t\t\tchangedMediator.notifyWatcher(localGuardDown);\n\t\t\t}\n\t\t}\n\n\t\tif (remainingEvaluations === 0) {\n\t\t\t// TODO - Make this error handling better\n\t\t\tthrow new DigestLoopError(\"Loop detected in digest cycle.\");\n\t\t}\n\n\t\tfor (const mediator of this.mediators) {\n\t\t\tmediator.executeCallback(localGuardDown);\n\t\t}\n\t}\n\n\tpublic $apply(fn: Function, args: any[], guard?: Guard): any {\n\t\tconst localGuardUp: GuardImpl = GuardImpl.up(guard) as GuardImpl;\n\t\tlet result: any = null;\n\n\t\tthis.parent.importExternals();\n\n\t\ttry {\n\t\t\tresult = fn.apply(this.model, args);\n\t\t\tthis.digest(guard);\n\t\t} finally {\n\t\t\tthis.parent.exportExternals();\n\t\t}\n\n\t\tthis.parent.message(INTERNAL_DIRECT_CHANNEL_NAME, \"propagateDigest\", localGuardUp);\n\n\t\tfor (const component of this.components) {\n\t\t\tcomponent.message(INTERNAL_DIRECT_CHANNEL_NAME, \"digest\", guard);\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tprivate populateElementMediators(): void {\n\t\tconst queue: HTMLElement[] = [this.el];\n\n\t\twhile (queue.length > 0) {\n\t\t\tthis.processChild(queue);\n\t\t}\n\t}\n\n\tprivate processChild(queue: HTMLElement[]): void {\n\t\tconst el: HTMLElement = queue.pop();\n\t\tconst EVT_NAME_ERR = \"Event expressor \\'%eventName%\\' MUST correspond to a valid event in the target environment: \\'\";\n\t\tconst regex = /^[A-Za-z]+$/;\n\t\tconst elName: string = el.tagName.toLowerCase();\n\n\t\tif (elName === this.regionPrefix) {\n\t\t\tconst regionName: string = el.getAttribute(\"name\");\n\t\t\tconst region: Region = this.regionLookupFn(regionName);\n\t\t\tregion.setDefaultEl(el as HTMLElement);\n\t\t\treturn;\n\t\t} else if (elName === this.componentPrefix) {\n\t\t\tconst componentName: string = el.getAttribute(\"name\");\n\t\t\tconst moduleName: string = el.getAttribute(\"module\");\n\t\t\tconst moduleToUse: Module = moduleName ? Modules.getModule(moduleName) : this.moduleInstance;\n\t\t\tconst component: Component = (moduleToUse || this.moduleInstance).get(componentName);\n\t\t\tel.parentElement.replaceChild(component.getEl(), el);\n\n\t\t\tfor (let i = el.attributes.length - 1; i >= 0; i--) {\n\t\t\t\tconst attributeName: string = el.attributes[i].name.toLowerCase();\n\t\t\t\tconst attributeValue: string = el.attributes[i].value;\n\n\t\t\t\tif (attributeName.indexOf(this.externalAttributePrefix) === 0) {\n\t\t\t\t\tconst propertyName: string = attributeName.substr(this.externalAttributePrefix.length);\n\t\t\t\t\tconst detail: ExternalAttributeDetail = {\n\t\t\t\t\t\tattributeName: propertyName,\n\t\t\t\t\t\texpression: attributeValue,\n\t\t\t\t\t};\n\n\t\t\t\t\tcomponent.message(INTERNAL_DIRECT_CHANNEL_NAME, \"addExternalAttribute\", detail);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tcomponent.message(INTERNAL_DIRECT_CHANNEL_NAME, \"setParentScope\", this.scope);\n\t\t\tcomponent.message(INTERNAL_DIRECT_CHANNEL_NAME, \"setParent\", this.parent.getComponent());\n\t\t\tcomponent.message(INTERNAL_DIRECT_CHANNEL_NAME, \"setMode\", \"repeatable\");\n\t\t\tthis.components.push(component);\n\t\t\treturn;\n\t\t}\n\n\t\t// tslint:disable-next-line\n\t\tfor (let i = 0; i < el.children.length; i++) {\n\t\t\tqueue.push(el.children[i] as HTMLElement);\n\t\t}\n\n\t\tthis.processTextChildren(el.childNodes);\n\n\t\tfor (const name of el.getAttributeNames()) {\n\t\t\tconst expression: string = el.getAttribute(name);\n\t\t\tif (name.indexOf(this.eventElementMediatorPrefix) === 0) {\n\t\t\t\tconst eventName: string = name.substr(this.eventElementMediatorPrefix.length);\n\n\t\t\t\tif (!regex.test(eventName)) {\n\t\t\t\t\tthrow new MalformedOnEventError(EVT_NAME_ERR, { \"%eventName%\": eventName });\n\t\t\t\t}\n\n\t\t\t\tthis.addEventElementMediator(eventName.toLowerCase(), expression, el as HTMLElement);\n\t\t\t\tel.removeAttribute(name);\n\t\t\t} else if (name.indexOf(this.elementMediatorPrefix) === 0) {\n\t\t\t\tconst elementMediatorType: string = name.substr(this.elementMediatorPrefix.length);\n\t\t\t\tthis.addElementMediator(el.tagName.toLowerCase(), elementMediatorType, expression, el as HTMLElement);\n\t\t\t\tel.removeAttribute(name);\n\t\t\t} else if (expression.length > 4 && expression.indexOf(\"{{\") === 0 && expression.indexOf(\"}}\", expression.length - 2) !== -1) {\n\t\t\t\tconst trimmedExpression: string = expression.substring(2, expression.length - 2);\n\t\t\t\tthis.addAttributeElementMediator(name, trimmedExpression, el as HTMLElement);\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate processTextChildren(children: NodeListOf<ChildNode>): void {\n\t\tconst discoveredNodes: ChildNode[] = [];\n\n\t\t// tslint:disable-next-line\n\t\tfor (let i = 0; i < children.length; i++) {\n\t\t\tconst child: ChildNode = children[i];\n\n\t\t\tif (TEXT_NODE_TYPE === child.nodeType) {\n\t\t\t\tdiscoveredNodes.push(child);\n\t\t\t}\n\t\t}\n\n\t\tfor (const node of discoveredNodes) {\n\t\t\tconst result: Node[] = this.splitChild(node);\n\n\t\t\tif (result.length > 1) {\n\t\t\t\tfor (const newNode of result) {\n\t\t\t\t\tnode.parentNode.insertBefore(newNode, node);\n\t\t\t\t}\n\n\t\t\t\tnode.remove();\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate splitChild(node: Node): Node[] {\n\t\tconst source: string = node.textContent || \"\";\n\t\tconst sections: string[] = source.split(/(\\{\\{|\\}\\})/);\n\n\t\tif (sections.length < 2) {\n\t\t\treturn [node];\n\t\t}\n\n\t\tlet inside: boolean = false;\n\n\t\tconst collected: Node[] = [];\n\n\t\tfor (const section of sections) {\n\t\t\tswitch (section) {\n\t\t\t\tcase \"{{\":\n\t\t\t\t\tinside = true;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"}}\":\n\t\t\t\t\tinside = false;\n\t\t\t\t\tbreak;\n\n\t\t\t\tdefault:\n\t\t\t\t\tif (inside) {\n\t\t\t\t\t\tconst span: HTMLElement = Properties.getWindow().document.createElement(\"span\");\n\t\t\t\t\t\tspan.innerHTML = \"\";\n\t\t\t\t\t\tthis.addTextElementMediator(section, span);\n\t\t\t\t\t\tcollected.push(span);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tconst textNode: Text = Properties.getWindow().document.createTextNode(section);\n\t\t\t\t\t\tcollected.push(textNode);\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\treturn collected;\n\t}\n\n\tprivate addTextElementMediator(expression: string, el: HTMLElement): void {\n\t\tconst deps = { mvvm: this, parent: this.parent, el: el, expression: expression, model: this.model, prefix: \"Text\" };\n\t\tconst elementMediator: TextElementMediator = new TextElementMediator(deps);\n\t\telementMediator.setModule(this.moduleInstance);\n\t\telementMediator.init();\n\n\t\tthis.elementMediators.push(elementMediator);\n\t}\n\n\tprivate addEventElementMediator(eventName: string, expression: string, el: HTMLElement): void {\n\t\tconst deps = { mvvm: this, parent: this.parent, el: el, expression: expression, model: this.model, prefix: \"Event\" };\n\t\tconst elementMediator: EventElementMediator = new EventElementMediator(deps);\n\t\telementMediator.setModule(this.moduleInstance);\n\t\telementMediator.setEventKey(eventName);\n\t\telementMediator.init();\n\n\t\tthis.elementMediators.push(elementMediator);\n\t}\n\n\tprivate addAttributeElementMediator(attributeName: string, expression: string, el: HTMLElement): void {\n\t\tconst deps = { mvvm: this, parent: this.parent, el: el, expression: expression, model: this.model, prefix: \"Event\" };\n\t\tconst elementMediator: AttributeElementMediator = new AttributeElementMediator(deps);\n\t\telementMediator.setModule(this.moduleInstance);\n\t\telementMediator.setAttributeName(attributeName);\n\t\telementMediator.init();\n\n\t\tthis.elementMediators.push(elementMediator);\n\t}\n\n\tprivate addElementMediator(tag: string, elementMediatorType: string, attributeValue: string, el: HTMLElement): void {\n\t\tconst tags: { [tag: string]: new () => ElementMediator<any, HTMLElement>; } = Mvvm.factories[elementMediatorType];\n\t\tconst prefix: string = \"data-p-\" + elementMediatorType + \"-\"; // TODO - Determine if this is still correct\n\n\t\tlet elementMediator: ElementMediator<any, HTMLElement> = null;\n\n\t\tif (!tags) {\n\t\t\tthis.logger.error(\"Unsupported elementMediator type: \" + elementMediatorType + \".\");\n\t\t\treturn;\n\t\t}\n\n\t\tlet elementMediatorClass: any = tags[tag];\n\n\t\tif (!elementMediatorClass) {\n\t\t\telementMediatorClass = tags[\"*\"];\n\t\t}\n\n\t\tif (!elementMediatorClass) {\n\t\t\tthis.logger.error(\"Unsupported tag: \" + tag + \" for elementMediator \" + elementMediatorType + \".\");\n\t\t\treturn;\n\t\t}\n\n\t\tconst deps = { mvvm: this, parent: this.parent, el: el, expression: attributeValue, model: this.model, prefix: prefix };\n\t\telementMediator = new elementMediatorClass(deps);\n\t\telementMediator.setModule(this.moduleInstance);\n\t\telementMediator.init();\n\n\t\tthis.elementMediators.push(elementMediator);\n\t}\n\n}\n\nexport {\n\tComponent,\n\tEvents,\n\tElementMediator,\n\tMvvm,\n\tStageComponent,\n\tModules,\n\tModuleImpl,\n\tElementMediatorDependencies,\n\tProperties,\n\tINTERNAL_CHANNEL_NAME,\n\tINTERNAL_DIRECT_CHANNEL_NAME,\n};\n","abstract class CydranError extends Error {\n\n\tprivate static doMsgFilling(msg: string, reps: any): string {\n\t\treturn msg.replace(/%\\w+%/g, (all: string) => (reps[all] + \"\") || all);\n\t}\n\n\tpublic readonly message: string;\n\n\t/**\n\t * Constructor\n\t *\n\t * @param msg string object specific to context\n\t * @param reps optional {key:value, <n^1>} object of named substitution values\n\t * @returns string filled in values in the mesage\n\t */\n\tconstructor(msg: string, reps?: any) {\n\t\tsuper();\n\n\t\tif (new.target === CydranError) {\n\t\t\tthrow TypeError(\"Direct instantiation of \" + new.target.name + \" is not allowed.\");\n\t\t}\n\n\t\tthis.message = (reps) ? CydranError.doMsgFilling(msg, reps) : msg;\n\t}\n\n}\n\nconst NEWI = \" needs to be instantiated with 'new'\";\n\nexport { CydranError, NEWI };\n","import Logger from \"./Logger\";\nimport LoggerImpl from \"./LoggerImpl\";\nimport LoggerService from \"./LoggerService\";\n\nclass LoggerFactory {\n\n\t/**\n\t * Get the named logger\n\t * @param name of the associated logger\n\t */\n\tpublic static getLogger(name: string): Logger {\n\t\treturn new LoggerImpl(name, LoggerService.INSTANCE);\n\t}\n\n}\n\nexport default LoggerFactory;\n","enum Level {\n\tTRACE,\n\tDEBUG,\n\tINFO,\n\tWARN,\n\tERROR,\n\tFATAL,\n\tDISABLE,\n}\n\nexport default Level;\n","/* tslint:disable */\n\nconst LARGE_ARRAY_SIZE = 200;\nconst FUNC_ERROR_TEXT = \"Expected a function\";\nconst HASH_UNDEFINED = \"__lodash_hash_undefined__\";\nconst CLONE_DEEP_FLAG = 1;\nconst CLONE_FLAT_FLAG = 2;\nconst CLONE_SYMBOLS_FLAG = 4;\nconst COMPARE_PARTIAL_FLAG = 1;\nconst COMPARE_UNORDERED_FLAG = 2;\nconst MAX_SAFE_INTEGER = 9007199254740991;\nconst argsTag = \"[object Arguments]\";\nconst arrayTag = \"[object Array]\";\nconst asyncTag = \"[object AsyncFunction]\";\nconst boolTag = \"[object Boolean]\";\nconst dateTag = \"[object Date]\";\nconst errorTag = \"[object Error]\";\nconst funcTag = \"[object Function]\";\nconst genTag = \"[object GeneratorFunction]\";\nconst mapTag = \"[object Map]\";\nconst numberTag = \"[object Number]\";\nconst nullTag = \"[object Null]\";\nconst objectTag = \"[object Object]\";\nconst promiseTag = \"[object Promise]\";\nconst proxyTag = \"[object Proxy]\";\nconst regexpTag = \"[object RegExp]\";\nconst setTag = \"[object Set]\";\nconst stringTag = \"[object String]\";\nconst symbolTag = \"[object Symbol]\";\nconst undefinedTag = \"[object Undefined]\";\nconst weakMapTag = \"[object WeakMap]\";\nconst arrayBufferTag = \"[object ArrayBuffer]\";\nconst dataViewTag = \"[object DataView]\";\nconst float32Tag = \"[object Float32Array]\";\nconst float64Tag = \"[object Float64Array]\";\nconst int8Tag = \"[object Int8Array]\";\nconst int16Tag = \"[object Int16Array]\";\nconst int32Tag = \"[object Int32Array]\";\nconst uint8Tag = \"[object Uint8Array]\";\nconst uint8ClampedTag = \"[object Uint8ClampedArray]\";\nconst uint16Tag = \"[object Uint16Array]\";\nconst uint32Tag = \"[object Uint32Array]\";\nconst reRegExpChar = /[\\\\^$.*+?()[\\]{}|]/g;\nconst reFlags = /\\w*$/;\nconst reIsHostCtor = /^\\[object .+?Constructor\\]$/;\nconst reIsUint = /^(?:0|[1-9]\\d*)$/;\nconst typedArrayTags = {};\ntypedArrayTags[float32Tag] = typedArrayTags[float64Tag] =\n\ttypedArrayTags[int8Tag] = typedArrayTags[int16Tag] =\n\ttypedArrayTags[int32Tag] = typedArrayTags[uint8Tag] =\n\ttypedArrayTags[uint8ClampedTag] = typedArrayTags[uint16Tag] =\n\ttypedArrayTags[uint32Tag] = true;\ntypedArrayTags[argsTag] = typedArrayTags[arrayTag] =\n\ttypedArrayTags[arrayBufferTag] = typedArrayTags[boolTag] =\n\ttypedArrayTags[dataViewTag] = typedArrayTags[dateTag] =\n\ttypedArrayTags[errorTag] = typedArrayTags[funcTag] =\n\ttypedArrayTags[mapTag] = typedArrayTags[numberTag] =\n\ttypedArrayTags[objectTag] = typedArrayTags[regexpTag] =\n\ttypedArrayTags[setTag] = typedArrayTags[stringTag] =\n\ttypedArrayTags[weakMapTag] = false;\nconst cloneableTags = {};\ncloneableTags[argsTag] = cloneableTags[arrayTag] =\n\tcloneableTags[arrayBufferTag] = cloneableTags[dataViewTag] =\n\tcloneableTags[boolTag] = cloneableTags[dateTag] =\n\tcloneableTags[float32Tag] = cloneableTags[float64Tag] =\n\tcloneableTags[int8Tag] = cloneableTags[int16Tag] =\n\tcloneableTags[int32Tag] = cloneableTags[mapTag] =\n\tcloneableTags[numberTag] = cloneableTags[objectTag] =\n\tcloneableTags[regexpTag] = cloneableTags[setTag] =\n\tcloneableTags[stringTag] = cloneableTags[symbolTag] =\n\tcloneableTags[uint8Tag] = cloneableTags[uint8ClampedTag] =\n\tcloneableTags[uint16Tag] = cloneableTags[uint32Tag] = true;\ncloneableTags[errorTag] = cloneableTags[funcTag] =\n\tcloneableTags[weakMapTag] = false;\nconst freeGlobal = typeof global === \"object\" && global && global.Object === Object && global;\nconst freeSelf = typeof self === \"object\" && self && self[\"Object\"] === Object && self;\nconst root = freeGlobal || freeSelf || Function(\"return this\")();\nconst freeExports = typeof exports === \"object\" && exports && !exports.nodeType && exports;\nconst freeModule = freeExports && typeof module === \"object\" && module && !module[\"nodeType\"] && module;\nconst moduleExports = freeModule && freeModule.exports === freeExports;\n\nfunction arrayEach(array: any[], iteratee: Function): any[] {\n\tconst length = array == null ? 0 : array.length;\n\n\tlet index = -1;\n\n\twhile (++index < length) {\n\t\tif (iteratee(array[index], index, array) === false) {\n\t\t\tbreak;\n\t\t}\n\t}\n\n\treturn array;\n}\n\nfunction arrayFilter(array: any[], predicate: Function): any[] {\n\tconst length = array == null ? 0 : array.length;\n\tconst result = [];\n\n\tlet index = -1;\n\tlet resIndex = 0;\n\n\twhile (++index < length) {\n\t\tconst value = array[index];\n\n\t\tif (predicate(value, index, array)) {\n\t\t\tresult[resIndex++] = value;\n\t\t}\n\t}\n\n\treturn result;\n}\n\nfunction arrayPush(array: any[], values: any[]): any[] {\n\tconst length = values.length;\n\tconst offset = array.length;\n\n\tlet index = -1;\n\n\twhile (++index < length) {\n\t\tarray[offset + index] = values[index];\n\t}\n\n\treturn array;\n}\n\nfunction arraySome(array: any[], predicate: Function): boolean {\n\tconst length = array == null ? 0 : array.length;\n\tlet index = -1;\n\n\twhile (++index < length) {\n\t\tif (predicate(array[index], index, array)) {\n\t\t\treturn true;\n\t\t}\n\t}\n\n\treturn false;\n}\n\nfunction baseTimes(n: number, iteratee: Function): any[] {\n\tconst result = Array(n);\n\tlet index = -1;\n\n\twhile (++index < n) {\n\t\tresult[index] = iteratee(index);\n\t}\n\n\treturn result;\n}\n\nfunction cacheHas(cache: any, key: string): boolean {\n\treturn cache.has(key);\n}\n\nfunction getValue(object: any, key: string): any {\n\treturn object == null ? undefined : object[key];\n}\n\nfunction mapToArray(map: any): any[] {\n\tconst result = Array(map.size);\n\n\tlet index = -1;\n\n\tmap.forEach(function(value: any, key: string) {\n\t\tresult[++index] = [key, value];\n\t});\n\n\treturn result;\n}\n\nfunction overArg(func: Function, transform: Function): Function {\n\treturn function(arg: any) {\n\t\treturn func(transform(arg));\n\t};\n}\n\nfunction setToArray(set: any): any[] {\n\tconst result = Array(set.size);\n\n\tlet index = -1;\n\n\tset.forEach(function(value: any) {\n\t\tresult[++index] = value;\n\t});\n\n\treturn result;\n}\n\ninterface ContextType {\n\t[x: string]: any;\n\tArray: any;\n\tDate: any;\n\tError: any;\n\tFunction: any;\n\tMath: any;\n\tObject: any;\n\tRegExp: any;\n\tString: any;\n\tTypeError: any;\n\tBuffer: any;\n\tSymbol: any;\n\tUint8Array: any;\n\tclearTimeout: any;\n\tsetTimeout: any;\n\tisFinite: any;\n\tparseInt: any;\n}\n\nconst context: ContextType = root;\n\nconst arrayProto = Array.prototype;\nconst funcProto = Function.prototype;\nconst objectProto = Object.prototype;\nconst coreJsData = context[\"__core-js_shared__\"];\nconst funcToString = funcProto.toString;\nconst hasOwnProperty = objectProto.hasOwnProperty;\nconst maskSrcKey = (function() {\n\tconst uid = /[^.]+$/.exec(coreJsData && coreJsData.keys && coreJsData.keys.IE_PROTO || \"\");\n\n\treturn uid ? (\"Symbol(src)_1.\" + uid) : \"\";\n}());\n\nconst nativeObjectToString = objectProto.toString;\nconst reIsNative = RegExp(\"^\" + funcToString.call(hasOwnProperty).replace(reRegExpChar, \"\\\\$&\").replace(/hasOwnProperty|(function).*?(?=\\\\\\()| for .+?(?=\\\\\\])/g, \"$1.*?\") + \"$\");\n\nconst Buffer = moduleExports ? context.Buffer : undefined;\nconst Symbol = context.Symbol;\nconst Uint8Array = context.Uint8Array;\nconst allocUnsafe = Buffer ? Buffer.allocUnsafe : undefined;\nconst getPrototype = overArg(Object.getPrototypeOf, Object);\nconst objectCreate = Object.create;\nconst propertyIsEnumerable = objectProto.propertyIsEnumerable;\nconst splice = arrayProto.splice;\nconst symToStringTag = Symbol ? Symbol.toStringTag : undefined;\nconst nativeGetSymbols = Object.getOwnPropertySymbols;\nconst nativeIsBuffer = Buffer ? Buffer.isBuffer : undefined;\nconst nativeKeys = overArg(Object.keys, Object);\nconst DataView = getNative(context, \"DataView\");\nconst Map = getNative(context, \"Map\");\nconst Promise = getNative(context, \"Promise\");\nconst Set = getNative(context, \"Set\");\nconst WeakMap = getNative(context, \"WeakMap\");\nconst nativeCreate = getNative(Object, \"create\");\nconst dataViewCtorString = toSource(DataView);\nconst mapCtorString = toSource(Map);\nconst promiseCtorString = toSource(Promise);\nconst setCtorString = toSource(Set);\nconst weakMapCtorString = toSource(WeakMap);\nconst symbolProto = Symbol ? Symbol.prototype : undefined;\nconst symbolValueOf = symbolProto ? symbolProto.valueOf : undefined;\n\nconst baseCreate = (function() {\n\tfunction object() {\n\t\t// Intentionally do nothing\n\t}\n\n\treturn function(proto: any) {\n\t\tif (!isObject(proto)) {\n\t\t\treturn {};\n\t\t}\n\t\tif (objectCreate) {\n\t\t\treturn objectCreate(proto);\n\t\t}\n\t\tobject.prototype = proto;\n\t\tconst result = new object();\n\t\tobject.prototype = undefined;\n\t\treturn result;\n\t};\n}());\n\nclass Hash {\n\n\tpublic size: number;\n\n\tpublic __DATA__: any;\n\n\tconstructor(entries?: any[]) {\n\t\tlet index = -1;\n\t\tconst length = entries == null ? 0 : entries.length;\n\n\t\tthis.clear();\n\t\twhile (++index < length) {\n\t\t\tconst entry = entries[index];\n\t\t\tthis.set(entry[0], entry[1]);\n\t\t}\n\t}\n\n\tpublic clear(): void {\n\t\tthis.__DATA__ = nativeCreate ? nativeCreate(null) : {};\n\t\tthis.size = 0;\n\t}\n\n\tpublic delete(key: string): boolean {\n\t\tconst result = this.has(key) && delete this.__DATA__[key];\n\t\tthis.size -= result ? 1 : 0;\n\t\treturn result;\n\t}\n\n\tpublic get(key: string): any {\n\t\tconst data = this.__DATA__;\n\t\tif (nativeCreate) {\n\t\t\tconst result = data[key];\n\t\t\treturn result === HASH_UNDEFINED ? undefined : result;\n\t\t}\n\t\treturn hasOwnProperty.call(data, key) ? data[key] : undefined;\n\t}\n\n\tpublic has(key: string): boolean {\n\t\tconst data = this.__DATA__;\n\t\treturn nativeCreate ? (data[key] !== undefined) : hasOwnProperty.call(data, key);\n\t}\n\n\tpublic set(key: string, value: any): any {\n\t\tconst data = this.__DATA__;\n\t\tthis.size += this.has(key) ? 0 : 1;\n\t\tdata[key] = (nativeCreate && value === undefined) ? HASH_UNDEFINED : value;\n\t\treturn this;\n\t}\n\n}\n\nclass ListCache {\n\n\tpublic size: number;\n\n\tpublic __DATA__: any;\n\n\tconstructor(entries?: any[]) {\n\t\tlet index = -1;\n\t\tconst length = entries == null ? 0 : entries.length;\n\n\t\tthis.clear();\n\n\t\twhile (++index < length) {\n\t\t\tconst entry = entries[index];\n\t\t\tthis.set(entry[0], entry[1]);\n\t\t}\n\t}\n\n\tpublic clear(): void {\n\t\tthis.__DATA__ = [];\n\t\tthis.size = 0;\n\t}\n\n\tpublic delete(key: string): boolean {\n\t\tconst data = this.__DATA__;\n\t\tconst index = assocIndexOf(data, key);\n\n\t\tif (index < 0) {\n\t\t\treturn false;\n\t\t}\n\t\tconst lastIndex = data.length - 1;\n\t\tif (index == lastIndex) {\n\t\t\tdata.pop();\n\t\t} else {\n\t\t\tsplice.call(data, index, 1);\n\t\t}\n\t\t--this.size;\n\t\treturn true;\n\t}\n\n\tpublic get(key: string): any {\n\t\tconst data = this.__DATA__;\n\t\tconst index = assocIndexOf(data, key);\n\n\t\treturn index < 0 ? undefined : data[index][1];\n\t}\n\n\tpublic has(key: string): boolean {\n\t\treturn assocIndexOf(this.__DATA__, key) > -1;\n\t}\n\n\tpublic set(key: string, value: any): any {\n\t\tconst data = this.__DATA__;\n\t\tconst index = assocIndexOf(data, key);\n\n\t\tif (index < 0) {\n\t\t\t++this.size;\n\t\t\tdata.push([key, value]);\n\t\t} else {\n\t\t\tdata[index][1] = value;\n\t\t}\n\t\treturn this;\n\t}\n\n}\n\nclass MapCache {\n\n\tpublic size: number;\n\n\tpublic __DATA__: any;\n\n\tconstructor(entries?: any[]) {\n\t\tlet index = -1;\n\t\tconst length = entries == null ? 0 : entries.length;\n\n\t\tthis.clear();\n\t\twhile (++index < length) {\n\t\t\tconst entry = entries[index];\n\t\t\tthis.set(entry[0], entry[1]);\n\t\t}\n\t}\n\n\tpublic clear(): void {\n\t\tthis.size = 0;\n\t\tthis.__DATA__ = {\n\t\t\thash: new Hash(),\n\t\t\tmap: new (Map || ListCache)(),\n\t\t\tstring: new Hash(),\n\t\t};\n\t}\n\n\tpublic delete(key: string): boolean {\n\t\tconst result = getMapData(this, key)[\"delete\"](key);\n\t\tthis.size -= result ? 1 : 0;\n\t\treturn result;\n\t}\n\n\tpublic get(key: string): any {\n\t\treturn getMapData(this, key).get(key);\n\t}\n\n\tpublic has(key: string): boolean {\n\t\treturn getMapData(this, key).has(key);\n\t}\n\n\tpublic set(key: string, value: any): any {\n\t\tconst data = getMapData(this, key);\n\t\tconst size = data.size;\n\n\t\tdata.set(key, value);\n\t\tthis.size += data.size == size ? 0 : 1;\n\t\treturn this;\n\t}\n\n}\n\nclass SetCache {\n\n\tpublic __DATA__: any;\n\n\tconstructor(values?: any[]) {\n\t\tlet index = -1;\n\t\tconst length = values == null ? 0 : values.length;\n\n\t\tthis.__DATA__ = new MapCache();\n\t\twhile (++index < length) {\n\t\t\tthis.add(values[index]);\n\t\t}\n\t}\n\n\tpublic push(value: any): any {\n\t\treturn this.add(value);\n\t}\n\n\tpublic add(value: any): any {\n\t\tthis.__DATA__.set(value, HASH_UNDEFINED);\n\t\treturn this;\n\t}\n\n\tpublic has(value: any): boolean {\n\t\treturn this.__DATA__.has(value);\n\t}\n\n}\n\nclass Stack {\n\n\tpublic __DATA__: any;\n\n\tpublic size: number;\n\n\tconstructor(entries?: any[]) {\n\t\tconst data = this.__DATA__ = new ListCache(entries);\n\t\tthis.size = data.size;\n\t}\n\n\tpublic clear(): void {\n\t\tthis.__DATA__ = new ListCache();\n\t\tthis.size = 0;\n\t}\n\n\tpublic delete(key: string): boolean {\n\t\tconst data = this.__DATA__;\n\t\tconst result = data[\"delete\"](key);\n\n\t\tthis.size = data.size;\n\t\treturn result;\n\t}\n\n\tpublic get(key: string): any {\n\t\treturn this.__DATA__.get(key);\n\t}\n\n\tpublic has(key: string): boolean {\n\t\treturn this.__DATA__.has(key);\n\t}\n\n\tpublic set(key: string, value: any): any {\n\t\tlet data = this.__DATA__;\n\t\tif (data instanceof ListCache) {\n\t\t\tconst pairs = data.__DATA__;\n\t\t\tif (!Map || (pairs.length < LARGE_ARRAY_SIZE - 1)) {\n\t\t\t\tpairs.push([key, value]);\n\t\t\t\tthis.size = ++data.size;\n\t\t\t\treturn this;\n\t\t\t}\n\t\t\tdata = this.__DATA__ = new MapCache(pairs);\n\t\t}\n\t\tdata.set(key, value);\n\t\tthis.size = data.size;\n\t\treturn this;\n\t}\n\n}\n\nfunction arrayLikeKeys(value: any, inherited?: boolean): string[] {\n\tconst isArr = isArray(value);\n\tconst isArg = !isArr && isArguments(value);\n\tconst isBuff = !isArr && !isArg && isBuffer(value);\n\tconst isType = !isArr && !isArg && !isBuff && isTypedArray(value);\n\tconst skipIndexes = isArr || isArg || isBuff || isType;\n\tconst result = skipIndexes ? baseTimes(value.length, String) : [];\n\tconst length = result.length;\n\n\tfor (const key in value) {\n\t\tif ((inherited || hasOwnProperty.call(value, key)) &&\n\t\t\t!(skipIndexes && (\n\t\t\t\t// Safari 9 has enumerable `arguments.length` in strict mode.\n\t\t\t\tkey == \"length\" ||\n\t\t\t\t// Node.js 0.10 has enumerable non-index properties on buffers.\n\t\t\t\t(isBuff && (key == \"offset\" || key == \"parent\")) ||\n\t\t\t\t// PhantomJS 2 has enumerable non-index properties on typed arrays.\n\t\t\t\t(isType && (key == \"buffer\" || key == \"byteLength\" || key == \"byteOffset\")) ||\n\t\t\t\t// Skip index properties.\n\t\t\t\tisIndex(key, length)\n\t\t\t))) {\n\t\t\tresult.push(key);\n\t\t}\n\t}\n\treturn result;\n}\n\nfunction assignValue(object: any, key: string, value: any): void {\n\tconst objValue = object[key];\n\tif (!(hasOwnProperty.call(object, key) && eq(objValue, value)) ||\n\t\t(value === undefined && !(key in object))) {\n\t\tbaseAssignValue(object, key, value);\n\t}\n}\n\nfunction assocIndexOf(array: any[], key: any): number {\n\tlet length = array.length;\n\twhile (length--) {\n\t\tif (eq(array[length][0], key)) {\n\t\t\treturn length;\n\t\t}\n\t}\n\treturn -1;\n}\n\nfunction baseAssign(object: any, source: any): any {\n\treturn object && copyObject(source, keys(source), object);\n}\n\nfunction baseAssignIn(object: any, source: any): any {\n\treturn object && copyObject(source, keysIn(source), object);\n}\n\nfunction baseAssignValue(object: any, key: string, value: any): void {\n\tif (key == \"__proto__\" && Object.defineProperty) {\n\t\tObject.defineProperty(object, key, {\n\t\t\tconfigurable: true,\n\t\t\tenumerable: true,\n\t\t\tvalue: value,\n\t\t\twritable: true,\n\t\t});\n\t} else {\n\t\tobject[key] = value;\n\t}\n}\n\nfunction baseClone(value: any, bitmask: number, customizer?: Function, key?: string, object?: any, stack?: any): any {\n\tlet result: any;\n\tconst isDeep = bitmask & CLONE_DEEP_FLAG;\n\tconst isFlat = bitmask & CLONE_FLAT_FLAG;\n\tconst isFull = bitmask & CLONE_SYMBOLS_FLAG;\n\n\tif (customizer) {\n\t\tresult = object ? customizer(value, key, object, stack) : customizer(value);\n\t}\n\tif (result !== undefined) {\n\t\treturn result;\n\t}\n\tif (!isObject(value)) {\n\t\treturn value;\n\t}\n\tconst isArr = isArray(value);\n\tif (isArr) {\n\t\tresult = initCloneArray(value);\n\t\tif (!isDeep) {\n\t\t\treturn copyArray(value, result);\n\t\t}\n\t} else {\n\t\tconst tag = getTag(value);\n\t\tconst isFunc = tag == funcTag || tag == genTag;\n\n\t\tif (isBuffer(value)) {\n\t\t\treturn cloneBuffer(value, !!isDeep);\n\t\t}\n\t\tif (tag == objectTag || tag == argsTag || (isFunc && !object)) {\n\t\t\tresult = (isFlat || isFunc) ? {} : initCloneObject(value);\n\t\t\tif (!isDeep) {\n\t\t\t\treturn isFlat\n\t\t\t\t\t? copySymbolsIn(value, baseAssignIn(result, value))\n\t\t\t\t\t: copySymbols(value, baseAssign(result, value));\n\t\t\t}\n\t\t} else {\n\t\t\tif (!cloneableTags[tag]) {\n\t\t\t\treturn object ? value : {};\n\t\t\t}\n\t\t\tresult = initCloneByTag(value, tag, !!isDeep);\n\t\t}\n\t}\n\t// Check for circular references and return its corresponding clone.\n\tstack = (!stack) ? new Stack() : stack;\n\tconst stacked = stack.get(value);\n\tif (stacked) {\n\t\treturn stacked;\n\t}\n\tstack.set(value, result);\n\n\tif (isSet(value)) {\n\t\tvalue.forEach(function(subValue: any) {\n\t\t\tresult.add(baseClone(subValue, bitmask, customizer, subValue, value, stack));\n\t\t});\n\t} else if (isMap(value)) {\n\t\tvalue.forEach(function(subValue: any, key: string) {\n\t\t\tresult.set(key, baseClone(subValue, bitmask, customizer, key, value, stack));\n\t\t});\n\t}\n\n\tconst keysFunc = isFull ? (isFlat ? getAllKeysIn : getAllKeys) : (isFlat ? keysIn : keys);\n\tconst props = isArr ? undefined : keysFunc(value);\n\tarrayEach(props || value, function(subValue: any, key: string) {\n\t\tif (props) {\n\t\t\tkey = subValue;\n\t\t\tsubValue = value[key];\n\t\t}\n\t\t// Recursively populate clone (susceptible to call stack limits).\n\t\tassignValue(result, key, baseClone(subValue, bitmask, customizer, key, value, stack));\n\t});\n\treturn result;\n}\n\nfunction baseGetAllKeys(object: any, keysFunc: Function, symbolsFunc: Function): any[] {\n\tconst result = keysFunc(object);\n\treturn isArray(object) ? result : arrayPush(result, symbolsFunc(object));\n}\n\nfunction baseGetTag(value: any): string {\n\tif (value == null) {\n\t\treturn value === undefined ? undefinedTag : nullTag;\n\t}\n\treturn (symToStringTag && symToStringTag in Object(value))\n\t\t? getRawTag(value)\n\t\t: objectToString(value);\n}\n\nfunction baseIsArguments(value: any): boolean {\n\treturn isObjectLike(value) && baseGetTag(value) == argsTag;\n}\n\nfunction baseIsEqual(value: any, other: any, bitmask?: number, customizer?: Function, stack?: any): boolean {\n\tif (value === other) {\n\t\treturn true;\n\t}\n\tif (value == null || other == null || (!isObjectLike(value) && !isObjectLike(other))) {\n\t\treturn value !== value && other !== other;\n\t}\n\treturn baseIsEqualDeep(value, other, bitmask, customizer, baseIsEqual, stack);\n}\n\nfunction baseIsEqualDeep(object: any, other: any, bitmask: number, customizer: Function, equalFunc: Function, stack: any): boolean {\n\tlet objIsArr = isArray(object);\n\tconst othIsArr = isArray(other);\n\tlet objTag = objIsArr ? arrayTag : getTag(object);\n\tlet othTag = othIsArr ? arrayTag : getTag(other);\n\n\tobjTag = objTag == argsTag ? objectTag : objTag;\n\tothTag = othTag == argsTag ? objectTag : othTag;\n\n\tlet objIsObj = objTag == objectTag;\n\tconst othIsObj = othTag == objectTag;\n\tconst isSameTag = objTag == othTag;\n\n\tif (isSameTag && isBuffer(object)) {\n\t\tif (!isBuffer(other)) {\n\t\t\treturn false;\n\t\t}\n\t\tobjIsArr = true;\n\t\tobjIsObj = false;\n\t}\n\tif (isSameTag && !objIsObj) {\n\t\tstack = (!stack) ? new Stack() : stack;\n\t\treturn (objIsArr || isTypedArray(object))\n\t\t\t? equalArrays(object, other, bitmask, customizer, equalFunc, stack)\n\t\t\t: equalByTag(object, other, objTag, bitmask, customizer, equalFunc, stack);\n\t}\n\tif (!(bitmask & COMPARE_PARTIAL_FLAG)) {\n\t\tconst objIsWrapped = objIsObj && hasOwnProperty.call(object, \"__wrapped__\");\n\t\tconst othIsWrapped = othIsObj && hasOwnProperty.call(other, \"__wrapped__\");\n\n\t\tif (objIsWrapped || othIsWrapped) {\n\t\t\tconst objUnwrapped = objIsWrapped ? object.value() : object;\n\t\t\tconst othUnwrapped = othIsWrapped ? other.value() : other;\n\n\t\t\tstack = (!stack) ? new Stack() : stack;\n\t\t\treturn equalFunc(objUnwrapped, othUnwrapped, bitmask, customizer, stack);\n\t\t}\n\t}\n\tif (!isSameTag) {\n\t\treturn false;\n\t}\n\tstack = (!stack) ? new Stack() : stack;\n\treturn equalObjects(object, other, bitmask, customizer, equalFunc, stack);\n}\n\nfunction baseIsMap(value: any): boolean {\n\treturn isObjectLike(value) && getTag(value) == mapTag;\n}\n\nfunction baseIsNative(value: any): boolean {\n\tif (!isObject(value) || isMasked(value)) {\n\t\treturn false;\n\t}\n\tconst pattern = isFunction(value) ? reIsNative : reIsHostCtor;\n\treturn pattern.test(toSource(value));\n}\n\nfunction baseIsSet(value: any): boolean {\n\treturn isObjectLike(value) && getTag(value) == setTag;\n}\n\nfunction baseIsTypedArray(value: any): boolean {\n\treturn isObjectLike(value) &&\n\t\tisLength(value.length) && !!typedArrayTags[baseGetTag(value)];\n}\n\nfunction baseKeys(object: any): string[] {\n\tif (!isPrototype(object)) {\n\t\treturn nativeKeys(object);\n\t}\n\tconst result = [];\n\tfor (const key in Object(object)) {\n\t\tif (hasOwnProperty.call(object, key) && key != \"constructor\") {\n\t\t\tresult.push(key);\n\t\t}\n\t}\n\treturn result;\n}\n\nfunction baseKeysIn(object: any): string[] {\n\tif (!isObject(object)) {\n\t\treturn nativeKeysIn(object);\n\t}\n\tconst isProto = isPrototype(object);\n\tconst result = [];\n\n\tfor (const key in object) {\n\t\tif (!(key == \"constructor\" && (isProto || !hasOwnProperty.call(object, key)))) {\n\t\t\tresult.push(key);\n\t\t}\n\t}\n\treturn result;\n}\n\nfunction cloneBuffer(buffer: Buffer, isDeep: boolean): Buffer {\n\tif (isDeep) {\n\t\treturn buffer.slice();\n\t}\n\tconst length = buffer.length;\n\tconst result = allocUnsafe ? allocUnsafe(length) : new buffer.constructor(length);\n\n\tbuffer.copy(result);\n\treturn result;\n}\n\nfunction cloneArrayBuffer(arrayBuffer: ArrayBuffer): ArrayBuffer {\n\tconst ctor: any = arrayBuffer[\"constructor\"];\n\tconst result = new ctor(arrayBuffer.byteLength);\n\tnew Uint8Array(result).set(new Uint8Array(arrayBuffer));\n\treturn result;\n}\n\nfunction cloneDataView(dataView: any, isDeep: boolean): any {\n\tconst buffer = isDeep ? cloneArrayBuffer(dataView.buffer) : dataView.buffer;\n\treturn new dataView.constructor(buffer, dataView.byteOffset, dataView.byteLength);\n}\n\nfunction cloneRegExp(regexp: any): any {\n\tconst result = new regexp.constructor(regexp.source, reFlags.exec(regexp));\n\tresult.lastIndex = regexp.lastIndex;\n\treturn result;\n}\n\nfunction cloneSymbol(symbol: any): any {\n\treturn symbolValueOf ? Object(symbolValueOf.call(symbol)) : {};\n}\n\nfunction cloneTypedArray(typedArray: any, isDeep: boolean): any {\n\tconst buffer = isDeep ? cloneArrayBuffer(typedArray.buffer) : typedArray.buffer;\n\treturn new typedArray.constructor(buffer, typedArray.byteOffset, typedArray.length);\n}\n\nfunction copyArray(source: any[], array?: any[]): any[] {\n\tlet index = -1;\n\tconst length = source.length;\n\n\tarray = (!array) ? Array(length) : array;\n\twhile (++index < length) {\n\t\tarray[index] = source[index];\n\t}\n\treturn array;\n}\n\nfunction copyObject(source: any, props: string[], object?: any, customizer?: Function): any {\n\tconst isNew = !object;\n\tobject = (isNew) ? {} : object;\n\n\tlet index = -1;\n\tconst length = props.length;\n\n\twhile (++index < length) {\n\t\tconst key = props[index];\n\n\t\tlet newValue = customizer\n\t\t\t? customizer(object[key], source[key], key, object, source)\n\t\t\t: undefined;\n\n\t\tif (newValue === undefined) {\n\t\t\tnewValue = source[key];\n\t\t}\n\t\tif (isNew) {\n\t\t\tbaseAssignValue(object, key, newValue);\n\t\t} else {\n\t\t\tassignValue(object, key, newValue);\n\t\t}\n\t}\n\treturn object;\n}\n\nfunction copySymbols(source: any, object: any): any {\n\treturn copyObject(source, getSymbols(source), object);\n}\n\nfunction copySymbolsIn(source: any, object: any): any {\n\treturn copyObject(source, getSymbolsIn(source), object);\n}\n\nfunction equalArrays(array: any[], other: any[], bitmask: number, customizer: Function, equalFunc: Function, stack: any): boolean {\n\tconst isPartial = bitmask & COMPARE_PARTIAL_FLAG;\n\tconst arrLength = array.length;\n\tconst othLength = other.length;\n\n\tif (arrLength != othLength && !(isPartial && othLength > arrLength)) {\n\t\treturn false;\n\t}\n\t// Assume cyclic values are equal.\n\tconst stacked = stack.get(array);\n\tif (stacked && stack.get(other)) {\n\t\treturn stacked == other;\n\t}\n\tlet index = -1;\n\tlet result = true;\n\tconst seen = (bitmask & COMPARE_UNORDERED_FLAG) ? new SetCache() : undefined;\n\n\tstack.set(array, other);\n\tstack.set(other, array);\n\n\t// Ignore non-index properties.\n\twhile (++index < arrLength) {\n\t\tconst arrValue = array[index];\n\t\tconst othValue = other[index];\n\n\t\tlet compared;\n\t\tif (customizer) {\n\t\t\tcompared = isPartial\n\t\t\t\t? customizer(othValue, arrValue, index, other, array, stack)\n\t\t\t\t: customizer(arrValue, othValue, index, array, other, stack);\n\t\t}\n\t\tif (compared !== undefined) {\n\t\t\tif (compared) {\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tresult = false;\n\t\t\tbreak;\n\t\t}\n\t\t// Recursively compare arrays (susceptible to call stack limits).\n\t\tif (seen) {\n\t\t\tif (!arraySome(other, function(othValue: any, othIndex: any) {\n\t\t\t\tif (!cacheHas(seen, othIndex) &&\n\t\t\t\t\t(arrValue === othValue || equalFunc(arrValue, othValue, bitmask, customizer, stack))) {\n\t\t\t\t\treturn seen.push(othIndex);\n\t\t\t\t}\n\t\t\t})) {\n\t\t\t\tresult = false;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t} else if (!(\n\t\t\tarrValue === othValue ||\n\t\t\tequalFunc(arrValue, othValue, bitmask, customizer, stack)\n\t\t)) {\n\t\t\tresult = false;\n\t\t\tbreak;\n\t\t}\n\t}\n\tstack[\"delete\"](array);\n\tstack[\"delete\"](other);\n\treturn result;\n}\n\nfunction equalByTag(object: any, other: any, tag: string, bitmask: number, customizer: Function, equalFunc: Function, stack: any): boolean {\n\tswitch (tag) {\n\t\tcase dataViewTag:\n\t\t\tif ((object.byteLength != other.byteLength) ||\n\t\t\t\t(object.byteOffset != other.byteOffset)) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tobject = object.buffer;\n\t\t\tother = other.buffer;\n\n\t\tcase arrayBufferTag:\n\t\t\tif ((object.byteLength != other.byteLength) ||\n\t\t\t\t!equalFunc(new Uint8Array(object), new Uint8Array(other))) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\treturn true;\n\n\t\tcase boolTag:\n\t\tcase dateTag:\n\t\tcase numberTag:\n\t\t\t// Coerce booleans to `1` or `0` and dates to milliseconds.\n\t\t\t// Invalid dates are coerced to `NaN`.\n\t\t\treturn eq(+object, +other);\n\n\t\tcase errorTag:\n\t\t\treturn object.name == other.name && object.message == other.message;\n\n\t\tcase regexpTag:\n\t\tcase stringTag:\n\t\t\t// Coerce regexes to strings and treat strings, primitives and objects,\n\t\t\t// as equal. See http://www.ecma-international.org/ecma-262/7.0/#sec-regexp.prototype.tostring\n\t\t\t// for more details.\n\t\t\treturn object == (other + \"\");\n\n\t\tcase mapTag:\n\t\t\tlet convert = mapToArray;\n\n\t\tcase setTag:\n\t\t\tconst isPartial = bitmask & COMPARE_PARTIAL_FLAG;\n\t\t\tconvert = (!convert) ? setToArray : convert;\n\n\t\t\tif (object.size != other.size && !isPartial) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\t// Assume cyclic values are equal.\n\t\t\tconst stacked = stack.get(object);\n\t\t\tif (stacked) {\n\t\t\t\treturn stacked == other;\n\t\t\t}\n\t\t\tbitmask |= COMPARE_UNORDERED_FLAG;\n\n\t\t\t// Recursively compare objects (susceptible to call stack limits).\n\t\t\tstack.set(object, other);\n\t\t\tconst result = equalArrays(convert(object), convert(other), bitmask, customizer, equalFunc, stack);\n\t\t\tstack[\"delete\"](object);\n\t\t\treturn result;\n\n\t\tcase symbolTag:\n\t\t\tif (symbolValueOf) {\n\t\t\t\treturn symbolValueOf.call(object) == symbolValueOf.call(other);\n\t\t\t}\n\t}\n\treturn false;\n}\n\nfunction equalObjects(object: any, other: any, bitmask: number, customizer: Function, equalFunc: Function, stack: any): boolean {\n\tconst isPartial = bitmask & COMPARE_PARTIAL_FLAG;\n\tconst objProps = getAllKeys(object);\n\tconst objLength = objProps.length;\n\tconst othProps = getAllKeys(other);\n\tconst othLength = othProps.length;\n\n\tif (objLength != othLength && !isPartial) {\n\t\treturn false;\n\t}\n\tlet index = objLength;\n\twhile (index--) {\n\t\tconst key = objProps[index];\n\t\tif (!(isPartial ? key in other : hasOwnProperty.call(other, key))) {\n\t\t\treturn false;\n\t\t}\n\t}\n\t// Assume cyclic values are equal.\n\tconst stacked = stack.get(object);\n\tif (stacked && stack.get(other)) {\n\t\treturn stacked == other;\n\t}\n\tlet result = true;\n\tstack.set(object, other);\n\tstack.set(other, object);\n\n\tlet skipCtor: boolean = !!isPartial;\n\twhile (++index < objLength) {\n\t\tconst key = objProps[index];\n\t\tconst objValue = object[key];\n\t\tconst othValue = other[key];\n\n\t\tlet compared;\n\t\tif (customizer) {\n\t\t\tcompared = isPartial\n\t\t\t\t? customizer(othValue, objValue, key, other, object, stack)\n\t\t\t\t: customizer(objValue, othValue, key, object, other, stack);\n\t\t}\n\t\t// Recursively compare objects (susceptible to call stack limits).\n\t\tif (!(compared === undefined\n\t\t\t? (objValue === othValue || equalFunc(objValue, othValue, bitmask, customizer, stack))\n\t\t\t: compared\n\t\t)) {\n\t\t\tresult = false;\n\t\t\tbreak;\n\t\t}\n\t\tskipCtor = (!skipCtor) ? key == \"constructor\" : skipCtor;\n\t}\n\tif (result && !skipCtor) {\n\t\tconst objCtor = object.constructor;\n\t\tconst othCtor = other.constructor;\n\n\t\t// Non `Object` object instances with different constructors are not equal.\n\t\tif (objCtor != othCtor &&\n\t\t\t(\"constructor\" in object && \"constructor\" in other) &&\n\t\t\t!(typeof objCtor == \"function\" && objCtor instanceof objCtor &&\n\t\t\t\ttypeof othCtor == \"function\" && othCtor instanceof othCtor)) {\n\t\t\tresult = false;\n\t\t}\n\t}\n\tstack[\"delete\"](object);\n\tstack[\"delete\"](other);\n\treturn result;\n}\n\nfunction getAllKeys(object: any): string[] {\n\treturn baseGetAllKeys(object, keys, getSymbols);\n}\n\nfunction getAllKeysIn(object: any): string[] {\n\treturn baseGetAllKeys(object, keysIn, getSymbolsIn);\n}\n\nfunction getMapData(map: any, key: string): any {\n\tconst data = map.__DATA__;\n\n\treturn isKeyable(key) ? data[typeof key === \"string\" ? \"string\" : \"hash\"]\n\t\t: data.map;\n}\n\nfunction getNative(object: any, key: string): any {\n\tconst value = getValue(object, key);\n\treturn baseIsNative(value) ? value : undefined;\n}\n\nfunction getRawTag(value: any): string {\n\tconst isOwn = hasOwnProperty.call(value, symToStringTag);\n\tconst tag = value[symToStringTag];\n\n\tlet unmasked = false;\n\n\ttry {\n\t\tvalue[symToStringTag] = undefined;\n\t\tunmasked = true;\n\t} catch (e) {\n\t\t// Intentionally do nothing\n\t}\n\n\tconst result = nativeObjectToString.call(value);\n\n\tif (unmasked) {\n\t\tif (isOwn) {\n\t\t\tvalue[symToStringTag] = tag;\n\t\t} else {\n\t\t\tdelete value[symToStringTag];\n\t\t}\n\t}\n\n\treturn result;\n}\n\nconst getSymbols: (source: any) => string[] = !nativeGetSymbols ? stubArray : function(object) {\n\tif (object == null) {\n\t\treturn [];\n\t}\n\tobject = Object(object);\n\treturn arrayFilter(nativeGetSymbols(object), function(symbol: any) {\n\t\treturn propertyIsEnumerable.call(object, symbol);\n\t});\n};\n\nconst getSymbolsIn: (source: any) => string[] = !nativeGetSymbols ? stubArray : function(object) {\n\tconst result = [];\n\n\twhile (object) {\n\t\tarrayPush(result, getSymbols(object));\n\t\tobject = getPrototype(object);\n\t}\n\n\treturn result;\n};\n\nlet getTag: (source: any) => string = baseGetTag;\n\n// Fallback for data views, maps, sets, and weak maps in IE 11 and promises in Node.js < 6.\nif ((DataView && getTag(new DataView(new ArrayBuffer(1))) !== dataViewTag) ||\n\t(Map && getTag(new Map()) !== mapTag) ||\n\t(Promise && getTag(Promise.resolve()) !== promiseTag) ||\n\t(Set && getTag(new Set()) !== setTag) ||\n\t(WeakMap && getTag(new WeakMap()) !== weakMapTag)) {\n\tgetTag = function(value) {\n\t\tconst result = baseGetTag(value);\n\t\tconst Ctor = result === objectTag ? value.constructor : undefined;\n\t\tconst ctorString = Ctor ? toSource(Ctor) : \"\";\n\n\t\tif (ctorString) {\n\t\t\tswitch (ctorString) {\n\t\t\t\tcase dataViewCtorString: return dataViewTag;\n\t\t\t\tcase mapCtorString: return mapTag;\n\t\t\t\tcase promiseCtorString: return promiseTag;\n\t\t\t\tcase setCtorString: return setTag;\n\t\t\t\tcase weakMapCtorString: return weakMapTag;\n\t\t\t}\n\t\t}\n\t\treturn result;\n\t};\n}\n\nfunction initCloneArray(array: any): any[] {\n\tconst length = array.length;\n\tconst result = new array.constructor(length);\n\n\t// Add properties assigned by `RegExp#exec`.\n\tif (length && typeof array[0] === \"string\" && hasOwnProperty.call(array, \"index\")) {\n\t\tresult.index = array.index;\n\t\tresult.input = array.input;\n\t}\n\treturn result;\n}\n\nfunction initCloneObject(object: any): any {\n\treturn (typeof object.constructor === \"function\" && !isPrototype(object))\n\t\t? baseCreate(getPrototype(object))\n\t\t: {};\n}\n\nfunction initCloneByTag(object: any, tag: string, isDeep: boolean): any {\n\tconst Ctor = object.constructor;\n\n\tswitch (tag) {\n\t\tcase arrayBufferTag:\n\t\t\treturn cloneArrayBuffer(object);\n\n\t\tcase boolTag:\n\t\tcase dateTag:\n\t\t\treturn new Ctor(+object);\n\n\t\tcase dataViewTag:\n\t\t\treturn cloneDataView(object, isDeep);\n\n\t\tcase float32Tag: case float64Tag:\n\t\tcase int8Tag: case int16Tag: case int32Tag:\n\t\tcase uint8Tag: case uint8ClampedTag: case uint16Tag: case uint32Tag:\n\t\t\treturn cloneTypedArray(object, isDeep);\n\n\t\tcase mapTag:\n\t\t\treturn new Ctor();\n\n\t\tcase numberTag:\n\t\tcase stringTag:\n\t\t\treturn new Ctor(object);\n\n\t\tcase regexpTag:\n\t\t\treturn cloneRegExp(object);\n\n\t\tcase setTag:\n\t\t\treturn new Ctor();\n\n\t\tcase symbolTag:\n\t\t\treturn cloneSymbol(object);\n\t}\n}\n\nfunction isIndex(value: any, length?: number): boolean {\n\tconst type = typeof value;\n\tlength = length == null ? MAX_SAFE_INTEGER : length;\n\n\treturn !!length &&\n\t\t(type === \"number\" ||\n\t\t\t(type !== \"symbol\" && reIsUint.test(value))) &&\n\t\t(value > -1 && value % 1 === 0 && value < length);\n}\n\nfunction isKeyable(value: any): boolean {\n\tconst type = typeof value;\n\n\treturn (type === \"string\" || type === \"number\" || type === \"symbol\" || type === \"boolean\")\n\t\t? (value !== \"__proto__\")\n\t\t: (value === null);\n}\n\nfunction isMasked(func: Function): boolean {\n\treturn !!maskSrcKey && (maskSrcKey in func);\n}\n\nfunction isPrototype(value: any): boolean {\n\tconst Ctor = value && value.constructor;\n\tconst proto = (typeof Ctor === \"function\" && Ctor.prototype) || objectProto;\n\n\treturn value === proto;\n}\n\nfunction nativeKeysIn(object: any): any[] {\n\tconst result = [];\n\n\tif (object != null) {\n\t\t/* tslint:disable-next-line */\n\t\tfor (const key in Object(object)) {\n\t\t\tresult.push(key);\n\t\t}\n\t}\n\n\treturn result;\n}\n\nfunction objectToString(value: any): string {\n\treturn nativeObjectToString.call(value);\n}\n\nfunction toSource(func: Function): string {\n\tif (func != null) {\n\t\ttry {\n\t\t\treturn funcToString.call(func);\n\t\t} catch (e) {\n\t\t\t// Intentionally do nothing\n\t\t}\n\t\ttry {\n\t\t\treturn (func + \"\");\n\t\t} catch (e) {\n\t\t\t// Intentionally do nothing\n\t\t}\n\t}\n\treturn \"\";\n}\n\nfunction memoize(func: Function, resolver: Function): Function {\n\tif (typeof func !== \"function\" || (resolver != null && typeof resolver !== \"function\")) {\n\t\tthrow new TypeError(FUNC_ERROR_TEXT);\n\t}\n\n\tconst memoized = function() {\n\t\tconst args = arguments;\n\t\tconst key = resolver ? resolver.apply(this, args) : args[0];\n\t\tconst cache = memoized[\"cache\"];\n\n\t\tif (cache.has(key)) {\n\t\t\treturn cache.get(key);\n\t\t}\n\n\t\tconst result = func.apply(this, args);\n\t\tmemoized[\"cache\"] = cache.set(key, result) || cache;\n\n\t\treturn result;\n\t};\n\n\tmemoized[\"cache\"] = new (memoize.Cache || MapCache)();\n\n\treturn memoized;\n}\n\n// Expose `MapCache`.\nmemoize.Cache = MapCache;\n\nfunction cloneDeep(value: any): any {\n\treturn baseClone(value, CLONE_DEEP_FLAG | CLONE_SYMBOLS_FLAG);\n}\n\nfunction eq(value: any, other: any): boolean {\n\treturn value === other || (value !== value && other !== other);\n}\n\nconst isArguments: (value: any) => boolean = baseIsArguments(function() { return arguments; }()) ? baseIsArguments : function(value) {\n\treturn isObjectLike(value) && hasOwnProperty.call(value, \"callee\") && !propertyIsEnumerable.call(value, \"callee\");\n};\n\nconst isArray: (value: any) => boolean = Array.isArray;\n\nfunction isArrayLike(value: any): boolean {\n\treturn value != null && isLength(value.length) && !isFunction(value);\n}\n\nconst isBuffer: (value: any) => boolean = nativeIsBuffer || stubFalse;\n\nfunction isEqual(value: any, other: any): boolean {\n\treturn baseIsEqual(value, other);\n}\n\nfunction isFunction(value: any): boolean {\n\tif (!isObject(value)) {\n\t\treturn false;\n\t}\n\n\tconst tag = baseGetTag(value);\n\n\treturn tag === funcTag || tag === genTag || tag === asyncTag || tag === proxyTag;\n}\n\nfunction isLength(value: any): boolean {\n\treturn typeof value === \"number\" && value > -1 && value % 1 === 0 && value <= MAX_SAFE_INTEGER;\n}\n\nfunction isObject(value: any): boolean {\n\tconst type = typeof value;\n\treturn value != null && (type === \"object\" || type === \"function\");\n}\n\nfunction isObjectLike(value: any): boolean {\n\treturn value != null && typeof value === \"object\";\n}\n\nconst isMap: (value: any) => boolean = baseIsMap;\n\nconst isSet: (value: any) => boolean = baseIsSet;\n\nconst isTypedArray: (value: any) => boolean = baseIsTypedArray;\n\nfunction keys(object: any): string[] {\n\treturn isArrayLike(object) ? arrayLikeKeys(object) : baseKeys(object);\n}\n\nfunction keysIn(object: any): string[] {\n\treturn isArrayLike(object) ? arrayLikeKeys(object, true) : baseKeysIn(object);\n}\n\nfunction stubArray(): any[] {\n\treturn [];\n}\n\nfunction stubFalse(): boolean {\n\treturn false;\n}\n\nconst encodeHtmlMap: any = {\n\t'\"': \"&quot;\",\n\t\"&\": \"&amp;\",\n\t\"'\": \"&#39;\",\n\t\"<\": \"&lt;\",\n\t\">\": \"&gt;\",\n};\n\nfunction lookupEncodeHtmlMap(key: string): string {\n\treturn encodeHtmlMap[key];\n}\n\nfunction encodeHtml(source: string): string {\n\treturn (source === null) ? null : (source + \"\").replace(/[&\"'<>]/g, lookupEncodeHtmlMap);\n}\n\nexport default {\n\tclone: function(source: any) {\n\t\treturn cloneDeep(source);\n\t},\n\tequals: function(first: any, second: any): boolean {\n\t\treturn isEqual(first, second);\n\t},\n\tencodeHtml: encodeHtml\n};\n","interface ComponentConfig {\n\n\tgetMetadata(key: string): any;\n\n\tgetPrefix(): string;\n\n\tgetAttributes(): string[];\n\n}\n\nclass ComponentConfigImpl implements ComponentConfig {\n\n\tprivate metadata: any;\n\n\tprivate attributes: string[];\n\n\tprivate prefix: string;\n\n\tconstructor() {\n\t\tthis.metadata = {};\n\t\tthis.attributes = [];\n\t\tthis.prefix = \"c\";\n\t}\n\n\tpublic getMetadata(key: string): any {\n\t\treturn (key) ? this.metadata[key] : null;\n\t}\n\n\tpublic getPrefix(): string {\n\t\treturn this.prefix;\n\t}\n\n\tpublic getAttributes(): string[] {\n\t\treturn this.attributes.slice();\n\t}\n\n\tpublic withMetadata(name: string, value: any): void {\n\t\tthis.metadata[name] = value;\n\t}\n\n\tpublic withAttribute(name: string): void {\n\t\tthis.attributes.push(name);\n\t}\n\n\tpublic withPrefix(prefix: string): void {\n\t\tthis.prefix = prefix;\n\t}\n\n}\n\nclass ComponentConfigBuilder {\n\n\tprivate instance: ComponentConfigImpl;\n\n\tconstructor() {\n\t\tthis.instance = new ComponentConfigImpl();\n\t}\n\n\tpublic withMetadata(name: string, value: any): ComponentConfigBuilder {\n\t\tthis.instance.withMetadata(name, value);\n\n\t\treturn this;\n\t}\n\n\tpublic withAttribute(name: string): ComponentConfigBuilder {\n\t\tthis.instance.withAttribute(name);\n\n\t\treturn this;\n\t}\n\n\tpublic withPrefix(prefix: string): ComponentConfigBuilder {\n\t\tthis.instance.withPrefix(prefix);\n\n\t\treturn this;\n\t}\n\n\tpublic build(): ComponentConfig {\n\t\treturn this.instance;\n\t}\n\n}\n\nexport { ComponentConfig, ComponentConfigBuilder };\n","import Logger from \"./logger/Logger\";\nimport LoggerFactory from \"./logger/LoggerFactory\";\nimport ScopeImpl from \"./ScopeImpl\";\n\nclass Getter<T> {\n\n\tprivate expression: string;\n\n\tprivate logger: Logger;\n\n\tconstructor(expression: string) {\n\t\tthis.expression = expression;\n\t\tthis.logger = LoggerFactory.getLogger(\"Getter: \" + expression);\n\t}\n\n\tpublic get(scope: ScopeImpl): T {\n\t\tconst code: string = '\"use strict\"; ' + scope.getCode() + \" return (\" + this.expression + \");\";\n\t\tlet value: any = null;\n\n\t\ttry {\n\t\t\tvalue = Function(code).apply({}, [scope.getItems()]);\n\t\t} catch (e) {\n\t\t\tthis.logInvocationError(code, e);\n\t\t}\n\n\t\treturn value;\n\t}\n\n\tprivate logInvocationError(code: string, e: Error) {\n\t\tthis.logger.error(\"\\nAn exception (\" + e.name + \") was thrown invoking the element mediator expression: \" + this.expression\n\t\t\t + \"\\n\\nIn context:\\n\" + code + \"\\n\\nException message: \" + e.message + \"\\n\\n\", e);\n\t}\n\n}\n\nexport default Getter;\n","import Level from \"./Level\";\nimport Logger from \"./Logger\";\nimport LoggerService from \"./LoggerService\";\n\nconst LOGGER_NAME_LENGTH = 20;\n\nclass LoggerImpl implements Logger {\n\n\tprivate name: string;\n\n\tprivate loggerService: LoggerService;\n\n\tconstructor(name: string, loggerService: LoggerService) {\n\t\tif (name.length < LOGGER_NAME_LENGTH) {\n\t\t\tlet count: number = LOGGER_NAME_LENGTH - name.length;\n\n\t\t\twhile (count > 0) {\n\t\t\t\tname = name + \" \";\n\t\t\t\t--count;\n\t\t\t}\n\t\t}\n\n\t\tthis.name = name;\n\t\tthis.loggerService = loggerService;\n\t}\n\n\tpublic trace(payload: any, error?: Error): void {\n\t\tthis.loggerService.log(this, Level.TRACE, payload, error);\n\t}\n\n\tpublic ifTrace(payloadFn: () => any, error?: Error): void {\n\t\tif (this.isTrace()) {\n\t\t\tthis.trace(payloadFn(), error);\n\t\t}\n\t}\n\n\tpublic debug(payload: any, error?: Error): void {\n\t\tthis.loggerService.log(this, Level.DEBUG, payload, error);\n\t}\n\n\tpublic ifDebug(payloadFn: () => any, error?: Error): void {\n\t\tif (this.isDebug()) {\n\t\t\tthis.debug(payloadFn(), error);\n\t\t}\n\t}\n\n\tpublic info(payload: any, error?: Error): void {\n\t\tthis.loggerService.log(this, Level.INFO, payload, error);\n\t}\n\n\tpublic ifInfo(payloadFn: () => any, error?: Error): void {\n\t\tif (this.isInfo()) {\n\t\t\tthis.info(payloadFn(), error);\n\t\t}\n\t}\n\n\tpublic warn(payload: any, error?: Error): void {\n\t\tthis.loggerService.log(this, Level.WARN, payload, error);\n\t}\n\n\tpublic ifWarn(payloadFn: () => any, error?: Error): void {\n\t\tif (this.isWarn()) {\n\t\t\tthis.warn(payloadFn(), error);\n\t\t}\n\t}\n\n\tpublic error(payload: any, error?: Error): void {\n\t\tthis.loggerService.log(this, Level.ERROR, payload, error);\n\t}\n\n\tpublic ifError(payloadFn: () => any, error?: Error): void {\n\t\tif (this.isError()) {\n\t\t\tthis.error(payloadFn(), error);\n\t\t}\n\t}\n\n\tpublic fatal(payload: any, error?: Error): void {\n\t\tthis.loggerService.log(this, Level.FATAL, payload, error);\n\t}\n\n\tpublic ifFatal(payloadFn: () => any, error?: Error): void {\n\t\tif (this.isFatal()) {\n\t\t\tthis.fatal(payloadFn(), error);\n\t\t}\n\t}\n\n\tpublic isTrace(): boolean {\n\t\treturn this.loggerService.isTrace();\n\t}\n\n\tpublic isDebug(): boolean {\n\t\treturn this.loggerService.isDebug();\n\t}\n\n\tpublic isInfo(): boolean {\n\t\treturn this.loggerService.isInfo();\n\t}\n\n\tpublic isWarn(): boolean {\n\t\treturn this.loggerService.isWarn();\n\t}\n\n\tpublic isError(): boolean {\n\t\treturn this.loggerService.isError();\n\t}\n\n\tpublic isFatal(): boolean {\n\t\treturn this.loggerService.isFatal();\n\t}\n\n\tpublic isDisable(): boolean {\n\t\treturn this.loggerService.isDisable();\n\t}\n\n\tpublic getName(): string {\n\t\treturn this.name;\n\t}\n\n}\n\nexport default LoggerImpl;\n","import ConsoleOutputStrategy from \"./ConsoleOutputStrategy\";\nimport Level from \"./Level\";\nimport LevelUtils from \"./LevelUtils\";\nimport Logger from \"./Logger\";\nimport LoggerImpl from \"./LoggerImpl\";\nimport OutputStrategy from \"./OutputStrategy\";\n\nclass LoggerService {\n\n\tpublic static INSTANCE: LoggerService = new LoggerService();\n\n\tprivate level: Level;\n\n\tprivate outputStrategy: OutputStrategy;\n\n\tprivate logger: LoggerImpl;\n\n\tconstructor() {\n\t\tthis.level = Level.INFO;\n\t\tthis.outputStrategy = new ConsoleOutputStrategy();\n\t\tthis.logger = new LoggerImpl(\"LoggerService\", this);\n\t}\n\n\tpublic log(logger: Logger, level: Level, payload: any, errorStack?: Error | boolean): void {\n\t\tif (level >= this.level && level !== Level.DISABLE) {\n\t\t\tthis.outputStrategy.log(logger, level, payload, errorStack);\n\t\t}\n\t}\n\n\tpublic setLevel(level: Level): void {\n\t\tthis.level = level;\n\t\tthis.log(this.logger, Level.DEBUG, \"Logging level: \" + LevelUtils.stringValueOf(level));\n\t}\n\n\tpublic isTrace(): boolean {\n\t\treturn (Level.TRACE >= this.level);\n\t}\n\n\tpublic isDebug(): boolean {\n\t\treturn (Level.DEBUG >= this.level);\n\t}\n\n\tpublic isInfo(): boolean {\n\t\treturn (Level.INFO >= this.level);\n\t}\n\n\tpublic isWarn(): boolean {\n\t\treturn (Level.WARN >= this.level);\n\t}\n\n\tpublic isError(): boolean {\n\t\treturn (Level.ERROR >= this.level);\n\t}\n\n\tpublic isFatal(): boolean {\n\t\treturn (Level.FATAL >= this.level);\n\t}\n\n\tpublic isDisable(): boolean {\n\t\treturn (Level.DISABLE >= this.level);\n\t}\n\n}\n\nexport default LoggerService;\n","import Logger from \"./logger/Logger\";\nimport LoggerFactory from \"./logger/LoggerFactory\";\nimport ScopeImpl from \"./ScopeImpl\";\n\nclass Setter<T> {\n\n\tprivate expression: string;\n\n\tprivate logger: Logger;\n\n\tconstructor(expression: string) {\n\t\tthis.expression = expression;\n\t\tthis.logger = LoggerFactory.getLogger(\"Setter: \" + expression);\n\t}\n\n\tpublic set(scope: ScopeImpl, value: T): void {\n\t\tconst code: string = '\"use strict\"; ' + scope.getCode() + \" \" + this.expression + \" = arguments[1];\";\n\n\t\ttry {\n\t\t\tFunction(code).apply({}, [scope.getItems(), value]);\n\t\t} catch (e) {\n\t\t\tthis.logInvocationError(code, e);\n\t\t}\n\t}\n\n\tprivate logInvocationError(code: string, e: Error) {\n\t\tthis.logger.error(\"\\nAn exception (\" + e.name + \") was thrown invoking the element mediator expression: \" + this.expression\n\t\t\t + \"\\n\\nIn context:\\n\" + code + \"\\n\\nException message: \" + e.message + \"\\n\\n\", e);\n\t}\n\n}\n\nexport default Setter;\n","import { ForChannelContinuation, OnContinuation } from \"../Continuation\";\nimport { INTERNAL_CHANNEL_NAME, Modules } from \"../Core\";\nimport Disposable from \"../Disposable\";\nimport Module from \"../Module\";\nimport Listener from \"./Listener\";\nimport ListenerImpl from \"./ListenerImpl\";\n\n// TODO - Refactor into common constants\nconst INTERNAL_DIRECT_CHANNEL_NAME: string = \"Cydran$$Direct$$Internal$$Channel\";\n\nclass PubSub implements Disposable {\n\n\tprivate listeners: Listener[];\n\n\tprivate listenersByChannel: {};\n\n\tprivate moduleInstance: Module;\n\n\tprivate context: any;\n\n\tprivate globalEnabled: boolean;\n\n\tconstructor(context: any, moduleInstance?: Module) {\n\t\tthis.globalEnabled = false;\n\t\tthis.listeners = [];\n\t\tthis.listenersByChannel = {};\n\t\tthis.context = context;\n\t\tthis.moduleInstance = (moduleInstance) ? moduleInstance : Modules.getModule(\"DEFAULT\");\n\t}\n\n\tpublic message(channelName: string, messageName: string, payload: any): void {\n\t\tif (INTERNAL_DIRECT_CHANNEL_NAME === channelName) {\n\t\t\tif (messageName === \"enableGlobal\") {\n\t\t\t\tthis.enableGlobal();\n\t\t\t} else if (messageName === \"disableGlobal\") {\n\t\t\t\tthis.disableGlobal();\n\t\t\t}\n\t\t} else {\n\t\t\tthis.listeners.forEach((listener) => {\n\t\t\t\tif (channelName === listener.getChannelName()) {\n\t\t\t\t\tlistener.receive(messageName, payload);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n\n\tpublic broadcast(channelName: string, messageName: string, payload: any): void {\n\t\tthis.moduleInstance.broadcast(channelName, messageName, payload);\n\t}\n\n\tpublic broadcastGlobally(channelName: string, messageName: string, payload: any): void {\n\t\tModules.broadcast(channelName, messageName, payload);\n\t}\n\n\tpublic dispose(): void {\n\t\tthis.disableGlobal();\n\t\tthis.listeners = [];\n\t\tthis.listenersByChannel = {};\n\t}\n\n\tpublic on(messageName: string): OnContinuation {\n\t\tconst mine: PubSub = this;\n\t\treturn {\n\t\t\tforChannel: (channel: string) => {\n\t\t\t\treturn {\n\t\t\t\t\tinvoke: (target: (payload: any) => void) => {\n\t\t\t\t\t\tmine.listenTo(channel, messageName, target);\n\t\t\t\t\t},\n\t\t\t\t};\n\t\t\t},\n\t\t\tinvoke: (target: (payload: any) => void) => {\n\t\t\t\tmine.listenTo(INTERNAL_CHANNEL_NAME, messageName, target);\n\t\t\t},\n\t\t};\n\t}\n\n\tprivate listenTo(channel: string, messageName: string, target: (payload: any) => void): void {\n\t\tlet listener: Listener = this.listenersByChannel[channel];\n\n\t\tif (!listener) {\n\t\t\tlistener = new ListenerImpl(channel, this.context);\n\n\t\t\tif (this.globalEnabled) {\n\t\t\t\tthis.moduleInstance.message(INTERNAL_DIRECT_CHANNEL_NAME, \"addListener\", listener);\n\t\t\t}\n\n\t\t\tthis.listeners.push(listener);\n\t\t}\n\t\tlistener.register(messageName, target);\n\t}\n\n\tprivate enableGlobal(): void {\n\t\tif (this.globalEnabled) {\n\t\t\treturn;\n\t\t}\n\n\t\tfor (const listener of this.listeners) {\n\t\t\tthis.moduleInstance.message(INTERNAL_DIRECT_CHANNEL_NAME, \"addListener\", listener);\n\t\t}\n\n\t\tthis.globalEnabled = true;\n\t}\n\n\tprivate disableGlobal(): void {\n\t\tif (!this.globalEnabled) {\n\t\t\treturn;\n\t\t}\n\n\t\tfor (const listener of this.listeners) {\n\t\t\tthis.moduleInstance.message(INTERNAL_DIRECT_CHANNEL_NAME, \"removeListener\", listener);\n\t\t}\n\n\t\tthis.globalEnabled = false;\n\t}\n}\n\nexport default PubSub;\n","var g;\n\n// This works in non-strict mode\ng = (function() {\n\treturn this;\n})();\n\ntry {\n\t// This works if eval is allowed (see CSP)\n\tg = g || new Function(\"return this\")();\n} catch (e) {\n\t// This works if the window reference is available\n\tif (typeof window === \"object\") g = window;\n}\n\n// g can still be undefined, but nothing to do about it...\n// We return undefined, instead of nothing here, so it's\n// easier to handle this case. if(!global) { ...}\n\nmodule.exports = g;\n","import Level from \"./logger/Level\";\nimport LoggerService from \"./logger/LoggerService\";\n\nclass CydranConfig {\n\n\tconstructor() {\n\t\tif (!(this instanceof CydranConfig)) {\n\t\t\tthrow TypeError(new.target.name + \" should be an instance of Config\");\n\t\t}\n\t}\n\n\tpublic useTrace(): void {\n\t\tLoggerService.INSTANCE.setLevel(Level.TRACE);\n\t}\n\n\tpublic useDebug(): void {\n\t\tLoggerService.INSTANCE.setLevel(Level.DEBUG);\n\t}\n\n\tpublic useInfo(): void {\n\t\tLoggerService.INSTANCE.setLevel(Level.INFO);\n\t}\n\n\tpublic useWarn(): void {\n\t\tLoggerService.INSTANCE.setLevel(Level.WARN);\n\t}\n\n\tpublic useError(): void {\n\t\tLoggerService.INSTANCE.setLevel(Level.ERROR);\n\t}\n\n\tpublic useFatal(): void {\n\t\tLoggerService.INSTANCE.setLevel(Level.FATAL);\n\t}\n\n\tpublic useDisable(): void {\n\t\tLoggerService.INSTANCE.setLevel(Level.DISABLE);\n\t}\n}\n\nexport default CydranConfig;\n","import { ComponentConfigBuilder } from \"./ComponentConfig\";\nimport { Component, ElementMediator, Events, Modules } from \"./Core\";\nimport * as CydranConfig from \"./CydranConfig\";\nimport Logger from \"./logger/Logger\";\nimport LoggerFactory from \"./logger/LoggerFactory\";\nimport \"./mediator/\";\nimport \"./messaging/\";\nimport PubSub from \"./messaging/PubSub\";\nimport RegistryStrategy from \"./RegistryStrategy\";\nimport Stage from \"./Stage\";\n\nconst CYDRAN_KEY: string = \"cydran\";\nconst ORIGINAL_CYDRAN: any = window[CYDRAN_KEY];\n\nfunction noConflict() {\n\tconst currentCydran: any = window[CYDRAN_KEY];\n\twindow[CYDRAN_KEY] = ORIGINAL_CYDRAN;\n\n\treturn currentCydran;\n}\n\nexport {\n\tComponentConfigBuilder,\n\tComponent,\n\tEvents,\n\tStage,\n\tElementMediator,\n\tLogger,\n\tLoggerFactory,\n\tCydranConfig,\n\tPubSub,\n\tRegistryStrategy,\n\tModules,\n\tnoConflict,\n};\n","import { CydranError, NEWI } from \"./AbstractCydranError\";\n\nclass DigestLoopError extends CydranError {\n\n\tconstructor(msg: string, reps?: any) {\n\t\tif (!new.target) { throw (new.target + NEWI); }\n\t\tsuper(msg, reps);\n\t}\n\n}\n\nexport default DigestLoopError;\n","import { CydranError, NEWI } from \"./AbstractCydranError\";\n\nclass MalformedOnEventError extends CydranError {\n\n\tconstructor(msg: string, reps?: any) {\n\t\tif (!new.target) { throw (new.target + NEWI); }\n\t\tsuper(msg, reps);\n\t}\n\n}\n\nexport default MalformedOnEventError;\n","import { CydranError, NEWI } from \"./AbstractCydranError\";\n\nclass SelectorError extends CydranError {\n\n\tconstructor(msg: string, reps?: any) {\n\t\tif (!new.target) { throw (new.target + NEWI); }\n\t\tsuper(msg, reps);\n\t}\n\n}\n\nexport default SelectorError;\n","import { CydranError, NEWI } from \"./AbstractCydranError\";\n\nclass SetComponentError extends CydranError {\n\n\tconstructor(msg: string, reps?: any) {\n\t\tif (!new.target) { throw (new.target + NEWI); }\n\t\tsuper(msg, reps);\n\t}\n\n}\n\nexport default SetComponentError;\n","import { CydranError, NEWI } from \"./AbstractCydranError\";\n\nclass TemplateError extends CydranError {\n\n\tconstructor(msg: string, reps?: any) {\n\t\tif (!new.target) { throw (new.target + NEWI); }\n\t\tsuper(msg, reps);\n\t}\n\n}\n\nexport default TemplateError;\n","import { CydranError, NEWI } from \"./AbstractCydranError\";\n\nclass UnknownRegionError extends CydranError {\n\n\tconstructor(msg: string, reps?: any) {\n\t\tif (!new.target) { throw (new.target + NEWI); }\n\t\tsuper(msg, reps);\n\t}\n\n}\n\nexport default UnknownRegionError;\n","import Getter from \"./Getter\";\nimport ScopeImpl from \"./ScopeImpl\";\nimport Setter from \"./Setter\";\n\nclass ExternalMediator<T> {\n\n\tprivate getter: Getter<T>;\n\n\tprivate setter: Setter<T>;\n\n\tconstructor(expression: string) {\n\t\tthis.getter = new Getter(expression);\n\t\tthis.setter = new Setter(expression);\n\t}\n\n\tpublic get(scope: ScopeImpl): T {\n\t\treturn this.getter.get(scope);\n\t}\n\n\tpublic set(scope: ScopeImpl, value: T): void {\n\t\tthis.setter.set(scope, value);\n\t}\n\n}\n\nexport default ExternalMediator;\n","import Level from \"./Level\";\nimport Logger from \"./Logger\";\nimport OutputStrategy from \"./OutputStrategy\";\n\nclass ConsoleOutputStrategy implements OutputStrategy {\n\n\tprivate static getNow(): string {\n\t\tconst now = new Date();\n\n\t\treturn now.getUTCFullYear()\n\t\t\t+ \"-\"\n\t\t\t+ now.getUTCMonth()\n\t\t\t+ \":\"\n\t\t\t+ now.getUTCDate()\n\t\t\t+ \":\"\n\t\t\t+ now.getUTCHours()\n\t\t\t+ \":\"\n\t\t\t+ now.getUTCMinutes()\n\t\t\t+ \":\"\n\t\t\t+ now.getUTCSeconds()\n\t\t\t+ \":\"\n\t\t\t+ now.getUTCMilliseconds();\n\t}\n\n\tpublic log(logger: Logger, level: Level, payload: any, stacked?: Error | boolean): void {\n\n\t\tif (level !== Level.DISABLE) {\n\t\t\tconst wkTStamp = ConsoleOutputStrategy.getNow();\n\t\t\tconst preamble: string = wkTStamp + \" \" + level + \" [\" + logger.getName() + \"]\";\n\n\t\t\tconst shortArgs: boolean = payload instanceof Error;\n\t\t\tconst printFullStack: boolean = !(stacked instanceof Error) ? (null !== stacked ? stacked : false) : false;\n\n\t\t\tif (level >= Level.WARN) {\n\t\t\t\tconst logMsg: string = (shortArgs ? payload.stack : payload);\n\t\t\t\tlet errMsg: string;\n\t\t\t\tif (stacked instanceof Error) {\n\t\t\t\t\terrMsg = stacked.stack;\n\t\t\t\t} else {\n\t\t\t\t\terrMsg = !shortArgs ? \"- FYI ONLY: \" : \"\";\n\t\t\t\t}\n\n\t\t\t\tconst secondPreamble = (shortArgs ? \"\" : ((stacked) ? \" - %s\" : \"\"));\n\n\t\t\t\tswitch (level) {\n\t\t\t\t\tcase Level.WARN:\n\t\t\t\t\t\t// tslint:disable-next-line\n\t\t\t\t\t\tconsole.warn(\"%c\" + preamble + secondPreamble, \"color:#ff9400;\", logMsg, errMsg);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase Level.ERROR:\n\t\t\t\t\tcase Level.FATAL:\n\t\t\t\t\tdefault:\n\t\t\t\t\t\t// tslint:disable-next-line\n\t\t\t\t\t\tconsole.error(preamble + secondPreamble, logMsg, errMsg);\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tswitch (level) {\n\t\t\t\t\tcase Level.TRACE:\n\t\t\t\t\t\tif (printFullStack) {\n\t\t\t\t\t\t\t// tslint:disable-next-line\n\t\t\t\t\t\t\tconsole.trace(\"%c\" + preamble, \"color:#00752d;\", payload);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t// tslint:disable-next-line\n\t\t\t\t\t\t\tconsole.info(\"%c\" + preamble, \"color:#ff9400;\", payload);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase Level.DEBUG:\n\t\t\t\t\t\t// tslint:disable-next-line\n\t\t\t\t\t\tconsole.debug(\"%c\" + preamble, \"color:#00752d;\", payload);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase Level.INFO:\n\t\t\t\t\t\t// tslint:disable-next-line\n\t\t\t\t\t\tconsole.info(\"%c\" + preamble, \"color:#2d57ca;\", payload);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tdefault:\n\t\t\t\t\t\t// tslint:disable-next-line\n\t\t\t\t\t\tconsole.log(preamble, payload);\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n}\n\nexport default ConsoleOutputStrategy;\n","import Level from \"./Level\";\n\nclass LevelUtils {\n\n\tpublic static valueOf(lvl: string): Level {\n\t\treturn Level[lvl];\n\t}\n\n\tpublic static stringValueOf(lvl: Level): string {\n\t\treturn Level[lvl];\n\t}\n\n\tpublic static getKeys(): String[] {\n\t\tconst keys: String[] = [];\n\t\tfor (const k of Object.keys(Level)) {\n\t\t\tif (this.rx.test(k)) {\n\t\t\t\tkeys[k] = this.stringValueOf(Number.parseInt(k, 10));\n\t\t\t}\n\t\t}\n\t\treturn keys;\n\t}\n\n\tpublic static values(): Level[] {\n\t\treturn this.getKeys().map((key: string) => {\n\t\t\treturn Level[key];\n\t\t});\n\t}\n\n\tpublic static size(): number {\n\t\treturn this.getKeys().length;\n\t}\n\n\tprivate static readonly rx = /\\d+/;\n}\n\nexport default LevelUtils;\n","\nclass GuardGenerator {\n\n\tpublic static readonly INSTANCE: GuardGenerator = new GuardGenerator();\n\n\tprivate static readonly MAX_VALUE: number = 9007199254740989;\n\n\tprivate major: number;\n\n\tprivate minor: number;\n\n\tprivate micro: number;\n\n\tconstructor() {\n\t\tthis.major = 0;\n\t\tthis.minor = 0;\n\t\tthis.micro = 0;\n\t}\n\n\tpublic generate(): string {\n\t\tconst result: string = this.major + \"-\" + this.minor + \"-\" + this.micro;\n\n\t\tthis.micro++;\n\n\t\tif (this.micro > GuardGenerator.MAX_VALUE) {\n\t\t\tthis.micro = 0;\n\t\t\tthis.minor++;\n\t\t}\n\n\t\tif (this.minor > GuardGenerator.MAX_VALUE) {\n\t\t\tthis.minor = 0;\n\t\t\tthis.major++;\n\t\t}\n\n\t\treturn result;\n\t}\n\n}\n\nexport default GuardGenerator;\n","import Guard from \"./Guard\";\n\ninterface ValueMap {\n\n\t[key: string]: string;\n\n}\n\nclass GuardImpl implements Guard {\n\n\tpublic static up(original: Guard): Guard {\n\t\treturn original || new GuardImpl(true);\n\t}\n\n\tpublic static down(original: Guard): Guard {\n\t\treturn original || new GuardImpl(false);\n\t}\n\n\tprivate propagateUp: boolean;\n\n\tprivate state: ValueMap;\n\n\tconstructor(propagateUp: boolean) {\n\t\tthis.state = {};\n\t\tthis.propagateUp = !!propagateUp;\n\t}\n\n\tpublic mark(value: string): void {\n\t\tif (value) {\n\t\t\tthis.state[value] = value;\n\t\t}\n\t}\n\n\tpublic seen(value: string): boolean {\n\t\treturn (value && this.state[value]) ? true : false;\n\t}\n\n\tpublic isPropagateUp(): boolean {\n\t\treturn this.propagateUp;\n\t}\n\n\tpublic isPropagateDown(): boolean {\n\t\treturn !this.propagateUp;\n\t}\n\n}\n\nexport default GuardImpl;\n","import Listener from \"./Listener\";\n\nclass ListenerImpl implements Listener {\n\n\tprivate context: any;\n\n\tprivate channelName;\n\n\tprivate mappings: {\n\t\t[messageName: string]: Array<(payload: any) => void>;\n\t};\n\n\tconstructor(channelName: string, context: any) {\n\t\tthis.mappings = {};\n\t\tthis.channelName = channelName;\n\t\tthis.context = context;\n\t}\n\n\tpublic receive(messageName: string, payload: any): void {\n\t\tconst mappings: Array<(payload: any) => void> = this.mappings[messageName];\n\n\t\tif (!mappings) {\n\t\t\treturn;\n\t\t}\n\n\t\tfor (const mapping of mappings) {\n\t\t\tmapping.call(this.context, payload);\n\t\t}\n\t}\n\n\tpublic register(messageName: string, fn: (payload: any) => void): void {\n\t\tif (!this.mappings[messageName]) {\n\t\t\tthis.mappings[messageName] = [];\n\t\t}\n\n\t\tthis.mappings[messageName].push(fn);\n\t}\n\n\tpublic getChannelName(): string {\n\t\treturn this.channelName;\n\t}\n\n\tpublic dispose(): void {\n\t\tthis.mappings = {};\n\t\tthis.context = null;\n\t}\n\n}\n\nexport default ListenerImpl;\n","import Getter from \"./Getter\";\nimport Guard from \"./Guard\";\nimport Invoker from \"./Invoker\";\nimport Logger from \"./logger/Logger\";\nimport LoggerFactory from \"./logger/LoggerFactory\";\nimport ModelMediator from \"./ModelMediator\";\nimport ObjectUtils from \"./ObjectUtils\";\nimport ScopeImpl from \"./ScopeImpl\";\nimport Setter from \"./Setter\";\n\nconst DEFAULT_REDUCER: (input: any) => any = (input) => input;\n\nclass ModelMediatorImpl<T> implements ModelMediator<T> {\n\n\tprivate logger: Logger;\n\n\tprivate model: any;\n\n\tprivate expression: string;\n\n\tprivate previous: T;\n\n\tprivate previousFragment: any;\n\n\tprivate watchPrevious: T;\n\n\tprivate watchCurrent: T;\n\n\tprivate watchDispatchPending: boolean;\n\n\tprivate scope: ScopeImpl;\n\n\tprivate context: any;\n\n\tprivate digested: boolean = false;\n\n\tprivate target: (previous: T, current: T, guard: Guard) => void;\n\n\tprivate digestCallback: (guard: Guard) => void;\n\n\tprivate digestCallbackContext: any;\n\n\tprivate reducerFn: (input: T) => any;\n\n\tprivate invoker: Invoker;\n\n\tprivate getter: Getter<T>;\n\n\tprivate setter: Setter<T>;\n\n\tconstructor(model: any, expression: string, scope: ScopeImpl) {\n\t\tthis.logger = LoggerFactory.getLogger(\"ModelMediator: \" + expression);\n\t\tthis.model = model;\n\t\tthis.expression = expression;\n\t\tthis.scope = scope;\n\t\tthis.previous = null;\n\t\tthis.context = {};\n\t\tthis.digestCallbackContext = {};\n\t\tthis.target = null;\n\t\tthis.digestCallback = null;\n\t\tthis.watchDispatchPending = false;\n\t\tthis.reducerFn = DEFAULT_REDUCER;\n\t\tthis.invoker = new Invoker(expression);\n\t\tthis.getter = new Getter(expression);\n\t\tthis.setter = new Setter(expression);\n\t}\n\n\tpublic invoke(...args: any[]): void {\n\t\tthis.invoker.invoke(this.scope, args);\n\t}\n\n\tpublic get(): T {\n\t\treturn this.getter.get(this.scope);\n\t}\n\n\tpublic set(value: T): void {\n\t\tthis.setter.set(this.scope, value);\n\t}\n\n\tpublic evaluate(guard: Guard): boolean {\n\t\tif (!this.target) {\n\t\t\treturn false;\n\t\t}\n\n\t\t// Check for opts out of digestion\n\t\tlet changed: boolean = false;\n\t\tconst value: T = this.get();\n\t\tconst valueFragment: any = this.reducerFn(value);\n\n\t\tif (this.digested) {\n\t\t\tif (ObjectUtils.equals(this.previousFragment, valueFragment)) {\n\t\t\t\tthis.logger.trace(\"Not different.\");\n\t\t\t} else {\n\t\t\t\tif (this.logger.isTrace()) {\n\t\t\t\t\tthis.logger.trace({ current: value, previous: this.previous });\n\t\t\t\t}\n\n\t\t\t\tthis.logger.trace(\"Invoking listener\");\n\t\t\t\tthis.swap(value, valueFragment);\n\t\t\t\tchanged = true;\n\t\t\t}\n\t\t} else {\n\t\t\tthis.swap(value, valueFragment);\n\t\t\tchanged = true;\n\t\t\tthis.digested = true;\n\t\t}\n\n\t\treturn changed;\n\t}\n\n\tpublic notifyWatcher(guard: Guard): void {\n\t\tif (this.watchDispatchPending) {\n\t\t\tthis.target.apply(this.context, [this.watchPrevious, this.watchCurrent, guard]);\n\t\t\tthis.watchDispatchPending = false;\n\t\t}\n\t}\n\n\tpublic watch(context: any, target: (previous: T, current: T, guard: Guard) => void): void {\n\t\tthis.context = context;\n\t\tthis.target = target;\n\t}\n\n\tpublic onDigest(context: any, digestCallback: (guard: Guard) => void): void {\n\t\tthis.digestCallbackContext = context;\n\t\tthis.digestCallback = digestCallback;\n\t}\n\n\tpublic dispose(): void {\n\t\tthis.model = null;\n\t\tthis.previous = null;\n\t\tthis.context = null;\n\t\tthis.target = null;\n\t\tthis.digestCallbackContext = null;\n\t\tthis.digestCallback = null;\n\t\tthis.watchPrevious = null;\n\t\tthis.watchCurrent = null;\n\t\tthis.watchDispatchPending = false;\n\t}\n\n\tpublic executeCallback(guard: Guard): void {\n\t\tif (this.digestCallback !== null) {\n\t\t\tthis.digestCallback.call(this.digestCallbackContext, guard);\n\t\t}\n\t}\n\n\tpublic setReducer(reducerFn: (input: T) => any): void {\n\t\tthis.reducerFn = (reducerFn === null) ? DEFAULT_REDUCER : reducerFn;\n\t}\n\n\tprotected getExpression(): string {\n\t\treturn this.expression;\n\t}\n\n\tprivate swap(value: T, valueFragment: any): void {\n\t\tconst newPrevious: T = ObjectUtils.clone(value);\n\t\tconst newPreviousFragment: any = ObjectUtils.clone(valueFragment);\n\t\tthis.watchPrevious = this.previous;\n\t\tthis.watchCurrent = value;\n\t\tthis.watchDispatchPending = true;\n\t\tthis.previous = newPrevious;\n\t\tthis.previousFragment = newPreviousFragment;\n\t}\n\n\tprivate logInvocationError(code: string, e: Error) {\n\t\tthis.logger.error(\"\\nAn exception (\" + e.name + \") was thrown invoking the element mediator expression: \" + this.expression\n\t\t\t + \"\\n\\nIn context:\\n\" + code + \"\\n\\nException message: \" + e.message + \"\\n\\n\", e);\n\t}\n\n}\n\nexport default ModelMediatorImpl;\n","import Logger from \"./logger/Logger\";\nimport LoggerFactory from \"./logger/LoggerFactory\";\nimport ScopeImpl from \"./ScopeImpl\";\n\nclass Invoker {\n\n\tprivate expression: string;\n\n\tprivate logger: Logger;\n\n\tconstructor(expression: string) {\n\t\tthis.expression = expression;\n\t\tthis.logger = LoggerFactory.getLogger(\"Invoker: \" + expression);\n\t}\n\n\tpublic invoke(scope: ScopeImpl, ...args: any[]): void {\n\t\tconst code: string = '\"use strict\"; ' + scope.getCode() + \" var args = arguments[1]; (\" + this.expression + \");\";\n\n\t\ttry {\n\t\t\tFunction(code).apply({}, [scope.getItems(), args]);\n\t\t} catch (e) {\n\t\t\tthis.logInvocationError(code, e);\n\t\t}\n\t}\n\n\tprivate logInvocationError(code: string, e: Error) {\n\t\tthis.logger.error(\"\\nAn exception (\" + e.name + \") was thrown invoking the element mediator expression: \" + this.expression\n\t\t\t + \"\\n\\nIn context:\\n\" + code + \"\\n\\nException message: \" + e.message + \"\\n\\n\", e);\n\t}\n\n}\n\nexport default Invoker;\n","module.exports = function(module) {\n\tif (!module.webpackPolyfill) {\n\t\tmodule.deprecate = function() {};\n\t\tmodule.paths = [];\n\t\t// module.parent = undefined by default\n\t\tif (!module.children) module.children = [];\n\t\tObject.defineProperty(module, \"loaded\", {\n\t\t\tenumerable: true,\n\t\t\tget: function() {\n\t\t\t\treturn module.l;\n\t\t\t}\n\t\t});\n\t\tObject.defineProperty(module, \"id\", {\n\t\t\tenumerable: true,\n\t\t\tget: function() {\n\t\t\t\treturn module.i;\n\t\t\t}\n\t\t});\n\t\tmodule.webpackPolyfill = 1;\n\t}\n\treturn module;\n};\n","class Properties {\n\n\tpublic static setWindow(window: Window): void {\n\t\tProperties.window = window;\n\t}\n\n\tpublic static getWindow(): Window {\n\t\treturn Properties.window;\n\t}\n\n\tprivate static window: Window;\n\n}\n\nProperties.setWindow(global[\"window\"]);\n\nexport default Properties;\n","import RegistrationError from \"./error/RegistrationError\";\nimport Register from \"./Register\";\nimport RegistryStrategy from \"./RegistryStrategy\";\n\ninterface Factories {\n\n\t[id: string]: Factory<any>;\n\n}\n\ninterface Factory<T> {\n\n\tget(): T;\n\n}\n\nclass DefaultRegistryStrategyImpl implements RegistryStrategy, Register {\n\n\tprivate factories: Factories;\n\n\tconstructor() {\n\t\tthis.factories = {};\n\t}\n\n\tpublic get<T>(id: string): T {\n\t\tlet instance: T = null;\n\n\t\tif (this.factories[id]) {\n\t\t\tinstance = this.factories[id].get();\n\t\t}\n\n\t\treturn instance;\n\t}\n\n\tpublic registerConstant(id: string, instance: any): void {\n\t\tthis.registerFactory(id, new ConstantFactory(instance));\n\t}\n\n\tpublic registerPrototype(id: string, classInstance: any): void {\n\t\tthis.registerFactory(id, new PrototypeFactory(classInstance));\n\t}\n\n\tpublic registerSingleton(id: string, classInstance: any): void {\n\t\tthis.registerFactory(id, new SingletonFactory(classInstance));\n\t}\n\n\tprivate registerFactory(id: string, factory: Factory<any>): void {\n\t\tif (id && factory) {\n\t\t\tif (this.factories[id]) {\n\t\t\t\tthrow new RegistrationError(\"'%id%' key is considered unique and already exists\", {\"%id%\": id});\n\t\t\t}\n\t\t\tthis.factories[id] = factory;\n\t\t}\n\t}\n}\n\nexport interface Registry extends Register {\n\n\tget<T>(id: string): T;\n\n\taddStrategy(strategy: RegistryStrategy): void;\n\n}\n\nexport class RegistryImpl implements Registry {\n\n\tpublic static INSTANCE: RegistryImpl = new RegistryImpl();\n\n\tprivate strategies: RegistryStrategy[];\n\n\tprivate defaultStrategy: DefaultRegistryStrategyImpl;\n\n\tconstructor() {\n\t\tthis.defaultStrategy = new DefaultRegistryStrategyImpl();\n\t\tthis.strategies = [this.defaultStrategy];\n\t}\n\n\tpublic get<T>(id: string): T {\n\t\tlet i: number = 0;\n\n\t\tlet instance: T = null;\n\n\t\twhile (!instance && i < this.strategies.length) {\n\t\t\tinstance = this.strategies[i].get(id);\n\t\t\ti++;\n\t\t}\n\n\t\treturn instance;\n\t}\n\n\tpublic registerConstant(id: string, instance: any): Registry {\n\t\tthis.defaultStrategy.registerConstant(id, instance);\n\t\treturn this;\n\t}\n\n\tpublic registerPrototype(id: string, classInstance: any): Registry {\n\t\tthis.defaultStrategy.registerPrototype(id, classInstance);\n\t\treturn this;\n\t}\n\n\tpublic registerSingleton(id: string, classInstance: any): Registry {\n\t\tthis.defaultStrategy.registerSingleton(id, classInstance);\n\t\treturn this;\n\t}\n\n\tpublic addStrategy(strategy: RegistryStrategy): void {\n\t\tif (strategy) {\n\t\t\tthis.strategies.push(strategy);\n\t\t}\n\t}\n\n}\n\nclass ConstantFactory<T> implements Factory<T> {\n\n\tprivate instance: T;\n\n\tconstructor(instance: T) {\n\t\tthis.instance = instance;\n\t}\n\n\tpublic get(): T {\n\t\treturn this.instance;\n\t}\n\n}\n\nclass PrototypeFactory<T> implements Factory<T> {\n\n\tprivate classInstance: any;\n\n\tconstructor(classInstance: any) {\n\t\tthis.classInstance = classInstance;\n\t}\n\n\tpublic get(): T {\n\t\treturn new this.classInstance();\n\t}\n\n}\n\nclass SingletonFactory<T> implements Factory<T> {\n\n\tprivate classInstance: any;\n\n\tprivate instance: T;\n\n\tconstructor(classInstance: any) {\n\t\tthis.classInstance = classInstance;\n\t}\n\n\tpublic get(): T {\n\t\tif (!this.instance) {\n\t\t\tthis.instance = new this.classInstance();\n\t\t}\n\n\t\treturn this.instance;\n\t}\n\n}\n","import { CydranError, NEWI } from \"./AbstractCydranError\";\n\nclass RegistrationError extends CydranError {\n\n\tconstructor(msg: string, reps?: any) {\n\t\tif (!new.target) { throw (new.target + NEWI); }\n\t\tsuper(msg, reps);\n\t}\n\n}\n\nexport default RegistrationError;\n","import ScopeError from \"./error/ScopeError\";\nimport Scope from \"./Scope\";\n\ninterface ScopeMap {\n\n\t[name: string]: any;\n\n}\n\ninterface ScopeSet {\n\n\t[name: string]: string;\n\n}\n\nconst EXCLUSIONS: ScopeSet = {\n\ti: \"i\",\n\titem: \"item\",\n\tm: \"m\",\n\tmodel: \"model\",\n\tp: \"p\",\n\tparent: \"parent\",\n};\n\nconst VALID_KEY_REGEX: RegExp = new RegExp(/^[a-zA-Z\\$\\_][a-zA-Z0-9\\$\\_]*$/);\n\nclass ScopeImpl implements Scope {\n\n\tprivate code: string;\n\n\tprivate children: ScopeImpl[];\n\n\tprivate localItems: ScopeMap;\n\n\tprivate items: ScopeMap;\n\n\tprivate parent: ScopeImpl;\n\n\tprivate restricted: boolean;\n\n\tconstructor(restricted?: boolean) {\n\t\tthis.children = [];\n\t\tthis.localItems = {};\n\t\tthis.items = {};\n\t\tthis.code = \"\";\n\t\tthis.parent = null;\n\t\tthis.restricted = (restricted === null || restricted === undefined) ? true : restricted;\n\t}\n\n\tpublic setParent(parent: ScopeImpl): void {\n\t\tif (!parent) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.parent) {\n\t\t\tthis.parent.removeChild(this);\n\t\t}\n\n\t\tthis.parent = parent;\n\t\tthis.parent.addChild(this);\n\t\tthis.refresh();\n\t}\n\n\tpublic addChild(child: ScopeImpl): void {\n\t\tif (child) {\n\t\t\tthis.children.push(child);\n\t\t}\n\t}\n\n\tpublic removeChild(child: ScopeImpl): void {\n\t\tconst index: number = this.children.indexOf(child);\n\n\t\tif (index >= 0) {\n\t\t\tthis.children.splice(index, 1);\n\t\t}\n\t}\n\n\tpublic getItems(): ScopeMap {\n\t\treturn this.items;\n\t}\n\n\tpublic getCode(): string {\n\t\treturn this.code;\n\t}\n\n\tpublic add(name: string, item: any): void {\n\t\tthis.checkName(name);\n\t\tthis.localItems[name] = item;\n\t\tthis.refresh();\n\t\tthis.refreshChildren();\n\t}\n\n\tpublic remove(name: string): void {\n\t\tthis.checkName(name);\n\t\tdelete this.localItems[name];\n\t\tthis.refresh();\n\t\tthis.refreshChildren();\n\t}\n\n\tprivate checkName(name: string): void {\n\t\tif (!VALID_KEY_REGEX.test(name)) {\n\t\t\tthrow new ScopeError(\"Only objects with names containing letters and numbers and starting with a letter are allowed.\");\n\t\t}\n\n\t\tif (this.restricted && EXCLUSIONS[name]) {\n\t\t\tthrow new ScopeError(name + \" is a reserved name in the scope.\");\n\t\t}\n\t}\n\n\tprivate refresh(): void {\n\t\tthis.items = {};\n\n\t\tif (this.parent) {\n\t\t\tconst parentItems: ScopeMap = this.parent.getItems();\n\n\t\t\tfor (const key in parentItems) {\n\t\t\t\tif (parentItems.hasOwnProperty(key)) {\n\t\t\t\t\tthis.items[key] = parentItems[key];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tfor (const key in this.localItems) {\n\t\t\tif (this.localItems.hasOwnProperty(key)) {\n\t\t\t\tthis.items[key] = this.localItems[key];\n\t\t\t}\n\t\t}\n\n\t\tthis.refreshCode();\n\t}\n\n\tprivate refreshCode(): void {\n\t\tthis.code = \"\";\n\n\t\tfor (const key in this.items) {\n\t\t\tif (this.items.hasOwnProperty(key)) {\n\t\t\t\tconst statement: string = \"var \" + key + \" = arguments[0]['\" + key + \"'];\\n\";\n\t\t\t\tthis.code += statement;\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate refreshChildren(): void {\n\t\tfor (const child of this.children) {\n\t\t\tchild.refresh();\n\t\t}\n\t}\n\n}\n\nexport default ScopeImpl;\n","import { CydranError, NEWI } from \"./AbstractCydranError\";\n\nclass ScopeError extends CydranError {\n\n\tconstructor(msg: string, reps?: any) {\n\t\tif (!new.target) {\n\t\t\tthrow (new.target + NEWI);\n\t\t}\n\n\t\tsuper(msg, reps);\n\t}\n\n}\n\nexport default ScopeError;\n","const MAX_SAFE_INTEGER: number = 9007199254740989;\n\nclass SequenceGenerator {\n\n\tpublic static INSTANCE: SequenceGenerator = new SequenceGenerator();\n\n\tprivate value: number;\n\n\tconstructor() {\n\t\tthis.value = 0;\n\t}\n\n\tpublic next(): number {\n\t\tif (this.value >= MAX_SAFE_INTEGER) {\n\t\t\tthis.value = -1;\n\t\t}\n\n\t\tthis.value++;\n\n\t\treturn this.value;\n\t}\n\n}\n\nexport default SequenceGenerator;\n","import { Mvvm } from \"../Core\";\n\nimport Checked from \"./Checked\";\nMvvm.register(Checked.KEY, [\"input\"], Checked);\n\nimport CSSClass from \"./CSSClass\";\nMvvm.register(CSSClass.KEY, [\"*\"], CSSClass);\n\nimport Content from \"./Content\";\nMvvm.register(Content.KEY, [\"*\"], Content);\n\nimport Enabled from \"./Enabled\";\nMvvm.register(Enabled.KEY, [\"*\"], Enabled);\n\nimport ReadOnly from \"./ReadOnly\";\nMvvm.register(ReadOnly.KEY, [\"*\"], ReadOnly);\n\nimport Style from \"./Style\";\nMvvm.register(Style.KEY, [\"*\"], Style);\n\nimport ForceFocus from \"./ForceFocus\";\nMvvm.register(ForceFocus.KEY, [\"*\"], ForceFocus);\n\nimport MultiSelectValueModel from \"./MultiSelectValueModel\";\nMvvm.register(MultiSelectValueModel.KEY, [\"select\"], MultiSelectValueModel);\n\nimport ValuedModel from \"./ValuedModel\";\nMvvm.register(ValuedModel.KEY, [\"textarea\"], ValuedModel);\n\nimport InputValueModel from \"./InputValueModel\";\nMvvm.register(InputValueModel.KEY, [\"input\"], InputValueModel);\n\nimport Visible from \"./Visible\";\nMvvm.register(Visible.KEY, [\"*\"], Visible);\n\nimport Repeat from \"./Repeat\";\nMvvm.register(\"repeat\", [\"*\"], Repeat);\n\nexport { };\n","import { ElementMediator } from \"../Core\";\n\n/**\n *\n */\nclass Checked extends ElementMediator<boolean, HTMLInputElement> {\n\n\tpublic static readonly KEY: string = \"checked\";\n\n\tpublic wire(): void {\n\t\tthis.getModelMediator().watch(this, this.onTargetChange);\n\t}\n\n\tpublic unwire(): void {\n\t\t// Intentionally do nothing\n\t}\n\n\tprotected onTargetChange(previous: boolean, current: boolean): void {\n\t\tthis.getEl().checked = !current;\n\t}\n}\n\nexport default Checked;\n","import { ElementMediator } from \"../Core\";\n\nclass CSSClass extends ElementMediator<any, HTMLElement> {\n\n\tpublic static readonly KEY: string = \"class\";\n\n\tpublic wire(): void {\n\t\tthis.getModelMediator().watch(this, this.onTargetChange);\n\t}\n\n\tpublic unwire(): void {\n\t\t// Intentionally do nothing\n\t}\n\n\tprivate onTargetChange(previous: any, current: any): void {\n\t\tconst oldClasses: string[] = (this.getEl().className || \"\").trim().split(\" \");\n\t\tconst newClasses: string[] = [];\n\t\tconst map: any = current || {};\n\n\t\tfor (const value of oldClasses) {\n\t\t\tif (!map.hasOwnProperty(value)) {\n\t\t\t\tnewClasses.push(value);\n\t\t\t}\n\t\t}\n\n\t\tfor (const key in map) {\n\t\t\tif (map.hasOwnProperty(key) && !!map[key]) {\n\t\t\t\tnewClasses.push(key);\n\t\t\t}\n\t\t}\n\n\t\tthis.getEl().className = newClasses.join(\" \");\n\t}\n\n}\n\nexport default CSSClass;\n","import { ElementMediator } from \"../Core\";\nimport ObjectUtils from \"../ObjectUtils\";\n\nclass Content extends ElementMediator<string, HTMLElement> {\n\n\tpublic static readonly KEY: string = \"content\";\n\n\tpublic wire(): void {\n\t\tthis.getModelMediator().watch(this, this.onTargetChange);\n\t}\n\n\tpublic unwire(): void {\n\t\t// Intentionally do nothing\n\t}\n\n\tprotected onTargetChange(previous: string, current: string): void {\n\t\tthis.getEl().innerHTML = ObjectUtils.encodeHtml(current);\n\t}\n\n}\n\nexport default Content;\n","import { ElementMediator } from \"../Core\";\n\nclass Enabled extends ElementMediator<boolean, HTMLInputElement> {\n\n\tpublic static readonly KEY: string = \"enabled\";\n\n\tpublic wire(): void {\n\t\tthis.getModelMediator().watch(this, this.onTargetChange);\n\t}\n\n\tpublic unwire(): void {\n\t\t// Intentionally do nothing\n\t}\n\n\tprotected onTargetChange(previous: boolean, current: boolean): void {\n\t\tthis.getEl().disabled = !current;\n\t}\n\n}\n\nexport default Enabled;\n","import { ElementMediator } from \"../Core\";\n\nclass ReadOnly extends ElementMediator<boolean, HTMLInputElement> {\n\n\tpublic static readonly KEY: string = \"readonly\";\n\n\tpublic wire(): void {\n\t\tthis.getModelMediator().watch(this, this.onTargetChange);\n\t}\n\n\tpublic unwire(): void {\n\t\t// Intentionally do nothing\n\t}\n\n\tprotected onTargetChange(previous: boolean, current: boolean): void {\n\t\tthis.getEl().readOnly = current;\n\t}\n\n}\n\nexport default ReadOnly;\n","import { ElementMediator } from \"../Core\";\n\nclass Style extends ElementMediator<any, HTMLElement> {\n\n\tpublic static readonly KEY: string = \"style\";\n\n\tpublic wire(): void {\n\t\tthis.getModelMediator().watch(this, this.onTargetChange);\n\t}\n\n\tpublic unwire(): void {\n\t\t// Intentionally do nothing\n\t}\n\n\tprotected onTargetChange(previous: any, current: any): void {\n\t\tif (current === null) {\n\t\t\treturn;\n\t\t}\n\n\t\tfor (const key in current) {\n\t\t\tif (!current.hasOwnProperty(key)) {\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tthis.getEl().style[key] = current[key];\n\t\t}\n\t}\n\n}\n\nexport default Style;\n","import { ElementMediator } from \"../Core\";\n\n\nclass ForceFocus extends ElementMediator<boolean, HTMLElement> {\n\n\tpublic static readonly KEY: string = \"force-focus\";\n\n\tprivate shouldFocus: boolean;\n\n\tpublic wire(): void {\n\t\tthis.bridge(\"focusout\");\n\t\tthis.listenTo(\"dom\", \"focusout\", this.handleFocusout);\n\t\tthis.shouldFocus = false;\n\t\tthis.getModelMediator().watch(this, this.onTargetChange);\n\t}\n\n\tpublic unwire(): void {\n\t\t// Intentionally do nothing\n\t}\n\n\tpublic handleFocusout(event: Event): void {\n\t\tif (this.shouldFocus) {\n\t\t\tthis.getEl().focus();\n\t\t}\n\t}\n\n\tprotected onTargetChange(previous: boolean, current: boolean): void {\n\t\tthis.shouldFocus = current;\n\t}\n\n}\n\nexport default ForceFocus;\n","import { ElementMediator } from \"../Core\";\n\n/**\n *\n */\nclass MultiSelectValueModel extends ElementMediator<string | string[], HTMLSelectElement> {\n\n\tpublic static readonly KEY: string = \"model\";\n\n\tpublic wire(): void {\n\t\tthis.bridge(\"input\");\n\t\tthis.listenTo(\"dom\", \"input\", this.handleInput);\n\t\tthis.getModelMediator().watch(this, this.onTargetChange);\n\t}\n\n\tpublic unwire(): void {\n\t\t// Intentionally do nothing\n\t}\n\n\tpublic handleInput(event: Event): void {\n\t\tif (this.getEl().multiple) {\n\t\t\tconst selectedValues: Array<string|number> = [];\n\n\t\t\tfor (let i = 0; i < this.getEl().selectedOptions.length; i++) {\n\t\t\t\tconst optValue: string = this.getEl().selectedOptions.item(i).getAttribute(\"value\");\n\t\t\t\tselectedValues.push(optValue);\n\t\t\t}\n\n\t\t\tthis.$apply(() => {\n\t\t\t\tthis.getModelMediator().set(selectedValues);\n\t\t\t}, [], null);\n\t\t} else {\n\t\t\tthis.$apply(() => {\n\t\t\t\tthis.getModelMediator().set(this.getEl()[\"value\"]);\n\t\t\t}, [], null);\n\t\t}\n\t}\n\n\tprotected onTargetChange(previous: string | string[], current: string | string[]): void {\n\t\tif (this.getEl().multiple) {\n\t\t\tcurrent = (current === null) ? [] : current;\n\n\t\t\tfor (let i = 0; i < this.getEl().options.length; i++) {\n\t\t\t\tconst element: HTMLOptionElement = this.getEl().options.item(i);\n\t\t\t\telement.selected = current.includes(element.value);\n\t\t\t}\n\t\t} else {\n\t\t\tthis.getEl().value = current as string;\n\t\t}\n\t}\n\n}\n\nexport default MultiSelectValueModel;\n","import { ElementMediator } from \"../Core\";\n\n/**\n *\n */\nclass ValuedModel extends ElementMediator<string, HTMLInputElement> {\n\n\tpublic static readonly KEY: string = \"model\";\n\n\tpublic wire(): void {\n\t\tthis.bridge(\"input\");\n\t\tthis.listenTo(\"dom\", \"input\", this.handleInput);\n\t\tthis.getModelMediator().watch(this, this.onTargetChange);\n\t}\n\n\tpublic unwire(): void {\n\t\t// Intentionally do nothing\n\t}\n\n\tpublic handleInput(event: Event): void {\n\t\tthis.$apply(() => {\n\t\t\tthis.getModelMediator().set(this.getEl().value);\n\t\t}, [], null);\n\t}\n\n\tprotected onTargetChange(previous: string, current: string): void {\n\t\tthis.getEl().value = current;\n\t}\n\n}\n\nexport default ValuedModel;\n","import { ElementMediator } from \"../Core\";\n\n/**\n *\n */\nclass InputValueModel extends ElementMediator<string, HTMLInputElement> {\n\n\tpublic static readonly KEY: string = \"model\";\n\n\tpublic wire(): void {\n\t\tthis.bridge(\"input\");\n\t\tconst isRadio: boolean = this.getEl().type.toLowerCase() === \"radio\";\n\t\tthis.listenTo(\"dom\", \"input\", (isRadio ? this.handleRadioInput : this.handleInput));\n\t\tthis.getModelMediator().watch(this, (isRadio ? this.onRadioTargetChange : this.onTargetChange));\n\t}\n\n\tpublic unwire(): void {\n\t\t// Intentionally do nothing\n\t}\n\n\tpublic handleInput(event: Event): void {\n\t\tthis.$apply(() => {\n\t\t\tthis.getModelMediator().set(this.getEl().value);\n\t\t}, [], null);\n\t}\n\n\tpublic handleRadioInput(event: Event): void {\n\t\tif (this.getEl().checked) {\n\t\t\tthis.$apply(() => {\n\t\t\t\tthis.getModelMediator().set(this.getEl().value);\n\t\t\t}, [], null);\n\t\t}\n\t}\n\n\tprotected onTargetChange(previous: string, current: string): void {\n\t\tthis.getEl().value = current;\n\t}\n\n\tprotected onRadioTargetChange(previous: string, current: string): void {\n\t\tif (this.getEl().value === current) {\n\t\t\tthis.getEl().checked = true;\n\t\t}\n\t}\n\n}\n\nexport default InputValueModel;\n","import { ElementMediator } from \"../Core\";\n\n/**\n *\n */\nclass Visible extends ElementMediator<boolean, HTMLElement> {\n\n\tpublic static readonly KEY: string = \"visible\";\n\n\tpublic wire(): void {\n\t\tthis.getModelMediator().watch(this, this.onTargetChange);\n\t}\n\n\tpublic unwire(): void {\n\t\t// Intentionally do nothing\n\t}\n\n\tprotected onTargetChange(previous: boolean, current: boolean): void {\n\t\tthis.getEl().hidden = !current;\n\t}\n\n}\n\nexport default Visible;\n","import { Component, ElementMediator, INTERNAL_DIRECT_CHANNEL_NAME, Properties } from \"../Core\";\nimport Guard from \"../Guard\";\nimport LoggerFactory from \"../logger/LoggerFactory\";\nimport ObjectUtils from \"../ObjectUtils\";\n\nconst LOGGER = LoggerFactory.getLogger(\"RepeatElementMediator\");\nconst DEFAULT_ID_KEY: string = \"id\";\nconst DOCUMENT: Document = Properties.getWindow().document;\n\ninterface ElementMediatorValues {\n\n\tidKey: string;\n\n\titem: string;\n\n\tempty: string;\n\n\tfirst: string;\n\n\tlast: string;\n\n\titems: any[];\n\n}\n\ninterface ComponentMap {\n\n\t[id: string]: Component;\n\n}\n\n/**\n *\n */\nclass Repeat extends ElementMediator<ElementMediatorValues, HTMLElement> {\n\n\tprivate idKey: string;\n\n\tprivate itemComponentName: string;\n\n\tprivate map: ComponentMap;\n\n\tprivate empty: Component;\n\n\tprivate first: Component;\n\n\tprivate last: Component;\n\n\tprivate ids: string[];\n\n\tprivate itemTemplate: string;\n\n\tprivate initialized: boolean = false;\n\n\tpublic wire(): void {\n\t\tthis.map = {};\n\t\tthis.empty = null;\n\t\tthis.ids = [];\n\t\tthis.itemTemplate = null;\n\t\tthis.getModelMediator().setReducer((input) => input.items);\n\t\tthis.getModelMediator().watch(this, this.onTargetChange);\n\t\tthis.getModelMediator().onDigest(this, this.onDigest);\n\t}\n\n\tpublic unwire(): void {\n\t\tif (this.empty) {\n\t\t\tthis.empty.dispose();\n\t\t}\n\n\t\tif (this.first) {\n\t\t\tthis.first.dispose();\n\t\t}\n\n\t\tif (this.last) {\n\t\t\tthis.last.dispose();\n\t\t}\n\n\t\tfor (const key in this.map) {\n\t\t\tif (this.map.hasOwnProperty(key)) {\n\t\t\t\tconst component: Component = this.map[key];\n\t\t\t\tcomponent.dispose();\n\t\t\t}\n\t\t}\n\n\t\tthis.empty = null;\n\t\tthis.map = {};\n\t}\n\n\tprotected onDigest(guard: Guard): void {\n\t\tif (guard.isPropagateDown()) {\n\t\t\tfor (const id of this.ids) {\n\t\t\t\tthis.map[id].message(INTERNAL_DIRECT_CHANNEL_NAME, \"digest\", guard);\n\t\t\t}\n\t\t} else {\n\t\t\tthis.getLogger().trace(\"Not propagating to children\");\n\t\t}\n\t}\n\n\tprotected onTargetChange(previous: ElementMediatorValues, current: ElementMediatorValues, guard: Guard): void {\n\t\tif (!this.initialized) {\n\t\t\tconst children: HTMLCollection = this.getEl().children;\n\n\t\t\t// tslint:disable-next-line\n\t\t\tfor (let i = 0; i < children.length; i++) {\n\t\t\t\tconst child: ChildNode = children[i];\n\n\t\t\t\tif (\"template\" === child.nodeName.toLowerCase()) {\n\t\t\t\t\tconst template: HTMLElement = child as HTMLElement;\n\n\t\t\t\t\tif (template.innerHTML) {\n\t\t\t\t\t\tconst markup: string = template.innerHTML.trim();\n\t\t\t\t\t\tconst type: string = template.getAttribute(\"type\");\n\n\t\t\t\t\t\tif (\"empty\" === type) {\n\t\t\t\t\t\t\tthis.empty = new Component(markup);\n\t\t\t\t\t\t\tthis.empty.message(INTERNAL_DIRECT_CHANNEL_NAME, \"setParent\", this.getParent());\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (\"first\" === type) {\n\t\t\t\t\t\t\tthis.first = new Component(markup);\n\t\t\t\t\t\t\tthis.first.message(INTERNAL_DIRECT_CHANNEL_NAME, \"setParent\", this.getParent());\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (\"after\" === type) {\n\t\t\t\t\t\t\tthis.last = new Component(markup);\n\t\t\t\t\t\t\tthis.last.message(INTERNAL_DIRECT_CHANNEL_NAME, \"setParent\", this.getParent());\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (\"item\" === type) {\n\t\t\t\t\t\t\tthis.itemTemplate = markup;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.idKey = current.idKey || DEFAULT_ID_KEY;\n\t\t\tthis.itemComponentName = current.item;\n\n\t\t\tif (current.empty && !this.empty) {\n\t\t\t\tthis.empty = this.getComponent(current.empty);\n\t\t\t\tthis.empty.message(INTERNAL_DIRECT_CHANNEL_NAME, \"setParent\", this.getParent());\n\t\t\t}\n\n\t\t\tif (current.first && !this.first) {\n\t\t\t\tthis.first = this.getComponent(current.first);\n\t\t\t\tthis.first.message(INTERNAL_DIRECT_CHANNEL_NAME, \"setParent\", this.getParent());\n\t\t\t}\n\n\t\t\tif (current.last && !this.last) {\n\t\t\t\tthis.last = this.getComponent(current.last);\n\t\t\t\tthis.last.message(INTERNAL_DIRECT_CHANNEL_NAME, \"setParent\", this.getParent());\n\t\t\t}\n\n\t\t\tif (this.empty) {\n\t\t\t\tthis.initAsRepeatable(this.empty);\n\t\t\t}\n\n\t\t\tif (this.first) {\n\t\t\t\tthis.initAsRepeatable(this.first);\n\t\t\t}\n\n\t\t\tif (this.last) {\n\t\t\t\tthis.initAsRepeatable(this.last);\n\t\t\t}\n\n\t\t\tthis.initialized = true;\n\t\t}\n\n\t\tconst newIds: string[] = [];\n\n\t\tfor (const item of current.items) {\n\t\t\tconst id: string = item[this.idKey] + \"\";\n\t\t\tnewIds.push(id);\n\t\t}\n\n\t\tif (!ObjectUtils.equals(this.ids, newIds)) {\n\t\t\tconst newMap: ComponentMap = {};\n\t\t\tconst components: Component[] = [];\n\n\t\t\tfor (const item of current.items) {\n\t\t\t\tconst id: string = item[this.idKey] + \"\";\n\t\t\t\tconst component: Component = this.map[id] ? this.map[id] : this.create(item);\n\t\t\t\tnewMap[id] = component;\n\t\t\t\tcomponents.push(component);\n\t\t\t\tdelete this.map[id];\n\t\t\t}\n\n\t\t\tfor (const key in this.map) {\n\t\t\t\tif (this.map.hasOwnProperty(key)) {\n\t\t\t\t\tconst component: Component = this.map[key];\n\t\t\t\t\tcomponent.dispose();\n\t\t\t\t\tdelete this.map[key];\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.map = newMap;\n\t\t\tconst el: HTMLElement = this.getEl();\n\n\t\t\twhile (el.firstChild) {\n\t\t\t\tel.removeChild(el.firstChild);\n\t\t\t}\n\n\t\t\tif (components.length === 0) {\n\t\t\t\tif (this.empty) {\n\t\t\t\t\tel.appendChild(this.empty.getEl());\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tconst fragment: DocumentFragment = DOCUMENT.createDocumentFragment();\n\n\t\t\t\tif (this.first) {\n\t\t\t\t\tfragment.appendChild(this.first.getEl());\n\t\t\t\t}\n\n\t\t\t\tfor (const component of components) {\n\t\t\t\t\tfragment.appendChild(component.getEl());\n\t\t\t\t}\n\n\t\t\t\tif (this.last) {\n\t\t\t\t\tfragment.appendChild(this.last.getEl());\n\t\t\t\t}\n\n\t\t\t\tel.appendChild(fragment);\n\t\t\t}\n\t\t}\n\n\t\tfor (const id of newIds) {\n\t\t\tthis.map[id].message(INTERNAL_DIRECT_CHANNEL_NAME, \"digest\", guard);\n\t\t}\n\n\t\tthis.ids = newIds;\n\t}\n\n\tprivate getComponent(name: string): Component {\n\t\treturn this.getParent().get(name);\n\t}\n\n\tprivate create(data: any): Component {\n\t\tconst component: Component = (this.itemTemplate === null)\n\t\t\t? this.getComponent(this.itemComponentName)\n\t\t\t: new Component(this.itemTemplate);\n\n\t\tthis.initAsRepeatable(component);\n\t\tcomponent.message(INTERNAL_DIRECT_CHANNEL_NAME, \"setData\", data);\n\t\tcomponent.message(INTERNAL_DIRECT_CHANNEL_NAME, \"setParent\", this.getParent());\n\n\t\treturn component;\n\t}\n\n\tprivate initAsRepeatable(component: Component): void {\n\t\tcomponent.message(INTERNAL_DIRECT_CHANNEL_NAME, \"setMode\", \"repeatable\");\n\t}\n\n}\n\nexport default Repeat;\n","import { Component, INTERNAL_DIRECT_CHANNEL_NAME, StageComponent } from \"./Core\";\nimport CydranConfig from \"./CydranConfig\";\nimport DomUtils from \"./DomUtils\";\nimport Logger from \"./logger/Logger\";\nimport LoggerFactory from \"./logger/LoggerFactory\";\n\nclass Stage {\n\n\tprivate started: boolean;\n\n\tprivate rootSelector: string;\n\n\tprivate logger: Logger;\n\n\tprivate initializers: Array<(() => void)>;\n\n\tprivate root: StageComponent;\n\n\tconstructor(rootSelector: string) {\n\t\tthis.logger = LoggerFactory.getLogger(\"Stage\");\n\t\tthis.started = false;\n\t\tthis.rootSelector = rootSelector;\n\t\tthis.initializers = [];\n\t\tthis.root = null;\n\t}\n\n\tpublic withInitializer(callback: () => void): Stage {\n\t\tthis.initializers.push(callback);\n\n\t\treturn this;\n\t}\n\n\tpublic start(): void {\n\t\tthis.logger.debug(\"Start Requested\");\n\n\t\tif (this.started) {\n\t\t\tthis.logger.debug(\"Aleady Started\");\n\t\t\treturn;\n\t\t}\n\n\t\tthis.logger.debug(\"Cydran Starting\");\n\n\t\tDomUtils.domReady(() => this.domReady());\n\t}\n\n\tpublic setComponent(component: Component): Stage {\n\t\tthis.root.setChild(\"body\", component);\n\n\t\treturn this;\n\t}\n\n\tpublic get<T>(id: string): T {\n\t\treturn this.root.get(id);\n\t}\n\n\tpublic getConfig(): CydranConfig {\n\t\treturn new CydranConfig();\n\t}\n\n\tprivate domReady(): void {\n\t\tthis.logger.debug(\"DOM Ready\");\n\t\tthis.root = new StageComponent(this.rootSelector);\n\t\tthis.root.message(INTERNAL_DIRECT_CHANNEL_NAME, \"setParent\", null);\n\t\tthis.started = true;\n\t\tthis.logger.debug(\"Running initializers\");\n\n\t\tfor (const initializer of this.initializers) {\n\t\t\tinitializer.apply(this);\n\t\t}\n\n\t\tthis.logger.debug(\"Startup Complete\");\n\t}\n\n}\n\nexport default Stage;\n","import { Properties } from \"./Core\";\n// TODO - Refactor this\n\nconst domReady = function(callback) {\n\tlet ready = false;\n\tconst WIN = Properties.getWindow();\n\tconst DOC = WIN.document;\n\n\tconst detach = function() {\n\t\tif (DOC.addEventListener) {\n\t\t\tDOC.removeEventListener(\"DOMContentLoaded\", completed);\n\t\t\tWIN.removeEventListener(\"load\", completed);\n\t\t} else {\n\t\t\tWIN[\"detachEvent\"](\"onreadystatechange\", completed);\n\t\t\tWIN[\"detachEvent\"](\"onload\", completed);\n\t\t}\n\t};\n\n\tconst completed = function() {\n\t\tif (!ready && (DOC.addEventListener || event.type === \"load\" || DOC.readyState === \"complete\")) {\n\t\t\tready = true;\n\t\t\tdetach();\n\t\t\tcallback();\n\t\t}\n\t};\n\n\tif (DOC.readyState === \"complete\") {\n\t\tcallback();\n\t} else if (DOC.addEventListener) {\n\t\tDOC.addEventListener(\"DOMContentLoaded\", completed);\n\t\tWIN.addEventListener(\"load\", completed);\n\t} else {\n\t\tDOC[\"attachEvent\"](\"onreadystatechange\", completed);\n\t\tWIN[\"attachEvent\"](\"onload\", completed);\n\n\t\tlet top = false;\n\n\t\ttry {\n\t\t\ttop = (WIN.frameElement == null && DOC.documentElement) ? true : false;\n\t\t} catch (e) {\n\t\t\t// Intentionally do nothing\n\t\t}\n\n\t\tif (top && top[\"doScroll\"]) {\n\t\t\t(function scrollCheck() {\n\t\t\t\tif (ready) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\ttry {\n\t\t\t\t\ttop[\"doScroll\"](\"left\");\n\t\t\t\t} catch (e) {\n\t\t\t\t\treturn setTimeout(scrollCheck, 50);\n\t\t\t\t}\n\n\t\t\t\tready = true;\n\t\t\t\tdetach();\n\t\t\t\tcallback();\n\t\t\t})();\n\t\t}\n\t}\n};\n\nconst result = {\n\tdomReady: domReady,\n};\n\nexport default result;\n"],"sourceRoot":""}